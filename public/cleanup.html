<!DOCTYPE html>
<html>
<head>
    <title>Clear Cache and Reload</title>
    <script>
        // Unregister service workers
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(registrations => {
                for (const registration of registrations) {
                    registration.unregister();
                    console.log('ServiceWorker unregistered:', registration);
                }
            });
        }

        // Clear all caches
        if ('caches' in window) {
            caches.keys().then(cacheNames => {
                return Promise.all(
                    cacheNames.map(cacheName => {
                        console.log('Deleting cache:', cacheName);
                        return caches.delete(cacheName);
                    })
                );
            }).then(() => {
                console.log('All caches cleared');
                // Clear localStorage and sessionStorage
                localStorage.clear();
                sessionStorage.clear();
                console.log('Local and session storage cleared');
                
                // Force reload the main page after a short delay
                setTimeout(() => {
                    window.location.href = 'http://localhost:3000';
                }, 1000);
            });
        } else {
            // If caches API is not available, just clear storage and reload
            localStorage.clear();
            sessionStorage.clear();
            console.log('Local and session storage cleared');
            setTimeout(() => {
                window.location.href = 'http://localhost:3000';
            }, 500);
        }
    </script>
</head>
<body>
    <h1>Clearing cache and reloading...</h1>
    <p>Please wait while we clear your browser's cache and reload the application.</p>
    <p>If you're not automatically redirected, <a href="http://localhost:3000">click here</a>.</p>
</body>
</html>
