var sS=Object.defineProperty;var aS=(e,t,r)=>t in e?sS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var nr=(e,t,r)=>aS(e,typeof t!="symbol"?t+"":t,r);import{r as x,a as Lc,g as iS,c as Dr,R as at,L as dt,b as zn,d as oS,u as ja,e as Ef,f as Cf,h as py,O as lS,B as cS,i as dS,j as xt,N as gu}from"./vendor-D68f7Of6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();window.ENV={REACT_APP_SUPABASE_URL:"https://pmrxyisasfaimumuobvu.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtcnh5aXNhc2ZhaW11bXVvYnZ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyODQ2ODMsImV4cCI6MjA2ODg2MDY4M30.rVsKq08Ynw82RkCntxWFXOTgP8T0cGyhJvqfrnOH4YQ"};var gy={exports:{}},Dc={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uS=x,hS=Symbol.for("react.element"),fS=Symbol.for("react.fragment"),mS=Object.prototype.hasOwnProperty,pS=uS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gS={key:!0,ref:!0,__self:!0,__source:!0};function xy(e,t,r){var s,a={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(s in t)mS.call(t,s)&&!gS.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:hS,type:e,key:i,ref:l,props:a,_owner:pS.current}}Dc.Fragment=fS;Dc.jsx=xy;Dc.jsxs=xy;gy.exports=Dc;var n=gy.exports,vy,$g=Lc;vy=$g.createRoot,$g.hydrateRoot;const xS="modulepreload",vS=function(e){return"/"+e},zg={},as=function(t,r,s){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(r.map(d=>{if(d=vS(d),d in zg)return;zg[d]=!0;const f=d.endsWith(".css"),h=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":xS,f||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),f)return new Promise((g,v)=>{m.addEventListener("load",g),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})},yS=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>as(async()=>{const{default:s}=await Promise.resolve().then(()=>yi);return{default:s}},void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)};class Pf extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class Bg extends Pf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Fg extends Pf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ug extends Pf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var rh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(rh||(rh={}));var bS=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};class wS{constructor(t,{headers:r={},customFetch:s,region:a=rh.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=yS(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return bS(this,arguments,void 0,function*(r,s={}){var a;try{const{headers:i,method:l,body:c,signal:d}=s;let f={},{region:h}=s;h||(h=this.region);const m=new URL(`${this.url}/${r}`);h&&h!=="any"&&(f["x-region"]=h,m.searchParams.set("forceFunctionRegion",h));let g;c&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",g=c):typeof c=="string"?(f["Content-Type"]="text/plain",g=c):typeof FormData<"u"&&c instanceof FormData?g=c:(f["Content-Type"]="application/json",g=JSON.stringify(c)));const v=yield this.fetch(m.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),i),body:g,signal:d}).catch(w=>{throw w.name==="AbortError"?w:new Bg(w)}),j=v.headers.get("x-relay-error");if(j&&j==="true")throw new Fg(v);if(!v.ok)throw new Ug(v);let _=((a=v.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),y;return _==="application/json"?y=yield v.json():_==="application/octet-stream"?y=yield v.blob():_==="text/event-stream"?y=v:_==="multipart/form-data"?y=yield v.formData():y=yield v.text(),{data:y,error:null,response:v}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new Bg(i)}:{data:null,error:i,response:i instanceof Ug||i instanceof Fg?i.context:void 0}}})}}var Ir={},Af={},Rc={},Co={},$c={},zc={},_S=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},si=_S();const jS=si.fetch,yy=si.fetch.bind(si),by=si.Headers,NS=si.Request,kS=si.Response,yi=Object.freeze(Object.defineProperty({__proto__:null,Headers:by,Request:NS,Response:kS,default:yy,fetch:jS},Symbol.toStringTag,{value:"Module"})),SS=iS(yi);var Bc={};Object.defineProperty(Bc,"__esModule",{value:!0});let ES=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Bc.default=ES;var wy=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zc,"__esModule",{value:!0});const CS=wy(SS),PS=wy(Bc);let AS=class{constructor(t){var r,s;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(s=t.isMaybeSingle)!==null&&s!==void 0?s:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=CS.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var l,c,d,f;let h=null,m=null,g=null,v=i.status,j=i.statusText;if(i.ok){if(this.method!=="HEAD"){const k=await i.text();k===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((l=this.headers.get("Accept"))===null||l===void 0)&&l.includes("application/vnd.pgrst.plan+text"))?m=k:m=JSON.parse(k))}const y=(c=this.headers.get("Prefer"))===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),w=(d=i.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");y&&w&&w.length>1&&(g=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(h={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,g=null,v=406,j="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const y=await i.text();try{h=JSON.parse(y),Array.isArray(h)&&i.status===404&&(m=[],h=null,v=200,j="OK")}catch{i.status===404&&y===""?(v=204,j="No Content"):h={message:y}}if(h&&this.isMaybeSingle&&(!((f=h==null?void 0:h.details)===null||f===void 0)&&f.includes("0 rows"))&&(h=null,v=200,j="OK"),h&&this.shouldThrowOnError)throw new PS.default(h)}return{error:h,data:m,count:g,status:v,statusText:j}});return this.shouldThrowOnError||(a=a.catch(i=>{var l,c,d;return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(c=i==null?void 0:i.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(d=i==null?void 0:i.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};zc.default=AS;var TS=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($c,"__esModule",{value:!0});const OS=TS(zc);let MS=class extends OS.default{select(t){let r=!1;const s=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:s,foreignTable:a,referencedTable:i=a}={}){const l=i?`${i}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${t}.${r?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:s=r}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:s,referencedTable:a=s}={}){const i=typeof a>"u"?"offset":`${a}.offset`,l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(l,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:s=!1,buffers:a=!1,wal:i=!1,format:l="text"}={}){var c;const d=[t?"analyze":null,r?"verbose":null,s?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),f=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${f}"; options=${d};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};$c.default=MS;var IS=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Co,"__esModule",{value:!0});const LS=IS($c);let DS=class extends LS.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const s=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${s})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:s,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const l=s===void 0?"":`(${s})`;return this.url.searchParams.append(t,`${i}fts${l}.${r}`),this}match(t){return Object.entries(t).forEach(([r,s])=>{this.url.searchParams.append(r,`eq.${s}`)}),this}not(t,r,s){return this.url.searchParams.append(t,`not.${r}.${s}`),this}or(t,{foreignTable:r,referencedTable:s=r}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,s){return this.url.searchParams.append(t,`${r}.${s}`),this}};Co.default=DS;var RS=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rc,"__esModule",{value:!0});const Hi=RS(Co);let $S=class{constructor(t,{headers:r={},schema:s,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=s,this.fetch=a}select(t,r){const{head:s=!1,count:a}=r??{},i=s?"HEAD":"GET";let l=!1;const c=(t??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),a&&this.headers.append("Prefer",`count=${a}`),new Hi.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:s=!0}={}){var a;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(l.length>0){const c=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Hi.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:s=!1,count:a,defaultToNull:i=!0}={}){var l;const c="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const d=t.reduce((f,h)=>f.concat(Object.keys(h)),[]);if(d.length>0){const f=[...new Set(d)].map(h=>`"${h}"`);this.url.searchParams.set("columns",f.join(","))}}return new Hi.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(t,{count:r}={}){var s;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Hi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:t}={}){var r;const s="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Hi.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Rc.default=$S;var _y=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Af,"__esModule",{value:!0});const zS=_y(Rc),BS=_y(Co);let FS=class jy{constructor(t,{headers:r={},schema:s,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new zS.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new jy(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:a=!1,count:i}={}){var l;let c;const d=new URL(`${this.url}/rpc/${t}`);let f;s||a?(c=s?"HEAD":"GET",Object.entries(r).filter(([m,g])=>g!==void 0).map(([m,g])=>[m,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([m,g])=>{d.searchParams.append(m,g)})):(c="POST",f=r);const h=new Headers(this.headers);return i&&h.set("Prefer",`count=${i}`),new BS.default({method:c,url:d,headers:h,schema:this.schemaName,body:f,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};Af.default=FS;var bi=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.PostgrestError=Ir.PostgrestBuilder=Ir.PostgrestTransformBuilder=Ir.PostgrestFilterBuilder=Ir.PostgrestQueryBuilder=Ir.PostgrestClient=void 0;const Ny=bi(Af);Ir.PostgrestClient=Ny.default;const ky=bi(Rc);Ir.PostgrestQueryBuilder=ky.default;const Sy=bi(Co);Ir.PostgrestFilterBuilder=Sy.default;const Ey=bi($c);Ir.PostgrestTransformBuilder=Ey.default;const Cy=bi(zc);Ir.PostgrestBuilder=Cy.default;const Py=bi(Bc);Ir.PostgrestError=Py.default;var US=Ir.default={PostgrestClient:Ny.default,PostgrestQueryBuilder:ky.default,PostgrestFilterBuilder:Sy.default,PostgrestTransformBuilder:Ey.default,PostgrestBuilder:Cy.default,PostgrestError:Py.default};const{PostgrestClient:WS,PostgrestQueryBuilder:u7,PostgrestFilterBuilder:h7,PostgrestTransformBuilder:f7,PostgrestBuilder:m7,PostgrestError:p7}=US;class qS{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const GS="2.75.0",HS=`realtime-js/${GS}`,VS="1.0.0",nh=1e4,KS=1e3,ZS=100;var ao;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ao||(ao={}));var Yt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Yt||(Yt={}));var vn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(vn||(vn={}));var sh;(function(e){e.websocket="websocket"})(sh||(sh={}));var ra;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ra||(ra={}));class YS{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),s=new TextDecoder;return this._decodeBroadcast(t,r,s)}_decodeBroadcast(t,r,s){const a=r.getUint8(1),i=r.getUint8(2);let l=this.HEADER_LENGTH+2;const c=s.decode(t.slice(l,l+a));l=l+a;const d=s.decode(t.slice(l,l+i));l=l+i;const f=JSON.parse(s.decode(t.slice(l,t.byteLength)));return{ref:null,topic:c,event:d,payload:f}}}class Ay{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var vt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(vt||(vt={}));const Wg=(e,t,r={})=>{var s;const a=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((i,l)=>(i[l]=XS(l,e,t,a),i),{}):{}},XS=(e,t,r,s)=>{const a=t.find(c=>c.name===e),i=a==null?void 0:a.type,l=r[e];return i&&!s.includes(i)?Ty(i,l):ah(l)},Ty=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return t2(t,r)}switch(e){case vt.bool:return JS(t);case vt.float4:case vt.float8:case vt.int2:case vt.int4:case vt.int8:case vt.numeric:case vt.oid:return QS(t);case vt.json:case vt.jsonb:return e2(t);case vt.timestamp:return r2(t);case vt.abstime:case vt.date:case vt.daterange:case vt.int4range:case vt.int8range:case vt.money:case vt.reltime:case vt.text:case vt.time:case vt.timestamptz:case vt.timetz:case vt.tsrange:case vt.tstzrange:return ah(t);default:return ah(t)}},ah=e=>e,JS=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},QS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},e2=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},t2=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(c=>Ty(t,c))}return e},r2=e=>typeof e=="string"?e.replace(" ","T"):e,Oy=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class xu{constructor(t,r,s={},a=nh){this.channel=t,this.event=r,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var qg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(qg||(qg={}));class io{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=io.syncState(this.state,a,i,l),this.pendingDiffs.forEach(d=>{this.state=io.syncDiff(this.state,d,i,l)}),this.pendingDiffs=[],c()}),this.channel._on(s.diff,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=io.syncDiff(this.state,a,i,l),c())}),this.onJoin((a,i,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:l})}),this.onLeave((a,i,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,a){const i=this.cloneDeep(t),l=this.transformState(r),c={},d={};return this.map(i,(f,h)=>{l[f]||(d[f]=h)}),this.map(l,(f,h)=>{const m=i[f];if(m){const g=h.map(y=>y.presence_ref),v=m.map(y=>y.presence_ref),j=h.filter(y=>v.indexOf(y.presence_ref)<0),_=m.filter(y=>g.indexOf(y.presence_ref)<0);j.length>0&&(c[f]=j),_.length>0&&(d[f]=_)}else c[f]=h}),this.syncDiff(i,{joins:c,leaves:d},s,a)}static syncDiff(t,r,s,a){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var f;const h=(f=t[c])!==null&&f!==void 0?f:[];if(t[c]=this.cloneDeep(d),h.length>0){const m=t[c].map(v=>v.presence_ref),g=h.filter(v=>m.indexOf(v.presence_ref)<0);t[c].unshift(...g)}s(c,h,d)}),this.map(l,(c,d)=>{let f=t[c];if(!f)return;const h=d.map(m=>m.presence_ref);f=f.filter(m=>h.indexOf(m.presence_ref)<0),t[c]=f,a(c,f,d),f.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const a=t[s];return"metas"in a?r[s]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Gg||(Gg={}));var oo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(oo||(oo={}));var Vn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Vn||(Vn={}));class Tf{constructor(t,r={config:{}},s){var a,i;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Yt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new xu(this,vn.join,this.params,this.timeout),this.rejoinTimer=new Ay(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Yt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Yt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vn.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new io(this),this.broadcastEndpointURL=Oy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Yt.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,f=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(v=>v.filter))!==null&&a!==void 0?a:[],h=!!this.bindings[oo.PRESENCE]&&this.bindings[oo.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,m={},g={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:h}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>t==null?void 0:t(Vn.CHANNEL_ERROR,v)),this._onClose(()=>t==null?void 0:t(Vn.CLOSED)),this.updateJoinPayload(Object.assign({config:g},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var j;if(this.socket.setAuth(),v===void 0){t==null||t(Vn.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,y=(j=_==null?void 0:_.length)!==null&&j!==void 0?j:0,w=[];for(let k=0;k<y;k++){const N=_[k],{filter:{event:P,schema:O,table:T,filter:A}}=N,C=v&&v[k];if(C&&C.event===P&&C.schema===O&&C.table===T&&C.filter===A)w.push(Object.assign(Object.assign({},N),{id:C.id}));else{this.unsubscribe(),this.state=Yt.errored,t==null||t(Vn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(Vn.SUBSCRIBED);return}}).receive("error",v=>{this.state=Yt.errored,t==null||t(Vn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Vn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Yt.joined&&t===oo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,s)}async send(t,r={}){var s,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:l}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,c,d;const f=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),f.receive("ok",()=>i("ok")),f.receive("error",()=>i("error")),f.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Yt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new xu(this,vn.leave,{},t),s.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Yt.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const a=new AbortController,i=setTimeout(()=>a.abort(),s),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),l}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new xu(this,t,r,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>ZS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var a,i;const l=t.toLocaleLowerCase(),{close:c,error:d,leave:f,join:h}=vn;if(s&&[c,d,f,h].indexOf(l)>=0&&s!==this._joinRef())return;let g=this._onMessage(l,r,s);if(r&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var j,_,y;return((j=v.filter)===null||j===void 0?void 0:j.event)==="*"||((y=(_=v.filter)===null||_===void 0?void 0:_.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===l}).map(v=>v.callback(g,s)):(i=this.bindings[l])===null||i===void 0||i.filter(v=>{var j,_,y,w,k,N;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in v){const P=v.id,O=(j=v.filter)===null||j===void 0?void 0:j.event;return P&&((_=r.ids)===null||_===void 0?void 0:_.includes(P))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const P=(k=(w=v==null?void 0:v.filter)===null||w===void 0?void 0:w.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return P==="*"||P===((N=r==null?void 0:r.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===l}).map(v=>{if(typeof g=="object"&&"ids"in g){const j=g.data,{schema:_,table:y,commit_timestamp:w,type:k,errors:N}=j;g=Object.assign(Object.assign({},{schema:_,table:y,commit_timestamp:w,eventType:k,new:{},old:{},errors:N}),this._getPayloadRecords(j))}v.callback(g,s)})}_isClosed(){return this.state===Yt.closed}_isJoined(){return this.state===Yt.joined}_isJoining(){return this.state===Yt.joining}_isLeaving(){return this.state===Yt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:s};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Tf.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(vn.close,{},t)}_onError(t){this._on(vn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Yt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Wg(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Wg(t.columns,t.old_record)),r}}const vu=()=>{},yl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},n2=[1e3,2e3,5e3,1e4],s2=1e4,a2=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class i2{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=nh,this.transport=null,this.heartbeatIntervalMs=yl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=vu,this.ref=0,this.reconnectTimer=null,this.logger=vu,this.conn=null,this.sendBuffer=[],this.serializer=new YS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...l)=>as(async()=>{const{default:c}=await Promise.resolve().then(()=>yi);return{default:c}},void 0).then(({default:c})=>c(...l)).catch(c=>{throw new Error(`Failed to load @supabase/node-fetch: ${c.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...l)=>i(...l)},!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${sh.websocket}`,this.httpEndpoint=Oy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=qS.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VS}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ao.connecting:return ra.Connecting;case ao.open:return ra.Open;case ao.closing:return ra.Closing;default:return ra.Closed}}isConnected(){return this.connectionState()===ra.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===s);if(a)return a;{const i=new Tf(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:s,payload:a,ref:i}=t,l=()=>{this.encode(t,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${r} ${s} (${i})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(KS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},yl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:a,payload:i,ref:l}=r,c=l?`(${l})`:"",d=i.status||"";this.log("receive",`${d} ${s} ${a} ${c}`.trim(),i),this.channels.filter(f=>f._isMember(s)).forEach(f=>f._trigger(a,i,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(vn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${s}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([a2],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const a={access_token:r,version:HS};r&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(vn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Ay(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},yl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,a,i,l,c,d,f,h;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:nh,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:yl.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=t==null?void 0:t.heartbeatCallback)!==null&&c!==void 0?c:vu,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t==null?void 0:t.reconnectAfterMs)!==null&&d!==void 0?d:m=>n2[m-1]||s2,this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:(m,g)=>g(JSON.stringify(m)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Of extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Wt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class o2 extends Of{constructor(t,r,s){super(t),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ih extends Of{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var l2=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};const My=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>as(async()=>{const{default:s}=await Promise.resolve().then(()=>yi);return{default:s}},void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)},c2=()=>l2(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield as(()=>Promise.resolve().then(()=>yi),void 0)).Response:Response}),oh=e=>{if(Array.isArray(e))return e.map(r=>oh(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=oh(s)}),t},d2=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Na=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};const yu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),u2=(e,t,r)=>Na(void 0,void 0,void 0,function*(){const s=yield c2();e instanceof s&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const i=e.status||500,l=(a==null?void 0:a.statusCode)||i+"";t(new o2(yu(a),i,l))}).catch(a=>{t(new ih(yu(a),a))}):t(new ih(yu(e),e))}),h2=(e,t,r,s)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!s?a:(d2(s)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function Po(e,t,r,s,a,i){return Na(this,void 0,void 0,function*(){return new Promise((l,c)=>{e(r,h2(t,s,a,i)).then(d=>{if(!d.ok)throw d;return s!=null&&s.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>u2(d,c,s))})})}function ql(e,t,r,s){return Na(this,void 0,void 0,function*(){return Po(e,"GET",t,r,s)})}function Cn(e,t,r,s,a){return Na(this,void 0,void 0,function*(){return Po(e,"POST",t,s,a,r)})}function lh(e,t,r,s,a){return Na(this,void 0,void 0,function*(){return Po(e,"PUT",t,s,a,r)})}function f2(e,t,r,s){return Na(this,void 0,void 0,function*(){return Po(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Iy(e,t,r,s,a){return Na(this,void 0,void 0,function*(){return Po(e,"DELETE",t,s,a,r)})}var m2=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};class p2{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return m2(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}}var g2=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};class x2{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new p2(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return g2(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}}var Tr=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};const v2={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Hg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class y2{constructor(t,r={},s,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=s,this.fetch=My(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,s,a){return Tr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},Hg),a);let c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=s,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(r),h=this._getFinalPath(f),m=yield(t=="PUT"?lh:Cn)(this.fetch,`${this.url}/object/${h}`,i,Object.assign({headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:f,id:m.Id,fullPath:m.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Wt(i))return{data:null,error:i};throw i}})}upload(t,r,s){return Tr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,s)})}uploadToSignedUrl(t,r,s,a){return Tr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),l=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",r);try{let d;const f=Object.assign({upsert:Hg.upsert},a),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&s instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",s)):typeof FormData<"u"&&s instanceof FormData?(d=s,d.append("cacheControl",f.cacheControl)):(d=s,h["cache-control"]=`max-age=${f.cacheControl}`,h["content-type"]=f.contentType);const m=yield lh(this.fetch,c.toString(),d,{headers:h});return{data:{path:i,fullPath:m.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Wt(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t,r){return Tr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield Cn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),l=new URL(this.url+i.url),c=l.searchParams.get("token");if(!c)throw new Of("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:c},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}update(t,r,s){return Tr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,s)})}move(t,r,s){return Tr(this,void 0,void 0,function*(){try{return{data:yield Cn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}copy(t,r,s){return Tr(this,void 0,void 0,function*(){try{return{data:{path:(yield Cn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,s){return Tr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield Cn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const l=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,s){return Tr(this,void 0,void 0,function*(){try{const a=yield Cn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}download(t,r){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),l=i?`?${i}`:"",c=this._getFinalPath(t),d=()=>ql(this.fetch,`${this.url}/${a}/${c}${l}`,{headers:this.headers,noResolveJson:!0});return new x2(d,this.shouldThrowOnError)}info(t){return Tr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const s=yield ql(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:oh(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}exists(t){return Tr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield f2(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s)&&s instanceof ih){const a=s.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,r){const s=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const c=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});d!==""&&a.push(d);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${s}${f}`)}}}remove(t){return Tr(this,void 0,void 0,function*(){try{return{data:yield Iy(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}})}list(t,r,s){return Tr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},v2),r),{prefix:t||""});return{data:yield Cn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}listV2(t,r){return Tr(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield Cn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const b2="2.75.0",w2={"X-Client-Info":`storage-js/${b2}`};var za=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};class _2{constructor(t,r={},s,a){this.shouldThrowOnError=!1;const i=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},w2),r),this.fetch=My(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return za(this,void 0,void 0,function*(){try{return{data:yield ql(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}getBucket(t){return za(this,void 0,void 0,function*(){try{return{data:yield ql(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}})}createBucket(t){return za(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield Cn(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return za(this,void 0,void 0,function*(){try{return{data:yield lh(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}emptyBucket(t){return za(this,void 0,void 0,function*(){try{return{data:yield Cn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return za(this,void 0,void 0,function*(){try{return{data:yield Iy(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}})}}class j2 extends _2{constructor(t,r={},s,a){super(t,r,s,a)}from(t){return new y2(this.url,this.headers,t,this.fetch)}}const N2="2.75.0";let ro="";typeof Deno<"u"?ro="deno":typeof document<"u"?ro="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ro="react-native":ro="node";const k2={"X-Client-Info":`supabase-js-${ro}/${N2}`},S2={headers:k2},E2={schema:"public"},C2={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},P2={};var A2=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};const T2=e=>{let t;return e?t=e:typeof fetch>"u"?t=yy:t=fetch,(...r)=>t(...r)},O2=()=>typeof Headers>"u"?by:Headers,M2=(e,t,r)=>{const s=T2(r),a=O2();return(i,l)=>A2(void 0,void 0,void 0,function*(){var c;const d=(c=yield t())!==null&&c!==void 0?c:e;let f=new a(l==null?void 0:l.headers);return f.has("apikey")||f.set("apikey",e),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),s(i,Object.assign(Object.assign({},l),{headers:f}))})};var I2=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};function L2(e){return e.endsWith("/")?e:e+"/"}function D2(e,t){var r,s;const{db:a,auth:i,realtime:l,global:c}=e,{db:d,auth:f,realtime:h,global:m}=t,g={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},f),i),realtime:Object.assign(Object.assign({},h),l),storage:{},global:Object.assign(Object.assign(Object.assign({},m),c),{headers:Object.assign(Object.assign({},(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{}),(s=c==null?void 0:c.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>I2(this,void 0,void 0,function*(){return""})};return e.accessToken?g.accessToken=e.accessToken:delete g.accessToken,g}function R2(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(L2(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Ly="2.75.0",Za=30*1e3,ch=3,bu=ch*Za,$2="http://localhost:9999",z2="supabase.auth.token",B2={"X-Client-Info":`gotrue-js/${Ly}`},dh="X-Supabase-Api-Version",Dy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},F2=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,U2=10*60*1e3;class ho extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Le(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class W2 extends ho{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function q2(e){return Le(e)&&e.name==="AuthApiError"}class na extends ho{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ls extends ho{constructor(t,r,s,a){super(t,s,a),this.name=r,this.status=s}}class js extends Ls{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function G2(e){return Le(e)&&e.name==="AuthSessionMissingError"}class Ba extends Ls{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bl extends Ls{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class wl extends Ls{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function H2(e){return Le(e)&&e.name==="AuthImplicitGrantRedirectError"}class Vg extends Ls{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class uh extends Ls{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function wu(e){return Le(e)&&e.name==="AuthRetryableFetchError"}class Kg extends Ls{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class hh extends Ls{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Gl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zg=` 	
\r=`.split(""),V2=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Zg.length;t+=1)e[Zg[t].charCodeAt(0)]=-2;for(let t=0;t<Gl.length;t+=1)e[Gl[t].charCodeAt(0)]=t;return e})();function Yg(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Gl[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Gl[s]),t.queuedBits-=6}}function Ry(e,t,r){const s=V2[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Xg(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=l=>{Y2(l,s,r)};for(let l=0;l<e.length;l+=1)Ry(e.charCodeAt(l),a,i);return t.join("")}function K2(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Z2(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}K2(s,t)}}function Y2(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ei(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Ry(e.charCodeAt(a),r,s);return new Uint8Array(t)}function X2(e){const t=[];return Z2(e,r=>t.push(r)),new Uint8Array(t)}function ia(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};return e.forEach(a=>Yg(a,r,s)),Yg(null,r,s),t.join("")}function J2(e){return Math.round(Date.now()/1e3)+e}function Q2(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Br=()=>typeof window<"u"&&typeof document<"u",Vs={tested:!1,writable:!1},$y=()=>{if(!Br())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vs.tested)return Vs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vs.tested=!0,Vs.writable=!0}catch{Vs.tested=!0,Vs.writable=!1}return Vs.writable};function eE(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((s,a)=>{t[a]=s}),t}const zy=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>as(async()=>{const{default:s}=await Promise.resolve().then(()=>yi);return{default:s}},void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)},tE=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ya=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ks=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ws=async(e,t)=>{await e.removeItem(t)};class Fc{constructor(){this.promise=new Fc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Fc.promiseConstructor=Promise;function _u(e){const t=e.split(".");if(t.length!==3)throw new hh("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!F2.test(t[s]))throw new hh("JWT not in base64url format");return{header:JSON.parse(Xg(t[0])),payload:JSON.parse(Xg(t[1])),signature:ei(t[2]),raw:{header:t[0],payload:t[1]}}}async function rE(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function nE(e,t){return new Promise((s,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){s(l);return}}catch(l){if(!t(i,l)){a(l);return}}})()})}function sE(e){return("0"+e.toString(16)).substr(-2)}function aE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(t),Array.from(t,sE).join("")}async function iE(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(s);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function oE(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await iE(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Fa(e,t,r=!1){const s=aE();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await Ya(e,`${t}-code-verifier`,a);const i=await oE(s);return[i,s===i?"plain":"s256"]}const lE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function cE(e){const t=e.headers.get(dh);if(!t||!t.match(lE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function dE(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function uE(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const hE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ua(e){if(!hE.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ju(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Jg(e){return JSON.parse(JSON.stringify(e))}var fE=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r};const Js=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),mE=[502,503,504];async function Qg(e){var t;if(!tE(e))throw new uh(Js(e),0);if(mE.includes(e.status))throw new uh(Js(e),e.status);let r;try{r=await e.json()}catch(i){throw new na(Js(i),i)}let s;const a=cE(e);if(a&&a.getTime()>=Dy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Kg(Js(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new js}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new Kg(Js(r),e.status,r.weak_password.reasons);throw new W2(Js(r),e.status||500,s)}const pE=(e,t,r,s)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function Ge(e,t,r,s){var a;const i=Object.assign({},s==null?void 0:s.headers);i[dh]||(i[dh]=Dy["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const l=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(l.redirect_to=s.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await gE(e,t,r+c,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(d):{data:Object.assign({},d),error:null}}async function gE(e,t,r,s,a,i){const l=pE(t,s,a,i);let c;try{c=await e(r,Object.assign({},l))}catch(d){throw console.error(d),new uh(Js(d),0)}if(c.ok||await Qg(c),s!=null&&s.noResolveJson)return c;try{return await c.json()}catch(d){await Qg(d)}}function xn(e){var t;let r=null;yE(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=J2(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function ex(e){const t=xn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ss(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function xE(e){return{data:e,error:null}}function vE(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i}=e,l=fE(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function tx(e){return e}function yE(e){return e.access_token&&e.refresh_token&&e.expires_in}const Nu=["global","local","others"];var bE=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r};class wE{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=zy(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Nu[0]){if(Nu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Nu.join(", ")}`);try{return await Ge(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await Ge(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ss})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=bE(t,["options"]),a=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await Ge(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:vE,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Le(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ge(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ss})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,a,i,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},h=await Ge(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:tx});if(h.error)throw h.error;const m=await h.json(),g=(l=h.headers.get("x-total-count"))!==null&&l!==void 0?l:0,v=(d=(c=h.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(j=>{const _=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(j.split(";")[1].split("=")[1]);f[`${y}Page`]=_}),f.total=parseInt(g)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(Le(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){Ua(t);try{return await Ge(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ss})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ua(t);try{return await Ge(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ss})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){Ua(t);try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ss})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){Ua(t.userId);try{const{data:r,error:s}=await Ge(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:s}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ua(t.userId),Ua(t.id);try{return{data:await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,a,i,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},h=await Ge(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:tx});if(h.error)throw h.error;const m=await h.json(),g=(l=h.headers.get("x-total-count"))!==null&&l!==void 0?l:0,v=(d=(c=h.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(j=>{const _=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(j.split(";")[1].split("=")[1]);f[`${y}Page`]=_}),f.total=parseInt(g)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(Le(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await Ge(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ge(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ge(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}}function rx(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Wa={debug:!!(globalThis&&$y()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class By extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class _E extends By{}async function jE(e,t,r){Wa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),Wa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){Wa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Wa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Wa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new _E(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Wa.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function NE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Fy(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function kE(e){return parseInt(e,16)}function SE(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function EE(e){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:i=new Date,nonce:l,notBefore:c,requestId:d,resources:f,scheme:h,uri:m,version:g}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(g!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${g}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const v=Fy(e.address),j=h?`${h}://${s}`:s,_=e.statement?`${e.statement}
`:"",y=`${j} wants you to sign in with your Ethereum account:
${v}

${_}`;let w=`URI: ${m}
Version: ${g}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${i.toISOString()}`;if(a&&(w+=`
Expiration Time: ${a.toISOString()}`),c&&(w+=`
Not Before: ${c.toISOString()}`),d&&(w+=`
Request ID: ${d}`),f){let k=`
Resources:`;for(const N of f){if(!N||typeof N!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${N}`);k+=`
- ${N}`}w+=k}return`${y}
${w}`}class Ut extends Error{constructor({message:t,code:r,cause:s,name:a}){var i;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=a??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Hl extends Ut{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function CE({error:e,options:t}){var r,s,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ut({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ut({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ut({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ut({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Ut({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Ut({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Ut({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ut({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(Wy(l)){if(i.rp.id!==l)return new Ut({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ut({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Ut({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Ut({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ut({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function PE({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ut({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Ut({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(Wy(s)){if(r.rpId!==s)return new Ut({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ut({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Ut({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ut({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}var Uy=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r};class AE{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const TE=new AE;function OE(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,a=Uy(e,["challenge","user","excludeCredentials"]),i=ei(t).buffer,l=Object.assign(Object.assign({},r),{id:ei(r.id).buffer}),c=Object.assign(Object.assign({},a),{challenge:i,user:l});if(s&&s.length>0){c.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const f=s[d];c.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:ei(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return c}function ME(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=Uy(e,["challenge","allowCredentials"]),a=ei(t).buffer,i=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];i.allowCredentials[l]=Object.assign(Object.assign({},c),{id:ei(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function IE(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ia(new Uint8Array(e.response.attestationObject)),clientDataJSON:ia(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function LE(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ia(new Uint8Array(a.authenticatorData)),clientDataJSON:ia(new Uint8Array(a.clientDataJSON)),signature:ia(new Uint8Array(a.signature)),userHandle:a.userHandle?ia(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Wy(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function nx(){var e,t;return!!(Br()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function DE(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Hl("Browser returned unexpected credential type",t)}:{data:null,error:new Hl("Empty credential response",t)}}catch(t){return{data:null,error:CE({error:t,options:e})}}}async function RE(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Hl("Browser returned unexpected credential type",t)}:{data:null,error:new Hl("Empty credential response",t)}}catch(t){return{data:null,error:PE({error:t,options:e})}}}const $E={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},zE={userVerification:"preferred",hints:["security-key"]};function Vl(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of e)if(a)for(const i in a){const l=a[i];if(l!==void 0)if(Array.isArray(l))s[i]=l;else if(r(l))s[i]=l;else if(t(l)){const c=s[i];t(c)?s[i]=Vl(c,l):s[i]=Vl(l)}else s[i]=l}return s}function BE(e,t){return Vl($E,e,t||{})}function FE(e,t){return Vl(zE,e,t||{})}class UE{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:a},i){try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:c};const d=a??TE.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:f}=l.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${s}`),f.displayName||(f.displayName=f.name)}switch(l.webauthn.type){case"create":{const f=BE(l.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:h,error:m}=await DE({publicKey:f,signal:d});return h?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:h}},error:null}:{data:null,error:m}}case"request":{const f=FE(l.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:h,error:m}=await RE(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:f,signal:d}));return h?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:h}},error:null}:{data:null,error:m}}}}catch(l){return Le(l)?{data:null,error:l}:{data:null,error:new na("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}},i){if(!r)return{data:null,error:new ho("rpId is required for WebAuthn authentication")};try{if(!nx())return{data:null,error:new na("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:a},{request:i});if(!l)return{data:null,error:c};const{webauthn:d}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:s,credential_response:d.credential_response}})}catch(l){return Le(l)?{data:null,error:l}:{data:null,error:new na("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a},i){if(!r)return{data:null,error:new ho("rpId is required for WebAuthn registration")};try{if(!nx())return{data:null,error:new na("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(h=>{var m;return(m=h.data)===null||m===void 0?void 0:m.all.find(g=>g.factor_type==="webauthn"&&g.friendly_name===t&&g.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:c};const{data:d,error:f}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:a},{create:i});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(l){return Le(l)?{data:null,error:l}:{data:null,error:new na("Unexpected error in register",l)}}}}NE();const WE={url:$2,storageKey:z2,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:B2,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function sx(e,t,r){return await r()}const qa={};class fo{get jwks(){var t,r;return(r=(t=qa[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){qa[this.storageKey]=Object.assign(Object.assign({},qa[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=qa[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){qa[this.storageKey]=Object.assign(Object.assign({},qa[this.storageKey]),{cachedAt:t})}constructor(t){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=fo.nextInstanceID,fo.nextInstanceID+=1,this.instanceID>0&&Br()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},WE),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new wE({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=zy(a.fetch),this.lock=a.lock||sx,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Br()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=jE:this.lock=sx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new UE(this)},this.persistSession?(a.storage?this.storage=a.storage:$y()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=rx(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=rx(this.memoryStorage)),Br()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ly}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=eE(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),Br()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),H2(i)){const d=(t=i.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Le(r)?{error:r}:{error:new na("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,a;try{const i=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:xn}),{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(Le(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,s,a;try{let i;if("email"in t){const{email:h,password:m,options:g}=t;let v=null,j=null;this.flowType==="pkce"&&([v,j]=await Fa(this.storage,this.storageKey)),i=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:h,password:m,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:v,code_challenge_method:j},xform:xn})}else if("phone"in t){const{phone:h,password:m,options:g}=t;i=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:m,data:(s=g==null?void 0:g.data)!==null&&s!==void 0?s:{},channel:(a=g==null?void 0:g.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:xn})}else throw new bl("You must provide either an email or phone number and a password");const{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(Le(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:c}=t;r=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ex})}else if("phone"in t){const{phone:i,password:l,options:c}=t;r=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ex})}else throw new bl("You must provide either an email or phone number and a password");const{data:s,error:a}=r;return a?{data:{user:null,session:null},error:a}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Ba}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(r){if(Le(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,s,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,a,i,l,c,d,f,h,m,g;let v,j;if("message"in t)v=t.message,j=t.signature;else{const{chain:_,wallet:y,statement:w,options:k}=t;let N;if(Br())if(typeof y=="object")N=y;else{const E=window;if("ethereum"in E&&typeof E.ethereum=="object"&&"request"in E.ethereum&&typeof E.ethereum.request=="function")N=E.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=y}const P=new URL((r=k==null?void 0:k.url)!==null&&r!==void 0?r:window.location.href),O=await N.request({method:"eth_requestAccounts"}).then(E=>E).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=Fy(O[0]);let A=(s=k==null?void 0:k.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!A){const E=await N.request({method:"eth_chainId"});A=kE(E)}const C={domain:P.host,address:T,statement:w,uri:P.href,version:"1",chainId:A,nonce:(a=k==null?void 0:k.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(l=(i=k==null?void 0:k.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=k==null?void 0:k.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=k==null?void 0:k.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=k==null?void 0:k.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(h=k==null?void 0:k.signInWithEthereum)===null||h===void 0?void 0:h.resources};v=EE(C),j=await N.request({method:"personal_sign",params:[SE(v),T]})}try{const{data:_,error:y}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:j},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:xn});if(y)throw y;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Ba}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:y})}catch(_){if(Le(_))return{data:{user:null,session:null},error:_};throw _}}async signInWithSolana(t){var r,s,a,i,l,c,d,f,h,m,g,v;let j,_;if("message"in t)j=t.message,_=t.signature;else{const{chain:y,wallet:w,statement:k,options:N}=t;let P;if(Br())if(typeof w=="object")P=w;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))P=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=w}const O=new URL((r=N==null?void 0:N.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in P&&P.signIn){const T=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),k?{statement:k}:null));let A;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")A=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)A=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)j=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),_=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${O.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(a=(s=N==null?void 0:N.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=N==null?void 0:N.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((l=N==null?void 0:N.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((f=N==null?void 0:N.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((m=(h=N==null?void 0:N.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||m===void 0)&&m.length?["Resources",...N.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const T=await P.signMessage(new TextEncoder().encode(j),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=T}}try{const{data:y,error:w}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:ia(_)},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:xn});if(w)throw w;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Ba}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:w})}catch(y){if(Le(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const r=await Ks(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(r??"").split("/");try{const{data:i,error:l}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:xn});if(await ws(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ba}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:l})}catch(i){if(Le(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:s,token:a,access_token:i,nonce:l}=t,c=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:xn}),{data:d,error:f}=c;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Ba}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(r){if(Le(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,s,a,i,l;try{if("email"in t){const{email:c,options:d}=t;let f=null,h=null;this.flowType==="pkce"&&([f,h]=await Fa(this.storage,this.storageKey));const{error:m}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},create_user:(s=d==null?void 0:d.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:h},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:c,options:d}=t,{data:f,error:h}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:h}}throw new bl("You must provide either an email or phone number.")}catch(c){if(Le(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(t){var r,s;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:l,error:c}=await Ge(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:xn});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(Le(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,s,a;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await Fa(this.storage,this.storageKey)),await Ge(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:xE})}catch(i){if(Le(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new js;const{error:a}=await Ge(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Le(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:a,options:i}=t,{error:l}=await Ge(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:s,type:a,options:i}=t,{data:l,error:c}=await Ge(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new bl("You must provide either an email or phone number and a type")}catch(r){if(Le(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ks(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<bu:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const l=await Ks(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=ju()}if(this.storage.isServer&&t.user){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(d,f,h)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,h))})}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ss}):await this._useSession(async r=>{var s,a,i;const{data:l,error:c}=r;if(c)throw c;return!(!((s=l.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new js}:await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Ss})})}catch(r){if(Le(r))return G2(r)&&(await this._removeSession(),await ws(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:a,error:i}=s;if(i)throw i;if(!a.session)throw new js;const l=a.session;let c=null,d=null;this.flowType==="pkce"&&t.email!=null&&([c,d]=await Fa(this.storage,this.storageKey));const{data:f,error:h}=await Ge(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:Ss});if(h)throw h;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new js;const r=Date.now()/1e3;let s=r,a=!0,i=null;const{payload:l}=_u(t.access_token);if(l.exp&&(s=l.exp,a=s<=r),a){const{data:c,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(t.access_token);if(d)throw d;i={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Le(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:l,error:c}=r;if(c)throw c;t=(s=l.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new js;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Le(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Br())throw new wl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new wl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Vg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Vg("No code detected.");const{data:k,error:N}=await this._exchangeCodeForSession(t.code);if(N)throw N;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:i,refresh_token:l,expires_in:c,expires_at:d,token_type:f}=t;if(!i||!c||!l||!f)throw new wl("No session defined in URL");const h=Math.round(Date.now()/1e3),m=parseInt(c);let g=h+m;d&&(g=parseInt(d));const v=g-h;v*1e3<=Za&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const j=g-m;h-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,g,h):h-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,g,h);const{data:_,error:y}=await this._getUser(i);if(y)throw y;const w={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:m,expires_at:g,refresh_token:l,token_type:f,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(s){if(Le(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ks(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return{error:i};const l=(s=a.session)===null||s===void 0?void 0:s.access_token;if(l){const{error:c}=await this.admin.signOut(l,t);if(c&&!(q2(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return t!=="others"&&(await this._removeSession(),await ws(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Q2(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,a;try{const{data:{session:i},error:l}=r;if(l)throw l;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await Fa(this.storage,this.storageKey,!0));try{return await Ge(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Le(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:a}=await this._useSession(async i=>{var l,c,d,f,h;const{data:m,error:g}=i;if(g)throw g;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Ge(this.fetch,"GET",v,{headers:this.headers,jwt:(h=(f=m.session)===null||f===void 0?void 0:f.access_token)!==null&&h!==void 0?h:void 0})});if(a)throw a;return Br()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:t.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(Le(s))return{data:{provider:t.provider,url:null},error:s};throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:l,provider:c,token:d,access_token:f,nonce:h}=t,m=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:c,id_token:d,access_token:f,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xn}),{data:g,error:v}=m;return v?{data:{user:null,session:null},error:v}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Ba}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("USER_UPDATED",g.session)),{data:g,error:v})}catch(a){if(Le(a))return{data:{user:null,session:null},error:a};throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,a;const{data:i,error:l}=r;if(l)throw l;return await Ge(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await nE(async a=>(a>0&&await rE(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ge(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:xn})),(a,i)=>{const l=200*Math.pow(2,a);return i&&wu(i)&&Date.now()+l-s<Za})}catch(s){if(this._debug(r,"error",s),Le(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),Br()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await Ks(this.storage,this.storageKey);if(a&&this.userStorage){let l=await Ks(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:a.user},await Ya(this.userStorage,this.storageKey+"-user",l)),a.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:ju()}else if(a&&!a.user&&!a.user){const l=await Ks(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(a.user=l.user,await ws(this.storage,this.storageKey+"-user"),await Ya(this.storage,this.storageKey,a)):a.user=ju()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<bu;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${bu}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:l}=await this._callRefreshToken(a.refresh_token);l&&(console.error(l),wu(l)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(a.access_token);!c&&(l!=null&&l.user)?(a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(s,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new js;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Fc;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new js;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),Le(i)){const l={data:null,error:i};return wu(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,s=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(d){i.push(d)}});if(await Promise.all(l),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Ya(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=Jg(a);await Ya(this.storage,this.storageKey,i)}else{const a=Jg(r);await Ya(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ws(this.storage,this.storageKey),await ws(this.storage,this.storageKey+"-code-verifier"),await ws(this.storage,this.storageKey+"-user"),this.userStorage&&await ws(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Br()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Za);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-t)/Za);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Za}ms, refresh threshold is ${ch} ticks`),a<=ch&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof By)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Br()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const a=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,l]=await Fa(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);a.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;return i?{data:null,error:i}:await Ge(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,a;const{data:i,error:l}=r;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:f}=await Ge(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return f?{data:null,error:f}:(t.factorType==="totp"&&d.type==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return{data:null,error:i};const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?IE(t.webauthn.credential_response):LE(t.webauthn.credential_response)})}:{code:t.code}),{data:c,error:d}=await Ge(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:d})})}catch(r){if(Le(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return{data:null,error:i};const l=await Ge(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:OE(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:ME(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Le(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?{data:null,error:s}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,s;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=_u(a.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((s=(r=a.user.factors)===null||r===void 0?void 0:r.filter(m=>m.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(d="aal2");const h=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(c=>c.kid===t);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(c=>c.kid===t),s&&this.jwks_cached_at+U2>a)return s;const{data:i,error:l}=await Ge(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,s=i.keys.find(c=>c.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:v,error:j}=await this.getSession();if(j||!v.session)return{data:null,error:j};s=v.session.access_token}const{header:a,payload:i,signature:l,raw:{header:c,payload:d}}=_u(s);r!=null&&r.allowExpired||dE(i.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!f){const{error:v}=await this.getUser(s);if(v)throw v;return{data:{claims:i,header:a,signature:l},error:null}}const h=uE(a.alg),m=await crypto.subtle.importKey("jwk",f,h,!0,["verify"]);if(!await crypto.subtle.verify(h,m,l,X2(`${c}.${d}`)))throw new hh("Invalid JWT signature");return{data:{claims:i,header:a,signature:l},error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}}}fo.nextInstanceID=0;const qE=fo;class GE extends qE{constructor(t){super(t)}}var HE=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(h){try{f(s.next(h))}catch(m){l(m)}}function d(h){try{f(s.throw(h))}catch(m){l(m)}}function f(h){h.done?i(h.value):a(h.value).then(c,d)}f((s=s.apply(e,t||[])).next())})};class VE{constructor(t,r,s){var a,i,l;this.supabaseUrl=t,this.supabaseKey=r;const c=R2(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:E2,realtime:P2,auth:Object.assign(Object.assign({},C2),{storageKey:d}),global:S2},h=D2(s??{},f);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=h.auth)!==null&&l!==void 0?l:{},this.headers,h.global.fetch),this.fetch=M2(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new WS(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new j2(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new wS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,s)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return HE(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:a,userStorage:i,storageKey:l,flowType:c,lock:d,debug:f},h,m){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new GE({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),h),storageKey:l,autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:a,userStorage:i,flowType:c,lock:d,debug:f,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new i2(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(t,r,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const KE=(e,t,r)=>new VE(e,t,r);function ZE(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}ZE()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const YE=typeof window<"u",XE="https://pmrxyisasfaimumuobvu.supabase.co",JE="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtcnh5aXNhc2ZhaW11bXVvYnZ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyODQ2ODMsImV4cCI6MjA2ODg2MDY4M30.rVsKq08Ynw82RkCntxWFXOTgP8T0cGyhJvqfrnOH4YQ",B=KE(XE,JE,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:YE}}),QE=Object.freeze(Object.defineProperty({__proto__:null,supabase:B},Symbol.toStringTag,{value:"Module"}));function qy(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=qy(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function Ve(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=qy(e))&&(s&&(s+=" "),s+=t);return s}function eC(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}eC(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Ao=e=>typeof e=="number"&&!isNaN(e),xa=e=>typeof e=="string",is=e=>typeof e=="function",tC=e=>xa(e)||Ao(e),fh=e=>xa(e)||is(e)?e:null,rC=(e,t)=>e===!1||Ao(e)&&e>0?e:t,mh=e=>x.isValidElement(e)||xa(e)||is(e)||Ao(e);function nC(e,t,r=300){let{scrollHeight:s,style:a}=e;requestAnimationFrame(()=>{a.minHeight="initial",a.height=s+"px",a.transition=`all ${r}ms`,requestAnimationFrame(()=>{a.height="0",a.padding="0",a.margin="0",setTimeout(t,r)})})}function sC({enter:e,exit:t,appendPosition:r=!1,collapse:s=!0,collapseDuration:a=300}){return function({children:i,position:l,preventExitTransition:c,done:d,nodeRef:f,isIn:h,playToast:m}){let g=r?`${e}--${l}`:e,v=r?`${t}--${l}`:t,j=x.useRef(0);return x.useLayoutEffect(()=>{let _=f.current,y=g.split(" "),w=k=>{k.target===f.current&&(m(),_.removeEventListener("animationend",w),_.removeEventListener("animationcancel",w),j.current===0&&k.type!=="animationcancel"&&_.classList.remove(...y))};_.classList.add(...y),_.addEventListener("animationend",w),_.addEventListener("animationcancel",w)},[]),x.useEffect(()=>{let _=f.current,y=()=>{_.removeEventListener("animationend",y),s?nC(_,d,a):d()};h||(c?y():(j.current=1,_.className+=` ${v}`,_.addEventListener("animationend",y)))},[h]),at.createElement(at.Fragment,null,i)}}function ax(e,t){return{content:Gy(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function Gy(e,t,r=!1){return x.isValidElement(e)&&!xa(e.type)?x.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):is(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function aC({closeToast:e,theme:t,ariaLabel:r="close"}){return at.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:s=>{s.stopPropagation(),e(!0)},"aria-label":r},at.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},at.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function iC({delay:e,isRunning:t,closeToast:r,type:s="default",hide:a,className:i,controlledProgress:l,progress:c,rtl:d,isIn:f,theme:h}){let m=a||l&&c===0,g={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};l&&(g.transform=`scaleX(${c})`);let v=Ve("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":d}),j=is(i)?i({rtl:d,type:s,defaultClassName:v}):Ve(v,i),_={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{f&&r()}};return at.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":m},at.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${s}`}),at.createElement("div",{role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:j,style:g,..._}))}var oC=1,Hy=()=>`${oC++}`;function lC(e,t,r){let s=1,a=0,i=[],l=[],c=t,d=new Map,f=new Set,h=k=>(f.add(k),()=>f.delete(k)),m=()=>{l=Array.from(d.values()),f.forEach(k=>k())},g=({containerId:k,toastId:N,updateId:P})=>{let O=k?k!==e:e!==1,T=d.has(N)&&P==null;return O||T},v=(k,N)=>{d.forEach(P=>{var O;(N==null||N===P.props.toastId)&&((O=P.toggle)==null||O.call(P,k))})},j=k=>{var N,P;(P=(N=k.props)==null?void 0:N.onClose)==null||P.call(N,k.removalReason),k.isActive=!1},_=k=>{if(k==null)d.forEach(j);else{let N=d.get(k);N&&j(N)}m()},y=()=>{a-=i.length,i=[]},w=k=>{var N,P;let{toastId:O,updateId:T}=k.props,A=T==null;k.staleId&&d.delete(k.staleId),k.isActive=!0,d.set(O,k),m(),r(ax(k,A?"added":"updated")),A&&((P=(N=k.props).onOpen)==null||P.call(N))};return{id:e,props:c,observe:h,toggle:v,removeToast:_,toasts:d,clearQueue:y,buildToast:(k,N)=>{if(g(N))return;let{toastId:P,updateId:O,data:T,staleId:A,delay:C}=N,E=O==null;E&&a++;let D={...c,style:c.toastStyle,key:s++,...Object.fromEntries(Object.entries(N).filter(([M,z])=>z!=null)),toastId:P,updateId:O,data:T,isIn:!1,className:fh(N.className||c.toastClassName),progressClassName:fh(N.progressClassName||c.progressClassName),autoClose:N.isLoading?!1:rC(N.autoClose,c.autoClose),closeToast(M){d.get(P).removalReason=M,_(P)},deleteToast(){let M=d.get(P);if(M!=null){if(r(ax(M,"removed")),d.delete(P),a--,a<0&&(a=0),i.length>0){w(i.shift());return}m()}}};D.closeButton=c.closeButton,N.closeButton===!1||mh(N.closeButton)?D.closeButton=N.closeButton:N.closeButton===!0&&(D.closeButton=mh(c.closeButton)?c.closeButton:!0);let $={content:k,props:D,staleId:A};c.limit&&c.limit>0&&a>c.limit&&E?i.push($):Ao(C)?setTimeout(()=>{w($)},C):w($)},setProps(k){c=k},setToggle:(k,N)=>{let P=d.get(k);P&&(P.toggle=N)},isToastActive:k=>{var N;return(N=d.get(k))==null?void 0:N.isActive},getSnapshot:()=>l}}var Er=new Map,mo=[],ph=new Set,cC=e=>ph.forEach(t=>t(e)),Vy=()=>Er.size>0;function dC(){mo.forEach(e=>Zy(e.content,e.options)),mo=[]}var uC=(e,{containerId:t})=>{var r;return(r=Er.get(t||1))==null?void 0:r.toasts.get(e)};function Ky(e,t){var r;if(t)return!!((r=Er.get(t))!=null&&r.isToastActive(e));let s=!1;return Er.forEach(a=>{a.isToastActive(e)&&(s=!0)}),s}function hC(e){if(!Vy()){mo=mo.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||tC(e))Er.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Er.get(e.containerId);t?t.removeToast(e.id):Er.forEach(r=>{r.removeToast(e.id)})}}var fC=(e={})=>{Er.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function Zy(e,t){mh(e)&&(Vy()||mo.push({content:e,options:t}),Er.forEach(r=>{r.buildToast(e,t)}))}function mC(e){var t;(t=Er.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function Yy(e,t){Er.forEach(r=>{(t==null||!(t!=null&&t.containerId)||(t==null?void 0:t.containerId)===r.id)&&r.toggle(e,t==null?void 0:t.id)})}function pC(e){let t=e.containerId||1;return{subscribe(r){let s=lC(t,e,cC);Er.set(t,s);let a=s.observe(r);return dC(),()=>{a(),Er.delete(t)}},setProps(r){var s;(s=Er.get(t))==null||s.setProps(r)},getSnapshot(){var r;return(r=Er.get(t))==null?void 0:r.getSnapshot()}}}function gC(e){return ph.add(e),()=>{ph.delete(e)}}function xC(e){return e&&(xa(e.toastId)||Ao(e.toastId))?e.toastId:Hy()}function To(e,t){return Zy(e,t),t.toastId}function Uc(e,t){return{...t,type:t&&t.type||e,toastId:xC(t)}}function Wc(e){return(t,r)=>To(t,Uc(e,r))}function ge(e,t){return To(e,Uc("default",t))}ge.loading=(e,t)=>To(e,Uc("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function vC(e,{pending:t,error:r,success:s},a){let i;t&&(i=xa(t)?ge.loading(t,a):ge.loading(t.render,{...a,...t}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(f,h,m)=>{if(h==null){ge.dismiss(i);return}let g={type:f,...l,...a,data:m},v=xa(h)?{render:h}:h;return i?ge.update(i,{...g,...v}):ge(v.render,{...g,...v}),m},d=is(e)?e():e;return d.then(f=>c("success",s,f)).catch(f=>c("error",r,f)),d}ge.promise=vC;ge.success=Wc("success");ge.info=Wc("info");ge.error=Wc("error");ge.warning=Wc("warning");ge.warn=ge.warning;ge.dark=(e,t)=>To(e,Uc("default",{theme:"dark",...t}));function yC(e){hC(e)}ge.dismiss=yC;ge.clearWaitingQueue=fC;ge.isActive=Ky;ge.update=(e,t={})=>{let r=uC(e,t);if(r){let{props:s,content:a}=r,i={delay:100,...s,...t,toastId:t.toastId||e,updateId:Hy()};i.toastId!==e&&(i.staleId=e);let l=i.render||a;delete i.render,To(l,i)}};ge.done=e=>{ge.update(e,{progress:1})};ge.onChange=gC;ge.play=e=>Yy(!0,e);ge.pause=e=>Yy(!1,e);function bC(e){var t;let{subscribe:r,getSnapshot:s,setProps:a}=x.useRef(pC(e)).current;a(e);let i=(t=x.useSyncExternalStore(r,s,s))==null?void 0:t.slice();function l(c){if(!i)return[];let d=new Map;return e.newestOnTop&&i.reverse(),i.forEach(f=>{let{position:h}=f.props;d.has(h)||d.set(h,[]),d.get(h).push(f)}),Array.from(d,f=>c(f[0],f[1]))}return{getToastToRender:l,isToastActive:Ky,count:i==null?void 0:i.length}}function wC(e){let[t,r]=x.useState(!1),[s,a]=x.useState(!1),i=x.useRef(null),l=x.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:c,pauseOnHover:d,closeToast:f,onClick:h,closeOnClick:m}=e;mC({id:e.toastId,containerId:e.containerId,fn:r}),x.useEffect(()=>{if(e.pauseOnFocusLoss)return g(),()=>{v()}},[e.pauseOnFocusLoss]);function g(){document.hasFocus()||w(),window.addEventListener("focus",y),window.addEventListener("blur",w)}function v(){window.removeEventListener("focus",y),window.removeEventListener("blur",w)}function j(A){if(e.draggable===!0||e.draggable===A.pointerType){k();let C=i.current;l.canCloseOnClick=!0,l.canDrag=!0,C.style.transition="none",e.draggableDirection==="x"?(l.start=A.clientX,l.removalDistance=C.offsetWidth*(e.draggablePercent/100)):(l.start=A.clientY,l.removalDistance=C.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function _(A){let{top:C,bottom:E,left:D,right:$}=i.current.getBoundingClientRect();A.nativeEvent.type!=="touchend"&&e.pauseOnHover&&A.clientX>=D&&A.clientX<=$&&A.clientY>=C&&A.clientY<=E?w():y()}function y(){r(!0)}function w(){r(!1)}function k(){l.didMove=!1,document.addEventListener("pointermove",P),document.addEventListener("pointerup",O)}function N(){document.removeEventListener("pointermove",P),document.removeEventListener("pointerup",O)}function P(A){let C=i.current;if(l.canDrag&&C){l.didMove=!0,t&&w(),e.draggableDirection==="x"?l.delta=A.clientX-l.start:l.delta=A.clientY-l.start,l.start!==A.clientX&&(l.canCloseOnClick=!1);let E=e.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`;C.style.transform=`translate3d(${E},0)`,C.style.opacity=`${1-Math.abs(l.delta/l.removalDistance)}`}}function O(){N();let A=i.current;if(l.canDrag&&l.didMove&&A){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance){a(!0),e.closeToast(!0),e.collapseAll();return}A.style.transition="transform 0.2s, opacity 0.2s",A.style.removeProperty("transform"),A.style.removeProperty("opacity")}}let T={onPointerDown:j,onPointerUp:_};return c&&d&&(T.onMouseEnter=w,e.stacked||(T.onMouseLeave=y)),m&&(T.onClick=A=>{h&&h(A),l.canCloseOnClick&&f(!0)}),{playToast:y,pauseToast:w,isRunning:t,preventExitTransition:s,toastRef:i,eventHandlers:T}}var _C=typeof window<"u"?x.useLayoutEffect:x.useEffect,qc=({theme:e,type:t,isLoading:r,...s})=>at.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...s});function jC(e){return at.createElement(qc,{...e},at.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function NC(e){return at.createElement(qc,{...e},at.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function kC(e){return at.createElement(qc,{...e},at.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function SC(e){return at.createElement(qc,{...e},at.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function EC(){return at.createElement("div",{className:"Toastify__spinner"})}var gh={info:NC,warning:jC,success:kC,error:SC,spinner:EC},CC=e=>e in gh;function PC({theme:e,type:t,isLoading:r,icon:s}){let a=null,i={theme:e,type:t};return s===!1||(is(s)?a=s({...i,isLoading:r}):x.isValidElement(s)?a=x.cloneElement(s,i):r?a=gh.spinner():CC(t)&&(a=gh[t](i))),a}var AC=e=>{let{isRunning:t,preventExitTransition:r,toastRef:s,eventHandlers:a,playToast:i}=wC(e),{closeButton:l,children:c,autoClose:d,onClick:f,type:h,hideProgressBar:m,closeToast:g,transition:v,position:j,className:_,style:y,progressClassName:w,updateId:k,role:N,progress:P,rtl:O,toastId:T,deleteToast:A,isIn:C,isLoading:E,closeOnClick:D,theme:$,ariaLabel:M}=e,z=Ve("Toastify__toast",`Toastify__toast-theme--${$}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":O},{"Toastify__toast--close-on-click":D}),K=is(_)?_({rtl:O,position:j,type:h,defaultClassName:z}):Ve(z,_),W=PC(e),U=!!P||!d,Y={closeToast:g,type:h,theme:$},R=null;return l===!1||(is(l)?R=l(Y):x.isValidElement(l)?R=x.cloneElement(l,Y):R=aC(Y)),at.createElement(v,{isIn:C,done:A,position:j,preventExitTransition:r,nodeRef:s,playToast:i},at.createElement("div",{id:T,tabIndex:0,onClick:f,"data-in":C,className:K,...a,style:y,ref:s,...C&&{role:N,"aria-label":M}},W!=null&&at.createElement("div",{className:Ve("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!E})},W),Gy(c,e,!t),R,!e.customProgressBar&&at.createElement(iC,{...k&&!U?{key:`p-${k}`}:{},rtl:O,theme:$,delay:d,isRunning:t,isIn:C,closeToast:g,hide:m,type:h,className:w,controlledProgress:U,progress:P||0})))},TC=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),OC=sC(TC("bounce",!0)),MC={position:"top-right",transition:OC,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function IC(e){let t={...MC,...e},r=e.stacked,[s,a]=x.useState(!0),i=x.useRef(null),{getToastToRender:l,isToastActive:c,count:d}=bC(t),{className:f,style:h,rtl:m,containerId:g,hotKeys:v}=t;function j(y){let w=Ve("Toastify__toast-container",`Toastify__toast-container--${y}`,{"Toastify__toast-container--rtl":m});return is(f)?f({position:y,rtl:m,defaultClassName:w}):Ve(w,fh(f))}function _(){r&&(a(!0),ge.play())}return _C(()=>{var y;if(r){let w=i.current.querySelectorAll('[data-in="true"]'),k=12,N=(y=t.position)==null?void 0:y.includes("top"),P=0,O=0;Array.from(w).reverse().forEach((T,A)=>{let C=T;C.classList.add("Toastify__toast--stacked"),A>0&&(C.dataset.collapsed=`${s}`),C.dataset.pos||(C.dataset.pos=N?"top":"bot");let E=P*(s?.2:1)+(s?0:k*A);C.style.setProperty("--y",`${N?E:E*-1}px`),C.style.setProperty("--g",`${k}`),C.style.setProperty("--s",`${1-(s?O:0)}`),P+=C.offsetHeight,O+=.025})}},[s,d,r]),x.useEffect(()=>{function y(w){var k;let N=i.current;v(w)&&((k=N.querySelector('[tabIndex="0"]'))==null||k.focus(),a(!1),ge.pause()),w.key==="Escape"&&(document.activeElement===N||N!=null&&N.contains(document.activeElement))&&(a(!0),ge.play())}return document.addEventListener("keydown",y),()=>{document.removeEventListener("keydown",y)}},[v]),at.createElement("section",{ref:i,className:"Toastify",id:g,onMouseEnter:()=>{r&&(a(!1),ge.pause())},onMouseLeave:_,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},l((y,w)=>{let k=w.length?{...h}:{...h,pointerEvents:"none"};return at.createElement("div",{tabIndex:-1,className:j(y),"data-stacked":r,style:k,key:`c-${y}`},w.map(({content:N,props:P})=>at.createElement(AC,{...P,stacked:r,collapseAll:_,isIn:c(P.toastId,P.containerId),key:`t-${P.key}`},N)))}))}const LC=()=>{const[e,t]=x.useState(""),[r,s]=x.useState(""),[a,i]=x.useState(!1),[l,c]=x.useState(null),d=async f=>{f.preventDefault(),i(!0),c(null);try{const{rateLimiter:h,rateLimitConfigs:m}=await as(async()=>{const{rateLimiter:_,rateLimitConfigs:y}=await import("./rateLimiter-RDTGfPPa.js");return{rateLimiter:_,rateLimitConfigs:y}},[]),g="client_"+(window.location.hostname||"unknown");if(!h.isAllowed(g,m.login)){const _=h.getTimeUntilUnblocked(g),y=Math.ceil(_/(60*1e3));throw new Error(`Too many login attempts. Please try again in ${y} minutes.`)}const{data:v,error:j}=await B.auth.signInWithPassword({email:e,password:r});if(j)throw h.isAllowed(g,m.login),j;h.reset(g)}catch(h){c(h instanceof Error?h.message:"An error occurred")}finally{i(!1)}};return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Event Admin Portal"}),n.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to access your event management dashboard"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,children:[l&&n.jsx("div",{className:"rounded-md bg-red-50 p-4",children:n.jsx("div",{className:"text-sm text-red-700",children:l})}),n.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),n.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:f=>t(f.target.value)})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),n.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:r,onChange:f=>s(f.target.value)})]})]}),n.jsx("div",{children:n.jsx("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:a?"Signing in...":"Sign in"})})]})]})})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var DC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),pe=(e,t)=>{const r=x.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:d,...f},h)=>x.createElement("svg",{ref:h,...DC,width:a,height:a,stroke:s,strokeWidth:l?Number(i)*24/Number(a):i,className:["lucide",`lucide-${RC(e)}`,c].join(" "),...f},[...t.map(([m,g])=>x.createElement(m,g)),...Array.isArray(d)?d:[d]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=pe("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=pe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=pe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mf=pe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=pe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=pe("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=pe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=pe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=pe("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=pe("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=pe("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=pe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=pe("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=pe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yh=pe("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=pe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=pe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zC=pe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=pe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=pe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=pe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=pe("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=pe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=pe("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=pe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=pe("DoorOpen",[["path",{d:"M13 4h3a2 2 0 0 1 2 2v14",key:"hrm0s9"}],["path",{d:"M2 20h3",key:"1gaodv"}],["path",{d:"M13 20h9",key:"s90cdi"}],["path",{d:"M10 12v.01",key:"vx6srw"}],["path",{d:"M13 4.562v16.157a1 1 0 0 1-1.242.97L5 20V5.562a2 2 0 0 1 1.515-1.94l4-1A2 2 0 0 1 13 4.561Z",key:"199qr4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=pe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=pe("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=pe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=pe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=pe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=pe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=pe("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=pe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=pe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=pe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=pe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=pe("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=pe("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=pe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=pe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=pe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=pe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=pe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=pe("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=pe("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=pe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=pe("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=pe("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=pe("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=pe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=pe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=pe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=pe("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=pe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=pe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=pe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=pe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=pe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=pe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=pe("Shuffle",[["path",{d:"M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l6.1-8.6c.7-1.1 2-1.7 3.3-1.7H22",key:"1wmou1"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 6h1.9c1.5 0 2.9.9 3.6 2.2",key:"10bdb2"}],["path",{d:"M22 18h-5.9c-1.3 0-2.6-.7-3.3-1.8l-.5-.8",key:"vgxac0"}],["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=pe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=pe("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=pe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=pe("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=pe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=pe("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=pe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=pe("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=pe("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=pe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=pe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=pe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=pe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _h=pe("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=pe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=pe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=pe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=pe("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),fP=()=>{const[e,t]=x.useState({totalEvents:0,activeEvents:0,totalWristbands:0,totalCheckins:0,recentEvents:[],liveEvents:[],systemHealth:{status:"healthy",uptime:"--",responseTime:0,activeConnections:0},realtimeMetrics:{checkinsLastHour:0,peakHourToday:"--",fraudAlertsToday:0,staffOnline:0}}),[r,s]=x.useState(!0);x.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:i,error:l}=await B.from("events").select("*").order("created_at",{ascending:!1});if(l)throw l;const{data:c,error:d}=await B.from("wristbands").select("*");if(d)throw d;const{data:f,error:h}=await B.from("checkin_logs").select("*");if(h)throw h;const m=new Date,g=(i==null?void 0:i.filter(A=>{const C=new Date(A.start_date),E=new Date(A.end_date);return m>=C&&m<=E}))||[],v=new Date(Date.now()-36e5),j=(f==null?void 0:f.filter(A=>new Date(A.created_at)>v).length)||0,_=new Date;_.setHours(0,0,0,0);const y=(f==null?void 0:f.filter(A=>new Date(A.created_at)>=_))||[],w={};y.forEach(A=>{const C=new Date(A.created_at).getHours();w[C]=(w[C]||0)+1});let k="--",N=0;Object.entries(w).forEach(([A,C])=>{if(C>N){N=C;const E=parseInt(A);k=E===0?"12:00 AM":E<12?`${E}:00 AM`:E===12?"12:00 PM":`${E-12}:00 PM`}});const{data:P,error:O}=await B.from("checkin_logs").select("staff_id").gte("created_at",_.toISOString()).not("staff_id","is",null),T=new Set((P==null?void 0:P.map(A=>A.staff_id))||[]);t(A=>({...A,totalEvents:(i==null?void 0:i.length)||0,activeEvents:g.length,totalWristbands:(c==null?void 0:c.length)||0,totalCheckins:(f==null?void 0:f.length)||0,recentEvents:(i==null?void 0:i.slice(0,5))||[],liveEvents:g.slice(0,3),realtimeMetrics:{...A.realtimeMetrics,checkinsLastHour:j,peakHourToday:k,staffOnline:T.size}}))}catch(i){console.error("Error fetching dashboard data:",i)}finally{s(!1)}};return r?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Command Center"}),n.jsx("p",{className:"text-gray-600",children:"Real-time portal overview and system status"})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsxs("button",{onClick:a,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(Gr,{className:"-ml-1 mr-2 h-4 w-4"}),"Refresh"]}),n.jsxs(dt,{to:"/events/new",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[n.jsx(po,{className:"-ml-1 mr-2 h-4 w-4"}),"New Event"]})]})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"System Health"}),n.jsxs("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e.systemHealth.status==="healthy"?"bg-green-100 text-green-800":e.systemHealth.status==="warning"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[e.systemHealth.status==="healthy"?"":e.systemHealth.status==="warning"?"":"",e.systemHealth.status.toUpperCase()]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.systemHealth.uptime}),n.jsx("div",{className:"text-sm text-gray-500",children:"Uptime"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[e.systemHealth.responseTime,"ms"]}),n.jsx("div",{className:"text-sm text-gray-500",children:"Response Time"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.systemHealth.activeConnections}),n.jsx("div",{className:"text-sm text-gray-500",children:"Active Connections"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.realtimeMetrics.staffOnline}),n.jsx("div",{className:"text-sm text-gray-500",children:"Staff Online"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Events"}),n.jsx("p",{className:"text-3xl font-semibold text-gray-900 mt-1",children:e.totalEvents})]}),n.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:n.jsx(On,{className:"h-6 w-6 text-blue-600"})})]})})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Events"}),n.jsx("p",{className:"text-3xl font-semibold text-gray-900 mt-1",children:e.activeEvents})]}),n.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:n.jsx(Mn,{className:"h-6 w-6 text-green-600"})})]})})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Wristbands"}),n.jsx("p",{className:"text-3xl font-semibold text-gray-900 mt-1",children:e.totalWristbands})]}),n.jsx("div",{className:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:n.jsx(lx,{className:"h-6 w-6 text-purple-600"})})]})})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Check-ins"}),n.jsx("p",{className:"text-3xl font-semibold text-gray-900 mt-1",children:e.totalCheckins})]}),n.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-lg flex items-center justify-center",children:n.jsx(yh,{className:"h-6 w-6 text-orange-600"})})]})})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[n.jsx("div",{className:"lg:col-span-2",children:n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"card-title",children:"Recent Events"}),n.jsx(dt,{to:"/events",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View all"})]})}),n.jsx("div",{className:"card-body",children:e.recentEvents.length>0?n.jsx("div",{className:"space-y-4",children:e.recentEvents.map(i=>{const l=new Date(i.start_date),c=new Date(i.end_date),d=new Date,f=d>=l&&d<=c,h=d>c;return n.jsx(dt,{to:`/events/${i.id}`,className:"block p-4 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("h3",{className:"font-medium text-gray-900",children:i.name}),f&&n.jsx("span",{className:"status-badge status-success",children:"Active"}),h&&n.jsx("span",{className:"status-badge status-neutral",children:"Completed"})]}),n.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[l.toLocaleDateString()," - ",c.toLocaleDateString(),i.location&&`  ${i.location}`]})]}),n.jsx(Xy,{className:"h-4 w-4 text-gray-400"})]})},i.id)})}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx(On,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No events yet"}),n.jsx(dt,{to:"/events/new",className:"btn btn-primary mt-4",children:"Create your first event"})]})})]})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h2",{className:"card-title",children:"Quick Actions"})}),n.jsxs("div",{className:"card-body space-y-3",children:[n.jsxs(dt,{to:"/events/new",className:"btn btn-secondary w-full justify-start",children:[n.jsx(On,{className:"h-4 w-4 mr-2"}),"Create Event"]}),n.jsxs(dt,{to:"/wristbands",className:"btn btn-secondary w-full justify-start",children:[n.jsx(lx,{className:"h-4 w-4 mr-2"}),"Manage Wristbands"]}),n.jsxs(dt,{to:"/access",className:"btn btn-secondary w-full justify-start",children:[n.jsx(lt,{className:"h-4 w-4 mr-2"}),"User Access"]}),n.jsxs(dt,{to:"/checkins",className:"btn btn-secondary w-full justify-start",children:[n.jsx(yh,{className:"h-4 w-4 mr-2"}),"View Check-ins"]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h2",{className:"card-title",children:"System Status"})}),n.jsxs("div",{className:"card-body space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Database"}),n.jsx("span",{className:"status-badge status-success",children:"Online"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"NFC Scanning"}),n.jsx("span",{className:"status-badge status-success",children:"Active"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Real-time Sync"}),n.jsx("span",{className:"status-badge status-success",children:"Connected"})]})]})]})]})]})]})},ve=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:`rounded-xl border bg-card text-card-foreground shadow ${e}`,...t}));ve.displayName="Card";const De=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:`flex flex-col space-y-1.5 p-6 ${e}`,...t}));De.displayName="CardHeader";const Re=x.forwardRef(({className:e,...t},r)=>n.jsx("h3",{ref:r,className:`font-semibold leading-none tracking-tight ${e}`,...t}));Re.displayName="CardTitle";const mP=x.forwardRef(({className:e,...t},r)=>n.jsx("p",{ref:r,className:`text-sm text-muted-foreground ${e}`,...t}));mP.displayName="CardDescription";const ye=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:`p-6 pt-0 ${e}`,...t}));ye.displayName="CardContent";const pP=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:`flex items-center p-6 pt-0 ${e}`,...t}));pP.displayName="CardFooter";const aa=class aa{static getInstance(){return aa.instance||(aa.instance=new aa),aa.instance}subscribeToAIEvents(t){const r=B.channel("autonomous_events_changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"autonomous_events"},s=>{const a=s.new,i={id:a.id,type:a.event_type,timestamp:a.created_at,confidence:Number(a.confidence_score)||0,details:{action:a.action,reasoning:a.reasoning||"",impact:a.impact||"",metadata:a.metadata||{}}};t(i)}).subscribe();return()=>{B.removeChannel(r)}}async fetchAutoGates(){try{const{data:t,error:r}=await B.from("autonomous_gates").select(`
          *,
          gate:gates(name)
        `).order("created_at",{ascending:!1}).limit(50);if(r)throw r;return(t||[]).map(s=>{var a,i;return{id:s.id,name:((a=s.gate)==null?void 0:a.name)||"Unknown Gate",location:((i=s.gate)==null?void 0:i.location)||"Unknown Location",status:s.status,confidence_score:Number(s.confidence_score)||0,last_decision:s.last_decision_at||new Date().toISOString(),decisions_today:s.decisions_today||0,accuracy_rate:Number(s.accuracy_rate)||0,created_at:s.created_at,updated_at:s.updated_at,confidence_history:Array.isArray(s.confidence_history)?s.confidence_history:[],performance_metrics:{avg_response_time:s.avg_response_time_ms||0,total_processed:s.total_processed||0,success_rate:Number(s.success_rate)||0}}})}catch(t){return console.error("Error fetching autonomous gates:",t),[]}}async fetchMergeEvents(){try{const{data:t,error:r}=await B.from("gate_merge_suggestions").select("*").eq("status","pending").order("suggested_at",{ascending:!1}).limit(10);if(r)throw r;return(t||[]).map(s=>({id:s.id,primary_gate_id:s.primary_gate_id,secondary_gate_id:s.secondary_gate_id,confidence:Number(s.confidence_score)||0,reasoning:s.reasoning||"",suggested_at:s.suggested_at,status:s.status}))}catch(t){return console.error("Error fetching merge events:",t),[]}}async fetchSystemHealth(){try{const{data:t,error:r}=await B.from("system_health_logs").select("*").order("recorded_at",{ascending:!1}).limit(1).single();if(r&&r.code!=="PGRST116")throw r;return t?{autoHealingRate:Number(t.auto_healing_rate)*100||0,interventionRequired:t.intervention_required||0,lastAutoCleanup:new Date(t.last_auto_cleanup_at||Date.now()),issuesAutoResolved:t.issues_auto_resolved||0,nextMaintenanceCycle:new Date(t.next_maintenance_cycle_at||Date.now()+7*24*60*60*1e3),uptime:Number(t.uptime_percentage)*100||100,selfRecoveryCount:t.self_recovery_count||0}:{autoHealingRate:0,interventionRequired:0,lastAutoCleanup:new Date,issuesAutoResolved:0,nextMaintenanceCycle:new Date(Date.now()+7*24*60*60*1e3),uptime:100,selfRecoveryCount:0}}catch(t){return console.error("Error fetching system health:",t),{autoHealingRate:0,interventionRequired:0,lastAutoCleanup:new Date,issuesAutoResolved:0,nextMaintenanceCycle:new Date(Date.now()+7*24*60*60*1e3),uptime:100,selfRecoveryCount:0}}}async fetchPerformanceMetrics(){try{const t=new Date(Date.now()-36e5).toISOString(),[r,s]=await Promise.all([B.from("autonomous_events").select("id, event_type, confidence_score, created_at, reviewed_at, review_status").order("created_at",{ascending:!1}).limit(1e3),B.from("autonomous_events").select("id").not("review_status","is",null)]),a=r.data||[],i=s.data||[],l=a.filter(N=>N.created_at>=t).length,c=l>0?l:0,d=a.filter(N=>N.review_status),f=d.filter(N=>N.review_status==="approved"),h=d.length>0?f.length/d.length:0,m=d.filter(N=>N.review_status==="rejected"),g=d.length>0?m.length/d.length:0,v=a.filter(N=>N.event_type==="performance_optimization"||N.event_type==="auto_correction").length,j=a.slice(0,100),_=j.length>0?j.reduce((N,P)=>N+(Number(P.confidence_score)||0),0)/j.length:0,y=a.slice(100,200),w=y.length>0?y.reduce((N,P)=>N+(Number(P.confidence_score)||0),0)/y.length:0,k=Math.max(0,_-w);return{decisionsPerHour:c,accuracyRate:h*100,falsePositiveRate:g*100,autoCorrections:v,learningVelocity:k*100,totalDecisions:a.length,validatedDecisions:i.length}}catch(t){return console.error("Error fetching performance metrics:",t),{decisionsPerHour:0,accuracyRate:0,falsePositiveRate:0,autoCorrections:0,learningVelocity:0,totalDecisions:0,validatedDecisions:0}}}async fetchPredictiveInsights(){try{const{data:t,error:r}=await B.from("predictive_insights").select("*").eq("is_active",!0).gte("valid_until",new Date().toISOString()).order("created_at",{ascending:!1}).limit(10);if(r)throw r;return(t||[]).map(s=>({id:s.id,type:s.insight_type,message:s.message,confidence:Number(s.confidence_score)||0,predicted_time:s.predicted_time,impact_level:s.impact_level,suggested_actions:Array.isArray(s.suggested_actions)?s.suggested_actions:[]}))}catch(t){return console.error("Error fetching predictive insights:",t),[]}}async fetchEventAutoDetection(){try{const{data:t,error:r}=await B.from("autonomous_events").select("*").eq("event_type","anomaly_detection").order("created_at",{ascending:!1}).limit(1).single();if(r||!t)return null;const s=t.metadata||{};return{eventType:s.event_type||"Unknown",gateStrategy:s.gate_strategy||"Standard",adaptedAt:new Date(t.created_at),confidence:Number(t.confidence_score)||0,reasoning:t.reasoning||"",detectedAt:t.created_at,expectedGateCount:s.expected_gate_count||0}}catch(t){return console.error("Error fetching event auto-detection:",t),null}}async fetchAdaptiveThresholds(){try{const{data:t,error:r}=await B.from("adaptive_thresholds").select("*").order("updated_at",{ascending:!1}).limit(1).single();if(r&&r.code!=="PGRST116")throw r;return t?{duplicateDistance:t.duplicate_distance_meters||25,promotionSampleSize:t.promotion_sample_size||100,confidenceThreshold:Number(t.confidence_threshold)||.85,lastOptimization:new Date(t.last_optimization_at),optimizationHistory:Array.isArray(t.optimization_history)?t.optimization_history:[]}:{duplicateDistance:25,promotionSampleSize:100,confidenceThreshold:.85,lastOptimization:new Date,optimizationHistory:[]}}catch(t){return console.error("Error fetching adaptive thresholds:",t),{duplicateDistance:25,promotionSampleSize:100,confidenceThreshold:.85,lastOptimization:new Date,optimizationHistory:[]}}}async generateLiveEvent(){const t=[{type:"gate_creation",action:"Created new gate at South Entrance",reasoning:"Detected queue buildup and optimal placement location",impact:"Reduced average wait time by 23%"},{type:"threshold_adjustment",action:"Adjusted duplicate detection threshold to 20m",reasoning:"Analysis showed 15m was too restrictive for this venue layout",impact:"Improved accuracy by 8%"},{type:"performance_optimization",action:"Optimized gate processing algorithm",reasoning:"Identified bottleneck in validation step",impact:"Reduced average processing time by 15%"}],r=t[Math.floor(Math.random()*t.length)],s=.85+Math.random()*.15;try{const{data:a}=await B.from("organization_members").select("organization_id").limit(1).single();a&&await B.from("autonomous_events").insert({organization_id:a.organization_id,event_type:r.type,action:r.action,reasoning:r.reasoning,impact:r.impact,confidence_score:s,metadata:{automated:!0,requires_review:!1}})}catch(a){console.error("Error inserting generated event:",a)}return{id:`auto-${Date.now()}`,type:r.type,timestamp:new Date().toISOString(),confidence:s,details:{action:r.action,reasoning:r.reasoning,impact:r.impact,metadata:{automated:!0,requires_review:!1}}}}};nr(aa,"instance");let Zl=aa;const gP=()=>{const[e,t]=x.useState([]),[r,s]=x.useState(null),[a,i]=x.useState(null),[l,c]=x.useState([]),[d,f]=x.useState(null),[h,m]=x.useState(null),[g,v]=x.useState(!0);x.useEffect(()=>{(async()=>{try{const w=Zl.getInstance(),[k,N,P]=await Promise.all([w.fetchAutoGates(),w.fetchSystemHealth(),w.fetchPerformanceMetrics()]);c(k),f(N),m(P)}catch(w){console.error("Error loading autonomous data:",w)}finally{v(!1)}})()},[]),x.useEffect(()=>{const y=setInterval(async()=>{const k=await Zl.getInstance().generateLiveEvent();t(N=>[k,...N.slice(0,9)])},5e3);return()=>clearInterval(y)},[]);const j=y=>{switch(y){case"active":return"text-green-600 bg-green-100";case"learning":return"text-yellow-600 bg-yellow-100";case"auto-archived":return"text-gray-600 bg-gray-100";default:return"text-blue-600 bg-blue-100"}},_=y=>y>=.8?"text-green-600":y>=.6?"text-yellow-600":"text-red-600";return g||!d||!h?n.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading Autonomous Operations..."})]})}):n.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[n.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[n.jsx(ox,{className:"w-8 h-8 mr-3 text-purple-600"}),"Autonomous Operations Center"]}),n.jsx("p",{className:"text-gray-600",children:"AI-driven gate intelligence and self-healing system monitoring"})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500 animate-pulse"}),n.jsx("span",{className:"text-sm text-gray-600",children:"AI Active"})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:[h.decisionsPerHour," decisions/hour"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsx(ve,{className:"border-l-4 border-l-green-500",children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Auto-Healing Rate"}),n.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[d.autoHealingRate,"%"]})]}),n.jsx(ha,{className:"w-8 h-8 text-green-500"})]})})}),n.jsx(ve,{className:"border-l-4 border-l-blue-500",children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"AI Accuracy"}),n.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[h.accuracyRate,"%"]})]}),n.jsx(iP,{className:"w-8 h-8 text-blue-500"})]})})}),n.jsx(ve,{className:"border-l-4 border-l-purple-500",children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Gates"}),n.jsx("p",{className:"text-2xl font-bold text-purple-600",children:l.filter(y=>y.status==="active").length})]}),n.jsx(us,{className:"w-8 h-8 text-purple-500"})]})})}),n.jsx(ve,{className:"border-l-4 border-l-orange-500",children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Learning Gates"}),n.jsx("p",{className:"text-2xl font-bold text-orange-600",children:l.filter(y=>y.status==="learning").length})]}),n.jsx(ox,{className:"w-8 h-8 text-orange-500"})]})})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[n.jsx(qt,{className:"w-5 h-5 mr-2 text-green-600"}),"Live AI Decision Stream"]})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:e.map(y=>n.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>i(y),children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 mt-2 flex-shrink-0 animate-pulse"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:y.details.action}),n.jsx("span",{className:"text-xs text-gray-500",children:new Date(y.timestamp).toLocaleTimeString()})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1",children:y.details.reasoning}),n.jsxs("div",{className:"flex items-center mt-2 space-x-4",children:[n.jsxs("span",{className:`text-xs font-medium ${_(y.confidence)}`,children:[(y.confidence*100).toFixed(1),"% confidence"]}),n.jsxs("span",{className:"text-xs text-gray-500",children:["Impact: ",y.details.impact]}),n.jsx("span",{className:"text-xs text-blue-600 hover:text-blue-800",children:"Click to analyze "})]})]})]},y.id))})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[n.jsx(UC,{className:"w-5 h-5 mr-2 text-purple-600"}),"Gate Intelligence Dashboard"]})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-4",children:l.map(y=>n.jsxs("div",{className:"p-4 rounded-lg border hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>s(y),children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:y.name}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j(y.status)}`,children:y.status})]}),n.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-600",children:[n.jsxs("span",{children:[y.performance_metrics.total_processed," processed"]}),n.jsxs("span",{className:_(y.confidence_score),children:[(y.confidence_score*100).toFixed(1),"% confidence"]}),n.jsx("span",{children:y.status})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:["Created ",new Date(y.created_at).toLocaleTimeString()]}),n.jsxs("div",{className:"text-xs text-blue-600",children:[y.decisions_today," decisions today"]})]})]}),n.jsxs("div",{className:"mt-3",children:[n.jsx("div",{className:"flex items-center space-x-1",children:y.confidence_history.map((w,k)=>n.jsx("div",{className:"flex-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:n.jsx("div",{className:`h-full transition-all duration-300 ${w>=.8?"bg-green-500":w>=.6?"bg-yellow-500":"bg-red-500"}`,style:{width:`${w*100}%`}})},k))}),n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Confidence Evolution"})]})]},y.id))})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[n.jsx(Xa,{className:"w-5 h-5 mr-2 text-green-600"}),"Self-Healing Activity"]})}),n.jsx(ye,{children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.issuesAutoResolved}),n.jsx("div",{className:"text-sm text-gray-600",children:"Issues Auto-Resolved"})]}),n.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.selfRecoveryCount}),n.jsx("div",{className:"text-sm text-gray-600",children:"Self-Recovery Count"})]})]}),n.jsx("div",{className:"space-y-3",children:n.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-gray-900",children:"Auto-Merge Completed"}),n.jsx("p",{className:"text-sm text-gray-600",children:"System automatically merged duplicate gates based on proximity analysis"})]}),n.jsx("div",{className:"text-xs text-gray-500",children:new Date().toLocaleTimeString()})]})})})]})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[n.jsx(sP,{className:"w-5 h-5 mr-2 text-purple-600"}),"Predictive Insights"]})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-4",children:n.jsx("div",{className:"p-4 border rounded-lg",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:"Capacity Warning"}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Main entrance expected to reach 85% capacity in 45 minutes"}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Open additional gates"}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Deploy staff to manage flow"})]})]}),n.jsxs("div",{className:"text-right ml-4",children:[n.jsx("div",{className:"text-sm font-medium text-yellow-600",children:"91% confidence"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Medium impact"})]})]})})})})]})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[n.jsx(ai,{className:"w-5 h-5 mr-2 text-blue-600"}),"Autonomous Performance Metrics"]})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-blue-600",children:h.decisionsPerHour}),n.jsx("div",{className:"text-sm text-gray-600",children:"Decisions/Hour"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[h.accuracyRate,"%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy Rate"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-yellow-600",children:[h.falsePositiveRate,"%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"False Positive Rate"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-purple-600",children:h.autoCorrections}),n.jsx("div",{className:"text-sm text-gray-600",children:"Auto-Corrections"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-indigo-600",children:[(h.learningVelocity*100).toFixed(0),"%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"Learning Velocity"})]})]})})]})]}),n.jsx("footer",{className:"mt-12 py-6 border-t border-gray-200 text-center",children:n.jsx("p",{className:"text-sm text-gray-500 italic",children:'"Faith by itself, if it does not have works, is dead." - James 2:17'})})]})};class xP{async getUserAccess(){const{data:{user:t}}=await B.auth.getUser();if(!t)return null;const{data:r}=await B.from("profiles").select("role, email").eq("id",t.id).single();if(!r)return null;const s=r.role==="admin"||r.role==="owner",{data:a}=await B.from("event_access").select("event_id, access_level").eq("user_id",t.id).eq("is_active",!0);return{userId:t.id,email:r.email,isAdmin:s,role:r.role,eventAccess:(a||[]).map(i=>({eventId:i.event_id,accessLevel:i.access_level}))}}async isAdmin(){const t=await this.getUserAccess();return(t==null?void 0:t.isAdmin)||!1}async getAccessibleEventIds(){const t=await this.getUserAccess();return t?t.isAdmin?"all":t.eventAccess.map(r=>r.eventId):[]}async canAccessEvent(t){const r=await this.getUserAccess();return r?r.isAdmin?!0:r.eventAccess.some(s=>s.eventId===t):!1}async canManageEvent(t){const r=await this.getUserAccess();if(!r)return!1;if(r.isAdmin)return!0;const s=r.eventAccess.find(a=>a.eventId===t);return(s==null?void 0:s.accessLevel)==="admin"||(s==null?void 0:s.accessLevel)==="owner"}async canScanAtEvent(t){const r=await this.getUserAccess();return r?r.isAdmin?!0:r.eventAccess.some(s=>s.eventId===t):!1}async grantEventAccess(t,r,s){if(!await this.canManageEvent(t))throw new Error("Insufficient permissions to grant access");const{data:{user:i}}=await B.auth.getUser();if(!i)throw new Error("Not authenticated");const{error:l}=await B.from("event_access").insert({event_id:t,user_id:r,access_level:s,granted_by:i.id,is_active:!0});if(l)throw l}async revokeEventAccess(t,r){if(!await this.canManageEvent(t))throw new Error("Insufficient permissions to revoke access");const{error:a}=await B.from("event_access").update({is_active:!1}).eq("event_id",t).eq("user_id",r);if(a)throw a}async getEventAccessList(t){if(!await this.canAccessEvent(t))throw new Error("Insufficient permissions to view event access");const{data:s,error:a}=await B.from("event_access").select(`
        user_id,
        access_level,
        created_at,
        user:profiles!event_access_user_id_fkey(email, full_name)
      `).eq("event_id",t).eq("is_active",!0).order("created_at",{ascending:!1});if(a)throw a;return(s||[]).map(i=>{var l,c;return{userId:i.user_id,email:((l=i.user)==null?void 0:l.email)||"",fullName:((c=i.user)==null?void 0:c.full_name)||null,accessLevel:i.access_level,grantedAt:i.created_at}})}}const dx=new xP;class vP{constructor(){nr(this,"lastCheck",null);nr(this,"checkInterval",6e4)}async refreshActivations(){try{const{data:t,error:r}=await B.rpc("refresh_event_activations");if(r)throw console.error("Error refreshing event activations:",r),r;const s=(t==null?void 0:t[0])||{total_checked:0,newly_activated:0,active_events:0};return s.newly_activated>0&&console.log(` Auto-activated ${s.newly_activated} events`),this.lastCheck=new Date,{totalChecked:s.total_checked,newlyActivated:s.newly_activated,activeEvents:s.active_events}}catch(t){throw console.error("Failed to refresh event activations:",t),t}}async checkEventActivation(t){try{const{data:r,error:s}=await B.rpc("check_event_activation",{event_id:t});return s?(console.error("Error checking event activation:",s),!1):r||!1}catch(r){return console.error("Failed to check event activation:",r),!1}}async getActiveEvents(){try{await this.autoRefreshIfNeeded();const{data:t,error:r}=await B.from("events").select("*").eq("is_active",!0).order("start_date",{ascending:!0});if(r)throw console.error("Error fetching active events:",r),r;return t||[]}catch(t){throw console.error("Failed to fetch active events:",t),t}}async autoRefreshIfNeeded(){const t=new Date;if(!this.lastCheck||t.getTime()-this.lastCheck.getTime()>this.checkInterval)try{await this.refreshActivations()}catch(r){console.warn("Background activation refresh failed:",r)}}startAutoRefresh(){this.autoRefreshIfNeeded(),setInterval(()=>{this.autoRefreshIfNeeded()},this.checkInterval),console.log(" Event activation auto-refresh started")}async getEventsWithAutoActivation(){try{const{data:t,error:r}=await B.rpc("get_events_with_activation");if(r){console.error("Error fetching events with activation:",r),await this.autoRefreshIfNeeded();const{data:s,error:a}=await B.from("events").select("*").order("created_at",{ascending:!1});if(a)throw a;return s||[]}return t||[]}catch(t){throw console.error("Failed to fetch events with activation:",t),t}}}const jh=new vP;typeof window<"u"&&jh.startAutoRefresh();const yP=()=>{const[e,t]=x.useState([]),[r,s]=x.useState([]),[a,i]=x.useState(!0),[l,c]=x.useState(""),[d,f]=x.useState("all"),[h,m]=x.useState(null);x.useEffect(()=>{g()},[]),x.useEffect(()=>{v()},[e,l,d]);const g=async()=>{try{await jh.autoRefreshIfNeeded();let y=[];try{y=await dx.getAccessibleEventIds()}catch(N){console.error("Error getting accessible event IDs:",N),y=[],t([]),i(!1);return}const w=await jh.getEventsWithAutoActivation();let k=w;if(y!=="all"){if(y.length===0){t([]),i(!1);return}k=w.filter(N=>y.includes(N.id))}t(k||[])}catch(y){console.error("Error fetching events:",y),t([])}finally{i(!1)}},v=()=>{let y=e;if(l&&(y=y.filter(w=>{var k;return w.name.toLowerCase().includes(l.toLowerCase())||((k=w.location)==null?void 0:k.toLowerCase().includes(l.toLowerCase()))})),d!=="all"){const w=new Date;y=y.filter(k=>{const N=new Date(k.start_date),P=new Date(k.end_date),O=w>=N&&w<=P,T=w>P,A=w<N;switch(d){case"active":return O;case"upcoming":return A;case"past":return T;default:return!0}})}s(y)},j=async y=>{const w=e.find(N=>N.id===y);if(!w||!confirm(`Delete "${w.name}"? This cannot be undone.`))return;if(!await dx.canManageEvent(y)){alert("You do not have permission to delete this event");return}m(y);try{await Promise.all([B.from("checkin_logs").delete().eq("event_id",y),B.from("wristbands").delete().eq("event_id",y),B.from("event_access").delete().eq("event_id",y)]);const{error:N}=await B.from("events").delete().eq("id",y);if(N)throw N;t(e.filter(P=>P.id!==y))}catch(N){console.error("Error deleting event:",N),alert("Failed to delete event")}finally{m(null)}},_=y=>{const w=new Date,k=new Date(y.start_date),N=new Date(y.end_date);return w>=k&&w<=N?"active":w>N?"past":"upcoming"};return a?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Events"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and monitor your events"})]}),n.jsxs(dt,{to:"/events/new",className:"btn btn-primary",children:[n.jsx(po,{className:"h-4 w-4 mr-2"}),"New Event"]})]}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"Search events...",className:"form-input pl-10",value:l,onChange:y=>c(y.target.value)})]})}),n.jsx("div",{className:"sm:w-48",children:n.jsxs("select",{className:"form-input form-select",value:d,onChange:y=>f(y.target.value),children:[n.jsx("option",{value:"all",children:"All Events"}),n.jsx("option",{value:"active",children:"Active"}),n.jsx("option",{value:"upcoming",children:"Upcoming"}),n.jsx("option",{value:"past",children:"Past"})]})})]})})}),r.length===0?n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center py-12",children:[n.jsx(On,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e.length===0?"No events yet":"No events match your filters"}),n.jsx("p",{className:"text-gray-600 mb-6",children:e.length===0?"Get started by creating your first event":"Try adjusting your search or filter criteria"}),e.length===0&&n.jsxs(dt,{to:"/events/new",className:"btn btn-primary",children:[n.jsx(po,{className:"h-4 w-4 mr-2"}),"Create Event"]})]})}):n.jsx("div",{className:"card",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"Event"}),n.jsx("th",{children:"Date Range"}),n.jsx("th",{children:"Location"}),n.jsx("th",{children:"Capacity"}),n.jsx("th",{children:"Status"}),n.jsx("th",{className:"text-right",children:"Actions"})]})}),n.jsx("tbody",{children:r.map(y=>{const w=_(y),k=new Date(y.start_date),N=new Date(y.end_date);return n.jsxs("tr",{children:[n.jsxs("td",{children:[n.jsx(dt,{to:`/events/${y.id}`,className:"font-medium text-blue-600 hover:text-blue-700",children:y.name}),y.description&&n.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-1",children:y.description})]}),n.jsx("td",{children:n.jsxs("div",{className:"text-sm",children:[n.jsx("div",{children:k.toLocaleDateString()}),n.jsxs("div",{className:"text-gray-500",children:["to ",N.toLocaleDateString()]})]})}),n.jsx("td",{children:n.jsx("div",{className:"flex items-center text-sm",children:y.location?n.jsxs(n.Fragment,{children:[n.jsx(cn,{className:"h-3 w-3 mr-1 text-gray-400"}),y.location]}):n.jsx("span",{className:"text-gray-400",children:""})})}),n.jsx("td",{children:n.jsxs("div",{className:"flex items-center text-sm",children:[n.jsx(lt,{className:"h-3 w-3 mr-1 text-gray-400"}),y.total_capacity>0?y.total_capacity:"Unlimited"]})}),n.jsx("td",{children:n.jsx("span",{className:`status-badge ${w==="active"?"status-success":w==="upcoming"?"status-warning":"status-neutral"}`,children:w==="active"?"Active":w==="upcoming"?"Upcoming":"Completed"})}),n.jsx("td",{children:n.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[n.jsx(dt,{to:`/events/${y.id}/edit`,className:"btn-ghost btn-sm p-2",title:"Edit event",children:n.jsx(ii,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>j(y.id),disabled:h===y.id,className:"btn-ghost btn-sm p-2 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Delete event",children:h===y.id?n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):n.jsx(wn,{className:"h-4 w-4"})})]})})]},y.id)})})]})})})]})};async function bP(e,t){if(!t||t.length===0)return[];const r=[...new Set([...t.map(s=>s.user_id),...t.map(s=>s.granted_by)])].filter(Boolean);if(r.length===0)return t;try{const{data:s,error:a}=await e.from("profiles").select("id, email, full_name").in("id",r);if(a)return console.error("Error fetching profiles:",a),t;const i=new Map;return s==null||s.forEach(l=>{i.set(l.id,l)}),t.map(l=>({...l,user:i.get(l.user_id),grantedBy:i.get(l.granted_by)}))}catch(s){return console.error("Error enriching access data with profiles:",s),t}}const nb=()=>n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),n.jsx("h2",{className:"text-lg font-medium text-gray-700",children:"Loading..."})]})});var sb={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,s)=>{e.exports=s()})(Dr,function r(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},a,i=!s.document&&!!s.postMessage,l=s.IS_PAPA_WORKER||!1,c={},d=0,f={};function h(C){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(E){var D=O(E);D.chunkSize=parseInt(D.chunkSize),E.step||E.chunk||(D.chunkSize=null),this._handle=new _(D),(this._handle.streamer=this)._config=D}).call(this,C),this.parseChunk=function(E,D){var $=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<$){let z=this._config.newline;z||(M=this._config.quoteChar||'"',z=this._handle.guessLineEndings(E,M)),E=[...E.split(z).slice($)].join(z)}this.isFirstChunk&&A(this._config.beforeFirstChunk)&&(M=this._config.beforeFirstChunk(E))!==void 0&&(E=M),this.isFirstChunk=!1,this._halted=!1;var $=this._partialLine+E,M=(this._partialLine="",this._handle.parse($,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(E=M.meta.cursor,$=(this._finished||(this._partialLine=$.substring(E-this._baseIndex),this._baseIndex=E),M&&M.data&&(this._rowCount+=M.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),l)s.postMessage({results:M,workerId:f.WORKER_ID,finished:$});else if(A(this._config.chunk)&&!D){if(this._config.chunk(M,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=M=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(M.data),this._completeResults.errors=this._completeResults.errors.concat(M.errors),this._completeResults.meta=M.meta),this._completed||!$||!A(this._config.complete)||M&&M.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),$||M&&M.meta.paused||this._nextChunk(),M}this._halted=!0},this._sendError=function(E){A(this._config.error)?this._config.error(E):l&&this._config.error&&s.postMessage({workerId:f.WORKER_ID,error:E,finished:!1})}}function m(C){var E;(C=C||{}).chunkSize||(C.chunkSize=f.RemoteChunkSize),h.call(this,C),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(D){this._input=D,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(E=new XMLHttpRequest,this._config.withCredentials&&(E.withCredentials=this._config.withCredentials),i||(E.onload=T(this._chunkLoaded,this),E.onerror=T(this._chunkError,this)),E.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var D,$=this._config.downloadRequestHeaders;for(D in $)E.setRequestHeader(D,$[D])}var M;this._config.chunkSize&&(M=this._start+this._config.chunkSize-1,E.setRequestHeader("Range","bytes="+this._start+"-"+M));try{E.send(this._config.downloadRequestBody)}catch(z){this._chunkError(z.message)}i&&E.status===0&&this._chunkError()}},this._chunkLoaded=function(){E.readyState===4&&(E.status<200||400<=E.status?this._chunkError():(this._start+=this._config.chunkSize||E.responseText.length,this._finished=!this._config.chunkSize||this._start>=(D=>(D=D.getResponseHeader("Content-Range"))!==null?parseInt(D.substring(D.lastIndexOf("/")+1)):-1)(E),this.parseChunk(E.responseText)))},this._chunkError=function(D){D=E.statusText||D,this._sendError(new Error(D))}}function g(C){(C=C||{}).chunkSize||(C.chunkSize=f.LocalChunkSize),h.call(this,C);var E,D,$=typeof FileReader<"u";this.stream=function(M){this._input=M,D=M.slice||M.webkitSlice||M.mozSlice,$?((E=new FileReader).onload=T(this._chunkLoaded,this),E.onerror=T(this._chunkError,this)):E=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var M=this._input,z=(this._config.chunkSize&&(z=Math.min(this._start+this._config.chunkSize,this._input.size),M=D.call(M,this._start,z)),E.readAsText(M,this._config.encoding));$||this._chunkLoaded({target:{result:z}})},this._chunkLoaded=function(M){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(M.target.result)},this._chunkError=function(){this._sendError(E.error)}}function v(C){var E;h.call(this,C=C||{}),this.stream=function(D){return E=D,this._nextChunk()},this._nextChunk=function(){var D,$;if(!this._finished)return D=this._config.chunkSize,E=D?($=E.substring(0,D),E.substring(D)):($=E,""),this._finished=!E,this.parseChunk($)}}function j(C){h.call(this,C=C||{});var E=[],D=!0,$=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(M){this._input=M,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){$&&E.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),E.length?this.parseChunk(E.shift()):D=!0},this._streamData=T(function(M){try{E.push(typeof M=="string"?M:M.toString(this._config.encoding)),D&&(D=!1,this._checkIsFinished(),this.parseChunk(E.shift()))}catch(z){this._streamError(z)}},this),this._streamError=T(function(M){this._streamCleanUp(),this._sendError(M)},this),this._streamEnd=T(function(){this._streamCleanUp(),$=!0,this._streamData("")},this),this._streamCleanUp=T(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function _(C){var E,D,$,M,z=Math.pow(2,53),K=-z,W=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,U=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Y=this,R=0,H=0,J=!1,F=!1,V=[],te={data:[],errors:[],meta:{}};function Z(xe){return C.skipEmptyLines==="greedy"?xe.join("").trim()==="":xe.length===1&&xe[0].length===0}function ie(){if(te&&$&&(be("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+f.DefaultDelimiter+"'"),$=!1),C.skipEmptyLines&&(te.data=te.data.filter(function(ce){return!Z(ce)})),fe()){let ce=function(ne,Oe){A(C.transformHeader)&&(ne=C.transformHeader(ne,Oe)),V.push(ne)};if(te)if(Array.isArray(te.data[0])){for(var xe=0;fe()&&xe<te.data.length;xe++)te.data[xe].forEach(ce);te.data.splice(0,1)}else te.data.forEach(ce)}function oe(ce,ne){for(var Oe=C.header?{}:[],Ce=0;Ce<ce.length;Ce++){var $e=Ce,Ne=ce[Ce],Ne=((G,se)=>(ue=>(C.dynamicTypingFunction&&C.dynamicTyping[ue]===void 0&&(C.dynamicTyping[ue]=C.dynamicTypingFunction(ue)),(C.dynamicTyping[ue]||C.dynamicTyping)===!0))(G)?se==="true"||se==="TRUE"||se!=="false"&&se!=="FALSE"&&((ue=>{if(W.test(ue)&&(ue=parseFloat(ue),K<ue&&ue<z))return 1})(se)?parseFloat(se):U.test(se)?new Date(se):se===""?null:se):se)($e=C.header?Ce>=V.length?"__parsed_extra":V[Ce]:$e,Ne=C.transform?C.transform(Ne,$e):Ne);$e==="__parsed_extra"?(Oe[$e]=Oe[$e]||[],Oe[$e].push(Ne)):Oe[$e]=Ne}return C.header&&(Ce>V.length?be("FieldMismatch","TooManyFields","Too many fields: expected "+V.length+" fields but parsed "+Ce,H+ne):Ce<V.length&&be("FieldMismatch","TooFewFields","Too few fields: expected "+V.length+" fields but parsed "+Ce,H+ne)),Oe}var de;te&&(C.header||C.dynamicTyping||C.transform)&&(de=1,!te.data.length||Array.isArray(te.data[0])?(te.data=te.data.map(oe),de=te.data.length):te.data=oe(te.data,0),C.header&&te.meta&&(te.meta.fields=V),H+=de)}function fe(){return C.header&&V.length===0}function be(xe,oe,de,ce){xe={type:xe,code:oe,message:de},ce!==void 0&&(xe.row=ce),te.errors.push(xe)}A(C.step)&&(M=C.step,C.step=function(xe){te=xe,fe()?ie():(ie(),te.data.length!==0&&(R+=xe.data.length,C.preview&&R>C.preview?D.abort():(te.data=te.data[0],M(te,Y))))}),this.parse=function(xe,oe,de){var ce=C.quoteChar||'"',ce=(C.newline||(C.newline=this.guessLineEndings(xe,ce)),$=!1,C.delimiter?A(C.delimiter)&&(C.delimiter=C.delimiter(xe),te.meta.delimiter=C.delimiter):((ce=((ne,Oe,Ce,$e,Ne)=>{var G,se,ue,he;Ne=Ne||[",","	","|",";",f.RECORD_SEP,f.UNIT_SEP];for(var me=0;me<Ne.length;me++){for(var Me,Qe=Ne[me],Xe=0,ut=0,tt=0,ae=(ue=void 0,new w({comments:$e,delimiter:Qe,newline:Oe,preview:10}).parse(ne)),Te=0;Te<ae.data.length;Te++)Ce&&Z(ae.data[Te])?tt++:(Me=ae.data[Te].length,ut+=Me,ue===void 0?ue=Me:0<Me&&(Xe+=Math.abs(Me-ue),ue=Me));0<ae.data.length&&(ut/=ae.data.length-tt),(se===void 0||Xe<=se)&&(he===void 0||he<ut)&&1.99<ut&&(se=Xe,G=Qe,he=ut)}return{successful:!!(C.delimiter=G),bestDelimiter:G}})(xe,C.newline,C.skipEmptyLines,C.comments,C.delimitersToGuess)).successful?C.delimiter=ce.bestDelimiter:($=!0,C.delimiter=f.DefaultDelimiter),te.meta.delimiter=C.delimiter),O(C));return C.preview&&C.header&&ce.preview++,E=xe,D=new w(ce),te=D.parse(E,oe,de),ie(),J?{meta:{paused:!0}}:te||{meta:{paused:!1}}},this.paused=function(){return J},this.pause=function(){J=!0,D.abort(),E=A(C.chunk)?"":E.substring(D.getCharIndex())},this.resume=function(){Y.streamer._halted?(J=!1,Y.streamer.parseChunk(E,!0)):setTimeout(Y.resume,3)},this.aborted=function(){return F},this.abort=function(){F=!0,D.abort(),te.meta.aborted=!0,A(C.complete)&&C.complete(te),E=""},this.guessLineEndings=function(ne,ce){ne=ne.substring(0,1048576);var ce=new RegExp(y(ce)+"([^]*?)"+y(ce),"gm"),de=(ne=ne.replace(ce,"")).split("\r"),ce=ne.split(`
`),ne=1<ce.length&&ce[0].length<de[0].length;if(de.length===1||ne)return`
`;for(var Oe=0,Ce=0;Ce<de.length;Ce++)de[Ce][0]===`
`&&Oe++;return Oe>=de.length/2?`\r
`:"\r"}}function y(C){return C.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(C){var E=(C=C||{}).delimiter,D=C.newline,$=C.comments,M=C.step,z=C.preview,K=C.fastMode,W=null,U=!1,Y=C.quoteChar==null?'"':C.quoteChar,R=Y;if(C.escapeChar!==void 0&&(R=C.escapeChar),(typeof E!="string"||-1<f.BAD_DELIMITERS.indexOf(E))&&(E=","),$===E)throw new Error("Comment character same as delimiter");$===!0?$="#":(typeof $!="string"||-1<f.BAD_DELIMITERS.indexOf($))&&($=!1),D!==`
`&&D!=="\r"&&D!==`\r
`&&(D=`
`);var H=0,J=!1;this.parse=function(F,V,te){if(typeof F!="string")throw new Error("Input must be a string");var Z=F.length,ie=E.length,fe=D.length,be=$.length,xe=A(M),oe=[],de=[],ce=[],ne=H=0;if(!F)return Xe();if(K||K!==!1&&F.indexOf(Y)===-1){for(var Oe=F.split(D),Ce=0;Ce<Oe.length;Ce++){if(ce=Oe[Ce],H+=ce.length,Ce!==Oe.length-1)H+=D.length;else if(te)return Xe();if(!$||ce.substring(0,be)!==$){if(xe){if(oe=[],he(ce.split(E)),ut(),J)return Xe()}else he(ce.split(E));if(z&&z<=Ce)return oe=oe.slice(0,z),Xe(!0)}}return Xe()}for(var $e=F.indexOf(E,H),Ne=F.indexOf(D,H),G=new RegExp(y(R)+y(Y),"g"),se=F.indexOf(Y,H);;)if(F[H]===Y)for(se=H,H++;;){if((se=F.indexOf(Y,se+1))===-1)return te||de.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:oe.length,index:H}),Me();if(se===Z-1)return Me(F.substring(H,se).replace(G,Y));if(Y===R&&F[se+1]===R)se++;else if(Y===R||se===0||F[se-1]!==R){$e!==-1&&$e<se+1&&($e=F.indexOf(E,se+1));var ue=me((Ne=Ne!==-1&&Ne<se+1?F.indexOf(D,se+1):Ne)===-1?$e:Math.min($e,Ne));if(F.substr(se+1+ue,ie)===E){ce.push(F.substring(H,se).replace(G,Y)),F[H=se+1+ue+ie]!==Y&&(se=F.indexOf(Y,H)),$e=F.indexOf(E,H),Ne=F.indexOf(D,H);break}if(ue=me(Ne),F.substring(se+1+ue,se+1+ue+fe)===D){if(ce.push(F.substring(H,se).replace(G,Y)),Qe(se+1+ue+fe),$e=F.indexOf(E,H),se=F.indexOf(Y,H),xe&&(ut(),J))return Xe();if(z&&oe.length>=z)return Xe(!0);break}de.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:oe.length,index:H}),se++}}else if($&&ce.length===0&&F.substring(H,H+be)===$){if(Ne===-1)return Xe();H=Ne+fe,Ne=F.indexOf(D,H),$e=F.indexOf(E,H)}else if($e!==-1&&($e<Ne||Ne===-1))ce.push(F.substring(H,$e)),H=$e+ie,$e=F.indexOf(E,H);else{if(Ne===-1)break;if(ce.push(F.substring(H,Ne)),Qe(Ne+fe),xe&&(ut(),J))return Xe();if(z&&oe.length>=z)return Xe(!0)}return Me();function he(tt){oe.push(tt),ne=H}function me(tt){var ae=0;return ae=tt!==-1&&(tt=F.substring(se+1,tt))&&tt.trim()===""?tt.length:ae}function Me(tt){return te||(tt===void 0&&(tt=F.substring(H)),ce.push(tt),H=Z,he(ce),xe&&ut()),Xe()}function Qe(tt){H=tt,he(ce),ce=[],Ne=F.indexOf(D,H)}function Xe(tt){if(C.header&&!V&&oe.length&&!U){var ae=oe[0],Te=Object.create(null),We=new Set(ae);let tr=!1;for(let It=0;It<ae.length;It++){let zt=ae[It];if(Te[zt=A(C.transformHeader)?C.transformHeader(zt,It):zt]){let Et,dr=Te[zt];for(;Et=zt+"_"+dr,dr++,We.has(Et););We.add(Et),ae[It]=Et,Te[zt]++,tr=!0,(W=W===null?{}:W)[Et]=zt}else Te[zt]=1,ae[It]=zt;We.add(zt)}tr&&console.warn("Duplicate headers found and renamed."),U=!0}return{data:oe,errors:de,meta:{delimiter:E,linebreak:D,aborted:J,truncated:!!tt,cursor:ne+(V||0),renamedHeaders:W}}}function ut(){M(Xe()),oe=[],de=[]}},this.abort=function(){J=!0},this.getCharIndex=function(){return H}}function k(C){var E=C.data,D=c[E.workerId],$=!1;if(E.error)D.userError(E.error,E.file);else if(E.results&&E.results.data){var M={abort:function(){$=!0,N(E.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:P,resume:P};if(A(D.userStep)){for(var z=0;z<E.results.data.length&&(D.userStep({data:E.results.data[z],errors:E.results.errors,meta:E.results.meta},M),!$);z++);delete E.results}else A(D.userChunk)&&(D.userChunk(E.results,M,E.file),delete E.results)}E.finished&&!$&&N(E.workerId,E.results)}function N(C,E){var D=c[C];A(D.userComplete)&&D.userComplete(E),D.terminate(),delete c[C]}function P(){throw new Error("Not implemented.")}function O(C){if(typeof C!="object"||C===null)return C;var E,D=Array.isArray(C)?[]:{};for(E in C)D[E]=O(C[E]);return D}function T(C,E){return function(){C.apply(E,arguments)}}function A(C){return typeof C=="function"}return f.parse=function(C,E){var D=(E=E||{}).dynamicTyping||!1;if(A(D)&&(E.dynamicTypingFunction=D,D={}),E.dynamicTyping=D,E.transform=!!A(E.transform)&&E.transform,!E.worker||!f.WORKERS_SUPPORTED)return D=null,f.NODE_STREAM_INPUT,typeof C=="string"?(C=($=>$.charCodeAt(0)!==65279?$:$.slice(1))(C),D=new(E.download?m:v)(E)):C.readable===!0&&A(C.read)&&A(C.on)?D=new j(E):(s.File&&C instanceof File||C instanceof Object)&&(D=new g(E)),D.stream(C);(D=(()=>{var $;return!!f.WORKERS_SUPPORTED&&($=(()=>{var M=s.URL||s.webkitURL||null,z=r.toString();return f.BLOB_URL||(f.BLOB_URL=M.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",z,")();"],{type:"text/javascript"})))})(),($=new s.Worker($)).onmessage=k,$.id=d++,c[$.id]=$)})()).userStep=E.step,D.userChunk=E.chunk,D.userComplete=E.complete,D.userError=E.error,E.step=A(E.step),E.chunk=A(E.chunk),E.complete=A(E.complete),E.error=A(E.error),delete E.worker,D.postMessage({input:C,config:E,workerId:D.id})},f.unparse=function(C,E){var D=!1,$=!0,M=",",z=`\r
`,K='"',W=K+K,U=!1,Y=null,R=!1,H=((()=>{if(typeof E=="object"){if(typeof E.delimiter!="string"||f.BAD_DELIMITERS.filter(function(V){return E.delimiter.indexOf(V)!==-1}).length||(M=E.delimiter),typeof E.quotes!="boolean"&&typeof E.quotes!="function"&&!Array.isArray(E.quotes)||(D=E.quotes),typeof E.skipEmptyLines!="boolean"&&typeof E.skipEmptyLines!="string"||(U=E.skipEmptyLines),typeof E.newline=="string"&&(z=E.newline),typeof E.quoteChar=="string"&&(K=E.quoteChar),typeof E.header=="boolean"&&($=E.header),Array.isArray(E.columns)){if(E.columns.length===0)throw new Error("Option columns is empty");Y=E.columns}E.escapeChar!==void 0&&(W=E.escapeChar+K),E.escapeFormulae instanceof RegExp?R=E.escapeFormulae:typeof E.escapeFormulae=="boolean"&&E.escapeFormulae&&(R=/^[=+\-@\t\r].*$/)}})(),new RegExp(y(K),"g"));if(typeof C=="string"&&(C=JSON.parse(C)),Array.isArray(C)){if(!C.length||Array.isArray(C[0]))return J(null,C,U);if(typeof C[0]=="object")return J(Y||Object.keys(C[0]),C,U)}else if(typeof C=="object")return typeof C.data=="string"&&(C.data=JSON.parse(C.data)),Array.isArray(C.data)&&(C.fields||(C.fields=C.meta&&C.meta.fields||Y),C.fields||(C.fields=Array.isArray(C.data[0])?C.fields:typeof C.data[0]=="object"?Object.keys(C.data[0]):[]),Array.isArray(C.data[0])||typeof C.data[0]=="object"||(C.data=[C.data])),J(C.fields||[],C.data||[],U);throw new Error("Unable to serialize unrecognized input");function J(V,te,Z){var ie="",fe=(typeof V=="string"&&(V=JSON.parse(V)),typeof te=="string"&&(te=JSON.parse(te)),Array.isArray(V)&&0<V.length),be=!Array.isArray(te[0]);if(fe&&$){for(var xe=0;xe<V.length;xe++)0<xe&&(ie+=M),ie+=F(V[xe],xe);0<te.length&&(ie+=z)}for(var oe=0;oe<te.length;oe++){var de=(fe?V:te[oe]).length,ce=!1,ne=fe?Object.keys(te[oe]).length===0:te[oe].length===0;if(Z&&!fe&&(ce=Z==="greedy"?te[oe].join("").trim()==="":te[oe].length===1&&te[oe][0].length===0),Z==="greedy"&&fe){for(var Oe=[],Ce=0;Ce<de;Ce++){var $e=be?V[Ce]:Ce;Oe.push(te[oe][$e])}ce=Oe.join("").trim()===""}if(!ce){for(var Ne=0;Ne<de;Ne++){0<Ne&&!ne&&(ie+=M);var G=fe&&be?V[Ne]:Ne;ie+=F(te[oe][G],Ne)}oe<te.length-1&&(!Z||0<de&&!ne)&&(ie+=z)}}return ie}function F(V,te){var Z,ie;return V==null?"":V.constructor===Date?JSON.stringify(V).slice(1,25):(ie=!1,R&&typeof V=="string"&&R.test(V)&&(V="'"+V,ie=!0),Z=V.toString().replace(H,W),(ie=ie||D===!0||typeof D=="function"&&D(V,te)||Array.isArray(D)&&D[te]||((fe,be)=>{for(var xe=0;xe<be.length;xe++)if(-1<fe.indexOf(be[xe]))return!0;return!1})(Z,f.BAD_DELIMITERS)||-1<Z.indexOf(M)||Z.charAt(0)===" "||Z.charAt(Z.length-1)===" ")?K+Z+K:Z)}},f.RECORD_SEP="",f.UNIT_SEP="",f.BYTE_ORDER_MARK="\uFEFF",f.BAD_DELIMITERS=["\r",`
`,'"',f.BYTE_ORDER_MARK],f.WORKERS_SUPPORTED=!i&&!!s.Worker,f.NODE_STREAM_INPUT=1,f.LocalChunkSize=10485760,f.RemoteChunkSize=5242880,f.DefaultDelimiter=",",f.Parser=w,f.ParserHandle=_,f.NetworkStreamer=m,f.FileStreamer=g,f.StringStreamer=v,f.ReadableStreamStreamer=j,s.jQuery&&((a=s.jQuery).fn.parse=function(C){var E=C.config||{},D=[];return this.each(function(z){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var K=0;K<this.files.length;K++)D.push({file:this.files[K],inputElem:this,instanceConfig:a.extend({},E)})}),$(),this;function $(){if(D.length===0)A(C.complete)&&C.complete();else{var z,K,W,U,Y=D[0];if(A(C.before)){var R=C.before(Y.file,Y.inputElem);if(typeof R=="object"){if(R.action==="abort")return z="AbortError",K=Y.file,W=Y.inputElem,U=R.reason,void(A(C.error)&&C.error({name:z},K,W,U));if(R.action==="skip")return void M();typeof R.config=="object"&&(Y.instanceConfig=a.extend(Y.instanceConfig,R.config))}else if(R==="skip")return void M()}var H=Y.instanceConfig.complete;Y.instanceConfig.complete=function(J){A(H)&&H(J,Y.file,Y.inputElem),M()},f.parse(Y.file,Y.instanceConfig)}}function M(){D.splice(0,1),$()}}),l&&(s.onmessage=function(C){C=C.data,f.WORKER_ID===void 0&&C&&(f.WORKER_ID=C.workerId),typeof C.input=="string"?s.postMessage({workerId:f.WORKER_ID,results:f.parse(C.input,C.config),finished:!0}):(s.File&&C.input instanceof File||C.input instanceof Object)&&(C=f.parse(C.input,C.config))&&s.postMessage({workerId:f.WORKER_ID,results:C,finished:!0})}),(m.prototype=Object.create(h.prototype)).constructor=m,(g.prototype=Object.create(h.prototype)).constructor=g,(v.prototype=Object.create(v.prototype)).constructor=v,(j.prototype=Object.create(h.prototype)).constructor=j,f})})(sb);var ti=sb.exports;const wP=zn(ti),_P=({eventId:e,onUploadComplete:t,onClose:r})=>{const[s,a]=x.useState(null),[i,l]=x.useState(!1),[c,d]=x.useState("idle"),[f,h]=x.useState(""),[m,g]=x.useState([]),[v,j]=x.useState([]),[_,y]=x.useState(!1),w=x.useRef(null);x.useEffect(()=>{const D=$=>{$.key==="Escape"&&r()};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[r]);const k=D=>{const $=wP.parse(D,{header:!0,skipEmptyLines:!0,transformHeader:F=>F.trim()});if($.errors.length>0){const F=$.errors.map(V=>`Row ${V.row}: ${V.message}`).join("; ");throw new Error(`CSV parsing errors: ${F}`)}const M=$.data,z=$.meta.fields||[],K={"ticket number":"ticket_number",ticket_number:"ticket_number",ticketnumber:"ticket_number","ticket id":"ticket_number",ticket_id:"ticket_number","ticket barcode":"ticket_number",barcode:"ticket_number","ticket category":"ticket_category",ticket_category:"ticket_category",category:"ticket_category","ticket type":"ticket_category",ticket_type:"ticket_category",type:"ticket_category","holder name":"holder_name",holder_name:"holder_name","full name":"holder_name",full_name:"holder_name",name:"holder_name","attendee name":"holder_name","first name":"first_name",firstname:"first_name","last name":"last_name",lastname:"last_name",surname:"last_name","holder email":"holder_email",holder_email:"holder_email",email:"holder_email","email address":"holder_email","purchaser email":"holder_email","holder phone":"holder_phone",holder_phone:"holder_phone",phone:"holder_phone","phone number":"holder_phone",cellphone:"holder_phone"},W={};z.forEach(F=>{const V=F.toLowerCase().trim();W[F]=K[V]||V.replace(/\s+/g,"_")});const U=Object.values(W),Y=U.includes("ticket_number"),R=U.includes("ticket_category");if(!Y)throw new Error('CSV must contain a "ticket_number" or "Ticket Number" column');if(!R)throw new Error('CSV must contain a "ticket_category" or "Ticket Category" column');const H=[],J=[];return M.forEach((F,V)=>{const te={};if(Object.keys(F).forEach(Z=>{const ie=W[Z];te[ie]=F[Z]||""}),!te.holder_name&&(te.first_name||te.last_name)){const Z=te.first_name||"",ie=te.last_name||"";te.holder_name=`${Z} ${ie}`.trim()}if(!te.ticket_number){J.push(`Row ${V+2}: Missing ticket number`);return}if(!te.ticket_category){J.push(`Row ${V+2}: Missing ticket category`);return}H.push(te)}),J.length>0&&j(J),H},N=D=>{if(!D.name.endsWith(".csv")){h("Please select a CSV file");return}a(D),h(""),d("idle"),j([]);const $=new FileReader;$.onload=M=>{var z;try{const K=(z=M.target)==null?void 0:z.result,W=k(K);g(W.slice(0,5))}catch(K){console.error("Error parsing CSV:",K),h(K instanceof Error?K.message:"Failed to parse CSV file")}},$.readAsText(D)},P=D=>{var M;const $=(M=D.target.files)==null?void 0:M[0];$&&N($)},O=D=>{D.preventDefault(),D.stopPropagation(),y(!0)},T=D=>{D.preventDefault(),D.stopPropagation(),y(!1)},A=D=>{D.preventDefault(),D.stopPropagation(),y(!1);const $=Array.from(D.dataTransfer.files),M=$.find(z=>z.name.endsWith(".csv"));if(!M){h("Please drop a CSV file");return}if($.length>1){h("Please drop only one file at a time");return}N(M)},C=async()=>{if(s){l(!0),d("idle"),h("");try{const D=new FileReader;D.onload=async $=>{var M;try{const z=(M=$.target)==null?void 0:M.result,K=k(z);if(v.length>0){h("Please fix validation errors before uploading"),l(!1);return}const W=K.map(Y=>({event_id:e,ticket_number:Y.ticket_number,ticket_category:Y.ticket_category,holder_name:Y.holder_name||null,holder_email:Y.holder_email||null,holder_phone:Y.holder_phone||null})),{error:U}=await B.from("tickets").insert(W);if(U)throw U;d("success"),setTimeout(()=>{t(),r()},2e3)}catch(z){console.error("Upload error:",z),h(z instanceof Error?z.message:"Upload failed"),d("error")}finally{l(!1)}},D.readAsText(s)}catch(D){console.error("File read error:",D),h("Failed to read file"),d("error"),l(!1)}}},E=()=>{const D=`ticket_number,ticket_category,holder_name,holder_email,holder_phone
TICKET001,VIP,John Smith,john@example.com,+256700000000
TICKET002,REGULAR,Jane Doe,jane@example.com,+256700000001
TICKET003,STAFF,Bob Johnson,bob@company.com,+256700000002
TICKET004,PRESS,Alice Brown,alice@media.com,+256700000003
TICKET005,VIP,Charlie Wilson,charlie@example.com,+256700000004`,$=new Blob([D],{type:"text/csv"}),M=window.URL.createObjectURL($),z=document.createElement("a");z.href=M,z.download="guest_list_template.csv",document.body.appendChild(z),z.click(),document.body.removeChild(z),window.URL.revokeObjectURL(M)};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:D=>{D.target===D.currentTarget&&r()},children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(lt,{className:"h-6 w-6 text-blue-600"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Upload Guest List"})]}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:n.jsx(Oo,{size:24})})]}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[n.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Ticket Upload"}),n.jsx("p",{className:"text-sm text-blue-600",children:"Upload your tickets from ticketing platforms (Quicket, Eventbrite, etc.). These tickets will be stored in your tickets table and can be linked to wristbands later."})]}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Need a template?"}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Download our template or use exports from your ticketing platform."})]}),n.jsxs("button",{onClick:E,className:"btn btn-secondary",children:[n.jsx(_n,{className:"h-4 w-4 mr-2"}),"Template"]})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-800 mb-2",children:"Required CSV Fields"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[n.jsxs("div",{children:[n.jsx("strong",{children:"Required:"})," ticket_number, ticket_category"]}),n.jsxs("div",{children:[n.jsx("strong",{children:"Optional:"})," holder_name, holder_email, holder_phone"]}),n.jsxs("div",{children:[n.jsx("strong",{children:"Note:"})," Status is automatically set to 'unused'"]})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"The system automatically maps common field names from different ticketing platforms."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Guest List CSV"}),n.jsx("div",{className:`mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md transition-colors ${_?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:O,onDragLeave:T,onDrop:A,children:n.jsxs("div",{className:"space-y-1 text-center",children:[n.jsx(Ps,{className:`mx-auto h-12 w-12 ${_?"text-blue-500":"text-gray-400"}`}),n.jsxs("div",{className:"flex text-sm text-gray-600",children:[n.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500",children:[n.jsx("span",{children:"Upload CSV file"}),n.jsx("input",{id:"file-upload",ref:w,name:"file-upload",type:"file",accept:".csv",className:"sr-only",onChange:P})]}),n.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),n.jsx("p",{className:`text-xs ${_?"text-blue-600":"text-gray-500"}`,children:_?"Drop your CSV file here":"CSV files from ticketing platforms"})]})}),s&&n.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",s.name," (",(s.size/1024).toFixed(1)," KB)"]})]}),v.length>0&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:n.jsxs("div",{className:"flex",children:[n.jsx(ir,{className:"h-5 w-5 text-red-400"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Validation Errors"}),n.jsx("div",{className:"mt-2 text-sm text-red-700",children:n.jsx("ul",{className:"list-disc pl-5 space-y-1",children:v.slice(0,10).map((D,$)=>n.jsx("li",{children:D},$))})})]})]})}),m.length>0&&v.length===0&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Preview (first 5 tickets)"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"Ticket Number"}),n.jsx("th",{children:"Category"}),n.jsx("th",{children:"Holder Name"}),n.jsx("th",{children:"Holder Email"}),n.jsx("th",{children:"Phone"})]})}),n.jsx("tbody",{children:m.map((D,$)=>n.jsxs("tr",{children:[n.jsx("td",{children:D.ticket_number}),n.jsx("td",{children:D.ticket_category}),n.jsx("td",{children:D.holder_name||""}),n.jsx("td",{children:D.holder_email||""}),n.jsx("td",{children:D.holder_phone||""})]},$))})]})})]}),f&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:n.jsxs("div",{className:"flex",children:[n.jsx(ir,{className:"h-5 w-5 text-red-400"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),n.jsx("p",{className:"mt-1 text-sm text-red-700",children:f})]})]})}),c==="success"&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:n.jsxs("div",{className:"flex",children:[n.jsx(Tt,{className:"h-5 w-5 text-green-400"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success!"}),n.jsx("p",{className:"mt-1 text-sm text-green-700",children:"Tickets uploaded successfully. You can now link wristbands to tickets."})]})]})})]}),n.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 bg-gray-50 border-t",children:[n.jsx("button",{onClick:r,className:"btn btn-secondary",children:"Cancel"}),n.jsx("button",{onClick:C,disabled:!s||i||v.length>0,className:"btn btn-primary",children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline-block mr-2"}),"Uploading..."]}):"Upload Tickets"})]})]})})},ab=({eventId:e,eventName:t,onUploadComplete:r,onClose:s,className:a})=>{const[i,l]=x.useState(null),[c,d]=x.useState(!1),[f,h]=x.useState("idle"),[m,g]=x.useState(""),[v,j]=x.useState([]),[_,y]=x.useState([]),w=x.useRef(null);x.useEffect(()=>{const T=A=>{A.key==="Escape"&&(s==null||s())};return document.addEventListener("keydown",T),()=>document.removeEventListener("keydown",T)},[s]);const k=T=>{const A=T.trim().split(`
`),C=A[0].split(",").map(W=>W.trim()),E={"nfc id":"nfc_id",nfc_id:"nfc_id",nfcid:"nfc_id","wristband id":"nfc_id",wristband_id:"nfc_id",id:"nfc_id","wristband number":"wristband_number",wristband_number:"wristband_number",number:"wristband_number",category:"category",type:"category",access_level:"category",color:"color",batch:"batch_number",batch_number:"batch_number","batch number":"batch_number"},D=C.map(W=>{const U=W.toLowerCase().trim();return E[U]||U.replace(/\s+/g,"_")});if(!D.includes("nfc_id"))throw new Error("CSV must contain NFC ID field (NFC ID, Wristband ID, or ID)");const M=[],z=[],K=new Set;for(let W=1;W<A.length;W++){const U=A[W].trim();if(!U)continue;const Y=U.split(",").map(H=>H.trim().replace(/^"|"$/g,""));if(Y.length!==C.length){z.push(`Row ${W+1}: Column count mismatch`);continue}const R={};if(D.forEach((H,J)=>{R[H]=Y[J]}),!R.nfc_id){z.push(`Row ${W+1}: Missing NFC ID`);continue}if(K.has(R.nfc_id)){z.push(`Row ${W+1}: Duplicate NFC ID ${R.nfc_id}`);continue}K.add(R.nfc_id),R.category||(R.category="General"),M.push(R)}return z.length>0&&y(z),M},N=T=>{var E;const A=(E=T.target.files)==null?void 0:E[0];if(!A)return;if(!A.name.endsWith(".csv")){g("Please select a CSV file");return}l(A),h("idle"),g(""),y([]);const C=new FileReader;C.onload=D=>{var $;try{const M=($=D.target)==null?void 0:$.result,z=k(M);j(z.slice(0,5))}catch(M){g(M instanceof Error?M.message:"Failed to parse CSV")}},C.readAsText(A)},P=async()=>{if(i){d(!0),h("idle"),g("");try{const T=new FileReader;T.onload=async A=>{var C;try{const E=(C=A.target)==null?void 0:C.result,D=k(E);if(_.length>0){g("Please fix validation errors before uploading"),d(!1);return}const $=D.map(z=>({event_id:e,nfc_id:z.nfc_id,wristband_number:z.wristband_number,category:z.category,color:z.color,batch_number:z.batch_number,status:"available",is_active:!0,metadata:{...Object.keys(z).reduce((K,W)=>(["nfc_id","wristband_number","category","color","batch_number"].includes(W)||(K[W]=z[W]),K),{})}})),{error:M}=await B.from("wristbands").insert($);if(M)throw M;h("success"),setTimeout(()=>{r==null||r(),s==null||s()},2e3)}catch(E){console.error("Upload error:",E),g(E instanceof Error?E.message:"Upload failed"),h("error")}finally{d(!1)}},T.readAsText(i)}catch(T){console.error("File read error:",T),g("Failed to read file"),h("error"),d(!1)}}},O=()=>{const T=`NFC ID,Wristband Number,Category,Color,Batch Number
NFC001,WB001,VIP,Gold,BATCH001
NFC002,WB002,Regular,Blue,BATCH001
NFC003,WB003,Staff,Green,BATCH002
NFC004,WB004,Press,Red,BATCH002
NFC005,WB005,VIP,Gold,BATCH001`,A=new Blob([T],{type:"text/csv"}),C=window.URL.createObjectURL(A),E=document.createElement("a");E.href=C,E.download="wristband_inventory_template.csv",document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(C)};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium text-purple-800",children:"Wristband Inventory Upload"}),t&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:t})]}),n.jsxs("p",{className:"text-sm text-purple-600",children:["Upload your physical wristband inventory with NFC IDs. These are the actual wristbands you'll distribute to guests at the event",t?` "${t}"`:"","."]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Need a template?"}),n.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Download template to format data"})]}),n.jsxs("button",{onClick:O,className:"btn btn-secondary text-xs px-3 py-1",children:[n.jsx(_n,{className:"h-3 w-3 mr-1"}),"Template"]})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-800 mb-1",children:"Required Fields"}),n.jsxs("div",{className:"text-xs text-gray-600",children:[n.jsxs("div",{children:[n.jsx("strong",{children:"NFC ID:"})," Required"]}),n.jsxs("div",{children:[n.jsx("strong",{children:"Category:"}),' Optional (defaults to "General")']})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Wristband Inventory CSV"}),n.jsx("div",{className:"mt-1 flex justify-center px-4 pt-4 pb-4 border-2 border-gray-300 border-dashed rounded-md hover:border-gray-400 transition-colors",children:n.jsxs("div",{className:"space-y-1 text-center",children:[n.jsx(Ps,{className:"mx-auto h-8 w-8 text-gray-400"}),n.jsxs("div",{className:"flex text-sm text-gray-600",children:[n.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-purple-600 hover:text-purple-500",children:[n.jsx("span",{children:"Upload CSV file"}),n.jsx("input",{id:"file-upload",ref:w,name:"file-upload",type:"file",accept:".csv",className:"sr-only",onChange:N})]}),n.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),n.jsx("p",{className:"text-xs text-gray-500",children:"CSV file with wristband NFC IDs"})]})}),i&&n.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",i.name," (",(i.size/1024).toFixed(1)," KB)"]})]}),_.length>0&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:n.jsxs("div",{className:"flex",children:[n.jsx(ir,{className:"h-4 w-4 text-red-400 mt-0.5"}),n.jsxs("div",{className:"ml-2",children:[n.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Validation Errors"}),n.jsx("div",{className:"mt-1 text-xs text-red-700 max-h-20 overflow-y-auto",children:n.jsxs("ul",{className:"list-disc pl-4 space-y-0.5",children:[_.slice(0,5).map((T,A)=>n.jsx("li",{children:T},A)),_.length>5&&n.jsxs("li",{children:["... and ",_.length-5," more errors"]})]})})]})]})}),v.length>0&&_.length===0&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Preview (first 3 wristbands)"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-xs",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-left",children:"NFC ID"}),n.jsx("th",{className:"px-2 py-1 text-left",children:"Category"}),n.jsx("th",{className:"px-2 py-1 text-left",children:"Color"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:v.slice(0,3).map((T,A)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-2 py-1 font-mono",children:T.nfc_id}),n.jsx("td",{className:"px-2 py-1",children:T.category}),n.jsx("td",{className:"px-2 py-1",children:T.color||""})]},A))})]})})]}),m&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:n.jsxs("div",{className:"flex",children:[n.jsx(ir,{className:"h-4 w-4 text-red-400 mt-0.5"}),n.jsxs("div",{className:"ml-2",children:[n.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),n.jsx("p",{className:"mt-1 text-xs text-red-700",children:m})]})]})}),f==="success"&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:n.jsxs("div",{className:"flex",children:[n.jsx(Tt,{className:"h-4 w-4 text-green-400 mt-0.5"}),n.jsxs("div",{className:"ml-2",children:[n.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success!"}),n.jsx("p",{className:"mt-1 text-xs text-green-700",children:"Wristband inventory uploaded successfully."})]})]})}),n.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t",children:[n.jsx("button",{onClick:()=>s==null?void 0:s(),className:"btn btn-secondary",children:"Cancel"}),n.jsx("button",{onClick:P,disabled:!i||c||_.length>0,className:"btn btn-primary",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline-block mr-2"}),"Uploading..."]}):"Upload Wristbands"})]})]})},ib=({eventId:e,onUploadComplete:t,onClose:r})=>{const[s,a]=x.useState(null),[i,l]=x.useState(!1),[c,d]=x.useState("idle"),[f,h]=x.useState(""),[m,g]=x.useState([]),[v,j]=x.useState([]),_=x.useRef(null),y=E=>{const D=E.trim().split(`
`),$=D[0].split(",").map(Y=>Y.trim()),M={ticket_number:"ticket_id","ticket number":"ticket_id",ticket_id:"ticket_id",ticketnumber:"ticket_id","ticket barcode":"ticket_barcode",ticketbarcode:"ticket_barcode",ticket_category:"category","ticket category":"category","ticket type":"category",tickettype:"category",category:"category",type:"category",holder_name:"holder_name","holder name":"holder_name",purchaser_name:"holder_name","purchaser name":"holder_name",name:"holder_name",holder_email:"purchaser_email","holder email":"purchaser_email",purchaser_email:"purchaser_email","purchaser email":"purchaser_email",email:"purchaser_email",holder_phone:"holder_phone","holder phone":"holder_phone",phone:"holder_phone",phone_number:"holder_phone","price paid":"price_paid",pricepaid:"price_paid",price:"price_paid","order number":"order_number",ordernumber:"order_number","purchase date":"purchase_date",purchasedate:"purchase_date","seat number":"seat_number",seatnumber:"seat_number",teamname:"team_name","team name":"team_name","checked in":"checked_in",checkedin:"checked_in"},z=$.map(Y=>{const R=Y.toLowerCase().trim();return M[R]||R.replace(/\s+/g,"_")});if(!(z.includes("ticket_id")||z.includes("ticket_barcode")))throw new Error("CSV must contain at least one ticket identifier field (Ticket Number, Ticket ID, or Ticket Barcode)");const W=[],U=[];for(let Y=1;Y<D.length;Y++){const R=D[Y].trim();if(!R)continue;const H=R.split(",").map(F=>F.trim().replace(/^"|"$/g,""));if(H.length!==$.length){U.push(`Row ${Y+1}: Column count mismatch (expected ${$.length}, got ${H.length})`);continue}const J={};if(z.forEach((F,V)=>{J[F]=H[V]}),!J.ticket_id&&J.ticket_barcode&&(J.ticket_id=J.ticket_barcode),!J.ticket_id){U.push(`Row ${Y+1}: Missing ticket identifier`);continue}if(J.category||(J.category="General"),J.price_paid){const F=parseFloat(J.price_paid.toString().replace(/[^\d.-]/g,""));isNaN(F)||(J.price_paid=F)}W.push(J)}return U.length>0&&j(U),W},w=E=>{var $;const D=($=E.target.files)==null?void 0:$[0];D&&k(D)},k=E=>{if(!E.name.endsWith(".csv")){h("Please select a CSV file");return}a(E),d("idle"),h(""),j([]);const D=new FileReader;D.onload=$=>{var M;try{const z=(M=$.target)==null?void 0:M.result,K=y(z);g(K.slice(0,5))}catch(z){h(z instanceof Error?z.message:"Failed to parse CSV")}},D.readAsText(E)},N=E=>{E.preventDefault(),E.stopPropagation()},P=E=>{E.preventDefault(),E.stopPropagation()},O=E=>{E.preventDefault(),E.stopPropagation()},T=E=>{E.preventDefault(),E.stopPropagation();const D=E.dataTransfer.files;if(D&&D.length>0){const $=D[0];k($)}},A=async()=>{if(s){l(!0),d("idle"),h("");try{const E=new FileReader;E.onload=async D=>{var $;try{const M=($=D.target)==null?void 0:$.result,z=y(M);if(v.length>0){h("Please fix validation errors before uploading"),l(!1);return}const K=z.map(U=>({event_id:e,ticket_number:U.ticket_id,ticket_category:U.category,holder_name:U.holder_name||null,holder_email:U.purchaser_email||null,holder_phone:U.holder_phone||null,status:"unused"})),{error:W}=await B.from("tickets").insert(K);if(W)throw W;d("success"),setTimeout(()=>{t(),r()},2e3)}catch(M){console.error("Upload error:",M);let z="Upload failed";if(M&&typeof M=="object"&&"code"in M)switch(M.code){case"23505":z="Duplicate ticket numbers detected. Some tickets already exist in the system. Please check your data or remove duplicates.";break;case"23502":z="Missing required fields. Please ensure all required columns are present.";break;case"23503":z="Invalid event reference. Please check the event ID.";break;default:z=M.message||"Database error occurred during upload"}else M instanceof Error&&(z=M.message);h(z),d("error")}finally{l(!1)}},E.readAsText(s)}catch(E){console.error("File read error:",E),h("Failed to read file"),d("error"),l(!1)}}},C=()=>{const E=`ticket_number,ticket_category,holder_name,holder_email,holder_phone
44932055,DIE HARD,Selector Jay,selectorj@gmail.com,+256772443657
44960573,DIE HARD,Aminah Nalubega,aminahnlbg@gmail.com,+256741741789
44982011,DIE HARD,stephen ruhinda,stephenruhinda@gmail.com,+256780527960
44991434,DIE HARD,Moses Moses,namaramss@yahoo.co.uk,+13014672967
44991435,VIP,Sample User,sample@example.com,+256700000000`,D=new Blob([E],{type:"text/csv"}),$=window.URL.createObjectURL(D),M=document.createElement("a");M.href=$,M.download="tickets_template.csv",document.body.appendChild(M),M.click(),document.body.removeChild(M),window.URL.revokeObjectURL($)};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Upload Tickets CSV"}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:n.jsx(Oo,{size:24})})]}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Need a template?"}),n.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Download our CSV template or use your existing ticketing system export. Supports common formats from Quicket, Eventbrite, and other platforms."})]}),n.jsxs("button",{onClick:C,className:"inline-flex items-center px-3 py-2 border border-blue-300 shadow-sm text-sm font-medium rounded-md text-blue-700 bg-white hover:bg-blue-50",children:[n.jsx(_n,{size:16,className:"mr-2"}),"Download Template"]})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-800 mb-2",children:"Supported CSV Fields"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[n.jsxs("div",{children:[n.jsx("strong",{children:"Required:"})," ticket_number (or Ticket Number/ID)"]}),n.jsxs("div",{children:[n.jsx("strong",{children:"Required:"})," ticket_category (or Ticket Type)"]}),n.jsxs("div",{children:[n.jsx("strong",{children:"Optional:"})," holder_name, holder_email, holder_phone"]}),n.jsxs("div",{children:[n.jsx("strong",{children:"Optional:"})," Purchase Date, Seat Number, Order Number"]})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:'The system automatically maps field names like "ticket_number" or "Ticket Number" to the correct format.'})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV File"}),n.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:border-gray-400 transition-colors",onDragOver:N,onDragEnter:P,onDragLeave:O,onDrop:T,children:n.jsxs("div",{className:"space-y-1 text-center",children:[n.jsx(Ps,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsxs("div",{className:"flex text-sm text-gray-600",children:[n.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[n.jsx("span",{children:"Upload a file"}),n.jsx("input",{id:"file-upload",ref:_,name:"file-upload",type:"file",accept:".csv",className:"sr-only",onChange:w})]}),n.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),n.jsx("p",{className:"text-xs text-gray-500",children:"CSV files only"})]})}),s&&n.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",s.name," (",(s.size/1024).toFixed(1)," KB)"]})]}),v.length>0&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:n.jsxs("div",{className:"flex",children:[n.jsx(ir,{className:"h-5 w-5 text-red-400"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Validation Errors"}),n.jsx("div",{className:"mt-2 text-sm text-red-700",children:n.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[v.slice(0,10).map((E,D)=>n.jsx("li",{children:E},D)),v.length>10&&n.jsxs("li",{children:["... and ",v.length-10," more errors"]})]})})]})]})}),m.length>0&&v.length===0&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Preview (first 5 rows)"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ticket Number"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Category"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Holder Name"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((E,D)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:E.ticket_id}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:E.category}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:E.holder_name||"-"}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:E.purchaser_email||"-"}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:E.holder_phone||"-"})]},D))})]})})]}),f&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:n.jsxs("div",{className:"flex",children:[n.jsx(ir,{className:"h-5 w-5 text-red-400"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),n.jsx("p",{className:"mt-1 text-sm text-red-700",children:f})]})]})}),c==="success"&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:n.jsxs("div",{className:"flex",children:[n.jsx(Tt,{className:"h-5 w-5 text-green-400"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success!"}),n.jsx("p",{className:"mt-1 text-sm text-green-700",children:"Tickets have been uploaded successfully."})]})]})})]}),n.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 bg-gray-50 border-t",children:[n.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:A,disabled:!s||i||v.length>0,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline-block mr-2"}),"Uploading..."]}):"Upload Tickets"})]})]})})},jP=({eventId:e})=>{const[t,r]=x.useState([]),[s,a]=x.useState([]),[i,l]=x.useState(new Set),[c,d]=x.useState(""),[f,h]=x.useState(""),[m,g]=x.useState(""),[v,j]=x.useState(!1),[_,y]=x.useState([]),[w,k]=x.useState(null),[N,P]=x.useState(!1),[O,T]=x.useState(!0);x.useEffect(()=>{A(),C()},[e]);const A=async()=>{try{const{data:Z,error:ie}=await B.from("wristbands").select("*").eq("event_id",e).order("created_at",{ascending:!1});if(ie)throw ie;r(Z||[])}catch(Z){console.error("Error fetching wristbands:",Z)}finally{T(!1)}},C=async()=>{try{const{data:Z,error:ie}=await B.from("wristbands").select("category").eq("event_id",e).order("category");if(ie)throw ie;const be=[...new Set((Z==null?void 0:Z.map(xe=>xe.category))||[])].map((xe,oe)=>({id:`cat-${oe}`,name:xe,color:E(xe),description:`${xe} wristbands`,is_active:!0,sort_order:oe}));a(be)}catch(Z){console.error("Error fetching categories:",Z),a([])}},E=Z=>({General:"#10B981",VIP:"#F59E0B",Staff:"#3B82F6",Press:"#8B5CF6",Vendor:"#EF4444"})[Z]||"#6B7280",D=Z=>{var fe;const ie=(fe=Z.target.files)==null?void 0:fe[0];ie&&ti.parse(ie,{header:!0,skipEmptyLines:!0,complete:be=>{y(be.data),$(be.data)},error:be=>{console.error("CSV parsing error:",be)}})},$=Z=>{const ie=[],fe=[],be=[],xe=new Set(t.map(de=>de.nfc_id)),oe=new Set;Z.forEach((de,ce)=>{const ne=M(de);if(ne.isValid){const Oe=ne.wristband.nfc_id;if(oe.has(Oe)){be.push({...de,_index:ce,_error:"Duplicate within CSV"});return}if(xe.has(Oe)){be.push({...de,_index:ce,_error:"Already exists in database"});return}oe.add(Oe),ie.push(ne.wristband)}else fe.push({...de,_index:ce,_error:ne.error})}),k({valid:ie,invalid:fe,duplicates:be,stats:{total:Z.length,valid:ie.length,invalid:fe.length,duplicates:be.length}})},M=(Z,ie)=>{const fe=Z["Ticket Number"]||Z["Ticket Barcode"]||Z["NFC ID"]||Z.ID||Z.ticket_id,be=Z["Ticket Type"]||Z["UBL Vibe Pass"]||Z.Category||Z.Type||"General";if(!fe||fe.toString().trim()==="")return{isValid:!1,error:"Missing NFC ID/Ticket Number"};const xe=s.find(oe=>oe.name.toLowerCase()===be.toLowerCase())||s.find(oe=>oe.name==="General");return xe?{isValid:!0,wristband:{id:"",nfc_id:fe.toString().trim(),category:xe.name,status:"active",created_at:new Date().toISOString(),event_id:e,metadata:{purchaser_email:Z["Purchaser Email"],price_paid:Z["Price Paid"],order_number:Z["Order Number"],purchase_date:Z["Purchase Date"],seat_number:Z["Seat Number"],team_name:Z["Team Name"],csv_import:!0,import_date:new Date().toISOString()}}}:{isValid:!1,error:`Invalid category: ${be}`}},z=async()=>{if(w!=null&&w.valid.length){P(!0);try{const{error:Z}=await B.from("wristbands").insert(w.valid);if(Z)throw Z;await A(),j(!1),y([]),k(null),alert(`Successfully imported ${w.valid.length} wristbands`)}catch(Z){console.error("Error importing wristbands:",Z),alert("Error importing wristbands")}finally{P(!1)}}},K=async Z=>{if(i.size!==0)try{const{error:ie}=await B.from("wristbands").update({status:Z}).in("id",Array.from(i));if(ie)throw ie;await A(),l(new Set),alert(`Updated ${i.size} wristbands to ${Z}`)}catch(ie){console.error("Error updating wristbands:",ie),alert("Error updating wristbands")}},W=async()=>{if(i.size!==0&&confirm(`Delete ${i.size} wristbands? This cannot be undone.`))try{const{error:Z}=await B.from("wristbands").delete().in("id",Array.from(i));if(Z)throw Z;await A(),l(new Set),alert(`Deleted ${i.size} wristbands`)}catch(Z){console.error("Error deleting wristbands:",Z),alert("Error deleting wristbands")}},U=()=>{const ie=Y().map(de=>{var ce,ne,Oe;return{"NFC ID":de.nfc_id,Category:de.category,Status:de.status,Created:new Date(de.created_at).toLocaleDateString(),"Checked In":de.checked_in_at?new Date(de.checked_in_at).toLocaleDateString():"No","Purchaser Email":((ce=de.metadata)==null?void 0:ce.purchaser_email)||"","Price Paid":((ne=de.metadata)==null?void 0:ne.price_paid)||"","Order Number":((Oe=de.metadata)==null?void 0:Oe.order_number)||""}}),fe=ti.unparse(ie),be=new Blob([fe],{type:"text/csv"}),xe=URL.createObjectURL(be),oe=document.createElement("a");oe.href=xe,oe.download=`wristbands-${new Date().toISOString().split("T")[0]}.csv`,oe.click(),URL.revokeObjectURL(xe)},Y=()=>t.filter(Z=>{const ie=Z.nfc_id.toLowerCase().includes(c.toLowerCase())||Z.category.toLowerCase().includes(c.toLowerCase()),fe=!f||Z.category===f,be=!m||Z.status===m;return ie&&fe&&be}),R=Z=>{const ie=new Set(i);ie.has(Z)?ie.delete(Z):ie.add(Z),l(ie)},H=()=>{const Z=Y();l(new Set(Z.map(ie=>ie.id)))},J=()=>{l(new Set)},F=Z=>{const ie=s.find(fe=>fe.name===Z);return(ie==null?void 0:ie.color)||"#10B981"},V=Z=>{switch(Z){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"blocked":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},te=Y();return O?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Wristband Management"}),n.jsxs("p",{className:"text-sm text-gray-600",children:[t.length," total  ",te.length," filtered  ",i.size," selected"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>j(!0),className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[n.jsx(Ps,{className:"w-4 h-4 mr-2"}),"Import CSV"]}),n.jsxs("button",{onClick:U,className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[n.jsx(_n,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),n.jsx("input",{type:"text",placeholder:"Search by NFC ID or category...",value:c,onChange:Z=>d(Z.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("select",{value:f,onChange:Z=>h(Z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Categories"}),s.map(Z=>n.jsx("option",{value:Z.name,children:Z.name},Z.id))]}),n.jsxs("select",{value:m,onChange:Z=>g(Z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Status"}),n.jsx("option",{value:"active",children:"Active"}),n.jsx("option",{value:"inactive",children:"Inactive"}),n.jsx("option",{value:"blocked",children:"Blocked"})]})]}),i.size>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[i.size," wristbands selected"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>K("active"),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:"Activate"}),n.jsx("button",{onClick:()=>K("inactive"),className:"px-3 py-1 bg-gray-600 text-white text-sm rounded hover:bg-gray-700",children:"Deactivate"}),n.jsx("button",{onClick:()=>K("blocked"),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Block"}),n.jsx("button",{onClick:W,className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:n.jsx(wn,{className:"w-3 h-3"})}),n.jsx("button",{onClick:J,className:"px-3 py-1 bg-gray-300 text-gray-700 text-sm rounded hover:bg-gray-400",children:"Clear"})]})]})}),n.jsx("div",{className:"flex items-center justify-between text-sm",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("button",{onClick:H,className:"text-blue-600 hover:text-blue-800",children:["Select All Filtered (",te.length,")"]}),n.jsx("button",{onClick:J,className:"text-gray-600 hover:text-gray-800",children:"Clear Selection"})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsx("input",{type:"checkbox",checked:i.size===te.length&&te.length>0,onChange:i.size===te.length?J:H,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NFC ID"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-in"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:te.map(Z=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("input",{type:"checkbox",checked:i.has(Z.id),onChange:()=>R(Z.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:Z.nfc_id})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-white",style:{backgroundColor:F(Z.category)},children:Z.category})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${V(Z.status)}`,children:Z.status})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(Z.created_at).toLocaleDateString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Z.checked_in_at?n.jsx("span",{className:"text-green-600",children:new Date(Z.checked_in_at).toLocaleDateString()}):n.jsx("span",{className:"text-gray-400",children:"Not checked in"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:n.jsx(ii,{className:"w-4 h-4"})}),n.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:n.jsx(us,{className:"w-4 h-4"})})]})})]},Z.id))})]})})}),v&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Import Wristbands from CSV"}),n.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(Oo,{className:"w-6 h-6"})})]}),w?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:w.stats.total}),n.jsx("div",{className:"text-sm text-blue-600",children:"Total Rows"})]}),n.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:w.stats.valid}),n.jsx("div",{className:"text-sm text-green-600",children:"Valid"})]}),n.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-red-600",children:w.stats.invalid}),n.jsx("div",{className:"text-sm text-red-600",children:"Invalid"})]}),n.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:w.stats.duplicates}),n.jsx("div",{className:"text-sm text-yellow-600",children:"Duplicates"})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("button",{onClick:()=>k(null),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Upload Different File"}),w.stats.valid>0&&n.jsxs("button",{onClick:z,disabled:N,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:[N?n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):n.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Import ",w.stats.valid," Valid Wristbands"]})]}),(w.invalid.length>0||w.duplicates.length>0)&&n.jsxs("div",{className:"space-y-3",children:[w.invalid.length>0&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[n.jsxs("h4",{className:"font-medium text-red-900 mb-2 flex items-center",children:[n.jsx(bt,{className:"w-4 h-4 mr-2"}),"Invalid Rows (",w.invalid.length,")"]}),n.jsxs("div",{className:"max-h-32 overflow-y-auto text-sm",children:[w.invalid.slice(0,5).map((Z,ie)=>n.jsxs("div",{className:"text-red-700",children:["Row ",Z._index+2,": ",Z._error]},ie)),w.invalid.length>5&&n.jsxs("div",{className:"text-red-600 italic",children:["... and ",w.invalid.length-5," more"]})]})]}),w.duplicates.length>0&&n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[n.jsxs("h4",{className:"font-medium text-yellow-900 mb-2 flex items-center",children:[n.jsx(bt,{className:"w-4 h-4 mr-2"}),"Duplicate Rows (",w.duplicates.length,")"]}),n.jsxs("div",{className:"max-h-32 overflow-y-auto text-sm",children:[w.duplicates.slice(0,5).map((Z,ie)=>n.jsxs("div",{className:"text-yellow-700",children:["Row ",Z._index+2,": ",Z._error]},ie)),w.duplicates.length>5&&n.jsxs("div",{className:"text-yellow-600 italic",children:["... and ",w.duplicates.length-5," more"]})]})]})]})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[n.jsx(Ps,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Upload CSV File"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Supports Quicket, Eventbrite, and custom formats"}),n.jsx("input",{type:"file",accept:".csv",onChange:D,className:"hidden",id:"csv-upload"}),n.jsx("label",{htmlFor:"csv-upload",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer",children:"Choose File"})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Supported Fields:"}),n.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Required:"})," Ticket Number, Ticket Barcode, NFC ID, or ID"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Optional:"})," Ticket Type, Category, Purchaser Email, Price Paid, Order Number"]})]})]})]})]})})]})};function ux(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function NP(...e){return t=>{let r=!1;const s=e.map(a=>{const i=ux(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<s.length;a++){const i=s[a];typeof i=="function"?i():ux(e[a],null)}}}}function kP(e){const t=EP(e),r=x.forwardRef((s,a)=>{const{children:i,...l}=s,c=x.Children.toArray(i),d=c.find(PP);if(d){const f=d.props.children,h=c.map(m=>m===d?x.Children.count(f)>1?x.Children.only(null):x.isValidElement(f)?f.props.children:null:m);return n.jsx(t,{...l,ref:a,children:x.isValidElement(f)?x.cloneElement(f,void 0,h):null})}return n.jsx(t,{...l,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var SP=kP("Slot");function EP(e){const t=x.forwardRef((r,s)=>{const{children:a,...i}=r;if(x.isValidElement(a)){const l=TP(a),c=AP(i,a.props);return a.type!==x.Fragment&&(c.ref=s?NP(s,l):l),x.cloneElement(a,c)}return x.Children.count(a)>1?x.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var CP=Symbol("radix.slottable");function PP(e){return x.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===CP}function AP(e,t){const r={...t};for(const s in t){const a=e[s],i=t[s];/^on[A-Z]/.test(s)?a&&i?r[s]=(...c)=>{const d=i(...c);return a(...c),d}:a&&(r[s]=a):s==="style"?r[s]={...a,...i}:s==="className"&&(r[s]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function TP(e){var s,a;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const hx=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,fx=Ve,ob=(e,t)=>r=>{var s;if((t==null?void 0:t.variants)==null)return fx(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,l=Object.keys(a).map(f=>{const h=r==null?void 0:r[f],m=i==null?void 0:i[f];if(h===null)return null;const g=hx(h)||hx(m);return a[f][g]}),c=r&&Object.entries(r).reduce((f,h)=>{let[m,g]=h;return g===void 0||(f[m]=g),f},{}),d=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((f,h)=>{let{class:m,className:g,...v}=h;return Object.entries(v).every(j=>{let[_,y]=j;return Array.isArray(y)?y.includes({...i,...c}[_]):{...i,...c}[_]===y})?[...f,m,g]:f},[]);return fx(e,l,d,r==null?void 0:r.class,r==null?void 0:r.className)},Df="-",OP=e=>{const t=IP(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:l=>{const c=l.split(Df);return c[0]===""&&c.length!==1&&c.shift(),lb(c,t)||MP(l)},getConflictingClassGroupIds:(l,c)=>{const d=r[l]||[];return c&&s[l]?[...d,...s[l]]:d}}},lb=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],s=t.nextPart.get(r),a=s?lb(e.slice(1),s):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(Df);return(l=t.validators.find(({validator:c})=>c(i)))==null?void 0:l.classGroupId},mx=/^\[(.+)\]$/,MP=e=>{if(mx.test(e)){const t=mx.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},IP=e=>{const{theme:t,classGroups:r}=e,s={nextPart:new Map,validators:[]};for(const a in r)Nh(r[a],s,a,t);return s},Nh=(e,t,r,s)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:px(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(LP(a)){Nh(a(s),t,r,s);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,l])=>{Nh(l,px(t,i),r,s)})})},px=(e,t)=>{let r=e;return t.split(Df).forEach(s=>{r.nextPart.has(s)||r.nextPart.set(s,{nextPart:new Map,validators:[]}),r=r.nextPart.get(s)}),r},LP=e=>e.isThemeGetter,DP=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,s=new Map;const a=(i,l)=>{r.set(i,l),t++,t>e&&(t=0,s=r,r=new Map)};return{get(i){let l=r.get(i);if(l!==void 0)return l;if((l=s.get(i))!==void 0)return a(i,l),l},set(i,l){r.has(i)?r.set(i,l):a(i,l)}}},kh="!",Sh=":",RP=Sh.length,$P=e=>{const{prefix:t,experimentalParseClassName:r}=e;let s=a=>{const i=[];let l=0,c=0,d=0,f;for(let j=0;j<a.length;j++){let _=a[j];if(l===0&&c===0){if(_===Sh){i.push(a.slice(d,j)),d=j+RP;continue}if(_==="/"){f=j;continue}}_==="["?l++:_==="]"?l--:_==="("?c++:_===")"&&c--}const h=i.length===0?a:a.substring(d),m=zP(h),g=m!==h,v=f&&f>d?f-d:void 0;return{modifiers:i,hasImportantModifier:g,baseClassName:m,maybePostfixModifierPosition:v}};if(t){const a=t+Sh,i=s;s=l=>l.startsWith(a)?i(l.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(r){const a=s;s=i=>r({className:i,parseClassName:a})}return s},zP=e=>e.endsWith(kh)?e.substring(0,e.length-1):e.startsWith(kh)?e.substring(1):e,BP=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const a=[];let i=[];return s.forEach(l=>{l[0]==="["||t[l]?(a.push(...i.sort(),l),i=[]):i.push(l)}),a.push(...i.sort()),a}},FP=e=>({cache:DP(e.cacheSize),parseClassName:$P(e),sortModifiers:BP(e),...OP(e)}),UP=/\s+/,WP=(e,t)=>{const{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:a,sortModifiers:i}=t,l=[],c=e.trim().split(UP);let d="";for(let f=c.length-1;f>=0;f-=1){const h=c[f],{isExternal:m,modifiers:g,hasImportantModifier:v,baseClassName:j,maybePostfixModifierPosition:_}=r(h);if(m){d=h+(d.length>0?" "+d:d);continue}let y=!!_,w=s(y?j.substring(0,_):j);if(!w){if(!y){d=h+(d.length>0?" "+d:d);continue}if(w=s(j),!w){d=h+(d.length>0?" "+d:d);continue}y=!1}const k=i(g).join(":"),N=v?k+kh:k,P=N+w;if(l.includes(P))continue;l.push(P);const O=a(w,y);for(let T=0;T<O.length;++T){const A=O[T];l.push(N+A)}d=h+(d.length>0?" "+d:d)}return d};function qP(){let e=0,t,r,s="";for(;e<arguments.length;)(t=arguments[e++])&&(r=cb(t))&&(s&&(s+=" "),s+=r);return s}const cb=e=>{if(typeof e=="string")return e;let t,r="";for(let s=0;s<e.length;s++)e[s]&&(t=cb(e[s]))&&(r&&(r+=" "),r+=t);return r};function GP(e,...t){let r,s,a,i=l;function l(d){const f=t.reduce((h,m)=>m(h),e());return r=FP(f),s=r.cache.get,a=r.cache.set,i=c,c(d)}function c(d){const f=s(d);if(f)return f;const h=WP(d,r);return a(d,h),h}return function(){return i(qP.apply(null,arguments))}}const Zt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},db=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ub=/^\((?:(\w[\w-]*):)?(.+)\)$/i,HP=/^\d+\/\d+$/,VP=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,KP=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ZP=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,YP=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,XP=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ga=e=>HP.test(e),Ze=e=>!!e&&!Number.isNaN(Number(e)),_s=e=>!!e&&Number.isInteger(Number(e)),ku=e=>e.endsWith("%")&&Ze(e.slice(0,-1)),Hn=e=>VP.test(e),JP=()=>!0,QP=e=>KP.test(e)&&!ZP.test(e),hb=()=>!1,eA=e=>YP.test(e),tA=e=>XP.test(e),rA=e=>!Se(e)&&!Ee(e),nA=e=>wi(e,pb,hb),Se=e=>db.test(e),Zs=e=>wi(e,gb,QP),Su=e=>wi(e,lA,Ze),gx=e=>wi(e,fb,hb),sA=e=>wi(e,mb,tA),_l=e=>wi(e,xb,eA),Ee=e=>ub.test(e),Vi=e=>_i(e,gb),aA=e=>_i(e,cA),xx=e=>_i(e,fb),iA=e=>_i(e,pb),oA=e=>_i(e,mb),jl=e=>_i(e,xb,!0),wi=(e,t,r)=>{const s=db.exec(e);return s?s[1]?t(s[1]):r(s[2]):!1},_i=(e,t,r=!1)=>{const s=ub.exec(e);return s?s[1]?t(s[1]):r:!1},fb=e=>e==="position"||e==="percentage",mb=e=>e==="image"||e==="url",pb=e=>e==="length"||e==="size"||e==="bg-size",gb=e=>e==="length",lA=e=>e==="number",cA=e=>e==="family-name",xb=e=>e==="shadow",dA=()=>{const e=Zt("color"),t=Zt("font"),r=Zt("text"),s=Zt("font-weight"),a=Zt("tracking"),i=Zt("leading"),l=Zt("breakpoint"),c=Zt("container"),d=Zt("spacing"),f=Zt("radius"),h=Zt("shadow"),m=Zt("inset-shadow"),g=Zt("text-shadow"),v=Zt("drop-shadow"),j=Zt("blur"),_=Zt("perspective"),y=Zt("aspect"),w=Zt("ease"),k=Zt("animate"),N=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],O=()=>[...P(),Ee,Se],T=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],C=()=>[Ee,Se,d],E=()=>[Ga,"full","auto",...C()],D=()=>[_s,"none","subgrid",Ee,Se],$=()=>["auto",{span:["full",_s,Ee,Se]},_s,Ee,Se],M=()=>[_s,"auto",Ee,Se],z=()=>["auto","min","max","fr",Ee,Se],K=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],W=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...C()],Y=()=>[Ga,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...C()],R=()=>[e,Ee,Se],H=()=>[...P(),xx,gx,{position:[Ee,Se]}],J=()=>["no-repeat",{repeat:["","x","y","space","round"]}],F=()=>["auto","cover","contain",iA,nA,{size:[Ee,Se]}],V=()=>[ku,Vi,Zs],te=()=>["","none","full",f,Ee,Se],Z=()=>["",Ze,Vi,Zs],ie=()=>["solid","dashed","dotted","double"],fe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],be=()=>[Ze,ku,xx,gx],xe=()=>["","none",j,Ee,Se],oe=()=>["none",Ze,Ee,Se],de=()=>["none",Ze,Ee,Se],ce=()=>[Ze,Ee,Se],ne=()=>[Ga,"full",...C()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Hn],breakpoint:[Hn],color:[JP],container:[Hn],"drop-shadow":[Hn],ease:["in","out","in-out"],font:[rA],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Hn],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Hn],shadow:[Hn],spacing:["px",Ze],text:[Hn],"text-shadow":[Hn],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ga,Se,Ee,y]}],container:["container"],columns:[{columns:[Ze,Se,Ee,c]}],"break-after":[{"break-after":N()}],"break-before":[{"break-before":N()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:O()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:E()}],"inset-x":[{"inset-x":E()}],"inset-y":[{"inset-y":E()}],start:[{start:E()}],end:[{end:E()}],top:[{top:E()}],right:[{right:E()}],bottom:[{bottom:E()}],left:[{left:E()}],visibility:["visible","invisible","collapse"],z:[{z:[_s,"auto",Ee,Se]}],basis:[{basis:[Ga,"full","auto",c,...C()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ze,Ga,"auto","initial","none",Se]}],grow:[{grow:["",Ze,Ee,Se]}],shrink:[{shrink:["",Ze,Ee,Se]}],order:[{order:[_s,"first","last","none",Ee,Se]}],"grid-cols":[{"grid-cols":D()}],"col-start-end":[{col:$()}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":D()}],"row-start-end":[{row:$()}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":z()}],"auto-rows":[{"auto-rows":z()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:[...K(),"normal"]}],"justify-items":[{"justify-items":[...W(),"normal"]}],"justify-self":[{"justify-self":["auto",...W()]}],"align-content":[{content:["normal",...K()]}],"align-items":[{items:[...W(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...W(),{baseline:["","last"]}]}],"place-content":[{"place-content":K()}],"place-items":[{"place-items":[...W(),"baseline"]}],"place-self":[{"place-self":["auto",...W()]}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":C()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":C()}],"space-y-reverse":["space-y-reverse"],size:[{size:Y()}],w:[{w:[c,"screen",...Y()]}],"min-w":[{"min-w":[c,"screen","none",...Y()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[l]},...Y()]}],h:[{h:["screen","lh",...Y()]}],"min-h":[{"min-h":["screen","lh","none",...Y()]}],"max-h":[{"max-h":["screen","lh",...Y()]}],"font-size":[{text:["base",r,Vi,Zs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,Ee,Su]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ku,Se]}],"font-family":[{font:[aA,Se,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,Ee,Se]}],"line-clamp":[{"line-clamp":[Ze,"none",Ee,Su]}],leading:[{leading:[i,...C()]}],"list-image":[{"list-image":["none",Ee,Se]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ee,Se]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:R()}],"text-color":[{text:R()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ie(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ze,"from-font","auto",Ee,Zs]}],"text-decoration-color":[{decoration:R()}],"underline-offset":[{"underline-offset":[Ze,"auto",Ee,Se]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ee,Se]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ee,Se]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:H()}],"bg-repeat":[{bg:J()}],"bg-size":[{bg:F()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},_s,Ee,Se],radial:["",Ee,Se],conic:[_s,Ee,Se]},oA,sA]}],"bg-color":[{bg:R()}],"gradient-from-pos":[{from:V()}],"gradient-via-pos":[{via:V()}],"gradient-to-pos":[{to:V()}],"gradient-from":[{from:R()}],"gradient-via":[{via:R()}],"gradient-to":[{to:R()}],rounded:[{rounded:te()}],"rounded-s":[{"rounded-s":te()}],"rounded-e":[{"rounded-e":te()}],"rounded-t":[{"rounded-t":te()}],"rounded-r":[{"rounded-r":te()}],"rounded-b":[{"rounded-b":te()}],"rounded-l":[{"rounded-l":te()}],"rounded-ss":[{"rounded-ss":te()}],"rounded-se":[{"rounded-se":te()}],"rounded-ee":[{"rounded-ee":te()}],"rounded-es":[{"rounded-es":te()}],"rounded-tl":[{"rounded-tl":te()}],"rounded-tr":[{"rounded-tr":te()}],"rounded-br":[{"rounded-br":te()}],"rounded-bl":[{"rounded-bl":te()}],"border-w":[{border:Z()}],"border-w-x":[{"border-x":Z()}],"border-w-y":[{"border-y":Z()}],"border-w-s":[{"border-s":Z()}],"border-w-e":[{"border-e":Z()}],"border-w-t":[{"border-t":Z()}],"border-w-r":[{"border-r":Z()}],"border-w-b":[{"border-b":Z()}],"border-w-l":[{"border-l":Z()}],"divide-x":[{"divide-x":Z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ie(),"hidden","none"]}],"divide-style":[{divide:[...ie(),"hidden","none"]}],"border-color":[{border:R()}],"border-color-x":[{"border-x":R()}],"border-color-y":[{"border-y":R()}],"border-color-s":[{"border-s":R()}],"border-color-e":[{"border-e":R()}],"border-color-t":[{"border-t":R()}],"border-color-r":[{"border-r":R()}],"border-color-b":[{"border-b":R()}],"border-color-l":[{"border-l":R()}],"divide-color":[{divide:R()}],"outline-style":[{outline:[...ie(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ze,Ee,Se]}],"outline-w":[{outline:["",Ze,Vi,Zs]}],"outline-color":[{outline:R()}],shadow:[{shadow:["","none",h,jl,_l]}],"shadow-color":[{shadow:R()}],"inset-shadow":[{"inset-shadow":["none",m,jl,_l]}],"inset-shadow-color":[{"inset-shadow":R()}],"ring-w":[{ring:Z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:R()}],"ring-offset-w":[{"ring-offset":[Ze,Zs]}],"ring-offset-color":[{"ring-offset":R()}],"inset-ring-w":[{"inset-ring":Z()}],"inset-ring-color":[{"inset-ring":R()}],"text-shadow":[{"text-shadow":["none",g,jl,_l]}],"text-shadow-color":[{"text-shadow":R()}],opacity:[{opacity:[Ze,Ee,Se]}],"mix-blend":[{"mix-blend":[...fe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":fe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ze]}],"mask-image-linear-from-pos":[{"mask-linear-from":be()}],"mask-image-linear-to-pos":[{"mask-linear-to":be()}],"mask-image-linear-from-color":[{"mask-linear-from":R()}],"mask-image-linear-to-color":[{"mask-linear-to":R()}],"mask-image-t-from-pos":[{"mask-t-from":be()}],"mask-image-t-to-pos":[{"mask-t-to":be()}],"mask-image-t-from-color":[{"mask-t-from":R()}],"mask-image-t-to-color":[{"mask-t-to":R()}],"mask-image-r-from-pos":[{"mask-r-from":be()}],"mask-image-r-to-pos":[{"mask-r-to":be()}],"mask-image-r-from-color":[{"mask-r-from":R()}],"mask-image-r-to-color":[{"mask-r-to":R()}],"mask-image-b-from-pos":[{"mask-b-from":be()}],"mask-image-b-to-pos":[{"mask-b-to":be()}],"mask-image-b-from-color":[{"mask-b-from":R()}],"mask-image-b-to-color":[{"mask-b-to":R()}],"mask-image-l-from-pos":[{"mask-l-from":be()}],"mask-image-l-to-pos":[{"mask-l-to":be()}],"mask-image-l-from-color":[{"mask-l-from":R()}],"mask-image-l-to-color":[{"mask-l-to":R()}],"mask-image-x-from-pos":[{"mask-x-from":be()}],"mask-image-x-to-pos":[{"mask-x-to":be()}],"mask-image-x-from-color":[{"mask-x-from":R()}],"mask-image-x-to-color":[{"mask-x-to":R()}],"mask-image-y-from-pos":[{"mask-y-from":be()}],"mask-image-y-to-pos":[{"mask-y-to":be()}],"mask-image-y-from-color":[{"mask-y-from":R()}],"mask-image-y-to-color":[{"mask-y-to":R()}],"mask-image-radial":[{"mask-radial":[Ee,Se]}],"mask-image-radial-from-pos":[{"mask-radial-from":be()}],"mask-image-radial-to-pos":[{"mask-radial-to":be()}],"mask-image-radial-from-color":[{"mask-radial-from":R()}],"mask-image-radial-to-color":[{"mask-radial-to":R()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":P()}],"mask-image-conic-pos":[{"mask-conic":[Ze]}],"mask-image-conic-from-pos":[{"mask-conic-from":be()}],"mask-image-conic-to-pos":[{"mask-conic-to":be()}],"mask-image-conic-from-color":[{"mask-conic-from":R()}],"mask-image-conic-to-color":[{"mask-conic-to":R()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:H()}],"mask-repeat":[{mask:J()}],"mask-size":[{mask:F()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ee,Se]}],filter:[{filter:["","none",Ee,Se]}],blur:[{blur:xe()}],brightness:[{brightness:[Ze,Ee,Se]}],contrast:[{contrast:[Ze,Ee,Se]}],"drop-shadow":[{"drop-shadow":["","none",v,jl,_l]}],"drop-shadow-color":[{"drop-shadow":R()}],grayscale:[{grayscale:["",Ze,Ee,Se]}],"hue-rotate":[{"hue-rotate":[Ze,Ee,Se]}],invert:[{invert:["",Ze,Ee,Se]}],saturate:[{saturate:[Ze,Ee,Se]}],sepia:[{sepia:["",Ze,Ee,Se]}],"backdrop-filter":[{"backdrop-filter":["","none",Ee,Se]}],"backdrop-blur":[{"backdrop-blur":xe()}],"backdrop-brightness":[{"backdrop-brightness":[Ze,Ee,Se]}],"backdrop-contrast":[{"backdrop-contrast":[Ze,Ee,Se]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ze,Ee,Se]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ze,Ee,Se]}],"backdrop-invert":[{"backdrop-invert":["",Ze,Ee,Se]}],"backdrop-opacity":[{"backdrop-opacity":[Ze,Ee,Se]}],"backdrop-saturate":[{"backdrop-saturate":[Ze,Ee,Se]}],"backdrop-sepia":[{"backdrop-sepia":["",Ze,Ee,Se]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ee,Se]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ze,"initial",Ee,Se]}],ease:[{ease:["linear","initial",w,Ee,Se]}],delay:[{delay:[Ze,Ee,Se]}],animate:[{animate:["none",k,Ee,Se]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[_,Ee,Se]}],"perspective-origin":[{"perspective-origin":O()}],rotate:[{rotate:oe()}],"rotate-x":[{"rotate-x":oe()}],"rotate-y":[{"rotate-y":oe()}],"rotate-z":[{"rotate-z":oe()}],scale:[{scale:de()}],"scale-x":[{"scale-x":de()}],"scale-y":[{"scale-y":de()}],"scale-z":[{"scale-z":de()}],"scale-3d":["scale-3d"],skew:[{skew:ce()}],"skew-x":[{"skew-x":ce()}],"skew-y":[{"skew-y":ce()}],transform:[{transform:[Ee,Se,"","none","gpu","cpu"]}],"transform-origin":[{origin:O()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ne()}],"translate-x":[{"translate-x":ne()}],"translate-y":[{"translate-y":ne()}],"translate-z":[{"translate-z":ne()}],"translate-none":["translate-none"],accent:[{accent:R()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:R()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ee,Se]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ee,Se]}],fill:[{fill:["none",...R()]}],"stroke-w":[{stroke:[Ze,Vi,Zs,Su]}],stroke:[{stroke:["none",...R()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},uA=GP(dA);function ji(...e){return uA(Ve(e))}function Eu(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}const hA=ob("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ht=x.forwardRef(({className:e,variant:t,size:r,asChild:s=!1,...a},i)=>{const l=s?SP:"button";return n.jsx(l,{className:ji(hA({variant:t,size:r,className:e})),ref:i,...a})});ht.displayName="Button";const fA=({eventId:e})=>{const[t,r]=x.useState([]),[s,a]=x.useState(null),[i,l]=x.useState(""),[c,d]=x.useState("all"),[f,h]=x.useState(!0);x.useEffect(()=>{m();const w=g();return()=>{w==null||w.unsubscribe()}},[e]);const m=async()=>{try{h(!0);const{data:w,error:k}=await B.from("fraud_detections").select("*").eq("event_id",e).order("created_at",{ascending:!1}).limit(100);if(k)throw k;const N=(w||[]).map(P=>{var O;return{id:P.id,wristband_id:P.wristband_id||"",alert_type:P.detection_type,severity:P.severity,description:((O=P.details)==null?void 0:O.description)||"Fraud detected",timestamp:P.created_at,resolved:!!P.investigated_at,data:P.details}});r(N)}catch(w){console.error("Error fetching fraud alerts:",w)}finally{h(!1)}},g=()=>B.channel(`fraud_${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"fraud_detections",filter:`event_id=eq.${e}`},k=>{var P;const N={id:k.new.id,wristband_id:k.new.wristband_id||"",alert_type:k.new.detection_type,severity:k.new.severity,description:((P=k.new.details)==null?void 0:P.description)||"Fraud detected",timestamp:k.new.created_at,resolved:!1,data:k.new.details};r(O=>[N,...O])}).subscribe(),v=async(w,k)=>{try{const{error:N}=await B.from("wristband_blocks").insert({wristband_id:w,event_id:e,reason:k,blocked_at:new Date().toISOString()});if(N)throw N;alert("Wristband blocked successfully"),m()}catch(N){console.error("Error blocking wristband:",N),alert("Failed to block wristband")}},j=async w=>{try{const{error:k}=await B.from("fraud_detections").update({investigated_at:new Date().toISOString()}).eq("id",w);if(k)throw k;r(N=>N.map(P=>P.id===w?{...P,resolved:!0}:P))}catch(k){console.error("Error investigating alert:",k)}},_=w=>{switch(w){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},y=t.filter(w=>{const k=c==="all"||w.severity===c,N=i===""||w.wristband_id.toLowerCase().includes(i.toLowerCase())||w.description.toLowerCase().includes(i.toLowerCase());return k&&N});return f?n.jsx("div",{className:"flex items-center justify-center p-12",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),n.jsx("p",{className:"mt-4 text-gray-600",children:"Loading fraud detection..."})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[n.jsx(jr,{className:"w-6 h-6 mr-2 text-red-600"}),"Fraud Detection System"]}),n.jsx("p",{className:"text-gray-600",children:"Monitor and prevent fraudulent activity"})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("input",{type:"text",placeholder:"Search wristband ID...",value:i,onChange:w=>l(w.target.value),className:"px-4 py-2 border rounded-md"}),n.jsxs("select",{value:c,onChange:w=>d(w.target.value),className:"px-4 py-2 border rounded-md",children:[n.jsx("option",{value:"all",children:"All Severities"}),n.jsx("option",{value:"critical",children:"Critical"}),n.jsx("option",{value:"high",children:"High"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"low",children:"Low"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsx(ve,{children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Alerts"}),n.jsx("p",{className:"text-3xl font-bold text-gray-900",children:t.length})]}),n.jsx(bt,{className:"w-8 h-8 text-red-500"})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Critical"}),n.jsx("p",{className:"text-3xl font-bold text-red-600",children:t.filter(w=>w.severity==="critical").length})]}),n.jsx(If,{className:"w-8 h-8 text-red-500"})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Resolved"}),n.jsx("p",{className:"text-3xl font-bold text-green-600",children:t.filter(w=>w.resolved).length})]}),n.jsx(us,{className:"w-8 h-8 text-green-500"})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),n.jsx("p",{className:"text-3xl font-bold text-orange-600",children:t.filter(w=>!w.resolved).length})]}),n.jsx(Vr,{className:"w-8 h-8 text-orange-500"})]})})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Fraud Alerts"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:y.length===0?n.jsxs("div",{className:"text-center py-12",children:[n.jsx(jr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No fraud alerts found"})]}):y.map(w=>n.jsx("div",{className:`p-4 rounded-lg border ${_(w.severity)}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[n.jsx(bt,{className:"w-4 h-4"}),n.jsx("h4",{className:"font-medium",children:w.description}),w.resolved&&n.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"Resolved"})]}),n.jsxs("div",{className:"space-y-1 text-sm",children:[n.jsxs("div",{className:"flex items-center text-gray-700",children:[n.jsx(cn,{className:"w-3 h-3 mr-1"}),"Wristband ID: ",w.wristband_id]}),n.jsxs("div",{className:"flex items-center text-gray-700",children:[n.jsx(Vr,{className:"w-3 h-3 mr-1"}),new Date(w.timestamp).toLocaleString()]}),n.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Type: ",w.alert_type.replace("_"," ")]})]})]}),n.jsx("div",{className:"flex flex-col space-y-2",children:!w.resolved&&n.jsxs(n.Fragment,{children:[n.jsx(ht,{size:"sm",variant:"default",onClick:()=>j(w.id),children:"Mark Resolved"}),n.jsx(ht,{size:"sm",variant:"destructive",onClick:()=>v(w.wristband_id,w.description),children:"Block Wristband"})]})})]})},w.id))})})]})]})},vb=x.createContext(void 0),yb=()=>{const e=x.useContext(vb);if(!e)throw new Error("Tabs components must be used within a Tabs provider");return e},Hc=x.forwardRef(({defaultValue:e,value:t,onValueChange:r,children:s,className:a,...i},l)=>{const[c,d]=x.useState(e||""),f=t!==void 0?t:c,h=r||d;return n.jsx(vb.Provider,{value:{value:f,onValueChange:h},children:n.jsx("div",{ref:l,className:a,...i,children:s})})});Hc.displayName="Tabs";const Vc=x.forwardRef(({className:e,children:t,...r},s)=>n.jsx("div",{ref:s,className:ji("inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-500",e),...r,children:t}));Vc.displayName="TabsList";const mr=x.forwardRef(({className:e,value:t,children:r,...s},a)=>{const{value:i,onValueChange:l}=yb(),c=i===t;return n.jsx("button",{ref:a,className:ji("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",c?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900",e),onClick:()=>l(t),...s,children:r})});mr.displayName="TabsTrigger";const sr=x.forwardRef(({className:e,value:t,children:r,...s},a)=>{const{value:i}=yb();return i!==t?null:n.jsx("div",{ref:a,className:ji("mt-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",e),...s,children:r})});sr.displayName="TabsContent";var Kc={},bb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(bb);var Rf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Rf);var Zc={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var s;return typeof r=="string"||typeof r=="symbol"?r:Object.is((s=r==null?void 0:r.valueOf)==null?void 0:s.call(r),-0)?"-0":String(r)}e.toKey=t})(Zc);var Yc={},wb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const s=String(r);return s==="0"&&Object.is(Number(r),-0)?"-0":s}e.toString=t})(wb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wb,r=Zc;function s(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],l=a.length;if(l===0)return i;let c=0,d="",f="",h=!1;for(a.charCodeAt(0)===46&&(i.push(""),c++);c<l;){const m=a[c];f?m==="\\"&&c+1<l?(c++,d+=a[c]):m===f?f="":d+=m:h?m==='"'||m==="'"?f=m:m==="]"?(h=!1,i.push(d),d=""):d+=m:m==="["?(h=!0,d&&(i.push(d),d="")):m==="."?d&&(i.push(d),d=""):d+=m,c++}return d&&i.push(d),i}e.toPath=s})(Yc);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bb,r=Rf,s=Zc,a=Yc;function i(c,d,f){if(c==null)return f;switch(typeof d){case"string":{if(t.isUnsafeProperty(d))return f;const h=c[d];return h===void 0?r.isDeepKey(d)?i(c,a.toPath(d),f):f:h}case"number":case"symbol":{typeof d=="number"&&(d=s.toKey(d));const h=c[d];return h===void 0?f:h}default:{if(Array.isArray(d))return l(c,d,f);if(Object.is(d==null?void 0:d.valueOf(),-0)?d="-0":d=String(d),t.isUnsafeProperty(d))return f;const h=c[d];return h===void 0?f:h}}}function l(c,d,f){if(d.length===0)return f;let h=c;for(let m=0;m<d.length;m++){if(h==null||t.isUnsafeProperty(d[m]))return f;h=h[d[m]]}return h===void 0?f:h}e.get=i})(Kc);var mA=Kc.get;const va=zn(mA);var _b={exports:{}},mt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $f=Symbol.for("react.transitional.element"),zf=Symbol.for("react.portal"),Xc=Symbol.for("react.fragment"),Jc=Symbol.for("react.strict_mode"),Qc=Symbol.for("react.profiler"),ed=Symbol.for("react.consumer"),td=Symbol.for("react.context"),rd=Symbol.for("react.forward_ref"),nd=Symbol.for("react.suspense"),sd=Symbol.for("react.suspense_list"),ad=Symbol.for("react.memo"),id=Symbol.for("react.lazy"),pA=Symbol.for("react.view_transition"),gA=Symbol.for("react.client.reference");function hn(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case $f:switch(e=e.type,e){case Xc:case Qc:case Jc:case nd:case sd:case pA:return e;default:switch(e=e&&e.$$typeof,e){case td:case rd:case id:case ad:return e;case ed:return e;default:return t}}case zf:return t}}}mt.ContextConsumer=ed;mt.ContextProvider=td;mt.Element=$f;mt.ForwardRef=rd;mt.Fragment=Xc;mt.Lazy=id;mt.Memo=ad;mt.Portal=zf;mt.Profiler=Qc;mt.StrictMode=Jc;mt.Suspense=nd;mt.SuspenseList=sd;mt.isContextConsumer=function(e){return hn(e)===ed};mt.isContextProvider=function(e){return hn(e)===td};mt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===$f};mt.isForwardRef=function(e){return hn(e)===rd};mt.isFragment=function(e){return hn(e)===Xc};mt.isLazy=function(e){return hn(e)===id};mt.isMemo=function(e){return hn(e)===ad};mt.isPortal=function(e){return hn(e)===zf};mt.isProfiler=function(e){return hn(e)===Qc};mt.isStrictMode=function(e){return hn(e)===Jc};mt.isSuspense=function(e){return hn(e)===nd};mt.isSuspenseList=function(e){return hn(e)===sd};mt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Xc||e===Qc||e===Jc||e===nd||e===sd||typeof e=="object"&&e!==null&&(e.$$typeof===id||e.$$typeof===ad||e.$$typeof===td||e.$$typeof===ed||e.$$typeof===rd||e.$$typeof===gA||e.getModuleId!==void 0)};mt.typeOf=hn;_b.exports=mt;var xA=_b.exports,or=e=>e===0?0:e>0?1:-1,Rr=e=>typeof e=="number"&&e!=+e,la=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Pe=e=>(typeof e=="number"||e instanceof Number)&&!Rr(e),Rn=e=>Pe(e)||typeof e=="string",vA=0,go=e=>{var t=++vA;return"".concat(e||"").concat(t)},_r=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Pe(t)&&typeof t!="string")return s;var i;if(la(t)){if(r==null)return s;var l=t.indexOf("%");i=r*parseFloat(t.slice(0,l))/100}else i=+t;return Rr(i)&&(i=s),a&&r!=null&&i>r&&(i=r),i},jb=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},s=0;s<t;s++)if(!r[e[s]])r[e[s]]=!0;else return!0;return!1};function At(e,t,r){return Pe(e)&&Pe(t)?e+r*(t-e):t}function Nb(e,t,r){if(!(!e||!e.length))return e.find(s=>s&&(typeof t=="function"?t(s):va(s,t))===r)}var Ot=e=>e===null||typeof e>"u",Mo=e=>Ot(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),yA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Bf(e){if(typeof e!="string")return!1;var t=yA;return t.includes(e)}var bA=["viewBox","children"],vx=["points","pathLength"],Cu={svg:bA,polygon:vx,polyline:vx},Ff=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(x.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var s={};return Object.keys(r).forEach(a=>{Bf(a)&&(s[a]=i=>r[a](r,i))}),s},wA=(e,t,r)=>s=>(e(t,r,s),null),Io=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var s=null;return Object.keys(e).forEach(a=>{var i=e[a];Bf(a)&&typeof i=="function"&&(s||(s={}),s[a]=wA(i,t,r))}),s},_A=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function kb(e){if(typeof e!="string")return!1;var t=_A;return t.includes(e)}function jn(e){var t=Object.entries(e).filter(r=>{var[s]=r;return kb(s)});return Object.fromEntries(t)}var yx=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",bx=null,Pu=null,Sb=e=>{if(e===bx&&Array.isArray(Pu))return Pu;var t=[];return x.Children.forEach(e,r=>{Ot(r)||(xA.isFragment(r)?t=t.concat(Sb(r.props.children)):t.push(r))}),Pu=t,bx=e,t};function Uf(e,t){var r=[],s=[];return Array.isArray(t)?s=t.map(a=>yx(a)):s=[yx(t)],Sb(e).forEach(a=>{var i=va(a,"type.displayName")||va(a,"type.name");s.indexOf(i)!==-1&&r.push(a)}),r}var Eb=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,jA=(e,t,r,s)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(a=s&&(Cu==null?void 0:Cu[s]))!==null&&a!==void 0?a:[],l=t.startsWith("data-"),c=typeof e!="function"&&(!!s&&i.includes(t)||kb(t)),d=!!r&&Bf(t);return l||c||d},Lt=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var s=e;if(x.isValidElement(e)&&(s=e.props),typeof s!="object"&&typeof s!="function")return null;var a={};return Object.keys(s).forEach(i=>{var l;jA((l=s)===null||l===void 0?void 0:l[i],i,t,r)&&(a[i]=s[i])}),a},NA=["children","width","height","viewBox","className","style","title","desc"];function Eh(){return Eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Eh.apply(null,arguments)}function kA(e,t){if(e==null)return{};var r,s,a=SA(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function SA(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Wf=x.forwardRef((e,t)=>{var{children:r,width:s,height:a,viewBox:i,className:l,style:c,title:d,desc:f}=e,h=kA(e,NA),m=i||{width:s,height:a,x:0,y:0},g=Ve("recharts-surface",l);return x.createElement("svg",Eh({},Lt(h,!0,"svg"),{className:g,width:s,height:a,style:c,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),x.createElement("title",null,d),x.createElement("desc",null,f),r)}),EA=["children","className"];function Ch(){return Ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ch.apply(null,arguments)}function CA(e,t){if(e==null)return{};var r,s,a=PA(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PA(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Vt=x.forwardRef((e,t)=>{var{children:r,className:s}=e,a=CA(e,EA),i=Ve("recharts-layer",s);return x.createElement("g",Ch({className:i},Lt(a,!0),{ref:t}),r)}),Cb=x.createContext(null),AA=()=>x.useContext(Cb);function yt(e){return function(){return e}}const Pb=Math.cos,Yl=Math.sin,Nn=Math.sqrt,Xl=Math.PI,od=2*Xl,Ph=Math.PI,Ah=2*Ph,Qs=1e-6,TA=Ah-Qs;function Ab(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function OA(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Ab;const r=10**t;return function(s){this._+=s[0];for(let a=1,i=s.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+s[a]}}class MA{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Ab:OA(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,s,a){this._append`Q${+t},${+r},${this._x1=+s},${this._y1=+a}`}bezierCurveTo(t,r,s,a,i,l){this._append`C${+t},${+r},${+s},${+a},${this._x1=+i},${this._y1=+l}`}arcTo(t,r,s,a,i){if(t=+t,r=+r,s=+s,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,c=this._y1,d=s-t,f=a-r,h=l-t,m=c-r,g=h*h+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(g>Qs)if(!(Math.abs(m*d-f*h)>Qs)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let v=s-l,j=a-c,_=d*d+f*f,y=v*v+j*j,w=Math.sqrt(_),k=Math.sqrt(g),N=i*Math.tan((Ph-Math.acos((_+g-y)/(2*w*k)))/2),P=N/k,O=N/w;Math.abs(P-1)>Qs&&this._append`L${t+P*h},${r+P*m}`,this._append`A${i},${i},0,0,${+(m*v>h*j)},${this._x1=t+O*d},${this._y1=r+O*f}`}}arc(t,r,s,a,i,l){if(t=+t,r=+r,s=+s,l=!!l,s<0)throw new Error(`negative radius: ${s}`);let c=s*Math.cos(a),d=s*Math.sin(a),f=t+c,h=r+d,m=1^l,g=l?a-i:i-a;this._x1===null?this._append`M${f},${h}`:(Math.abs(this._x1-f)>Qs||Math.abs(this._y1-h)>Qs)&&this._append`L${f},${h}`,s&&(g<0&&(g=g%Ah+Ah),g>TA?this._append`A${s},${s},0,1,${m},${t-c},${r-d}A${s},${s},0,1,${m},${this._x1=f},${this._y1=h}`:g>Qs&&this._append`A${s},${s},0,${+(g>=Ph)},${m},${this._x1=t+s*Math.cos(i)},${this._y1=r+s*Math.sin(i)}`)}rect(t,r,s,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${s=+s}v${+a}h${-s}Z`}toString(){return this._}}function qf(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);t=s}return e},()=>new MA(t)}function Gf(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Tb(e){this._context=e}Tb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ld(e){return new Tb(e)}function Ob(e){return e[0]}function Mb(e){return e[1]}function Ib(e,t){var r=yt(!0),s=null,a=ld,i=null,l=qf(c);e=typeof e=="function"?e:e===void 0?Ob:yt(e),t=typeof t=="function"?t:t===void 0?Mb:yt(t);function c(d){var f,h=(d=Gf(d)).length,m,g=!1,v;for(s==null&&(i=a(v=l())),f=0;f<=h;++f)!(f<h&&r(m=d[f],f,d))===g&&((g=!g)?i.lineStart():i.lineEnd()),g&&i.point(+e(m,f,d),+t(m,f,d));if(v)return i=null,v+""||null}return c.x=function(d){return arguments.length?(e=typeof d=="function"?d:yt(+d),c):e},c.y=function(d){return arguments.length?(t=typeof d=="function"?d:yt(+d),c):t},c.defined=function(d){return arguments.length?(r=typeof d=="function"?d:yt(!!d),c):r},c.curve=function(d){return arguments.length?(a=d,s!=null&&(i=a(s)),c):a},c.context=function(d){return arguments.length?(d==null?s=i=null:i=a(s=d),c):s},c}function Nl(e,t,r){var s=null,a=yt(!0),i=null,l=ld,c=null,d=qf(f);e=typeof e=="function"?e:e===void 0?Ob:yt(+e),t=typeof t=="function"?t:yt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?Mb:yt(+r);function f(m){var g,v,j,_=(m=Gf(m)).length,y,w=!1,k,N=new Array(_),P=new Array(_);for(i==null&&(c=l(k=d())),g=0;g<=_;++g){if(!(g<_&&a(y=m[g],g,m))===w)if(w=!w)v=g,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),j=g-1;j>=v;--j)c.point(N[j],P[j]);c.lineEnd(),c.areaEnd()}w&&(N[g]=+e(y,g,m),P[g]=+t(y,g,m),c.point(s?+s(y,g,m):N[g],r?+r(y,g,m):P[g]))}if(k)return c=null,k+""||null}function h(){return Ib().defined(a).curve(l).context(i)}return f.x=function(m){return arguments.length?(e=typeof m=="function"?m:yt(+m),s=null,f):e},f.x0=function(m){return arguments.length?(e=typeof m=="function"?m:yt(+m),f):e},f.x1=function(m){return arguments.length?(s=m==null?null:typeof m=="function"?m:yt(+m),f):s},f.y=function(m){return arguments.length?(t=typeof m=="function"?m:yt(+m),r=null,f):t},f.y0=function(m){return arguments.length?(t=typeof m=="function"?m:yt(+m),f):t},f.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:yt(+m),f):r},f.lineX0=f.lineY0=function(){return h().x(e).y(t)},f.lineY1=function(){return h().x(e).y(r)},f.lineX1=function(){return h().x(s).y(t)},f.defined=function(m){return arguments.length?(a=typeof m=="function"?m:yt(!!m),f):a},f.curve=function(m){return arguments.length?(l=m,i!=null&&(c=l(i)),f):l},f.context=function(m){return arguments.length?(m==null?i=c=null:c=l(i=m),f):i},f}class Lb{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function IA(e){return new Lb(e,!0)}function LA(e){return new Lb(e,!1)}const Hf={draw(e,t){const r=Nn(t/Xl);e.moveTo(r,0),e.arc(0,0,r,0,od)}},DA={draw(e,t){const r=Nn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},Db=Nn(1/3),RA=Db*2,$A={draw(e,t){const r=Nn(t/RA),s=r*Db;e.moveTo(0,-r),e.lineTo(s,0),e.lineTo(0,r),e.lineTo(-s,0),e.closePath()}},zA={draw(e,t){const r=Nn(t),s=-r/2;e.rect(s,s,r,r)}},BA=.8908130915292852,Rb=Yl(Xl/10)/Yl(7*Xl/10),FA=Yl(od/10)*Rb,UA=-Pb(od/10)*Rb,WA={draw(e,t){const r=Nn(t*BA),s=FA*r,a=UA*r;e.moveTo(0,-r),e.lineTo(s,a);for(let i=1;i<5;++i){const l=od*i/5,c=Pb(l),d=Yl(l);e.lineTo(d*r,-c*r),e.lineTo(c*s-d*a,d*s+c*a)}e.closePath()}},Au=Nn(3),qA={draw(e,t){const r=-Nn(t/(Au*3));e.moveTo(0,r*2),e.lineTo(-Au*r,-r),e.lineTo(Au*r,-r),e.closePath()}},en=-.5,tn=Nn(3)/2,Th=1/Nn(12),GA=(Th/2+1)*3,HA={draw(e,t){const r=Nn(t/GA),s=r/2,a=r*Th,i=s,l=r*Th+r,c=-i,d=l;e.moveTo(s,a),e.lineTo(i,l),e.lineTo(c,d),e.lineTo(en*s-tn*a,tn*s+en*a),e.lineTo(en*i-tn*l,tn*i+en*l),e.lineTo(en*c-tn*d,tn*c+en*d),e.lineTo(en*s+tn*a,en*a-tn*s),e.lineTo(en*i+tn*l,en*l-tn*i),e.lineTo(en*c+tn*d,en*d-tn*c),e.closePath()}};function VA(e,t){let r=null,s=qf(a);e=typeof e=="function"?e:yt(e||Hf),t=typeof t=="function"?t:yt(t===void 0?64:+t);function a(){let i;if(r||(r=i=s()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:yt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:yt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Jl(){}function Ql(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function $b(e){this._context=e}$b.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ql(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ql(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function KA(e){return new $b(e)}function zb(e){this._context=e}zb.prototype={areaStart:Jl,areaEnd:Jl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ql(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZA(e){return new zb(e)}function Bb(e){this._context=e}Bb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:Ql(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function YA(e){return new Bb(e)}function Fb(e){this._context=e}Fb.prototype={areaStart:Jl,areaEnd:Jl,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function XA(e){return new Fb(e)}function wx(e){return e<0?-1:1}function _x(e,t,r){var s=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(s||a<0&&-0),l=(r-e._y1)/(a||s<0&&-0),c=(i*a+l*s)/(s+a);return(wx(i)+wx(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(c))||0}function jx(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Tu(e,t,r){var s=e._x0,a=e._y0,i=e._x1,l=e._y1,c=(i-s)/3;e._context.bezierCurveTo(s+c,a+c*t,i-c,l-c*r,i,l)}function ec(e){this._context=e}ec.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tu(this,this._t0,jx(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Tu(this,jx(this,r=_x(this,e,t)),r);break;default:Tu(this,this._t0,r=_x(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Ub(e){this._context=new Wb(e)}(Ub.prototype=Object.create(ec.prototype)).point=function(e,t){ec.prototype.point.call(this,t,e)};function Wb(e){this._context=e}Wb.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,s,a,i){this._context.bezierCurveTo(t,e,s,r,i,a)}};function JA(e){return new ec(e)}function QA(e){return new Ub(e)}function qb(e){this._context=e}qb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var s=Nx(e),a=Nx(t),i=0,l=1;l<r;++i,++l)this._context.bezierCurveTo(s[0][i],a[0][i],s[1][i],a[1][i],e[l],t[l]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Nx(e){var t,r=e.length-1,s,a=new Array(r),i=new Array(r),l=new Array(r);for(a[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,l[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)s=a[t]/i[t-1],i[t]-=s,l[t]-=s*l[t-1];for(a[r-1]=l[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(l[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function eT(e){return new qb(e)}function cd(e,t){this._context=e,this._t=t}cd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function tT(e){return new cd(e,.5)}function rT(e){return new cd(e,0)}function nT(e){return new cd(e,1)}function ci(e,t){if((l=e.length)>1)for(var r=1,s,a,i=e[t[0]],l,c=i.length;r<l;++r)for(a=i,i=e[t[r]],s=0;s<c;++s)i[s][1]+=i[s][0]=isNaN(a[s][1])?a[s][0]:a[s][1]}function Oh(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function sT(e,t){return e[t]}function aT(e){const t=[];return t.key=e,t}function iT(){var e=yt([]),t=Oh,r=ci,s=sT;function a(i){var l=Array.from(e.apply(this,arguments),aT),c,d=l.length,f=-1,h;for(const m of i)for(c=0,++f;c<d;++c)(l[c][f]=[0,+s(m,l[c].key,f,i)]).data=m;for(c=0,h=Gf(t(l));c<d;++c)l[h[c]].index=c;return r(l,h),l}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:yt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(s=typeof i=="function"?i:yt(+i),a):s},a.order=function(i){return arguments.length?(t=i==null?Oh:typeof i=="function"?i:yt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??ci,a):r},a}function oT(e,t){if((s=e.length)>0){for(var r,s,a=0,i=e[0].length,l;a<i;++a){for(l=r=0;r<s;++r)l+=e[r][a][1]||0;if(l)for(r=0;r<s;++r)e[r][a][1]/=l}ci(e,t)}}function lT(e,t){if((a=e.length)>0){for(var r=0,s=e[t[0]],a,i=s.length;r<i;++r){for(var l=0,c=0;l<a;++l)c+=e[l][r][1]||0;s[r][1]+=s[r][0]=-c/2}ci(e,t)}}function cT(e,t){if(!(!((l=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,s=1,a,i,l;s<i;++s){for(var c=0,d=0,f=0;c<l;++c){for(var h=e[t[c]],m=h[s][1]||0,g=h[s-1][1]||0,v=(m-g)/2,j=0;j<c;++j){var _=e[t[j]],y=_[s][1]||0,w=_[s-1][1]||0;v+=y-w}d+=m,f+=v*m}a[s-1][1]+=a[s-1][0]=r,d&&(r-=f/d)}a[s-1][1]+=a[s-1][0]=r,ci(e,t)}}var dT=["type","size","sizeType"];function Mh(){return Mh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Mh.apply(null,arguments)}function kx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Sx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kx(Object(r),!0).forEach(function(s){uT(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kx(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function uT(e,t,r){return(t=hT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hT(e){var t=fT(e,"string");return typeof t=="symbol"?t:t+""}function fT(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mT(e,t){if(e==null)return{};var r,s,a=pT(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pT(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Gb={symbolCircle:Hf,symbolCross:DA,symbolDiamond:$A,symbolSquare:zA,symbolStar:WA,symbolTriangle:qA,symbolWye:HA},gT=Math.PI/180,xT=e=>{var t="symbol".concat(Mo(e));return Gb[t]||Hf},vT=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*gT;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},yT=(e,t)=>{Gb["symbol".concat(Mo(e))]=t},Vf=e=>{var{type:t="circle",size:r=64,sizeType:s="area"}=e,a=mT(e,dT),i=Sx(Sx({},a),{},{type:t,size:r,sizeType:s}),l="circle";typeof t=="string"&&(l=t);var c=()=>{var g=xT(l),v=VA().type(g).size(vT(r,s,l));return v()},{className:d,cx:f,cy:h}=i,m=Lt(i,!0);return f===+f&&h===+h&&r===+r?x.createElement("path",Mh({},m,{className:Ve("recharts-symbols",d),transform:"translate(".concat(f,", ").concat(h,")"),d:c()})):null};Vf.registerSymbol=yT;function Ih(){return Ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ih.apply(null,arguments)}function Ex(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function bT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ex(Object(r),!0).forEach(function(s){Kf(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ex(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Kf(e,t,r){return(t=wT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wT(e){var t=_T(e,"string");return typeof t=="symbol"?t:t+""}function _T(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rn=32;class Zf extends x.PureComponent{renderIcon(t,r){var{inactiveColor:s}=this.props,a=rn/2,i=rn/6,l=rn/3,c=t.inactive?s:t.color,d=r??t.type;if(d==="none")return null;if(d==="plainline")return x.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:rn,y2:a,className:"recharts-legend-icon"});if(d==="line")return x.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(a,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(a,`
            H`).concat(rn,"M").concat(2*l,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(a),className:"recharts-legend-icon"});if(d==="rect")return x.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(rn/8,"h").concat(rn,"v").concat(rn*3/4,"h").concat(-rn,"z"),className:"recharts-legend-icon"});if(x.isValidElement(t.legendIcon)){var f=bT({},t);return delete f.legendIcon,x.cloneElement(t.legendIcon,f)}return x.createElement(Vf,{fill:c,cx:a,cy:a,size:rn,sizeType:"diameter",type:d})}renderItems(){var{payload:t,iconSize:r,layout:s,formatter:a,inactiveColor:i,iconType:l}=this.props,c={x:0,y:0,width:rn,height:rn},d={display:s==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((h,m)=>{var g=h.formatter||a,v=Ve({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:h.inactive});if(h.type==="none")return null;var j=h.inactive?i:h.color,_=g?g(h.value,h,m):h.value;return x.createElement("li",Ih({className:v,style:d,key:"legend-item-".concat(m)},Io(this.props,h,m)),x.createElement(Wf,{width:r,height:r,viewBox:c,style:f,"aria-label":"".concat(_," legend icon")},this.renderIcon(h,l)),x.createElement("span",{className:"recharts-legend-item-text",style:{color:j}},_))})}render(){var{payload:t,layout:r,align:s}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?s:"left"};return x.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}Kf(Zf,"displayName","Legend");Kf(Zf,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Hb={},Vb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s){const a=new Map;for(let i=0;i<r.length;i++){const l=r[i],c=s(l);a.has(c)||a.set(c,l)}return Array.from(a.values())}e.uniqBy=t})(Vb);var Yf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Yf);var Kb={},dd={},Zb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Zb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zb;function r(s){return s!=null&&typeof s!="function"&&t.isLength(s.length)}e.isArrayLike=r})(dd);var Yb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Yb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dd,r=Yb;function s(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=s})(Kb);var Xb={},Jb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Kc;function r(s){return function(a){return t.get(a,s)}}e.property=r})(Jb);var Qb={},Ou={},Mu={},Xf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Xf);var Jf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Jf);var Qf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s){return r===s||Number.isNaN(r)&&Number.isNaN(s)}e.eq=t})(Qf);var Cx;function jT(){return Cx||(Cx=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=em(),r=Xf,s=Jf,a=Qf;function i(m,g,v){return typeof v!="function"?t.isMatch(m,g):l(m,g,function j(_,y,w,k,N,P){const O=v(_,y,w,k,N,P);return O!==void 0?!!O:l(_,y,j,P)},new Map)}function l(m,g,v,j){if(g===m)return!0;switch(typeof g){case"object":return c(m,g,v,j);case"function":return Object.keys(g).length>0?l(m,{...g},v,j):a.eq(m,g);default:return r.isObject(m)?typeof g=="string"?g==="":!0:a.eq(m,g)}}function c(m,g,v,j){if(g==null)return!0;if(Array.isArray(g))return f(m,g,v,j);if(g instanceof Map)return d(m,g,v,j);if(g instanceof Set)return h(m,g,v,j);const _=Object.keys(g);if(m==null)return _.length===0;if(_.length===0)return!0;if(j&&j.has(g))return j.get(g)===m;j&&j.set(g,m);try{for(let y=0;y<_.length;y++){const w=_[y];if(!s.isPrimitive(m)&&!(w in m)||g[w]===void 0&&m[w]!==void 0||g[w]===null&&m[w]!==null||!v(m[w],g[w],w,m,g,j))return!1}return!0}finally{j&&j.delete(g)}}function d(m,g,v,j){if(g.size===0)return!0;if(!(m instanceof Map))return!1;for(const[_,y]of g.entries()){const w=m.get(_);if(v(w,y,_,m,g,j)===!1)return!1}return!0}function f(m,g,v,j){if(g.length===0)return!0;if(!Array.isArray(m))return!1;const _=new Set;for(let y=0;y<g.length;y++){const w=g[y];let k=!1;for(let N=0;N<m.length;N++){if(_.has(N))continue;const P=m[N];let O=!1;if(v(P,w,y,m,g,j)&&(O=!0),O){_.add(N),k=!0;break}}if(!k)return!1}return!0}function h(m,g,v,j){return g.size===0?!0:m instanceof Set?f([...m],[...g],v,j):!1}e.isMatchWith=i,e.isSetMatch=h}(Mu)),Mu}var Px;function em(){return Px||(Px=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jT();function r(s,a){return t.isMatchWith(s,a,()=>{})}e.isMatch=r}(Ou)),Ou}var ew={},tm={},tw={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(s=>Object.prototype.propertyIsEnumerable.call(r,s))}e.getSymbols=t})(tw);var rm={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(rm);var nm={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",s="[object Number]",a="[object Boolean]",i="[object Arguments]",l="[object Symbol]",c="[object Date]",d="[object Map]",f="[object Set]",h="[object Array]",m="[object Function]",g="[object ArrayBuffer]",v="[object Object]",j="[object Error]",_="[object DataView]",y="[object Uint8Array]",w="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]",P="[object BigUint64Array]",O="[object Int8Array]",T="[object Int16Array]",A="[object Int32Array]",C="[object BigInt64Array]",E="[object Float32Array]",D="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=g,e.arrayTag=h,e.bigInt64ArrayTag=C,e.bigUint64ArrayTag=P,e.booleanTag=a,e.dataViewTag=_,e.dateTag=c,e.errorTag=j,e.float32ArrayTag=E,e.float64ArrayTag=D,e.functionTag=m,e.int16ArrayTag=T,e.int32ArrayTag=A,e.int8ArrayTag=O,e.mapTag=d,e.numberTag=s,e.objectTag=v,e.regexpTag=t,e.setTag=f,e.stringTag=r,e.symbolTag=l,e.uint16ArrayTag=k,e.uint32ArrayTag=N,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=w})(nm);var rw={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(rw);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tw,r=rm,s=nm,a=Jf,i=rw;function l(h,m){return c(h,void 0,h,new Map,m)}function c(h,m,g,v=new Map,j=void 0){const _=j==null?void 0:j(h,m,g,v);if(_!==void 0)return _;if(a.isPrimitive(h))return h;if(v.has(h))return v.get(h);if(Array.isArray(h)){const y=new Array(h.length);v.set(h,y);for(let w=0;w<h.length;w++)y[w]=c(h[w],w,g,v,j);return Object.hasOwn(h,"index")&&(y.index=h.index),Object.hasOwn(h,"input")&&(y.input=h.input),y}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const y=new RegExp(h.source,h.flags);return y.lastIndex=h.lastIndex,y}if(h instanceof Map){const y=new Map;v.set(h,y);for(const[w,k]of h)y.set(w,c(k,w,g,v,j));return y}if(h instanceof Set){const y=new Set;v.set(h,y);for(const w of h)y.add(c(w,void 0,g,v,j));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(i.isTypedArray(h)){const y=new(Object.getPrototypeOf(h)).constructor(h.length);v.set(h,y);for(let w=0;w<h.length;w++)y[w]=c(h[w],w,g,v,j);return y}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const y=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return v.set(h,y),d(y,h,g,v,j),y}if(typeof File<"u"&&h instanceof File){const y=new File([h],h.name,{type:h.type});return v.set(h,y),d(y,h,g,v,j),y}if(typeof Blob<"u"&&h instanceof Blob){const y=new Blob([h],{type:h.type});return v.set(h,y),d(y,h,g,v,j),y}if(h instanceof Error){const y=new h.constructor;return v.set(h,y),y.message=h.message,y.name=h.name,y.stack=h.stack,y.cause=h.cause,d(y,h,g,v,j),y}if(h instanceof Boolean){const y=new Boolean(h.valueOf());return v.set(h,y),d(y,h,g,v,j),y}if(h instanceof Number){const y=new Number(h.valueOf());return v.set(h,y),d(y,h,g,v,j),y}if(h instanceof String){const y=new String(h.valueOf());return v.set(h,y),d(y,h,g,v,j),y}if(typeof h=="object"&&f(h)){const y=Object.create(Object.getPrototypeOf(h));return v.set(h,y),d(y,h,g,v,j),y}return h}function d(h,m,g=h,v,j){const _=[...Object.keys(m),...t.getSymbols(m)];for(let y=0;y<_.length;y++){const w=_[y],k=Object.getOwnPropertyDescriptor(h,w);(k==null||k.writable)&&(h[w]=c(m[w],w,g,v,j))}}function f(h){switch(r.getTag(h)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=l,e.cloneDeepWithImpl=c,e.copyProperties=d})(tm);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tm;function r(s){return t.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}e.cloneDeep=r})(ew);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=em(),r=ew;function s(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=s})(Qb);var nw={},sw={},aw={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tm,r=nm;function s(a,i){return t.cloneDeepWith(a,(l,c,d,f)=>{const h=i==null?void 0:i(l,c,d,f);if(h!==void 0)return h;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(m,a),m}case r.argumentsTag:{const m={};return t.copyProperties(m,a),m.length=a.length,m[Symbol.iterator]=a[Symbol.iterator],m}default:return}})}e.cloneDeepWith=s})(aw);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aw;function r(s){return t.cloneDeepWith(s)}e.cloneDeep=r})(sw);var iw={},sm={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(s,a=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<a;case"symbol":return!1;case"string":return t.test(s)}}e.isIndex=r})(sm);var ow={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rm;function r(s){return s!==null&&typeof s=="object"&&t.getTag(s)==="[object Arguments]"}e.isArguments=r})(ow);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rf,r=sm,s=ow,a=Yc;function i(l,c){let d;if(Array.isArray(c)?d=c:typeof c=="string"&&t.isDeepKey(c)&&(l==null?void 0:l[c])==null?d=a.toPath(c):d=[c],d.length===0)return!1;let f=l;for(let h=0;h<d.length;h++){const m=d[h];if((f==null||!Object.hasOwn(f,m))&&!((Array.isArray(f)||s.isArguments(f))&&r.isIndex(m)&&m<f.length))return!1;f=f[m]}return!0}e.has=i})(iw);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=em(),r=Zc,s=sw,a=Kc,i=iw;function l(c,d){switch(typeof c){case"object":{Object.is(c==null?void 0:c.valueOf(),-0)&&(c="-0");break}case"number":{c=r.toKey(c);break}}return d=s.cloneDeep(d),function(f){const h=a.get(f,c);return h===void 0?i.has(f,c):d===void 0?h===void 0:t.isMatch(h,d)}}e.matchesProperty=l})(nw);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Yf,r=Jb,s=Qb,a=nw;function i(l){if(l==null)return t.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?a.matchesProperty(l[0],l[1]):s.matches(l);case"string":case"symbol":case"number":return r.property(l)}}e.iteratee=i})(Xb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vb,r=Yf,s=Kb,a=Xb;function i(l,c=r.identity){return s.isArrayLikeObject(l)?t.uniqBy(Array.from(l),a.iteratee(c)):[]}e.uniqBy=i})(Hb);var NT=Hb.uniqBy;const Ax=zn(NT);function lw(e,t,r){return t===!0?Ax(e,r):typeof t=="function"?Ax(e,t):e}var cw={exports:{}},dw={},uw={exports:{}},hw={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var di=x;function kT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ST=typeof Object.is=="function"?Object.is:kT,ET=di.useState,CT=di.useEffect,PT=di.useLayoutEffect,AT=di.useDebugValue;function TT(e,t){var r=t(),s=ET({inst:{value:r,getSnapshot:t}}),a=s[0].inst,i=s[1];return PT(function(){a.value=r,a.getSnapshot=t,Iu(a)&&i({inst:a})},[e,r,t]),CT(function(){return Iu(a)&&i({inst:a}),e(function(){Iu(a)&&i({inst:a})})},[e]),AT(r),r}function Iu(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ST(e,r)}catch{return!0}}function OT(e,t){return t()}var MT=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?OT:TT;hw.useSyncExternalStore=di.useSyncExternalStore!==void 0?di.useSyncExternalStore:MT;uw.exports=hw;var IT=uw.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ud=x,LT=IT;function DT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var RT=typeof Object.is=="function"?Object.is:DT,$T=LT.useSyncExternalStore,zT=ud.useRef,BT=ud.useEffect,FT=ud.useMemo,UT=ud.useDebugValue;dw.useSyncExternalStoreWithSelector=function(e,t,r,s,a){var i=zT(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=FT(function(){function d(v){if(!f){if(f=!0,h=v,v=s(v),a!==void 0&&l.hasValue){var j=l.value;if(a(j,v))return m=j}return m=v}if(j=m,RT(h,v))return j;var _=s(v);return a!==void 0&&a(j,_)?(h=v,j):(h=v,m=_)}var f=!1,h,m,g=r===void 0?null:r;return[function(){return d(t())},g===null?void 0:function(){return d(g())}]},[t,r,s,a]);var c=$T(e,i[0],i[1]);return BT(function(){l.hasValue=!0,l.value=c},[c]),UT(c),c};cw.exports=dw;var WT=cw.exports,am=x.createContext(null),qT=e=>e,Mt=()=>{var e=x.useContext(am);return e?e.store.dispatch:qT},Ul=()=>{},GT=()=>Ul,HT=(e,t)=>e===t;function Ae(e){var t=x.useContext(am);return WT.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:GT,t?t.store.getState:Ul,t?t.store.getState:Ul,t?e:Ul,HT)}function VT(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function KT(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function ZT(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${t}[${r}]`)}}var Tx=e=>Array.isArray(e)?e:[e];function YT(e){const t=Array.isArray(e[0])?e[0]:e;return ZT(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function XT(e,t){const r=[],{length:s}=e;for(let a=0;a<s;a++)r.push(e[a].apply(null,t));return r}var JT=class{constructor(e){this.value=e}deref(){return this.value}},QT=typeof WeakRef<"u"?WeakRef:JT,eO=0,Ox=1;function kl(){return{s:eO,v:void 0,o:null,p:null}}function fw(e,t={}){let r=kl();const{resultEqualityCheck:s}=t;let a,i=0;function l(){var m;let c=r;const{length:d}=arguments;for(let g=0,v=d;g<v;g++){const j=arguments[g];if(typeof j=="function"||typeof j=="object"&&j!==null){let _=c.o;_===null&&(c.o=_=new WeakMap);const y=_.get(j);y===void 0?(c=kl(),_.set(j,c)):c=y}else{let _=c.p;_===null&&(c.p=_=new Map);const y=_.get(j);y===void 0?(c=kl(),_.set(j,c)):c=y}}const f=c;let h;if(c.s===Ox)h=c.v;else if(h=e.apply(null,arguments),i++,s){const g=((m=a==null?void 0:a.deref)==null?void 0:m.call(a))??a;g!=null&&s(g,h)&&(h=g,i!==0&&i--),a=typeof h=="object"&&h!==null||typeof h=="function"?new QT(h):h}return f.s=Ox,f.v=h,h}return l.clearCache=()=>{r=kl(),l.resetResultsCount()},l.resultsCount=()=>i,l.resetResultsCount=()=>{i=0},l}function tO(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,s=(...a)=>{let i=0,l=0,c,d={},f=a.pop();typeof f=="object"&&(d=f,f=a.pop()),VT(f,`createSelector expects an output function after the inputs, but received: [${typeof f}]`);const h={...r,...d},{memoize:m,memoizeOptions:g=[],argsMemoize:v=fw,argsMemoizeOptions:j=[]}=h,_=Tx(g),y=Tx(j),w=YT(a),k=m(function(){return i++,f.apply(null,arguments)},..._),N=v(function(){l++;const O=XT(w,arguments);return c=k.apply(null,O),c},...y);return Object.assign(N,{resultFunc:f,memoizedResultFunc:k,dependencies:w,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>c,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:v})};return Object.assign(s,{withTypes:()=>s}),s}var ee=tO(fw),rO=Object.assign((e,t=ee)=>{KT(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),s=r.map(i=>e[i]);return t(s,(...i)=>i.reduce((l,c,d)=>(l[r[d]]=c,l),{}))},{withTypes:()=>rO}),mw={},pw={},gw={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const r=(s,a,i)=>{if(s!==a){const l=t(s),c=t(a);if(l===c&&l===0){if(s<a)return i==="desc"?1:-1;if(s>a)return i==="desc"?-1:1}return i==="desc"?c-l:l-c}return 0};e.compareValues=r})(gw);var xw={},im={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(im);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=im,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function a(i,l){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(s.test(i)||!r.test(i))||l!=null&&Object.hasOwn(l,i)}e.isKey=a})(xw);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gw,r=xw,s=Yc;function a(i,l,c,d){if(i==null)return[];c=d?void 0:c,Array.isArray(i)||(i=Object.values(i)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(v=>String(v));const f=(v,j)=>{let _=v;for(let y=0;y<j.length&&_!=null;++y)_=_[j[y]];return _},h=(v,j)=>j==null||v==null?j:typeof v=="object"&&"key"in v?Object.hasOwn(j,v.key)?j[v.key]:f(j,v.path):typeof v=="function"?v(j):Array.isArray(v)?f(j,v):typeof j=="object"?j[v]:j,m=l.map(v=>(Array.isArray(v)&&v.length===1&&(v=v[0]),v==null||typeof v=="function"||Array.isArray(v)||r.isKey(v)?v:{key:v,path:s.toPath(v)}));return i.map(v=>({original:v,criteria:m.map(j=>h(j,v))})).slice().sort((v,j)=>{for(let _=0;_<m.length;_++){const y=t.compareValues(v.criteria[_],j.criteria[_],c[_]);if(y!==0)return y}return 0}).map(v=>v.original)}e.orderBy=a})(pw);var vw={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s=1){const a=[],i=Math.floor(s),l=(c,d)=>{for(let f=0;f<c.length;f++){const h=c[f];Array.isArray(h)&&d<i?l(h,d+1):a.push(h)}};return l(r,0),a}e.flatten=t})(vw);var om={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sm,r=dd,s=Xf,a=Qf;function i(l,c,d){return s.isObject(d)&&(typeof c=="number"&&r.isArrayLike(d)&&t.isIndex(c)&&c<d.length||typeof c=="string"&&c in d)?a.eq(d[c],l):!1}e.isIterateeCall=i})(om);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pw,r=vw,s=om;function a(i,...l){const c=l.length;return c>1&&s.isIterateeCall(i,l[0],l[1])?l=[]:c>2&&s.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),t.orderBy(i,r.flatten(l),["asc"])}e.sortBy=a})(mw);var nO=mw.sortBy;const hd=zn(nO);var yw=e=>e.legend.settings,sO=e=>e.legend.size,aO=e=>e.legend.payload,iO=ee([aO,yw],(e,t)=>{var{itemSorter:r}=t,s=e.flat(1);return r?hd(s,r):s});function oO(){return Ae(iO)}var Sl=1;function bw(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=x.useState({height:0,left:0,top:0,width:0}),s=x.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),l={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(l.height-t.height)>Sl||Math.abs(l.left-t.left)>Sl||Math.abs(l.top-t.top)>Sl||Math.abs(l.width-t.width)>Sl)&&r({height:l.height,left:l.left,top:l.top,width:l.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,s]}function fr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var lO=typeof Symbol=="function"&&Symbol.observable||"@@observable",Mx=lO,Lu=()=>Math.random().toString(36).substring(7).split("").join("."),cO={INIT:`@@redux/INIT${Lu()}`,REPLACE:`@@redux/REPLACE${Lu()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Lu()}`},tc=cO;function lm(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function ww(e,t,r){if(typeof e!="function")throw new Error(fr(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(fr(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(fr(1));return r(ww)(e,t)}let s=e,a=t,i=new Map,l=i,c=0,d=!1;function f(){l===i&&(l=new Map,i.forEach((y,w)=>{l.set(w,y)}))}function h(){if(d)throw new Error(fr(3));return a}function m(y){if(typeof y!="function")throw new Error(fr(4));if(d)throw new Error(fr(5));let w=!0;f();const k=c++;return l.set(k,y),function(){if(w){if(d)throw new Error(fr(6));w=!1,f(),l.delete(k),i=null}}}function g(y){if(!lm(y))throw new Error(fr(7));if(typeof y.type>"u")throw new Error(fr(8));if(typeof y.type!="string")throw new Error(fr(17));if(d)throw new Error(fr(9));try{d=!0,a=s(a,y)}finally{d=!1}return(i=l).forEach(k=>{k()}),y}function v(y){if(typeof y!="function")throw new Error(fr(10));s=y,g({type:tc.REPLACE})}function j(){const y=m;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(fr(11));function k(){const P=w;P.next&&P.next(h())}return k(),{unsubscribe:y(k)}},[Mx](){return this}}}return g({type:tc.INIT}),{dispatch:g,subscribe:m,getState:h,replaceReducer:v,[Mx]:j}}function dO(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:tc.INIT})>"u")throw new Error(fr(12));if(typeof r(void 0,{type:tc.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(fr(13))})}function _w(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const l=t[i];typeof e[l]=="function"&&(r[l]=e[l])}const s=Object.keys(r);let a;try{dO(r)}catch(i){a=i}return function(l={},c){if(a)throw a;let d=!1;const f={};for(let h=0;h<s.length;h++){const m=s[h],g=r[m],v=l[m],j=g(v,c);if(typeof j>"u")throw c&&c.type,new Error(fr(14));f[m]=j,d=d||j!==v}return d=d||s.length!==Object.keys(l).length,d?f:l}}function rc(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...s)=>t(r(...s)))}function uO(...e){return t=>(r,s)=>{const a=t(r,s);let i=()=>{throw new Error(fr(15))};const l={getState:a.getState,dispatch:(d,...f)=>i(d,...f)},c=e.map(d=>d(l));return i=rc(...c)(a.dispatch),{...a,dispatch:i}}}function jw(e){return lm(e)&&"type"in e&&typeof e.type=="string"}var Nw=Symbol.for("immer-nothing"),Ix=Symbol.for("immer-draftable"),Kr=Symbol.for("immer-state");function yn(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ui=Object.getPrototypeOf;function ya(e){return!!e&&!!e[Kr]}function os(e){var t;return e?kw(e)||Array.isArray(e)||!!e[Ix]||!!((t=e.constructor)!=null&&t[Ix])||Lo(e)||md(e):!1}var hO=Object.prototype.constructor.toString();function kw(e){if(!e||typeof e!="object")return!1;const t=ui(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===hO}function nc(e,t){fd(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,s)=>t(s,r,e))}function fd(e){const t=e[Kr];return t?t.type_:Array.isArray(e)?1:Lo(e)?2:md(e)?3:0}function Lh(e,t){return fd(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Sw(e,t,r){const s=fd(e);s===2?e.set(t,r):s===3?e.add(r):e[t]=r}function fO(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Lo(e){return e instanceof Map}function md(e){return e instanceof Set}function ea(e){return e.copy_||e.base_}function Dh(e,t){if(Lo(e))return new Map(e);if(md(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=kw(e);if(t===!0||t==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(e);delete s[Kr];let a=Reflect.ownKeys(s);for(let i=0;i<a.length;i++){const l=a[i],c=s[l];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(s[l]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[l]})}return Object.create(ui(e),s)}else{const s=ui(e);if(s!==null&&r)return{...e};const a=Object.create(s);return Object.assign(a,e)}}function cm(e,t=!1){return pd(e)||ya(e)||!os(e)||(fd(e)>1&&Object.defineProperties(e,{set:{value:El},add:{value:El},clear:{value:El},delete:{value:El}}),Object.freeze(e),t&&Object.values(e).forEach(r=>cm(r,!0))),e}function El(){yn(2)}function pd(e){return Object.isFrozen(e)}var mO={};function ba(e){const t=mO[e];return t||yn(0,e),t}var xo;function Ew(){return xo}function pO(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Lx(e,t){t&&(ba("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Rh(e){$h(e),e.drafts_.forEach(gO),e.drafts_=null}function $h(e){e===xo&&(xo=e.parent_)}function Dx(e){return xo=pO(xo,e)}function gO(e){const t=e[Kr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Rx(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Kr].modified_&&(Rh(t),yn(4)),os(e)&&(e=sc(t,e),t.parent_||ac(t,e)),t.patches_&&ba("Patches").generateReplacementPatches_(r[Kr].base_,e,t.patches_,t.inversePatches_)):e=sc(t,r,[]),Rh(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Nw?e:void 0}function sc(e,t,r){if(pd(t))return t;const s=t[Kr];if(!s)return nc(t,(a,i)=>$x(e,s,t,a,i,r)),t;if(s.scope_!==e)return t;if(!s.modified_)return ac(e,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const a=s.copy_;let i=a,l=!1;s.type_===3&&(i=new Set(a),a.clear(),l=!0),nc(i,(c,d)=>$x(e,s,a,c,d,r,l)),ac(e,a,!1),r&&e.patches_&&ba("Patches").generatePatches_(s,r,e.patches_,e.inversePatches_)}return s.copy_}function $x(e,t,r,s,a,i,l){if(ya(a)){const c=i&&t&&t.type_!==3&&!Lh(t.assigned_,s)?i.concat(s):void 0,d=sc(e,a,c);if(Sw(r,s,d),ya(d))e.canAutoFreeze_=!1;else return}else l&&r.add(a);if(os(a)&&!pd(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;sc(e,a),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&(Lo(r)?r.has(s):Object.prototype.propertyIsEnumerable.call(r,s))&&ac(e,a)}}function ac(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&cm(t,r)}function xO(e,t){const r=Array.isArray(e),s={type_:r?1:0,scope_:t?t.scope_:Ew(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=s,i=dm;r&&(a=[s],i=vo);const{revoke:l,proxy:c}=Proxy.revocable(a,i);return s.draft_=c,s.revoke_=l,c}var dm={get(e,t){if(t===Kr)return e;const r=ea(e);if(!Lh(r,t))return vO(e,r,t);const s=r[t];return e.finalized_||!os(s)?s:s===Du(e.base_,t)?(Ru(e),e.copy_[t]=Bh(s,e)):s},has(e,t){return t in ea(e)},ownKeys(e){return Reflect.ownKeys(ea(e))},set(e,t,r){const s=Cw(ea(e),t);if(s!=null&&s.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const a=Du(ea(e),t),i=a==null?void 0:a[Kr];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(fO(r,a)&&(r!==void 0||Lh(e.base_,t)))return!0;Ru(e),zh(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Du(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Ru(e),zh(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=ea(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:r[t]}},defineProperty(){yn(11)},getPrototypeOf(e){return ui(e.base_)},setPrototypeOf(){yn(12)}},vo={};nc(dm,(e,t)=>{vo[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});vo.deleteProperty=function(e,t){return vo.set.call(this,e,t,void 0)};vo.set=function(e,t,r){return dm.set.call(this,e[0],t,r,e[0])};function Du(e,t){const r=e[Kr];return(r?ea(r):e)[t]}function vO(e,t,r){var a;const s=Cw(t,r);return s?"value"in s?s.value:(a=s.get)==null?void 0:a.call(e.draft_):void 0}function Cw(e,t){if(!(t in e))return;let r=ui(e);for(;r;){const s=Object.getOwnPropertyDescriptor(r,t);if(s)return s;r=ui(r)}}function zh(e){e.modified_||(e.modified_=!0,e.parent_&&zh(e.parent_))}function Ru(e){e.copy_||(e.copy_=Dh(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var yO=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,s)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const l=this;return function(d=i,...f){return l.produce(d,h=>r.call(this,h,...f))}}typeof r!="function"&&yn(6),s!==void 0&&typeof s!="function"&&yn(7);let a;if(os(t)){const i=Dx(this),l=Bh(t,void 0);let c=!0;try{a=r(l),c=!1}finally{c?Rh(i):$h(i)}return Lx(i,s),Rx(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===Nw&&(a=void 0),this.autoFreeze_&&cm(a,!0),s){const i=[],l=[];ba("Patches").generateReplacementPatches_(t,a,i,l),s(i,l)}return a}else yn(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(l,...c)=>this.produceWithPatches(l,d=>t(d,...c));let s,a;return[this.produce(t,r,(l,c)=>{s=l,a=c}),s,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){os(e)||yn(8),ya(e)&&(e=ts(e));const t=Dx(this),r=Bh(e,void 0);return r[Kr].isManual_=!0,$h(t),r}finishDraft(e,t){const r=e&&e[Kr];(!r||!r.isManual_)&&yn(9);const{scope_:s}=r;return Lx(s,t),Rx(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const s=ba("Patches").applyPatches_;return ya(e)?s(e,t):this.produce(e,a=>s(a,t))}};function Bh(e,t){const r=Lo(e)?ba("MapSet").proxyMap_(e,t):md(e)?ba("MapSet").proxySet_(e,t):xO(e,t);return(t?t.scope_:Ew()).drafts_.push(r),r}function ts(e){return ya(e)||yn(10,e),Pw(e)}function Pw(e){if(!os(e)||pd(e))return e;const t=e[Kr];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Dh(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Dh(e,!0);return nc(r,(s,a)=>{Sw(r,s,Pw(a))}),t&&(t.finalized_=!1),r}var bO=new yO,Aw=bO.produce;function Tw(e){return({dispatch:r,getState:s})=>a=>i=>typeof i=="function"?i(r,s,e):a(i)}var wO=Tw(),_O=Tw,jO=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?rc:rc.apply(null,arguments)};function dn(e,t){function r(...s){if(t){let a=t(...s);if(!a)throw new Error(Hr(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:s[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=s=>jw(s)&&s.type===e,r}var Ow=class no extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,no.prototype)}static get[Symbol.species](){return no}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new no(...t[0].concat(this)):new no(...t.concat(this))}};function zx(e){return os(e)?Aw(e,()=>{}):e}function Cl(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function NO(e){return typeof e=="boolean"}var kO=()=>function(t){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let l=new Ow;return r&&(NO(r)?l.push(wO):l.push(_O(r.extraArgument))),l},SO="RTK_autoBatch",Bx=e=>t=>{setTimeout(t,e)},EO=(e={type:"raf"})=>t=>(...r)=>{const s=t(...r);let a=!0,i=!1,l=!1;const c=new Set,d=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Bx(10):e.type==="callback"?e.queueNotification:Bx(e.timeout),f=()=>{l=!1,i&&(i=!1,c.forEach(h=>h()))};return Object.assign({},s,{subscribe(h){const m=()=>a&&h(),g=s.subscribe(m);return c.add(h),()=>{g(),c.delete(h)}},dispatch(h){var m;try{return a=!((m=h==null?void 0:h.meta)!=null&&m[SO]),i=!a,i&&(l||(l=!0,d(f))),s.dispatch(h)}finally{a=!0}}})},CO=e=>function(r){const{autoBatch:s=!0}=r??{};let a=new Ow(e);return s&&a.push(EO(typeof s=="object"?s:void 0)),a};function PO(e){const t=kO(),{reducer:r=void 0,middleware:s,devTools:a=!0,preloadedState:i=void 0,enhancers:l=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(lm(r))c=_w(r);else throw new Error(Hr(1));let d;typeof s=="function"?d=s(t):d=t();let f=rc;a&&(f=jO({trace:!1,...typeof a=="object"&&a}));const h=uO(...d),m=CO(h);let g=typeof l=="function"?l(m):m();const v=f(...g);return ww(c,i,v)}function Mw(e){const t={},r=[];let s;const a={addCase(i,l){const c=typeof i=="string"?i:i.type;if(!c)throw new Error(Hr(28));if(c in t)throw new Error(Hr(29));return t[c]=l,a},addAsyncThunk(i,l){return l.pending&&(t[i.pending.type]=l.pending),l.rejected&&(t[i.rejected.type]=l.rejected),l.fulfilled&&(t[i.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:i.settled,reducer:l.settled}),a},addMatcher(i,l){return r.push({matcher:i,reducer:l}),a},addDefaultCase(i){return s=i,a}};return e(a),[t,r,s]}function AO(e){return typeof e=="function"}function TO(e,t){let[r,s,a]=Mw(t),i;if(AO(e))i=()=>zx(e());else{const c=zx(e);i=()=>c}function l(c=i(),d){let f=[r[d.type],...s.filter(({matcher:h})=>h(d)).map(({reducer:h})=>h)];return f.filter(h=>!!h).length===0&&(f=[a]),f.reduce((h,m)=>{if(m)if(ya(h)){const v=m(h,d);return v===void 0?h:v}else{if(os(h))return Aw(h,g=>m(g,d));{const g=m(h,d);if(g===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return h},c)}return l.getInitialState=i,l}var OO="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",MO=(e=21)=>{let t="",r=e;for(;r--;)t+=OO[Math.random()*64|0];return t},IO=Symbol.for("rtk-slice-createasyncthunk");function LO(e,t){return`${e}/${t}`}function DO({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[IO];return function(a){const{name:i,reducerPath:l=i}=a;if(!i)throw new Error(Hr(11));const c=(typeof a.reducers=="function"?a.reducers($O()):a.reducers)||{},d=Object.keys(c),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(P,O){const T=typeof P=="string"?P:P.type;if(!T)throw new Error(Hr(12));if(T in f.sliceCaseReducersByType)throw new Error(Hr(13));return f.sliceCaseReducersByType[T]=O,h},addMatcher(P,O){return f.sliceMatchers.push({matcher:P,reducer:O}),h},exposeAction(P,O){return f.actionCreators[P]=O,h},exposeCaseReducer(P,O){return f.sliceCaseReducersByName[P]=O,h}};d.forEach(P=>{const O=c[P],T={reducerName:P,type:LO(i,P),createNotation:typeof a.reducers=="function"};BO(O)?UO(T,O,h,t):zO(T,O,h)});function m(){const[P={},O=[],T=void 0]=typeof a.extraReducers=="function"?Mw(a.extraReducers):[a.extraReducers],A={...P,...f.sliceCaseReducersByType};return TO(a.initialState,C=>{for(let E in A)C.addCase(E,A[E]);for(let E of f.sliceMatchers)C.addMatcher(E.matcher,E.reducer);for(let E of O)C.addMatcher(E.matcher,E.reducer);T&&C.addDefaultCase(T)})}const g=P=>P,v=new Map,j=new WeakMap;let _;function y(P,O){return _||(_=m()),_(P,O)}function w(){return _||(_=m()),_.getInitialState()}function k(P,O=!1){function T(C){let E=C[P];return typeof E>"u"&&O&&(E=Cl(j,T,w)),E}function A(C=g){const E=Cl(v,O,()=>new WeakMap);return Cl(E,C,()=>{const D={};for(const[$,M]of Object.entries(a.selectors??{}))D[$]=RO(M,C,()=>Cl(j,C,w),O);return D})}return{reducerPath:P,getSelectors:A,get selectors(){return A(T)},selectSlice:T}}const N={name:i,reducer:y,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:w,...k(l),injectInto(P,{reducerPath:O,...T}={}){const A=O??l;return P.inject({reducerPath:A,reducer:y},T),{...N,...k(A,!0)}}};return N}}function RO(e,t,r,s){function a(i,...l){let c=t(i);return typeof c>"u"&&s&&(c=r()),e(c,...l)}return a.unwrapped=e,a}var Zr=DO();function $O(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function zO({type:e,reducerName:t,createNotation:r},s,a){let i,l;if("reducer"in s){if(r&&!FO(s))throw new Error(Hr(17));i=s.reducer,l=s.prepare}else i=s;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,l?dn(e,l):dn(e))}function BO(e){return e._reducerDefinitionType==="asyncThunk"}function FO(e){return e._reducerDefinitionType==="reducerWithPrepare"}function UO({type:e,reducerName:t},r,s,a){if(!a)throw new Error(Hr(18));const{payloadCreator:i,fulfilled:l,pending:c,rejected:d,settled:f,options:h}=r,m=a(e,i,h);s.exposeAction(t,m),l&&s.addCase(m.fulfilled,l),c&&s.addCase(m.pending,c),d&&s.addCase(m.rejected,d),f&&s.addMatcher(m.settled,f),s.exposeCaseReducer(t,{fulfilled:l||Pl,pending:c||Pl,rejected:d||Pl,settled:f||Pl})}function Pl(){}var WO="task",Iw="listener",Lw="completed",um="cancelled",qO=`task-${um}`,GO=`task-${Lw}`,Fh=`${Iw}-${um}`,HO=`${Iw}-${Lw}`,gd=class{constructor(e){nr(this,"name","TaskAbortError");nr(this,"message");this.code=e,this.message=`${WO} ${um} (reason: ${e})`}},hm=(e,t)=>{if(typeof e!="function")throw new TypeError(Hr(32))},ic=()=>{},Dw=(e,t=ic)=>(e.catch(t),e),Rw=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),fa=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},ma=e=>{if(e.aborted){const{reason:t}=e;throw new gd(t)}};function $w(e,t){let r=ic;return new Promise((s,a)=>{const i=()=>a(new gd(e.reason));if(e.aborted){i();return}r=Rw(e,i),t.finally(()=>r()).then(s,a)}).finally(()=>{r=ic})}var VO=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof gd?"cancelled":"rejected",error:r}}finally{t==null||t()}},oc=e=>t=>Dw($w(e,t).then(r=>(ma(e),r))),zw=e=>{const t=oc(e);return r=>t(new Promise(s=>setTimeout(s,r)))},{assign:ri}=Object,Fx={},xd="listenerMiddleware",KO=(e,t)=>{const r=s=>Rw(e,()=>fa(s,e.reason));return(s,a)=>{hm(s);const i=new AbortController;r(i);const l=VO(async()=>{ma(e),ma(i.signal);const c=await s({pause:oc(i.signal),delay:zw(i.signal),signal:i.signal});return ma(i.signal),c},()=>fa(i,GO));return a!=null&&a.autoJoin&&t.push(l.catch(ic)),{result:oc(e)(l),cancel(){fa(i,qO)}}}},ZO=(e,t)=>{const r=async(s,a)=>{ma(t);let i=()=>{};const c=[new Promise((d,f)=>{let h=e({predicate:s,effect:(m,g)=>{g.unsubscribe(),d([m,g.getState(),g.getOriginalState()])}});i=()=>{h(),f()}})];a!=null&&c.push(new Promise(d=>setTimeout(d,a,null)));try{const d=await $w(t,Promise.race(c));return ma(t),d}finally{i()}};return(s,a)=>Dw(r(s,a))},Bw=e=>{let{type:t,actionCreator:r,matcher:s,predicate:a,effect:i}=e;if(t)a=dn(t).match;else if(r)t=r.type,a=r.match;else if(s)a=s;else if(!a)throw new Error(Hr(21));return hm(i),{predicate:a,type:t,effect:i}},Fw=ri(e=>{const{type:t,predicate:r,effect:s}=Bw(e);return{id:MO(),effect:s,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Hr(22))}}},{withTypes:()=>Fw}),Ux=(e,t)=>{const{type:r,effect:s,predicate:a}=Bw(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===s)},Uh=e=>{e.pending.forEach(t=>{fa(t,Fh)})},YO=e=>()=>{e.forEach(Uh),e.clear()},Wx=(e,t,r)=>{try{e(t,r)}catch(s){setTimeout(()=>{throw s},0)}},Uw=ri(dn(`${xd}/add`),{withTypes:()=>Uw}),XO=dn(`${xd}/removeAll`),Ww=ri(dn(`${xd}/remove`),{withTypes:()=>Ww}),JO=(...e)=>{console.error(`${xd}/error`,...e)},Do=(e={})=>{const t=new Map,{extra:r,onError:s=JO}=e;hm(s);const a=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&Uh(h)}),i=h=>{const m=Ux(t,h)??Fw(h);return a(m)};ri(i,{withTypes:()=>i});const l=h=>{const m=Ux(t,h);return m&&(m.unsubscribe(),h.cancelActive&&Uh(m)),!!m};ri(l,{withTypes:()=>l});const c=async(h,m,g,v)=>{const j=new AbortController,_=ZO(i,j.signal),y=[];try{h.pending.add(j),await Promise.resolve(h.effect(m,ri({},g,{getOriginalState:v,condition:(w,k)=>_(w,k).then(Boolean),take:_,delay:zw(j.signal),pause:oc(j.signal),extra:r,signal:j.signal,fork:KO(j.signal,y),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((w,k,N)=>{w!==j&&(fa(w,Fh),N.delete(w))})},cancel:()=>{fa(j,Fh),h.pending.delete(j)},throwIfCancelled:()=>{ma(j.signal)}})))}catch(w){w instanceof gd||Wx(s,w,{raisedBy:"effect"})}finally{await Promise.all(y),fa(j,HO),h.pending.delete(j)}},d=YO(t);return{middleware:h=>m=>g=>{if(!jw(g))return m(g);if(Uw.match(g))return i(g.payload);if(XO.match(g)){d();return}if(Ww.match(g))return l(g.payload);let v=h.getState();const j=()=>{if(v===Fx)throw new Error(Hr(23));return v};let _;try{if(_=m(g),t.size>0){const y=h.getState(),w=Array.from(t.values());for(const k of w){let N=!1;try{N=k.predicate(g,y,v)}catch(P){N=!1,Wx(s,P,{raisedBy:"predicate"})}N&&c(k,g,h,j)}}}finally{v=Fx}return _},startListening:i,stopListening:l,clearListeners:d}};function Hr(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var QO={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},qw=Zr({name:"chartLayout",initialState:QO,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,s,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(s=t.payload.right)!==null&&s!==void 0?s:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:e5,setLayout:t5,setChartSize:r5,setScale:n5}=qw.actions,s5=qw.reducer;function qx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Gx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qx(Object(r),!0).forEach(function(s){a5(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qx(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function a5(e,t,r){return(t=i5(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i5(e){var t=o5(e,"string");return typeof t=="symbol"?t:t+""}function o5(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lc=Math.PI/180,l5=e=>e*180/Math.PI,Gt=(e,t,r,s)=>({x:e+Math.cos(-lc*s)*r,y:t+Math.sin(-lc*s)*r}),Gw=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(r-(s.top||0)-(s.bottom||0)))/2},c5=(e,t)=>{var{x:r,y:s}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(s-i)**2)},d5=(e,t)=>{var{x:r,y:s}=e,{cx:a,cy:i}=t,l=c5({x:r,y:s},{x:a,y:i});if(l<=0)return{radius:l,angle:0};var c=(r-a)/l,d=Math.acos(c);return s>i&&(d=2*Math.PI-d),{radius:l,angle:l5(d),angleInRadian:d}},u5=e=>{var{startAngle:t,endAngle:r}=e,s=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(s,a);return{startAngle:t-i*360,endAngle:r-i*360}},h5=(e,t)=>{var{startAngle:r,endAngle:s}=t,a=Math.floor(r/360),i=Math.floor(s/360),l=Math.min(a,i);return e+l*360},f5=(e,t)=>{var{x:r,y:s}=e,{radius:a,angle:i}=d5({x:r,y:s},t),{innerRadius:l,outerRadius:c}=t;if(a<l||a>c||a===0)return null;var{startAngle:d,endAngle:f}=u5(t),h=i,m;if(d<=f){for(;h>f;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=f}else{for(;h>d;)h-=360;for(;h<f;)h+=360;m=h>=f&&h<=d}return m?Gx(Gx({},t),{},{radius:a,angle:h5(h,t)}):null};function Hw(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Hx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function an(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hx(Object(r),!0).forEach(function(s){m5(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hx(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function m5(e,t,r){return(t=p5(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p5(e){var t=g5(e,"string");return typeof t=="symbol"?t:t+""}function g5(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wt(e,t,r){return Ot(e)||Ot(t)?r:Rn(t)?va(e,t,r):typeof t=="function"?t(e):r}var x5=(e,t,r,s,a)=>{var i,l=-1,c=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(c<=1||e==null)return 0;if(s==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var d=0;d<c;d++){var f=d>0?r[d-1].coordinate:r[c-1].coordinate,h=r[d].coordinate,m=d>=c-1?r[0].coordinate:r[d+1].coordinate,g=void 0;if(or(h-f)!==or(m-h)){var v=[];if(or(m-h)===or(a[1]-a[0])){g=m;var j=h+a[1]-a[0];v[0]=Math.min(j,(j+f)/2),v[1]=Math.max(j,(j+f)/2)}else{g=f;var _=m+a[1]-a[0];v[0]=Math.min(h,(_+h)/2),v[1]=Math.max(h,(_+h)/2)}var y=[Math.min(h,(g+h)/2),Math.max(h,(g+h)/2)];if(e>y[0]&&e<=y[1]||e>=v[0]&&e<=v[1]){({index:l}=r[d]);break}}else{var w=Math.min(f,m),k=Math.max(f,m);if(e>(w+h)/2&&e<=(k+h)/2){({index:l}=r[d]);break}}}else if(t){for(var N=0;N<c;N++)if(N===0&&e<=(t[N].coordinate+t[N+1].coordinate)/2||N>0&&N<c-1&&e>(t[N].coordinate+t[N-1].coordinate)/2&&e<=(t[N].coordinate+t[N+1].coordinate)/2||N===c-1&&e>(t[N].coordinate+t[N-1].coordinate)/2){({index:l}=t[N]);break}}return l},v5=(e,t,r)=>{if(t&&r){var{width:s,height:a}=r,{align:i,verticalAlign:l,layout:c}=t;if((c==="vertical"||c==="horizontal"&&l==="middle")&&i!=="center"&&Pe(e[i]))return an(an({},e),{},{[i]:e[i]+(s||0)});if((c==="horizontal"||c==="vertical"&&i==="center")&&l!=="middle"&&Pe(e[l]))return an(an({},e),{},{[l]:e[l]+(a||0)})}return e},hs=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Vw=(e,t,r,s)=>{if(s)return e.map(c=>c.coordinate);var a,i,l=e.map(c=>(c.coordinate===t&&(a=!0),c.coordinate===r&&(i=!0),c.coordinate));return a||l.push(t),i||l.push(r),l},Kw=(e,t,r)=>{if(!e)return null;var{duplicateDomain:s,type:a,range:i,scale:l,realScaleType:c,isCategorical:d,categoricalDomain:f,tickCount:h,ticks:m,niceTicks:g,axisType:v}=e;if(!l)return null;var j=c==="scaleBand"&&l.bandwidth?l.bandwidth()/2:2,_=a==="category"&&l.bandwidth?l.bandwidth()/j:0;if(_=v==="angleAxis"&&i&&i.length>=2?or(i[0]-i[1])*2*_:_,m||g){var y=(m||g||[]).map((w,k)=>{var N=s?s.indexOf(w):w;return{coordinate:l(N)+_,value:w,offset:_,index:k}});return y.filter(w=>!Rr(w.coordinate))}return d&&f?f.map((w,k)=>({coordinate:l(w)+_,value:w,index:k,offset:_})):l.ticks&&h!=null?l.ticks(h).map((w,k)=>({coordinate:l(w)+_,value:w,offset:_,index:k})):l.domain().map((w,k)=>({coordinate:l(w)+_,value:s?s[w]:w,index:k,offset:_}))},Vx=1e-4,y5=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,s=e.range(),a=Math.min(s[0],s[1])-Vx,i=Math.max(s[0],s[1])+Vx,l=e(t[0]),c=e(t[r-1]);(l<a||l>i||c<a||c>i)&&e.domain([t[0],t[r-1]])}},b5=(e,t)=>{if(!t||t.length!==2||!Pe(t[0])||!Pe(t[1]))return e;var r=Math.min(t[0],t[1]),s=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Pe(e[0])||e[0]<r)&&(a[0]=r),(!Pe(e[1])||e[1]>s)&&(a[1]=s),a[0]>s&&(a[0]=s),a[1]<r&&(a[1]=r),a},w5=e=>{var t=e.length;if(!(t<=0))for(var r=0,s=e[0].length;r<s;++r)for(var a=0,i=0,l=0;l<t;++l){var c=Rr(e[l][r][1])?e[l][r][0]:e[l][r][1];c>=0?(e[l][r][0]=a,e[l][r][1]=a+c,a=e[l][r][1]):(e[l][r][0]=i,e[l][r][1]=i+c,i=e[l][r][1])}},_5=e=>{var t=e.length;if(!(t<=0))for(var r=0,s=e[0].length;r<s;++r)for(var a=0,i=0;i<t;++i){var l=Rr(e[i][r][1])?e[i][r][0]:e[i][r][1];l>=0?(e[i][r][0]=a,e[i][r][1]=a+l,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},j5={sign:w5,expand:oT,none:ci,silhouette:lT,wiggle:cT,positive:_5},N5=(e,t,r)=>{var s=j5[r],a=iT().keys(t).value((i,l)=>+wt(i,l,0)).order(Oh).offset(s);return a(e)};function Zw(e){return e==null?void 0:String(e)}function Kx(e){var{axis:t,ticks:r,bandSize:s,entry:a,index:i,dataKey:l}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ot(a[t.dataKey])){var c=Nb(r,"value",a[t.dataKey]);if(c)return c.coordinate+s/2}return r[i]?r[i].coordinate+s/2:null}var d=wt(a,Ot(l)?t.dataKey:l);return Ot(d)?null:t.scale(d)}var Zx=e=>{var{axis:t,ticks:r,offset:s,bandSize:a,entry:i,index:l}=e;if(t.type==="category")return r[l]?r[l].coordinate+s:null;var c=wt(i,t.dataKey,t.scale.domain()[l]);return Ot(c)?null:t.scale(c)-a/2+s},k5=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var s=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return s<=0&&a>=0?0:a<0?a:s}return r[0]},S5=e=>{var t=e.flat(2).filter(Pe);return[Math.min(...t),Math.max(...t)]},E5=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],C5=(e,t,r)=>{if(e!=null)return E5(Object.keys(e).reduce((s,a)=>{var i=e[a],{stackedData:l}=i,c=l.reduce((d,f)=>{var h=Hw(f,t,r),m=S5(h);return[Math.min(d[0],m[0]),Math.max(d[1],m[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]))},Yx=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Xx=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,yo=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!r||s>0)return s}if(e&&t&&t.length>=2){for(var a=hd(t,h=>h.coordinate),i=1/0,l=1,c=a.length;l<c;l++){var d=a[l],f=a[l-1];i=Math.min((d.coordinate||0)-(f.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function Jx(e){var{tooltipEntrySettings:t,dataKey:r,payload:s,value:a,name:i}=e;return an(an({},t),{},{dataKey:r,payload:s,value:a,name:i})}function Ni(e,t){if(e)return String(e);if(typeof t=="string")return t}function P5(e,t,r,s,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return s?f5({x:e,y:t},s):null}var A5=(e,t,r,s)=>{var a=t.find(f=>f&&f.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:s.y};if(e==="vertical")return{x:s.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:l}=s;return an(an(an({},s),Gt(s.cx,s.cy,l,i)),{},{angle:i,radius:l})}var c=a.coordinate,{angle:d}=s;return an(an(an({},s),Gt(s.cx,s.cy,c,d)),{},{angle:d,radius:c})}return{x:0,y:0}},T5=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,fs=e=>e.layout.width,ms=e=>e.layout.height,O5=e=>e.layout.scale,Yw=e=>e.layout.margin,vd=ee(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),yd=ee(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Xw="data-recharts-item-index",Jw="data-recharts-item-data-key",Ro=60;function Qx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Al(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qx(Object(r),!0).forEach(function(s){M5(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qx(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function M5(e,t,r){return(t=I5(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I5(e){var t=L5(e,"string");return typeof t=="symbol"?t:t+""}function L5(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D5=e=>e.brush.height;function R5(e){var t=yd(e);return t.reduce((r,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var a=typeof s.width=="number"?s.width:Ro;return r+a}return r},0)}function $5(e){var t=yd(e);return t.reduce((r,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var a=typeof s.width=="number"?s.width:Ro;return r+a}return r},0)}function z5(e){var t=vd(e);return t.reduce((r,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?r+s.height:r,0)}function B5(e){var t=vd(e);return t.reduce((r,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?r+s.height:r,0)}var Jt=ee([fs,ms,Yw,D5,R5,$5,z5,B5,yw,sO],(e,t,r,s,a,i,l,c,d,f)=>{var h={left:(r.left||0)+a,right:(r.right||0)+i},m={top:(r.top||0)+l,bottom:(r.bottom||0)+c},g=Al(Al({},m),h),v=g.bottom;g.bottom+=s,g=v5(g,d,f);var j=e-g.left-g.right,_=t-g.top-g.bottom;return Al(Al({brushBottom:v},g),{},{width:Math.max(j,0),height:Math.max(_,0)})}),F5=ee(Jt,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),fm=ee(fs,ms,(e,t)=>({x:0,y:0,width:e,height:t})),U5=x.createContext(null),$r=()=>x.useContext(U5)!=null,bd=e=>e.brush,wd=ee([bd,Jt,Yw],(e,t,r)=>({height:e.height,x:Pe(e.x)?e.x:t.left,y:Pe(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Pe(e.width)?e.width:t.width})),mm=()=>{var e,t=$r(),r=Ae(F5),s=Ae(wd),a=(e=Ae(bd))===null||e===void 0?void 0:e.padding;return!t||!s||!a?r:{width:s.width-a.left-a.right,height:s.height-a.top-a.bottom,x:a.left,y:a.top}},W5={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Qw=()=>{var e;return(e=Ae(Jt))!==null&&e!==void 0?e:W5},pm=()=>Ae(fs),gm=()=>Ae(ms),q5=()=>Ae(e=>e.layout.margin),nt=e=>e.layout.layoutType,_d=()=>Ae(nt),G5={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},e_=Zr({name:"legend",initialState:G5,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=ts(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:ev,setLegendSettings:H5,addLegendPayload:t_,removeLegendPayload:r_}=e_.actions,V5=e_.reducer,K5=["contextPayload"];function Wh(){return Wh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Wh.apply(null,arguments)}function tv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function hi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tv(Object(r),!0).forEach(function(s){xm(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tv(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function xm(e,t,r){return(t=Z5(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z5(e){var t=Y5(e,"string");return typeof t=="symbol"?t:t+""}function Y5(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X5(e,t){if(e==null)return{};var r,s,a=J5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function J5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Q5(e){return e.value}function eM(e){var{contextPayload:t}=e,r=X5(e,K5),s=lw(t,e.payloadUniqBy,Q5),a=hi(hi({},r),{},{payload:s});return x.isValidElement(e.content)?x.cloneElement(e.content,a):typeof e.content=="function"?x.createElement(e.content,a):x.createElement(Zf,a)}function tM(e,t,r,s,a,i){var{layout:l,align:c,verticalAlign:d}=t,f,h;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(c==="center"&&l==="vertical"?f={left:((s||0)-i.width)/2}:f=c==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(d==="middle"?h={top:((a||0)-i.height)/2}:h=d==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),hi(hi({},f),h)}function rM(e){var t=Mt();return x.useEffect(()=>{t(H5(e))},[t,e]),null}function nM(e){var t=Mt();return x.useEffect(()=>(t(ev(e)),()=>{t(ev({width:0,height:0}))}),[t,e]),null}function sM(e){var t=oO(),r=AA(),s=q5(),{width:a,height:i,wrapperStyle:l,portal:c}=e,[d,f]=bw([t]),h=pm(),m=gm();if(h==null||m==null)return null;var g=h-(s.left||0)-(s.right||0),v=jd.getWidthOrHeight(e.layout,i,a,g),j=c?l:hi(hi({position:"absolute",width:(v==null?void 0:v.width)||a||"auto",height:(v==null?void 0:v.height)||i||"auto"},tM(l,e,s,h,m,d)),l),_=c??r;if(_==null)return null;var y=x.createElement("div",{className:"recharts-legend-wrapper",style:j,ref:f},x.createElement(rM,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),x.createElement(nM,{width:d.width,height:d.height}),x.createElement(eM,Wh({},e,v,{margin:s,chartWidth:h,chartHeight:m,contextPayload:t})));return Lc.createPortal(y,_)}class jd extends x.PureComponent{static getWidthOrHeight(t,r,s,a){return t==="vertical"&&Pe(r)?{height:r}:t==="horizontal"?{width:s||a}:null}render(){return x.createElement(sM,this.props)}}xm(jd,"displayName","Legend");xm(jd,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function qh(){return qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},qh.apply(null,arguments)}function rv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function $u(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rv(Object(r),!0).forEach(function(s){aM(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rv(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function aM(e,t,r){return(t=iM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iM(e){var t=oM(e,"string");return typeof t=="symbol"?t:t+""}function oM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lM(e){return Array.isArray(e)&&Rn(e[0])&&Rn(e[1])?e.join(" ~ "):e}var cM=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:s={},labelStyle:a={},payload:i,formatter:l,itemSorter:c,wrapperClassName:d,labelClassName:f,label:h,labelFormatter:m,accessibilityLayer:g=!1}=e,v=()=>{if(i&&i.length){var O={padding:0,margin:0},T=(c?hd(i,c):i).map((A,C)=>{if(A.type==="none")return null;var E=A.formatter||l||lM,{value:D,name:$}=A,M=D,z=$;if(E){var K=E(D,$,A,C,i);if(Array.isArray(K))[M,z]=K;else if(K!=null)M=K;else return null}var W=$u({display:"block",paddingTop:4,paddingBottom:4,color:A.color||"#000"},s);return x.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(C),style:W},Rn(z)?x.createElement("span",{className:"recharts-tooltip-item-name"},z):null,Rn(z)?x.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,x.createElement("span",{className:"recharts-tooltip-item-value"},M),x.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return x.createElement("ul",{className:"recharts-tooltip-item-list",style:O},T)}return null},j=$u({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),_=$u({margin:0},a),y=!Ot(h),w=y?h:"",k=Ve("recharts-default-tooltip",d),N=Ve("recharts-tooltip-label",f);y&&m&&i!==void 0&&i!==null&&(w=m(h,i));var P=g?{role:"status","aria-live":"assertive"}:{};return x.createElement("div",qh({className:k,style:j},P),x.createElement("p",{className:N,style:_},x.isValidElement(w)?w:"".concat(w)),v())},Ki="recharts-tooltip-wrapper",dM={visibility:"hidden"};function uM(e){var{coordinate:t,translateX:r,translateY:s}=e;return Ve(Ki,{["".concat(Ki,"-right")]:Pe(r)&&t&&Pe(t.x)&&r>=t.x,["".concat(Ki,"-left")]:Pe(r)&&t&&Pe(t.x)&&r<t.x,["".concat(Ki,"-bottom")]:Pe(s)&&t&&Pe(t.y)&&s>=t.y,["".concat(Ki,"-top")]:Pe(s)&&t&&Pe(t.y)&&s<t.y})}function nv(e){var{allowEscapeViewBox:t,coordinate:r,key:s,offsetTopLeft:a,position:i,reverseDirection:l,tooltipDimension:c,viewBox:d,viewBoxDimension:f}=e;if(i&&Pe(i[s]))return i[s];var h=r[s]-c-(a>0?a:0),m=r[s]+a;if(t[s])return l[s]?h:m;var g=d[s];if(g==null)return 0;if(l[s]){var v=h,j=g;return v<j?Math.max(m,g):Math.max(h,g)}if(f==null)return 0;var _=m+c,y=g+f;return _>y?Math.max(h,g):Math.max(m,g)}function hM(e){var{translateX:t,translateY:r,useTranslate3d:s}=e;return{transform:s?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function fM(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:s,position:a,reverseDirection:i,tooltipBox:l,useTranslate3d:c,viewBox:d}=e,f,h,m;return l.height>0&&l.width>0&&r?(h=nv({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:l.width,viewBox:d,viewBoxDimension:d.width}),m=nv({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:l.height,viewBox:d,viewBoxDimension:d.height}),f=hM({translateX:h,translateY:m,useTranslate3d:c})):f=dM,{cssProperties:f,cssClasses:uM({translateX:h,translateY:m,coordinate:r})}}function sv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Tl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sv(Object(r),!0).forEach(function(s){Gh(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sv(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Gh(e,t,r){return(t=mM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mM(e){var t=pM(e,"string");return typeof t=="symbol"?t:t+""}function pM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class gM extends x.PureComponent{constructor(){super(...arguments),Gh(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Gh(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,s,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:s,animationEasing:a,children:i,coordinate:l,hasPayload:c,isAnimationActive:d,offset:f,position:h,reverseDirection:m,useTranslate3d:g,viewBox:v,wrapperStyle:j,lastBoundingBox:_,innerRef:y,hasPortalFromProps:w}=this.props,{cssClasses:k,cssProperties:N}=fM({allowEscapeViewBox:r,coordinate:l,offsetTopLeft:f,position:h,reverseDirection:m,tooltipBox:{height:_.height,width:_.width},useTranslate3d:g,viewBox:v}),P=w?{}:Tl(Tl({transition:d&&t?"transform ".concat(s,"ms ").concat(a):void 0},N),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&c?"visible":"hidden",position:"absolute",top:0,left:0}),O=Tl(Tl({},P),{},{visibility:!this.state.dismissed&&t&&c?"visible":"hidden"},j);return x.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:O,ref:y},i)}}var xM=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Ds={devToolsEnabled:!1,isSsr:xM()},n_=()=>Ae(e=>e.rootProps.accessibilityLayer);function gr(e){return Number.isFinite(e)}function fi(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Hh(){return Hh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Hh.apply(null,arguments)}function av(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function iv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?av(Object(r),!0).forEach(function(s){vM(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):av(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function vM(e,t,r){return(t=yM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yM(e){var t=bM(e,"string");return typeof t=="symbol"?t:t+""}function bM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ov={curveBasisClosed:ZA,curveBasisOpen:YA,curveBasis:KA,curveBumpX:IA,curveBumpY:LA,curveLinearClosed:XA,curveLinear:ld,curveMonotoneX:JA,curveMonotoneY:QA,curveNatural:eT,curveStep:tT,curveStepAfter:nT,curveStepBefore:rT},Ol=e=>gr(e.x)&&gr(e.y),Zi=e=>e.x,Yi=e=>e.y,wM=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Mo(e));return(r==="curveMonotone"||r==="curveBump")&&t?ov["".concat(r).concat(t==="vertical"?"Y":"X")]:ov[r]||ld},_M=e=>{var{type:t="linear",points:r=[],baseLine:s,layout:a,connectNulls:i=!1}=e,l=wM(t,a),c=i?r.filter(Ol):r,d;if(Array.isArray(s)){var f=i?s.filter(m=>Ol(m)):s,h=c.map((m,g)=>iv(iv({},m),{},{base:f[g]}));return a==="vertical"?d=Nl().y(Yi).x1(Zi).x0(m=>m.base.x):d=Nl().x(Zi).y1(Yi).y0(m=>m.base.y),d.defined(Ol).curve(l),d(h)}return a==="vertical"&&Pe(s)?d=Nl().y(Yi).x1(Zi).x0(s):Pe(s)?d=Nl().x(Zi).y1(Yi).y0(s):d=Ib().x(Zi).y(Yi),d.defined(Ol).curve(l),d(c)},lo=e=>{var{className:t,points:r,path:s,pathRef:a}=e;if((!r||!r.length)&&!s)return null;var i=r&&r.length?_M(e):s;return x.createElement("path",Hh({},jn(e),Ff(e),{className:Ve("recharts-curve",t),d:i===null?void 0:i,ref:a}))},jM=["x","y","top","left","width","height","className"];function Vh(){return Vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Vh.apply(null,arguments)}function lv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function NM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lv(Object(r),!0).forEach(function(s){kM(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lv(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function kM(e,t,r){return(t=SM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SM(e){var t=EM(e,"string");return typeof t=="symbol"?t:t+""}function EM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CM(e,t){if(e==null)return{};var r,s,a=PM(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PM(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var AM=(e,t,r,s,a,i)=>"M".concat(e,",").concat(a,"v").concat(s,"M").concat(i,",").concat(t,"h").concat(r),TM=e=>{var{x:t=0,y:r=0,top:s=0,left:a=0,width:i=0,height:l=0,className:c}=e,d=CM(e,jM),f=NM({x:t,y:r,top:s,left:a,width:i,height:l},d);return!Pe(t)||!Pe(r)||!Pe(i)||!Pe(l)||!Pe(s)||!Pe(a)?null:x.createElement("path",Vh({},Lt(f,!0),{className:Ve("recharts-cross",c),d:AM(t,r,i,l,s,a)}))};function OM(e,t,r,s){var a=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?s:r.width-1,height:e==="horizontal"?r.height-1:s}}function cv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function MM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cv(Object(r),!0).forEach(function(s){IM(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cv(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function IM(e,t,r){return(t=LM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LM(e){var t=DM(e,"string");return typeof t=="symbol"?t:t+""}function DM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xr(e,t){var r=MM({},e),s=t,a=Object.keys(t),i=a.reduce((l,c)=>(l[c]===void 0&&s[c]!==void 0&&(l[c]=s[c]),l),r);return i}function RM(){}function dv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function uv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dv(Object(r),!0).forEach(function(s){$M(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dv(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function $M(e,t,r){return(t=zM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zM(e){var t=BM(e,"string");return typeof t=="symbol"?t:t+""}function BM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FM=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),s_=(e,t,r)=>e.map(s=>"".concat(FM(s)," ").concat(t,"ms ").concat(r)).join(","),UM=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,s)=>r.filter(a=>s.includes(a))),bo=(e,t)=>Object.keys(t).reduce((r,s)=>uv(uv({},r),{},{[s]:e(s,t[s])}),{});function hv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hv(Object(r),!0).forEach(function(s){WM(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hv(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function WM(e,t,r){return(t=qM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qM(e){var t=GM(e,"string");return typeof t=="symbol"?t:t+""}function GM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cc=(e,t,r)=>e+(t-e)*r,Kh=e=>{var{from:t,to:r}=e;return t!==r},a_=(e,t,r)=>{var s=bo((a,i)=>{if(Kh(i)){var[l,c]=e(i.from,i.to,i.velocity);return pr(pr({},i),{},{from:l,velocity:c})}return i},t);return r<1?bo((a,i)=>Kh(i)?pr(pr({},i),{},{velocity:cc(i.velocity,s[a].velocity,r),from:cc(i.from,s[a].from,r)}):i,t):a_(e,s,r-1)};function HM(e,t,r,s,a,i){var l,c=s.reduce((g,v)=>pr(pr({},g),{},{[v]:{from:e[v],velocity:0,to:t[v]}}),{}),d=()=>bo((g,v)=>v.from,c),f=()=>!Object.values(c).filter(Kh).length,h=null,m=g=>{l||(l=g);var v=g-l,j=v/r.dt;c=a_(r,c,j),a(pr(pr(pr({},e),t),d())),l=g,f()||(h=i.setTimeout(m))};return()=>(h=i.setTimeout(m),()=>{h()})}function VM(e,t,r,s,a,i,l){var c=null,d=a.reduce((m,g)=>pr(pr({},m),{},{[g]:[e[g],t[g]]}),{}),f,h=m=>{f||(f=m);var g=(m-f)/s,v=bo((_,y)=>cc(...y,r(g)),d);if(i(pr(pr(pr({},e),t),v)),g<1)c=l.setTimeout(h);else{var j=bo((_,y)=>cc(...y,r(1)),d);i(pr(pr(pr({},e),t),j))}};return()=>(c=l.setTimeout(h),()=>{c()})}const KM=(e,t,r,s,a,i)=>{var l=UM(e,t);return r.isStepper===!0?HM(e,t,r,l,a,i):VM(e,t,r,s,l,a,i)};var dc=1e-4,i_=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],o_=(e,t)=>e.map((r,s)=>r*t**s).reduce((r,s)=>r+s),fv=(e,t)=>r=>{var s=i_(e,t);return o_(s,r)},ZM=(e,t)=>r=>{var s=i_(e,t),a=[...s.map((i,l)=>i*l).slice(1),0];return o_(a,r)},mv=function(){for(var t,r,s,a,i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];if(l.length===1)switch(l[0]){case"linear":[t,s,r,a]=[0,0,1,1];break;case"ease":[t,s,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,s,r,a]=[.42,0,1,1];break;case"ease-out":[t,s,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,s,r,a]=[0,0,.58,1];break;default:{var d=l[0].split("(");d[0]==="cubic-bezier"&&d[1].split(")")[0].split(",").length===4&&([t,s,r,a]=d[1].split(")")[0].split(",").map(j=>parseFloat(j)))}}else l.length===4&&([t,s,r,a]=l);var f=fv(t,r),h=fv(s,a),m=ZM(t,r),g=j=>j>1?1:j<0?0:j,v=j=>{for(var _=j>1?1:j,y=_,w=0;w<8;++w){var k=f(y)-_,N=m(y);if(Math.abs(k-_)<dc||N<dc)return h(y);y=g(y-k/N)}return h(y)};return v.isStepper=!1,v},YM=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:s=8,dt:a=17}=t,i=(l,c,d)=>{var f=-(l-c)*r,h=d*s,m=d+(f-h)*a/1e3,g=d*a/1e3+l;return Math.abs(g-c)<dc&&Math.abs(m)<dc?[c,0]:[g,m]};return i.isStepper=!0,i.dt=a,i},XM=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return mv(e);case"spring":return YM();default:if(e.split("(")[0]==="cubic-bezier")return mv(e)}return typeof e=="function"?e:null};function JM(e){var t,r=()=>null,s=!1,a=null,i=l=>{if(!s){if(Array.isArray(l)){if(!l.length)return;var c=l,[d,...f]=c;if(typeof d=="number"){a=e.setTimeout(i.bind(null,f),d);return}i(d),a=e.setTimeout(i.bind(null,f));return}typeof l=="string"&&(t=l,r(t)),typeof l=="object"&&(t=l,r(t)),typeof l=="function"&&l()}};return{stop:()=>{s=!0},start:l=>{s=!1,a&&(a(),a=null),i(l)},subscribe:l=>(r=l,()=>{r=()=>null}),getTimeoutController:()=>e}}class QM{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),a=null,i=l=>{l-s>=r?t(l):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function eI(){return JM(new QM)}var tI=x.createContext(eI);function rI(e,t){var r=x.useContext(tI);return x.useMemo(()=>t??r(e),[e,t,r])}var nI={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},pv={t:0},zu={t:1};function $o(e){var t=xr(e,nI),{isActive:r,canBegin:s,duration:a,easing:i,begin:l,onAnimationEnd:c,onAnimationStart:d,children:f}=t,h=rI(t.animationId,t.animationManager),[m,g]=x.useState(r?pv:zu),v=x.useRef(null);return x.useEffect(()=>{r||g(zu)},[r]),x.useEffect(()=>{if(!r||!s)return RM;var j=KM(pv,zu,XM(i),a,g,h.getTimeoutController()),_=()=>{v.current=j()};return h.start([d,l,_,a,c]),()=>{h.stop(),v.current&&v.current(),c()}},[r,s,a,i,l,d,c,h]),f(m.t)}function zo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=x.useRef(go(t)),s=x.useRef(e);return s.current!==e&&(r.current=go(t),s.current=e),r.current}function gv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function xv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gv(Object(r),!0).forEach(function(s){sI(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gv(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function sI(e,t,r){return(t=aI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aI(e){var t=iI(e,"string");return typeof t=="symbol"?t:t+""}function iI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uc(){return uc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},uc.apply(null,arguments)}var vv=(e,t,r,s,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(s)/2),l=s>=0?1:-1,c=r>=0?1:-1,d=s>=0&&r>=0||s<0&&r<0?1:0,f;if(i>0&&a instanceof Array){for(var h=[0,0,0,0],m=0,g=4;m<g;m++)h[m]=a[m]>i?i:a[m];f="M".concat(e,",").concat(t+l*h[0]),h[0]>0&&(f+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(d,",").concat(e+c*h[0],",").concat(t)),f+="L ".concat(e+r-c*h[1],",").concat(t),h[1]>0&&(f+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(d,`,
        `).concat(e+r,",").concat(t+l*h[1])),f+="L ".concat(e+r,",").concat(t+s-l*h[2]),h[2]>0&&(f+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(d,`,
        `).concat(e+r-c*h[2],",").concat(t+s)),f+="L ".concat(e+c*h[3],",").concat(t+s),h[3]>0&&(f+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(d,`,
        `).concat(e,",").concat(t+s-l*h[3])),f+="Z"}else if(i>0&&a===+a&&a>0){var v=Math.min(i,a);f="M ".concat(e,",").concat(t+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(e+c*v,",").concat(t,`
            L `).concat(e+r-c*v,",").concat(t,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(e+r,",").concat(t+l*v,`
            L `).concat(e+r,",").concat(t+s-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(e+r-c*v,",").concat(t+s,`
            L `).concat(e+c*v,",").concat(t+s,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(e,",").concat(t+s-l*v," Z")}else f="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(s," h ").concat(-r," Z");return f},oI={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},l_=e=>{var t=xr(e,oI),r=x.useRef(null),[s,a]=x.useState(-1);x.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var K=r.current.getTotalLength();K&&a(K)}catch{}},[]);var{x:i,y:l,width:c,height:d,radius:f,className:h}=t,{animationEasing:m,animationDuration:g,animationBegin:v,isAnimationActive:j,isUpdateAnimationActive:_}=t,y=x.useRef(c),w=x.useRef(d),k=x.useRef(i),N=x.useRef(l),P=x.useMemo(()=>({x:i,y:l,width:c,height:d,radius:f}),[i,l,c,d,f]),O=zo(P,"rectangle-");if(i!==+i||l!==+l||c!==+c||d!==+d||c===0||d===0)return null;var T=Ve("recharts-rectangle",h);if(!_)return x.createElement("path",uc({},Lt(t,!0),{className:T,d:vv(i,l,c,d,f)}));var A=y.current,C=w.current,E=k.current,D=N.current,$="0px ".concat(s===-1?1:s,"px"),M="".concat(s,"px 0px"),z=s_(["strokeDasharray"],g,typeof m=="string"?m:void 0);return x.createElement($o,{animationId:O,key:O,canBegin:s>0,duration:g,easing:m,isActive:_,begin:v},K=>{var W=At(A,c,K),U=At(C,d,K),Y=At(E,i,K),R=At(D,l,K);r.current&&(y.current=W,w.current=U,k.current=Y,N.current=R);var H;return j?K>0?H={transition:z,strokeDasharray:M}:H={strokeDasharray:$}:H={strokeDasharray:M},x.createElement("path",uc({},Lt(t,!0),{className:T,d:vv(Y,R,W,U,f),ref:r,style:xv(xv({},H),t.style)}))})};function c_(e){var{cx:t,cy:r,radius:s,startAngle:a,endAngle:i}=e,l=Gt(t,r,s,a),c=Gt(t,r,s,i);return{points:[l,c],cx:t,cy:r,radius:s,startAngle:a,endAngle:i}}function Zh(){return Zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Zh.apply(null,arguments)}var lI=(e,t)=>{var r=or(t-e),s=Math.min(Math.abs(t-e),359.999);return r*s},Ml=e=>{var{cx:t,cy:r,radius:s,angle:a,sign:i,isExternal:l,cornerRadius:c,cornerIsExternal:d}=e,f=c*(l?1:-1)+s,h=Math.asin(c/f)/lc,m=d?a:a+i*h,g=Gt(t,r,f,m),v=Gt(t,r,s,m),j=d?a-i*h:a,_=Gt(t,r,f*Math.cos(h*lc),j);return{center:g,circleTangency:v,lineTangency:_,theta:h}},d_=e=>{var{cx:t,cy:r,innerRadius:s,outerRadius:a,startAngle:i,endAngle:l}=e,c=lI(i,l),d=i+c,f=Gt(t,r,a,i),h=Gt(t,r,a,d),m="M ".concat(f.x,",").concat(f.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(i>d),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(s>0){var g=Gt(t,r,s,i),v=Gt(t,r,s,d);m+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(i<=d),`,
            `).concat(g.x,",").concat(g.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},cI=e=>{var{cx:t,cy:r,innerRadius:s,outerRadius:a,cornerRadius:i,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:f}=e,h=or(f-d),{circleTangency:m,lineTangency:g,theta:v}=Ml({cx:t,cy:r,radius:a,angle:d,sign:h,cornerRadius:i,cornerIsExternal:c}),{circleTangency:j,lineTangency:_,theta:y}=Ml({cx:t,cy:r,radius:a,angle:f,sign:-h,cornerRadius:i,cornerIsExternal:c}),w=c?Math.abs(d-f):Math.abs(d-f)-v-y;if(w<0)return l?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):d_({cx:t,cy:r,innerRadius:s,outerRadius:a,startAngle:d,endAngle:f});var k="M ".concat(g.x,",").concat(g.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(w>180),",").concat(+(h<0),",").concat(j.x,",").concat(j.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(_.x,",").concat(_.y,`
  `);if(s>0){var{circleTangency:N,lineTangency:P,theta:O}=Ml({cx:t,cy:r,radius:s,angle:d,sign:h,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),{circleTangency:T,lineTangency:A,theta:C}=Ml({cx:t,cy:r,radius:s,angle:f,sign:-h,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),E=c?Math.abs(d-f):Math.abs(d-f)-O-C;if(E<0&&i===0)return"".concat(k,"L").concat(t,",").concat(r,"Z");k+="L".concat(A.x,",").concat(A.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(T.x,",").concat(T.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(E>180),",").concat(+(h>0),",").concat(N.x,",").concat(N.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(P.x,",").concat(P.y,"Z")}else k+="L".concat(t,",").concat(r,"Z");return k},dI={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},u_=e=>{var t=xr(e,dI),{cx:r,cy:s,innerRadius:a,outerRadius:i,cornerRadius:l,forceCornerRadius:c,cornerIsExternal:d,startAngle:f,endAngle:h,className:m}=t;if(i<a||f===h)return null;var g=Ve("recharts-sector",m),v=i-a,j=_r(l,v,0,!0),_;return j>0&&Math.abs(f-h)<360?_=cI({cx:r,cy:s,innerRadius:a,outerRadius:i,cornerRadius:Math.min(j,v/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:f,endAngle:h}):_=d_({cx:r,cy:s,innerRadius:a,outerRadius:i,startAngle:f,endAngle:h}),x.createElement("path",Zh({},Lt(t,!0),{className:g,d:_}))};function uI(e,t,r){var s,a,i,l;if(e==="horizontal")s=t.x,i=s,a=r.top,l=r.top+r.height;else if(e==="vertical")a=t.y,l=a,s=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:c,cy:d,innerRadius:f,outerRadius:h,angle:m}=t,g=Gt(c,d,f,m),v=Gt(c,d,h,m);s=g.x,a=g.y,i=v.x,l=v.y}else return c_(t);return[{x:s,y:a},{x:i,y:l}]}var h_={},f_={},m_={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=im;function r(s){return t.isSymbol(s)?NaN:Number(s)}e.toNumber=r})(m_);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m_;function r(s){return s?(s=t.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}e.toFinite=r})(f_);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=om,r=f_;function s(a,i,l){l&&typeof l!="number"&&t.isIterateeCall(a,i,l)&&(i=l=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),l=l===void 0?a<i?1:-1:r.toFinite(l);const c=Math.max(Math.ceil((i-a)/(l||1)),0),d=new Array(c);for(let f=0;f<c;f++)d[f]=a,a+=l;return d}e.range=s})(h_);var hI=h_.range;const p_=zn(hI);function Cs(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function fI(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function vm(e){let t,r,s;e.length!==2?(t=Cs,r=(c,d)=>Cs(e(c),d),s=(c,d)=>e(c)-d):(t=e===Cs||e===fI?e:mI,r=e,s=e);function a(c,d,f=0,h=c.length){if(f<h){if(t(d,d)!==0)return h;do{const m=f+h>>>1;r(c[m],d)<0?f=m+1:h=m}while(f<h)}return f}function i(c,d,f=0,h=c.length){if(f<h){if(t(d,d)!==0)return h;do{const m=f+h>>>1;r(c[m],d)<=0?f=m+1:h=m}while(f<h)}return f}function l(c,d,f=0,h=c.length){const m=a(c,d,f,h-1);return m>f&&s(c[m-1],d)>-s(c[m],d)?m-1:m}return{left:a,center:l,right:i}}function mI(){return 0}function g_(e){return e===null?NaN:+e}function*pI(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const gI=vm(Cs),Bo=gI.right;vm(g_).center;class yv extends Map{constructor(t,r=yI){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[s,a]of t)this.set(s,a)}get(t){return super.get(bv(this,t))}has(t){return super.has(bv(this,t))}set(t,r){return super.set(xI(this,t),r)}delete(t){return super.delete(vI(this,t))}}function bv({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):r}function xI({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):(e.set(s,r),r)}function vI({_intern:e,_key:t},r){const s=t(r);return e.has(s)&&(r=e.get(s),e.delete(s)),r}function yI(e){return e!==null&&typeof e=="object"?e.valueOf():e}function bI(e=Cs){if(e===Cs)return x_;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const s=e(t,r);return s||s===0?s:(e(r,r)===0)-(e(t,t)===0)}}function x_(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const wI=Math.sqrt(50),_I=Math.sqrt(10),jI=Math.sqrt(2);function hc(e,t,r){const s=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(s)),i=s/Math.pow(10,a),l=i>=wI?10:i>=_I?5:i>=jI?2:1;let c,d,f;return a<0?(f=Math.pow(10,-a)/l,c=Math.round(e*f),d=Math.round(t*f),c/f<e&&++c,d/f>t&&--d,f=-f):(f=Math.pow(10,a)*l,c=Math.round(e/f),d=Math.round(t/f),c*f<e&&++c,d*f>t&&--d),d<c&&.5<=r&&r<2?hc(e,t,r*2):[c,d,f]}function Yh(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const s=t<e,[a,i,l]=s?hc(t,e,r):hc(e,t,r);if(!(i>=a))return[];const c=i-a+1,d=new Array(c);if(s)if(l<0)for(let f=0;f<c;++f)d[f]=(i-f)/-l;else for(let f=0;f<c;++f)d[f]=(i-f)*l;else if(l<0)for(let f=0;f<c;++f)d[f]=(a+f)/-l;else for(let f=0;f<c;++f)d[f]=(a+f)*l;return d}function Xh(e,t,r){return t=+t,e=+e,r=+r,hc(e,t,r)[2]}function Jh(e,t,r){t=+t,e=+e,r=+r;const s=t<e,a=s?Xh(t,e,r):Xh(e,t,r);return(s?-1:1)*(a<0?1/-a:a)}function wv(e,t){let r;for(const s of e)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function _v(e,t){let r;for(const s of e)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function v_(e,t,r=0,s=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(e.length-1,s)),!(r<=t&&t<=s))return e;for(a=a===void 0?x_:bI(a);s>r;){if(s-r>600){const d=s-r+1,f=t-r+1,h=Math.log(d),m=.5*Math.exp(2*h/3),g=.5*Math.sqrt(h*m*(d-m)/d)*(f-d/2<0?-1:1),v=Math.max(r,Math.floor(t-f*m/d+g)),j=Math.min(s,Math.floor(t+(d-f)*m/d+g));v_(e,t,v,j,a)}const i=e[t];let l=r,c=s;for(Xi(e,r,t),a(e[s],i)>0&&Xi(e,r,s);l<c;){for(Xi(e,l,c),++l,--c;a(e[l],i)<0;)++l;for(;a(e[c],i)>0;)--c}a(e[r],i)===0?Xi(e,r,c):(++c,Xi(e,c,s)),c<=t&&(r=c+1),t<=c&&(s=c-1)}return e}function Xi(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function NI(e,t,r){if(e=Float64Array.from(pI(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return _v(e);if(t>=1)return wv(e);var s,a=(s-1)*t,i=Math.floor(a),l=wv(v_(e,i).subarray(0,i+1)),c=_v(e.subarray(i+1));return l+(c-l)*(a-i)}}function kI(e,t,r=g_){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+r(e[0],0,e);if(t>=1)return+r(e[s-1],s-1,e);var s,a=(s-1)*t,i=Math.floor(a),l=+r(e[i],i,e),c=+r(e[i+1],i+1,e);return l+(c-l)*(a-i)}}function SI(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var s=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++s<a;)i[s]=e+s*r;return i}function fn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ps(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Qh=Symbol("implicit");function ym(){var e=new yv,t=[],r=[],s=Qh;function a(i){let l=e.get(i);if(l===void 0){if(s!==Qh)return s;e.set(i,l=t.push(i)-1)}return r[l%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new yv;for(const l of i)e.has(l)||e.set(l,t.push(l)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.copy=function(){return ym(t,r).unknown(s)},fn.apply(a,arguments),a}function bm(){var e=ym().unknown(void 0),t=e.domain,r=e.range,s=0,a=1,i,l,c=!1,d=0,f=0,h=.5;delete e.unknown;function m(){var g=t().length,v=a<s,j=v?a:s,_=v?s:a;i=(_-j)/Math.max(1,g-d+f*2),c&&(i=Math.floor(i)),j+=(_-j-i*(g-d))*h,l=i*(1-d),c&&(j=Math.round(j),l=Math.round(l));var y=SI(g).map(function(w){return j+i*w});return r(v?y.reverse():y)}return e.domain=function(g){return arguments.length?(t(g),m()):t()},e.range=function(g){return arguments.length?([s,a]=g,s=+s,a=+a,m()):[s,a]},e.rangeRound=function(g){return[s,a]=g,s=+s,a=+a,c=!0,m()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(g){return arguments.length?(c=!!g,m()):c},e.padding=function(g){return arguments.length?(d=Math.min(1,f=+g),m()):d},e.paddingInner=function(g){return arguments.length?(d=Math.min(1,g),m()):d},e.paddingOuter=function(g){return arguments.length?(f=+g,m()):f},e.align=function(g){return arguments.length?(h=Math.max(0,Math.min(1,g)),m()):h},e.copy=function(){return bm(t(),[s,a]).round(c).paddingInner(d).paddingOuter(f).align(h)},fn.apply(m(),arguments)}function y_(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return y_(t())},e}function EI(){return y_(bm.apply(null,arguments).paddingInner(1))}function wm(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function b_(e,t){var r=Object.create(e.prototype);for(var s in t)r[s]=t[s];return r}function Fo(){}var wo=.7,fc=1/wo,ni="\\s*([+-]?\\d+)\\s*",_o="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ln="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",CI=/^#([0-9a-f]{3,8})$/,PI=new RegExp(`^rgb\\(${ni},${ni},${ni}\\)$`),AI=new RegExp(`^rgb\\(${Ln},${Ln},${Ln}\\)$`),TI=new RegExp(`^rgba\\(${ni},${ni},${ni},${_o}\\)$`),OI=new RegExp(`^rgba\\(${Ln},${Ln},${Ln},${_o}\\)$`),MI=new RegExp(`^hsl\\(${_o},${Ln},${Ln}\\)$`),II=new RegExp(`^hsla\\(${_o},${Ln},${Ln},${_o}\\)$`),jv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wm(Fo,jo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Nv,formatHex:Nv,formatHex8:LI,formatHsl:DI,formatRgb:kv,toString:kv});function Nv(){return this.rgb().formatHex()}function LI(){return this.rgb().formatHex8()}function DI(){return w_(this).formatHsl()}function kv(){return this.rgb().formatRgb()}function jo(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=CI.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Sv(t):r===3?new Lr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Il(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Il(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=PI.exec(e))?new Lr(t[1],t[2],t[3],1):(t=AI.exec(e))?new Lr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=TI.exec(e))?Il(t[1],t[2],t[3],t[4]):(t=OI.exec(e))?Il(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=MI.exec(e))?Pv(t[1],t[2]/100,t[3]/100,1):(t=II.exec(e))?Pv(t[1],t[2]/100,t[3]/100,t[4]):jv.hasOwnProperty(e)?Sv(jv[e]):e==="transparent"?new Lr(NaN,NaN,NaN,0):null}function Sv(e){return new Lr(e>>16&255,e>>8&255,e&255,1)}function Il(e,t,r,s){return s<=0&&(e=t=r=NaN),new Lr(e,t,r,s)}function RI(e){return e instanceof Fo||(e=jo(e)),e?(e=e.rgb(),new Lr(e.r,e.g,e.b,e.opacity)):new Lr}function ef(e,t,r,s){return arguments.length===1?RI(e):new Lr(e,t,r,s??1)}function Lr(e,t,r,s){this.r=+e,this.g=+t,this.b=+r,this.opacity=+s}wm(Lr,ef,b_(Fo,{brighter(e){return e=e==null?fc:Math.pow(fc,e),new Lr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?wo:Math.pow(wo,e),new Lr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Lr(pa(this.r),pa(this.g),pa(this.b),mc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ev,formatHex:Ev,formatHex8:$I,formatRgb:Cv,toString:Cv}));function Ev(){return`#${ca(this.r)}${ca(this.g)}${ca(this.b)}`}function $I(){return`#${ca(this.r)}${ca(this.g)}${ca(this.b)}${ca((isNaN(this.opacity)?1:this.opacity)*255)}`}function Cv(){const e=mc(this.opacity);return`${e===1?"rgb(":"rgba("}${pa(this.r)}, ${pa(this.g)}, ${pa(this.b)}${e===1?")":`, ${e})`}`}function mc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pa(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ca(e){return e=pa(e),(e<16?"0":"")+e.toString(16)}function Pv(e,t,r,s){return s<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new bn(e,t,r,s)}function w_(e){if(e instanceof bn)return new bn(e.h,e.s,e.l,e.opacity);if(e instanceof Fo||(e=jo(e)),!e)return new bn;if(e instanceof bn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,s=e.b/255,a=Math.min(t,r,s),i=Math.max(t,r,s),l=NaN,c=i-a,d=(i+a)/2;return c?(t===i?l=(r-s)/c+(r<s)*6:r===i?l=(s-t)/c+2:l=(t-r)/c+4,c/=d<.5?i+a:2-i-a,l*=60):c=d>0&&d<1?0:l,new bn(l,c,d,e.opacity)}function zI(e,t,r,s){return arguments.length===1?w_(e):new bn(e,t,r,s??1)}function bn(e,t,r,s){this.h=+e,this.s=+t,this.l=+r,this.opacity=+s}wm(bn,zI,b_(Fo,{brighter(e){return e=e==null?fc:Math.pow(fc,e),new bn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?wo:Math.pow(wo,e),new bn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*t,a=2*r-s;return new Lr(Bu(e>=240?e-240:e+120,a,s),Bu(e,a,s),Bu(e<120?e+240:e-120,a,s),this.opacity)},clamp(){return new bn(Av(this.h),Ll(this.s),Ll(this.l),mc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=mc(this.opacity);return`${e===1?"hsl(":"hsla("}${Av(this.h)}, ${Ll(this.s)*100}%, ${Ll(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Av(e){return e=(e||0)%360,e<0?e+360:e}function Ll(e){return Math.max(0,Math.min(1,e||0))}function Bu(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const _m=e=>()=>e;function BI(e,t){return function(r){return e+r*t}}function FI(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(s){return Math.pow(e+s*t,r)}}function UI(e){return(e=+e)==1?__:function(t,r){return r-t?FI(t,r,e):_m(isNaN(t)?r:t)}}function __(e,t){var r=t-e;return r?BI(e,r):_m(isNaN(e)?t:e)}const Tv=function e(t){var r=UI(t);function s(a,i){var l=r((a=ef(a)).r,(i=ef(i)).r),c=r(a.g,i.g),d=r(a.b,i.b),f=__(a.opacity,i.opacity);return function(h){return a.r=l(h),a.g=c(h),a.b=d(h),a.opacity=f(h),a+""}}return s.gamma=e,s}(1);function WI(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,s=t.slice(),a;return function(i){for(a=0;a<r;++a)s[a]=e[a]*(1-i)+t[a]*i;return s}}function qI(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function GI(e,t){var r=t?t.length:0,s=e?Math.min(r,e.length):0,a=new Array(s),i=new Array(r),l;for(l=0;l<s;++l)a[l]=ki(e[l],t[l]);for(;l<r;++l)i[l]=t[l];return function(c){for(l=0;l<s;++l)i[l]=a[l](c);return i}}function HI(e,t){var r=new Date;return e=+e,t=+t,function(s){return r.setTime(e*(1-s)+t*s),r}}function pc(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function VI(e,t){var r={},s={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=ki(e[a],t[a]):s[a]=t[a];return function(i){for(a in r)s[a]=r[a](i);return s}}var tf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fu=new RegExp(tf.source,"g");function KI(e){return function(){return e}}function ZI(e){return function(t){return e(t)+""}}function YI(e,t){var r=tf.lastIndex=Fu.lastIndex=0,s,a,i,l=-1,c=[],d=[];for(e=e+"",t=t+"";(s=tf.exec(e))&&(a=Fu.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),c[l]?c[l]+=i:c[++l]=i),(s=s[0])===(a=a[0])?c[l]?c[l]+=a:c[++l]=a:(c[++l]=null,d.push({i:l,x:pc(s,a)})),r=Fu.lastIndex;return r<t.length&&(i=t.slice(r),c[l]?c[l]+=i:c[++l]=i),c.length<2?d[0]?ZI(d[0].x):KI(t):(t=d.length,function(f){for(var h=0,m;h<t;++h)c[(m=d[h]).i]=m.x(f);return c.join("")})}function ki(e,t){var r=typeof t,s;return t==null||r==="boolean"?_m(t):(r==="number"?pc:r==="string"?(s=jo(t))?(t=s,Tv):YI:t instanceof jo?Tv:t instanceof Date?HI:qI(t)?WI:Array.isArray(t)?GI:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?VI:pc)(e,t)}function jm(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function XI(e,t){t===void 0&&(t=e,e=ki);for(var r=0,s=t.length-1,a=t[0],i=new Array(s<0?0:s);r<s;)i[r]=e(a,a=t[++r]);return function(l){var c=Math.max(0,Math.min(s-1,Math.floor(l*=s)));return i[c](l-c)}}function JI(e){return function(){return e}}function gc(e){return+e}var Ov=[0,1];function Cr(e){return e}function rf(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:JI(isNaN(t)?NaN:.5)}function QI(e,t){var r;return e>t&&(r=e,e=t,t=r),function(s){return Math.max(e,Math.min(t,s))}}function e4(e,t,r){var s=e[0],a=e[1],i=t[0],l=t[1];return a<s?(s=rf(a,s),i=r(l,i)):(s=rf(s,a),i=r(i,l)),function(c){return i(s(c))}}function t4(e,t,r){var s=Math.min(e.length,t.length)-1,a=new Array(s),i=new Array(s),l=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<s;)a[l]=rf(e[l],e[l+1]),i[l]=r(t[l],t[l+1]);return function(c){var d=Bo(e,c,1,s)-1;return i[d](a[d](c))}}function Uo(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Nd(){var e=Ov,t=Ov,r=ki,s,a,i,l=Cr,c,d,f;function h(){var g=Math.min(e.length,t.length);return l!==Cr&&(l=QI(e[0],e[g-1])),c=g>2?t4:e4,d=f=null,m}function m(g){return g==null||isNaN(g=+g)?i:(d||(d=c(e.map(s),t,r)))(s(l(g)))}return m.invert=function(g){return l(a((f||(f=c(t,e.map(s),pc)))(g)))},m.domain=function(g){return arguments.length?(e=Array.from(g,gc),h()):e.slice()},m.range=function(g){return arguments.length?(t=Array.from(g),h()):t.slice()},m.rangeRound=function(g){return t=Array.from(g),r=jm,h()},m.clamp=function(g){return arguments.length?(l=g?!0:Cr,h()):l!==Cr},m.interpolate=function(g){return arguments.length?(r=g,h()):r},m.unknown=function(g){return arguments.length?(i=g,m):i},function(g,v){return s=g,a=v,h()}}function Nm(){return Nd()(Cr,Cr)}function r4(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function xc(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,s=e.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+e.slice(r+1)]}function mi(e){return e=xc(Math.abs(e)),e?e[1]:NaN}function n4(e,t){return function(r,s){for(var a=r.length,i=[],l=0,c=e[0],d=0;a>0&&c>0&&(d+c+1>s&&(c=Math.max(1,s-d)),i.push(r.substring(a-=c,a+c)),!((d+=c+1)>s));)c=e[l=(l+1)%e.length];return i.reverse().join(t)}}function s4(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var a4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function No(e){if(!(t=a4.exec(e)))throw new Error("invalid format: "+e);var t;return new km({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}No.prototype=km.prototype;function km(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}km.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function i4(e){e:for(var t=e.length,r=1,s=-1,a;r<t;++r)switch(e[r]){case".":s=a=r;break;case"0":s===0&&(s=r),a=r;break;default:if(!+e[r])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(a+1):e}var j_;function o4(e,t){var r=xc(e,t);if(!r)return e+"";var s=r[0],a=r[1],i=a-(j_=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,l=s.length;return i===l?s:i>l?s+new Array(i-l+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+xc(e,Math.max(0,t+i-1))[0]}function Mv(e,t){var r=xc(e,t);if(!r)return e+"";var s=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+s:s.length>a+1?s.slice(0,a+1)+"."+s.slice(a+1):s+new Array(a-s.length+2).join("0")}const Iv={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:r4,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Mv(e*100,t),r:Mv,s:o4,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Lv(e){return e}var Dv=Array.prototype.map,Rv=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function l4(e){var t=e.grouping===void 0||e.thousands===void 0?Lv:n4(Dv.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Lv:s4(Dv.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function f(m){m=No(m);var g=m.fill,v=m.align,j=m.sign,_=m.symbol,y=m.zero,w=m.width,k=m.comma,N=m.precision,P=m.trim,O=m.type;O==="n"?(k=!0,O="g"):Iv[O]||(N===void 0&&(N=12),P=!0,O="g"),(y||g==="0"&&v==="=")&&(y=!0,g="0",v="=");var T=_==="$"?r:_==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",A=_==="$"?s:/[%p]/.test(O)?l:"",C=Iv[O],E=/[defgprs%]/.test(O);N=N===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function D($){var M=T,z=A,K,W,U;if(O==="c")z=C($)+z,$="";else{$=+$;var Y=$<0||1/$<0;if($=isNaN($)?d:C(Math.abs($),N),P&&($=i4($)),Y&&+$==0&&j!=="+"&&(Y=!1),M=(Y?j==="("?j:c:j==="-"||j==="("?"":j)+M,z=(O==="s"?Rv[8+j_/3]:"")+z+(Y&&j==="("?")":""),E){for(K=-1,W=$.length;++K<W;)if(U=$.charCodeAt(K),48>U||U>57){z=(U===46?a+$.slice(K+1):$.slice(K))+z,$=$.slice(0,K);break}}}k&&!y&&($=t($,1/0));var R=M.length+$.length+z.length,H=R<w?new Array(w-R+1).join(g):"";switch(k&&y&&($=t(H+$,H.length?w-z.length:1/0),H=""),v){case"<":$=M+$+z+H;break;case"=":$=M+H+$+z;break;case"^":$=H.slice(0,R=H.length>>1)+M+$+z+H.slice(R);break;default:$=H+M+$+z;break}return i($)}return D.toString=function(){return m+""},D}function h(m,g){var v=f((m=No(m),m.type="f",m)),j=Math.max(-8,Math.min(8,Math.floor(mi(g)/3)))*3,_=Math.pow(10,-j),y=Rv[8+j/3];return function(w){return v(_*w)+y}}return{format:f,formatPrefix:h}}var Dl,Sm,N_;c4({thousands:",",grouping:[3],currency:["$",""]});function c4(e){return Dl=l4(e),Sm=Dl.format,N_=Dl.formatPrefix,Dl}function d4(e){return Math.max(0,-mi(Math.abs(e)))}function u4(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mi(t)/3)))*3-mi(Math.abs(e)))}function h4(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,mi(t)-mi(e))+1}function k_(e,t,r,s){var a=Jh(e,t,r),i;switch(s=No(s??",f"),s.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=u4(a,l))&&(s.precision=i),N_(s,l)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=h4(a,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=d4(a))&&(s.precision=i-(s.type==="%")*2);break}}return Sm(s)}function Rs(e){var t=e.domain;return e.ticks=function(r){var s=t();return Yh(s[0],s[s.length-1],r??10)},e.tickFormat=function(r,s){var a=t();return k_(a[0],a[a.length-1],r??10,s)},e.nice=function(r){r==null&&(r=10);var s=t(),a=0,i=s.length-1,l=s[a],c=s[i],d,f,h=10;for(c<l&&(f=l,l=c,c=f,f=a,a=i,i=f);h-- >0;){if(f=Xh(l,c,r),f===d)return s[a]=l,s[i]=c,t(s);if(f>0)l=Math.floor(l/f)*f,c=Math.ceil(c/f)*f;else if(f<0)l=Math.ceil(l*f)/f,c=Math.floor(c*f)/f;else break;d=f}return e},e}function S_(){var e=Nm();return e.copy=function(){return Uo(e,S_())},fn.apply(e,arguments),Rs(e)}function E_(e){var t;function r(s){return s==null||isNaN(s=+s)?t:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(e=Array.from(s,gc),r):e.slice()},r.unknown=function(s){return arguments.length?(t=s,r):t},r.copy=function(){return E_(e).unknown(t)},e=arguments.length?Array.from(e,gc):[0,1],Rs(r)}function C_(e,t){e=e.slice();var r=0,s=e.length-1,a=e[r],i=e[s],l;return i<a&&(l=r,r=s,s=l,l=a,a=i,i=l),e[r]=t.floor(a),e[s]=t.ceil(i),e}function $v(e){return Math.log(e)}function zv(e){return Math.exp(e)}function f4(e){return-Math.log(-e)}function m4(e){return-Math.exp(-e)}function p4(e){return isFinite(e)?+("1e"+e):e<0?0:e}function g4(e){return e===10?p4:e===Math.E?Math.exp:t=>Math.pow(e,t)}function x4(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Bv(e){return(t,r)=>-e(-t,r)}function Em(e){const t=e($v,zv),r=t.domain;let s=10,a,i;function l(){return a=x4(s),i=g4(s),r()[0]<0?(a=Bv(a),i=Bv(i),e(f4,m4)):e($v,zv),t}return t.base=function(c){return arguments.length?(s=+c,l()):s},t.domain=function(c){return arguments.length?(r(c),l()):r()},t.ticks=c=>{const d=r();let f=d[0],h=d[d.length-1];const m=h<f;m&&([f,h]=[h,f]);let g=a(f),v=a(h),j,_;const y=c==null?10:+c;let w=[];if(!(s%1)&&v-g<y){if(g=Math.floor(g),v=Math.ceil(v),f>0){for(;g<=v;++g)for(j=1;j<s;++j)if(_=g<0?j/i(-g):j*i(g),!(_<f)){if(_>h)break;w.push(_)}}else for(;g<=v;++g)for(j=s-1;j>=1;--j)if(_=g>0?j/i(-g):j*i(g),!(_<f)){if(_>h)break;w.push(_)}w.length*2<y&&(w=Yh(f,h,y))}else w=Yh(g,v,Math.min(v-g,y)).map(i);return m?w.reverse():w},t.tickFormat=(c,d)=>{if(c==null&&(c=10),d==null&&(d=s===10?"s":","),typeof d!="function"&&(!(s%1)&&(d=No(d)).precision==null&&(d.trim=!0),d=Sm(d)),c===1/0)return d;const f=Math.max(1,s*c/t.ticks().length);return h=>{let m=h/i(Math.round(a(h)));return m*s<s-.5&&(m*=s),m<=f?d(h):""}},t.nice=()=>r(C_(r(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),t}function P_(){const e=Em(Nd()).domain([1,10]);return e.copy=()=>Uo(e,P_()).base(e.base()),fn.apply(e,arguments),e}function Fv(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Uv(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Cm(e){var t=1,r=e(Fv(t),Uv(t));return r.constant=function(s){return arguments.length?e(Fv(t=+s),Uv(t)):t},Rs(r)}function A_(){var e=Cm(Nd());return e.copy=function(){return Uo(e,A_()).constant(e.constant())},fn.apply(e,arguments)}function Wv(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function v4(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function y4(e){return e<0?-e*e:e*e}function Pm(e){var t=e(Cr,Cr),r=1;function s(){return r===1?e(Cr,Cr):r===.5?e(v4,y4):e(Wv(r),Wv(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,s()):r},Rs(t)}function Am(){var e=Pm(Nd());return e.copy=function(){return Uo(e,Am()).exponent(e.exponent())},fn.apply(e,arguments),e}function b4(){return Am.apply(null,arguments).exponent(.5)}function qv(e){return Math.sign(e)*e*e}function w4(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function T_(){var e=Nm(),t=[0,1],r=!1,s;function a(i){var l=w4(e(i));return isNaN(l)?s:r?Math.round(l):l}return a.invert=function(i){return e.invert(qv(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,gc)).map(qv)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.copy=function(){return T_(e.domain(),t).round(r).clamp(e.clamp()).unknown(s)},fn.apply(a,arguments),Rs(a)}function O_(){var e=[],t=[],r=[],s;function a(){var l=0,c=Math.max(1,t.length);for(r=new Array(c-1);++l<c;)r[l-1]=kI(e,l/c);return i}function i(l){return l==null||isNaN(l=+l)?s:t[Bo(r,l)]}return i.invertExtent=function(l){var c=t.indexOf(l);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let c of l)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(Cs),a()},i.range=function(l){return arguments.length?(t=Array.from(l),a()):t.slice()},i.unknown=function(l){return arguments.length?(s=l,i):s},i.quantiles=function(){return r.slice()},i.copy=function(){return O_().domain(e).range(t).unknown(s)},fn.apply(i,arguments)}function M_(){var e=0,t=1,r=1,s=[.5],a=[0,1],i;function l(d){return d!=null&&d<=d?a[Bo(s,d,0,r)]:i}function c(){var d=-1;for(s=new Array(r);++d<r;)s[d]=((d+1)*t-(d-r)*e)/(r+1);return l}return l.domain=function(d){return arguments.length?([e,t]=d,e=+e,t=+t,c()):[e,t]},l.range=function(d){return arguments.length?(r=(a=Array.from(d)).length-1,c()):a.slice()},l.invertExtent=function(d){var f=a.indexOf(d);return f<0?[NaN,NaN]:f<1?[e,s[0]]:f>=r?[s[r-1],t]:[s[f-1],s[f]]},l.unknown=function(d){return arguments.length&&(i=d),l},l.thresholds=function(){return s.slice()},l.copy=function(){return M_().domain([e,t]).range(a).unknown(i)},fn.apply(Rs(l),arguments)}function I_(){var e=[.5],t=[0,1],r,s=1;function a(i){return i!=null&&i<=i?t[Bo(e,i,0,s)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return I_().domain(e).range(t).unknown(r)},fn.apply(a,arguments)}const Uu=new Date,Wu=new Date;function Qt(e,t,r,s){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const l=a(i),c=a.ceil(i);return i-l<c-i?l:c},a.offset=(i,l)=>(t(i=new Date(+i),l==null?1:Math.floor(l)),i),a.range=(i,l,c)=>{const d=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<l)||!(c>0))return d;let f;do d.push(f=new Date(+i)),t(i,c),e(i);while(f<i&&i<l);return d},a.filter=i=>Qt(l=>{if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},(l,c)=>{if(l>=l)if(c<0)for(;++c<=0;)for(;t(l,-1),!i(l););else for(;--c>=0;)for(;t(l,1),!i(l););}),r&&(a.count=(i,l)=>(Uu.setTime(+i),Wu.setTime(+l),e(Uu),e(Wu),Math.floor(r(Uu,Wu))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(s?l=>s(l)%i===0:l=>a.count(0,l)%i===0):a)),a}const vc=Qt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);vc.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Qt(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):vc);vc.range;const Jn=1e3,ln=Jn*60,Qn=ln*60,ls=Qn*24,Tm=ls*7,Gv=ls*30,qu=ls*365,da=Qt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Jn)},(e,t)=>(t-e)/Jn,e=>e.getUTCSeconds());da.range;const Om=Qt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jn)},(e,t)=>{e.setTime(+e+t*ln)},(e,t)=>(t-e)/ln,e=>e.getMinutes());Om.range;const Mm=Qt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ln)},(e,t)=>(t-e)/ln,e=>e.getUTCMinutes());Mm.range;const Im=Qt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jn-e.getMinutes()*ln)},(e,t)=>{e.setTime(+e+t*Qn)},(e,t)=>(t-e)/Qn,e=>e.getHours());Im.range;const Lm=Qt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Qn)},(e,t)=>(t-e)/Qn,e=>e.getUTCHours());Lm.range;const Wo=Qt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ln)/ls,e=>e.getDate()-1);Wo.range;const kd=Qt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ls,e=>e.getUTCDate()-1);kd.range;const L_=Qt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ls,e=>Math.floor(e/ls));L_.range;function ka(e){return Qt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ln)/Tm)}const Sd=ka(0),yc=ka(1),_4=ka(2),j4=ka(3),pi=ka(4),N4=ka(5),k4=ka(6);Sd.range;yc.range;_4.range;j4.range;pi.range;N4.range;k4.range;function Sa(e){return Qt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Tm)}const Ed=Sa(0),bc=Sa(1),S4=Sa(2),E4=Sa(3),gi=Sa(4),C4=Sa(5),P4=Sa(6);Ed.range;bc.range;S4.range;E4.range;gi.range;C4.range;P4.range;const Dm=Qt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Dm.range;const Rm=Qt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Rm.range;const cs=Qt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());cs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Qt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});cs.range;const ds=Qt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ds.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Qt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ds.range;function D_(e,t,r,s,a,i){const l=[[da,1,Jn],[da,5,5*Jn],[da,15,15*Jn],[da,30,30*Jn],[i,1,ln],[i,5,5*ln],[i,15,15*ln],[i,30,30*ln],[a,1,Qn],[a,3,3*Qn],[a,6,6*Qn],[a,12,12*Qn],[s,1,ls],[s,2,2*ls],[r,1,Tm],[t,1,Gv],[t,3,3*Gv],[e,1,qu]];function c(f,h,m){const g=h<f;g&&([f,h]=[h,f]);const v=m&&typeof m.range=="function"?m:d(f,h,m),j=v?v.range(f,+h+1):[];return g?j.reverse():j}function d(f,h,m){const g=Math.abs(h-f)/m,v=vm(([,,y])=>y).right(l,g);if(v===l.length)return e.every(Jh(f/qu,h/qu,m));if(v===0)return vc.every(Math.max(Jh(f,h,m),1));const[j,_]=l[g/l[v-1][2]<l[v][2]/g?v-1:v];return j.every(_)}return[c,d]}const[A4,T4]=D_(ds,Rm,Ed,L_,Lm,Mm),[O4,M4]=D_(cs,Dm,Sd,Wo,Im,Om);function Gu(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Hu(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ji(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function I4(e){var t=e.dateTime,r=e.date,s=e.time,a=e.periods,i=e.days,l=e.shortDays,c=e.months,d=e.shortMonths,f=Qi(a),h=eo(a),m=Qi(i),g=eo(i),v=Qi(l),j=eo(l),_=Qi(c),y=eo(c),w=Qi(d),k=eo(d),N={a:Y,A:R,b:H,B:J,c:null,d:Xv,e:Xv,f:nL,g:fL,G:pL,H:eL,I:tL,j:rL,L:R_,m:sL,M:aL,p:F,q:V,Q:e0,s:t0,S:iL,u:oL,U:lL,V:cL,w:dL,W:uL,x:null,X:null,y:hL,Y:mL,Z:gL,"%":Qv},P={a:te,A:Z,b:ie,B:fe,c:null,d:Jv,e:Jv,f:bL,g:AL,G:OL,H:xL,I:vL,j:yL,L:z_,m:wL,M:_L,p:be,q:xe,Q:e0,s:t0,S:jL,u:NL,U:kL,V:SL,w:EL,W:CL,x:null,X:null,y:PL,Y:TL,Z:ML,"%":Qv},O={a:D,A:$,b:M,B:z,c:K,d:Zv,e:Zv,f:Y4,g:Kv,G:Vv,H:Yv,I:Yv,j:H4,L:Z4,m:G4,M:V4,p:E,q:q4,Q:J4,s:Q4,S:K4,u:z4,U:B4,V:F4,w:$4,W:U4,x:W,X:U,y:Kv,Y:Vv,Z:W4,"%":X4};N.x=T(r,N),N.X=T(s,N),N.c=T(t,N),P.x=T(r,P),P.X=T(s,P),P.c=T(t,P);function T(oe,de){return function(ce){var ne=[],Oe=-1,Ce=0,$e=oe.length,Ne,G,se;for(ce instanceof Date||(ce=new Date(+ce));++Oe<$e;)oe.charCodeAt(Oe)===37&&(ne.push(oe.slice(Ce,Oe)),(G=Hv[Ne=oe.charAt(++Oe)])!=null?Ne=oe.charAt(++Oe):G=Ne==="e"?" ":"0",(se=de[Ne])&&(Ne=se(ce,G)),ne.push(Ne),Ce=Oe+1);return ne.push(oe.slice(Ce,Oe)),ne.join("")}}function A(oe,de){return function(ce){var ne=Ji(1900,void 0,1),Oe=C(ne,oe,ce+="",0),Ce,$e;if(Oe!=ce.length)return null;if("Q"in ne)return new Date(ne.Q);if("s"in ne)return new Date(ne.s*1e3+("L"in ne?ne.L:0));if(de&&!("Z"in ne)&&(ne.Z=0),"p"in ne&&(ne.H=ne.H%12+ne.p*12),ne.m===void 0&&(ne.m="q"in ne?ne.q:0),"V"in ne){if(ne.V<1||ne.V>53)return null;"w"in ne||(ne.w=1),"Z"in ne?(Ce=Hu(Ji(ne.y,0,1)),$e=Ce.getUTCDay(),Ce=$e>4||$e===0?bc.ceil(Ce):bc(Ce),Ce=kd.offset(Ce,(ne.V-1)*7),ne.y=Ce.getUTCFullYear(),ne.m=Ce.getUTCMonth(),ne.d=Ce.getUTCDate()+(ne.w+6)%7):(Ce=Gu(Ji(ne.y,0,1)),$e=Ce.getDay(),Ce=$e>4||$e===0?yc.ceil(Ce):yc(Ce),Ce=Wo.offset(Ce,(ne.V-1)*7),ne.y=Ce.getFullYear(),ne.m=Ce.getMonth(),ne.d=Ce.getDate()+(ne.w+6)%7)}else("W"in ne||"U"in ne)&&("w"in ne||(ne.w="u"in ne?ne.u%7:"W"in ne?1:0),$e="Z"in ne?Hu(Ji(ne.y,0,1)).getUTCDay():Gu(Ji(ne.y,0,1)).getDay(),ne.m=0,ne.d="W"in ne?(ne.w+6)%7+ne.W*7-($e+5)%7:ne.w+ne.U*7-($e+6)%7);return"Z"in ne?(ne.H+=ne.Z/100|0,ne.M+=ne.Z%100,Hu(ne)):Gu(ne)}}function C(oe,de,ce,ne){for(var Oe=0,Ce=de.length,$e=ce.length,Ne,G;Oe<Ce;){if(ne>=$e)return-1;if(Ne=de.charCodeAt(Oe++),Ne===37){if(Ne=de.charAt(Oe++),G=O[Ne in Hv?de.charAt(Oe++):Ne],!G||(ne=G(oe,ce,ne))<0)return-1}else if(Ne!=ce.charCodeAt(ne++))return-1}return ne}function E(oe,de,ce){var ne=f.exec(de.slice(ce));return ne?(oe.p=h.get(ne[0].toLowerCase()),ce+ne[0].length):-1}function D(oe,de,ce){var ne=v.exec(de.slice(ce));return ne?(oe.w=j.get(ne[0].toLowerCase()),ce+ne[0].length):-1}function $(oe,de,ce){var ne=m.exec(de.slice(ce));return ne?(oe.w=g.get(ne[0].toLowerCase()),ce+ne[0].length):-1}function M(oe,de,ce){var ne=w.exec(de.slice(ce));return ne?(oe.m=k.get(ne[0].toLowerCase()),ce+ne[0].length):-1}function z(oe,de,ce){var ne=_.exec(de.slice(ce));return ne?(oe.m=y.get(ne[0].toLowerCase()),ce+ne[0].length):-1}function K(oe,de,ce){return C(oe,t,de,ce)}function W(oe,de,ce){return C(oe,r,de,ce)}function U(oe,de,ce){return C(oe,s,de,ce)}function Y(oe){return l[oe.getDay()]}function R(oe){return i[oe.getDay()]}function H(oe){return d[oe.getMonth()]}function J(oe){return c[oe.getMonth()]}function F(oe){return a[+(oe.getHours()>=12)]}function V(oe){return 1+~~(oe.getMonth()/3)}function te(oe){return l[oe.getUTCDay()]}function Z(oe){return i[oe.getUTCDay()]}function ie(oe){return d[oe.getUTCMonth()]}function fe(oe){return c[oe.getUTCMonth()]}function be(oe){return a[+(oe.getUTCHours()>=12)]}function xe(oe){return 1+~~(oe.getUTCMonth()/3)}return{format:function(oe){var de=T(oe+="",N);return de.toString=function(){return oe},de},parse:function(oe){var de=A(oe+="",!1);return de.toString=function(){return oe},de},utcFormat:function(oe){var de=T(oe+="",P);return de.toString=function(){return oe},de},utcParse:function(oe){var de=A(oe+="",!0);return de.toString=function(){return oe},de}}}var Hv={"-":"",_:" ",0:"0"},lr=/^\s*\d+/,L4=/^%/,D4=/[\\^$*+?|[\]().{}]/g;function ot(e,t,r){var s=e<0?"-":"",a=(s?-e:e)+"",i=a.length;return s+(i<r?new Array(r-i+1).join(t)+a:a)}function R4(e){return e.replace(D4,"\\$&")}function Qi(e){return new RegExp("^(?:"+e.map(R4).join("|")+")","i")}function eo(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function $4(e,t,r){var s=lr.exec(t.slice(r,r+1));return s?(e.w=+s[0],r+s[0].length):-1}function z4(e,t,r){var s=lr.exec(t.slice(r,r+1));return s?(e.u=+s[0],r+s[0].length):-1}function B4(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.U=+s[0],r+s[0].length):-1}function F4(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.V=+s[0],r+s[0].length):-1}function U4(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.W=+s[0],r+s[0].length):-1}function Vv(e,t,r){var s=lr.exec(t.slice(r,r+4));return s?(e.y=+s[0],r+s[0].length):-1}function Kv(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function W4(e,t,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function q4(e,t,r){var s=lr.exec(t.slice(r,r+1));return s?(e.q=s[0]*3-3,r+s[0].length):-1}function G4(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.m=s[0]-1,r+s[0].length):-1}function Zv(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.d=+s[0],r+s[0].length):-1}function H4(e,t,r){var s=lr.exec(t.slice(r,r+3));return s?(e.m=0,e.d=+s[0],r+s[0].length):-1}function Yv(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.H=+s[0],r+s[0].length):-1}function V4(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.M=+s[0],r+s[0].length):-1}function K4(e,t,r){var s=lr.exec(t.slice(r,r+2));return s?(e.S=+s[0],r+s[0].length):-1}function Z4(e,t,r){var s=lr.exec(t.slice(r,r+3));return s?(e.L=+s[0],r+s[0].length):-1}function Y4(e,t,r){var s=lr.exec(t.slice(r,r+6));return s?(e.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function X4(e,t,r){var s=L4.exec(t.slice(r,r+1));return s?r+s[0].length:-1}function J4(e,t,r){var s=lr.exec(t.slice(r));return s?(e.Q=+s[0],r+s[0].length):-1}function Q4(e,t,r){var s=lr.exec(t.slice(r));return s?(e.s=+s[0],r+s[0].length):-1}function Xv(e,t){return ot(e.getDate(),t,2)}function eL(e,t){return ot(e.getHours(),t,2)}function tL(e,t){return ot(e.getHours()%12||12,t,2)}function rL(e,t){return ot(1+Wo.count(cs(e),e),t,3)}function R_(e,t){return ot(e.getMilliseconds(),t,3)}function nL(e,t){return R_(e,t)+"000"}function sL(e,t){return ot(e.getMonth()+1,t,2)}function aL(e,t){return ot(e.getMinutes(),t,2)}function iL(e,t){return ot(e.getSeconds(),t,2)}function oL(e){var t=e.getDay();return t===0?7:t}function lL(e,t){return ot(Sd.count(cs(e)-1,e),t,2)}function $_(e){var t=e.getDay();return t>=4||t===0?pi(e):pi.ceil(e)}function cL(e,t){return e=$_(e),ot(pi.count(cs(e),e)+(cs(e).getDay()===4),t,2)}function dL(e){return e.getDay()}function uL(e,t){return ot(yc.count(cs(e)-1,e),t,2)}function hL(e,t){return ot(e.getFullYear()%100,t,2)}function fL(e,t){return e=$_(e),ot(e.getFullYear()%100,t,2)}function mL(e,t){return ot(e.getFullYear()%1e4,t,4)}function pL(e,t){var r=e.getDay();return e=r>=4||r===0?pi(e):pi.ceil(e),ot(e.getFullYear()%1e4,t,4)}function gL(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ot(t/60|0,"0",2)+ot(t%60,"0",2)}function Jv(e,t){return ot(e.getUTCDate(),t,2)}function xL(e,t){return ot(e.getUTCHours(),t,2)}function vL(e,t){return ot(e.getUTCHours()%12||12,t,2)}function yL(e,t){return ot(1+kd.count(ds(e),e),t,3)}function z_(e,t){return ot(e.getUTCMilliseconds(),t,3)}function bL(e,t){return z_(e,t)+"000"}function wL(e,t){return ot(e.getUTCMonth()+1,t,2)}function _L(e,t){return ot(e.getUTCMinutes(),t,2)}function jL(e,t){return ot(e.getUTCSeconds(),t,2)}function NL(e){var t=e.getUTCDay();return t===0?7:t}function kL(e,t){return ot(Ed.count(ds(e)-1,e),t,2)}function B_(e){var t=e.getUTCDay();return t>=4||t===0?gi(e):gi.ceil(e)}function SL(e,t){return e=B_(e),ot(gi.count(ds(e),e)+(ds(e).getUTCDay()===4),t,2)}function EL(e){return e.getUTCDay()}function CL(e,t){return ot(bc.count(ds(e)-1,e),t,2)}function PL(e,t){return ot(e.getUTCFullYear()%100,t,2)}function AL(e,t){return e=B_(e),ot(e.getUTCFullYear()%100,t,2)}function TL(e,t){return ot(e.getUTCFullYear()%1e4,t,4)}function OL(e,t){var r=e.getUTCDay();return e=r>=4||r===0?gi(e):gi.ceil(e),ot(e.getUTCFullYear()%1e4,t,4)}function ML(){return"+0000"}function Qv(){return"%"}function e0(e){return+e}function t0(e){return Math.floor(+e/1e3)}var Ha,F_,U_;IL({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function IL(e){return Ha=I4(e),F_=Ha.format,Ha.parse,U_=Ha.utcFormat,Ha.utcParse,Ha}function LL(e){return new Date(e)}function DL(e){return e instanceof Date?+e:+new Date(+e)}function $m(e,t,r,s,a,i,l,c,d,f){var h=Nm(),m=h.invert,g=h.domain,v=f(".%L"),j=f(":%S"),_=f("%I:%M"),y=f("%I %p"),w=f("%a %d"),k=f("%b %d"),N=f("%B"),P=f("%Y");function O(T){return(d(T)<T?v:c(T)<T?j:l(T)<T?_:i(T)<T?y:s(T)<T?a(T)<T?w:k:r(T)<T?N:P)(T)}return h.invert=function(T){return new Date(m(T))},h.domain=function(T){return arguments.length?g(Array.from(T,DL)):g().map(LL)},h.ticks=function(T){var A=g();return e(A[0],A[A.length-1],T??10)},h.tickFormat=function(T,A){return A==null?O:f(A)},h.nice=function(T){var A=g();return(!T||typeof T.range!="function")&&(T=t(A[0],A[A.length-1],T??10)),T?g(C_(A,T)):h},h.copy=function(){return Uo(h,$m(e,t,r,s,a,i,l,c,d,f))},h}function RL(){return fn.apply($m(O4,M4,cs,Dm,Sd,Wo,Im,Om,da,F_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function $L(){return fn.apply($m(A4,T4,ds,Rm,Ed,kd,Lm,Mm,da,U_).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Cd(){var e=0,t=1,r,s,a,i,l=Cr,c=!1,d;function f(m){return m==null||isNaN(m=+m)?d:l(a===0?.5:(m=(i(m)-r)*a,c?Math.max(0,Math.min(1,m)):m))}f.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),s=i(t=+t),a=r===s?0:1/(s-r),f):[e,t]},f.clamp=function(m){return arguments.length?(c=!!m,f):c},f.interpolator=function(m){return arguments.length?(l=m,f):l};function h(m){return function(g){var v,j;return arguments.length?([v,j]=g,l=m(v,j),f):[l(0),l(1)]}}return f.range=h(ki),f.rangeRound=h(jm),f.unknown=function(m){return arguments.length?(d=m,f):d},function(m){return i=m,r=m(e),s=m(t),a=r===s?0:1/(s-r),f}}function $s(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function W_(){var e=Rs(Cd()(Cr));return e.copy=function(){return $s(e,W_())},ps.apply(e,arguments)}function q_(){var e=Em(Cd()).domain([1,10]);return e.copy=function(){return $s(e,q_()).base(e.base())},ps.apply(e,arguments)}function G_(){var e=Cm(Cd());return e.copy=function(){return $s(e,G_()).constant(e.constant())},ps.apply(e,arguments)}function zm(){var e=Pm(Cd());return e.copy=function(){return $s(e,zm()).exponent(e.exponent())},ps.apply(e,arguments)}function zL(){return zm.apply(null,arguments).exponent(.5)}function H_(){var e=[],t=Cr;function r(s){if(s!=null&&!isNaN(s=+s))return t((Bo(e,s,1)-1)/(e.length-1))}return r.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Cs),r},r.interpolator=function(s){return arguments.length?(t=s,r):t},r.range=function(){return e.map((s,a)=>t(a/(e.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(a,i)=>NI(e,i/s))},r.copy=function(){return H_(t).domain(e)},ps.apply(r,arguments)}function Pd(){var e=0,t=.5,r=1,s=1,a,i,l,c,d,f=Cr,h,m=!1,g;function v(_){return isNaN(_=+_)?g:(_=.5+((_=+h(_))-i)*(s*_<s*i?c:d),f(m?Math.max(0,Math.min(1,_)):_))}v.domain=function(_){return arguments.length?([e,t,r]=_,a=h(e=+e),i=h(t=+t),l=h(r=+r),c=a===i?0:.5/(i-a),d=i===l?0:.5/(l-i),s=i<a?-1:1,v):[e,t,r]},v.clamp=function(_){return arguments.length?(m=!!_,v):m},v.interpolator=function(_){return arguments.length?(f=_,v):f};function j(_){return function(y){var w,k,N;return arguments.length?([w,k,N]=y,f=XI(_,[w,k,N]),v):[f(0),f(.5),f(1)]}}return v.range=j(ki),v.rangeRound=j(jm),v.unknown=function(_){return arguments.length?(g=_,v):g},function(_){return h=_,a=_(e),i=_(t),l=_(r),c=a===i?0:.5/(i-a),d=i===l?0:.5/(l-i),s=i<a?-1:1,v}}function V_(){var e=Rs(Pd()(Cr));return e.copy=function(){return $s(e,V_())},ps.apply(e,arguments)}function K_(){var e=Em(Pd()).domain([.1,1,10]);return e.copy=function(){return $s(e,K_()).base(e.base())},ps.apply(e,arguments)}function Z_(){var e=Cm(Pd());return e.copy=function(){return $s(e,Z_()).constant(e.constant())},ps.apply(e,arguments)}function Bm(){var e=Pm(Pd());return e.copy=function(){return $s(e,Bm()).exponent(e.exponent())},ps.apply(e,arguments)}function BL(){return Bm.apply(null,arguments).exponent(.5)}const so=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:bm,scaleDiverging:V_,scaleDivergingLog:K_,scaleDivergingPow:Bm,scaleDivergingSqrt:BL,scaleDivergingSymlog:Z_,scaleIdentity:E_,scaleImplicit:Qh,scaleLinear:S_,scaleLog:P_,scaleOrdinal:ym,scalePoint:EI,scalePow:Am,scaleQuantile:O_,scaleQuantize:M_,scaleRadial:T_,scaleSequential:W_,scaleSequentialLog:q_,scaleSequentialPow:zm,scaleSequentialQuantile:H_,scaleSequentialSqrt:zL,scaleSequentialSymlog:G_,scaleSqrt:b4,scaleSymlog:A_,scaleThreshold:I_,scaleTime:RL,scaleUtc:$L,tickFormat:k_},Symbol.toStringTag,{value:"Module"}));var zs=e=>e.chartData,Fm=ee([zs],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Ad=(e,t,r,s)=>s?Fm(e):zs(e);function xi(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(gr(t)&&gr(r))return!0}return!1}function r0(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function FL(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,s]=e,a,i;if(gr(r))a=r;else if(typeof r=="function")return;if(gr(s))i=s;else if(typeof s=="function")return;var l=[a,i];if(xi(l))return l}}function UL(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var s=e(t,r);if(xi(s))return r0(s,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,l,c;if(a==="auto")t!=null&&(l=Math.min(...t));else if(Pe(a))l=a;else if(typeof a=="function")try{t!=null&&(l=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&Yx.test(a)){var d=Yx.exec(a);if(d==null||t==null)l=void 0;else{var f=+d[1];l=t[0]-f}}else l=t==null?void 0:t[0];if(i==="auto")t!=null&&(c=Math.max(...t));else if(Pe(i))c=i;else if(typeof i=="function")try{t!=null&&(c=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&Xx.test(i)){var h=Xx.exec(i);if(h==null||t==null)c=void 0;else{var m=+h[1];c=t[1]+m}}else c=t==null?void 0:t[1];var g=[l,c];if(xi(g))return t==null?g:r0(g,t,r)}}}var Si=1e9,WL={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Wm,kt=!0,un="[DecimalError] ",ga=un+"Invalid argument: ",Um=un+"Exponent out of range: ",Ei=Math.floor,ta=Math.pow,qL=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,qr,ar=1e7,_t=7,Y_=9007199254740991,wc=Ei(Y_/_t),je={};je.absoluteValue=je.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};je.comparedTo=je.cmp=function(e){var t,r,s,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,a=e.d.length,t=0,r=s<a?s:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===a?0:s>a^i.s<0?1:-1};je.decimalPlaces=je.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*_t;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};je.dividedBy=je.div=function(e){return rs(this,new this.constructor(e))};je.dividedToIntegerBy=je.idiv=function(e){var t=this,r=t.constructor;return ft(rs(t,new r(e),0,1),r.precision)};je.equals=je.eq=function(e){return!this.cmp(e)};je.exponent=function(){return Ht(this)};je.greaterThan=je.gt=function(e){return this.cmp(e)>0};je.greaterThanOrEqualTo=je.gte=function(e){return this.cmp(e)>=0};je.isInteger=je.isint=function(){return this.e>this.d.length-2};je.isNegative=je.isneg=function(){return this.s<0};je.isPositive=je.ispos=function(){return this.s>0};je.isZero=function(){return this.s===0};je.lessThan=je.lt=function(e){return this.cmp(e)<0};je.lessThanOrEqualTo=je.lte=function(e){return this.cmp(e)<1};je.logarithm=je.log=function(e){var t,r=this,s=r.constructor,a=s.precision,i=a+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(qr))throw Error(un+"NaN");if(r.s<1)throw Error(un+(r.s?"NaN":"-Infinity"));return r.eq(qr)?new s(0):(kt=!1,t=rs(ko(r,i),ko(e,i),i),kt=!0,ft(t,a))};je.minus=je.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Q_(t,e):X_(t,(e.s=-e.s,e))};je.modulo=je.mod=function(e){var t,r=this,s=r.constructor,a=s.precision;if(e=new s(e),!e.s)throw Error(un+"NaN");return r.s?(kt=!1,t=rs(r,e,0,1).times(e),kt=!0,r.minus(t)):ft(new s(r),a)};je.naturalExponential=je.exp=function(){return J_(this)};je.naturalLogarithm=je.ln=function(){return ko(this)};je.negated=je.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};je.plus=je.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?X_(t,e):Q_(t,(e.s=-e.s,e))};je.precision=je.sd=function(e){var t,r,s,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ga+e);if(t=Ht(a)+1,s=a.d.length-1,r=s*_t+1,s=a.d[s],s){for(;s%10==0;s/=10)r--;for(s=a.d[0];s>=10;s/=10)r++}return e&&t>r?t:r};je.squareRoot=je.sqrt=function(){var e,t,r,s,a,i,l,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(un+"NaN")}for(e=Ht(c),kt=!1,a=Math.sqrt(+c),a==0||a==1/0?(t=An(c.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Ei((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new d(t)):s=new d(a.toString()),r=d.precision,a=l=r+3;;)if(i=s,s=i.plus(rs(c,i,l+2)).times(.5),An(i.d).slice(0,l)===(t=An(s.d)).slice(0,l)){if(t=t.slice(l-3,l+1),a==l&&t=="4999"){if(ft(i,r+1,0),i.times(i).eq(c)){s=i;break}}else if(t!="9999")break;l+=4}return kt=!0,ft(s,r)};je.times=je.mul=function(e){var t,r,s,a,i,l,c,d,f,h=this,m=h.constructor,g=h.d,v=(e=new m(e)).d;if(!h.s||!e.s)return new m(0);for(e.s*=h.s,r=h.e+e.e,d=g.length,f=v.length,d<f&&(i=g,g=v,v=i,l=d,d=f,f=l),i=[],l=d+f,s=l;s--;)i.push(0);for(s=f;--s>=0;){for(t=0,a=d+s;a>s;)c=i[a]+v[s]*g[a-s-1]+t,i[a--]=c%ar|0,t=c/ar|0;i[a]=(i[a]+t)%ar|0}for(;!i[--l];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,kt?ft(e,m.precision):e};je.toDecimalPlaces=je.todp=function(e,t){var r=this,s=r.constructor;return r=new s(r),e===void 0?r:($n(e,0,Si),t===void 0?t=s.rounding:$n(t,0,8),ft(r,e+Ht(r)+1,t))};je.toExponential=function(e,t){var r,s=this,a=s.constructor;return e===void 0?r=wa(s,!0):($n(e,0,Si),t===void 0?t=a.rounding:$n(t,0,8),s=ft(new a(s),e+1,t),r=wa(s,!0,e+1)),r};je.toFixed=function(e,t){var r,s,a=this,i=a.constructor;return e===void 0?wa(a):($n(e,0,Si),t===void 0?t=i.rounding:$n(t,0,8),s=ft(new i(a),e+Ht(a)+1,t),r=wa(s.abs(),!1,e+Ht(s)+1),a.isneg()&&!a.isZero()?"-"+r:r)};je.toInteger=je.toint=function(){var e=this,t=e.constructor;return ft(new t(e),Ht(e)+1,t.rounding)};je.toNumber=function(){return+this};je.toPower=je.pow=function(e){var t,r,s,a,i,l,c=this,d=c.constructor,f=12,h=+(e=new d(e));if(!e.s)return new d(qr);if(c=new d(c),!c.s){if(e.s<1)throw Error(un+"Infinity");return c}if(c.eq(qr))return c;if(s=d.precision,e.eq(qr))return ft(c,s);if(t=e.e,r=e.d.length-1,l=t>=r,i=c.s,l){if((r=h<0?-h:h)<=Y_){for(a=new d(qr),t=Math.ceil(s/_t+4),kt=!1;r%2&&(a=a.times(c),s0(a.d,t)),r=Ei(r/2),r!==0;)c=c.times(c),s0(c.d,t);return kt=!0,e.s<0?new d(qr).div(a):ft(a,s)}}else if(i<0)throw Error(un+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,kt=!1,a=e.times(ko(c,s+f)),kt=!0,a=J_(a),a.s=i,a};je.toPrecision=function(e,t){var r,s,a=this,i=a.constructor;return e===void 0?(r=Ht(a),s=wa(a,r<=i.toExpNeg||r>=i.toExpPos)):($n(e,1,Si),t===void 0?t=i.rounding:$n(t,0,8),a=ft(new i(a),e,t),r=Ht(a),s=wa(a,e<=r||r<=i.toExpNeg,e)),s};je.toSignificantDigits=je.tosd=function(e,t){var r=this,s=r.constructor;return e===void 0?(e=s.precision,t=s.rounding):($n(e,1,Si),t===void 0?t=s.rounding:$n(t,0,8)),ft(new s(r),e,t)};je.toString=je.valueOf=je.val=je.toJSON=je[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ht(e),r=e.constructor;return wa(e,t<=r.toExpNeg||t>=r.toExpPos)};function X_(e,t){var r,s,a,i,l,c,d,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),kt?ft(t,m):t;if(d=e.d,f=t.d,l=e.e,a=t.e,d=d.slice(),i=l-a,i){for(i<0?(s=d,i=-i,c=f.length):(s=f,a=l,c=d.length),l=Math.ceil(m/_t),c=l>c?l+1:c+1,i>c&&(i=c,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(c=d.length,i=f.length,c-i<0&&(i=c,s=f,f=d,d=s),r=0;i;)r=(d[--i]=d[i]+f[i]+r)/ar|0,d[i]%=ar;for(r&&(d.unshift(r),++a),c=d.length;d[--c]==0;)d.pop();return t.d=d,t.e=a,kt?ft(t,m):t}function $n(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ga+e)}function An(e){var t,r,s,a=e.length-1,i="",l=e[0];if(a>0){for(i+=l,t=1;t<a;t++)s=e[t]+"",r=_t-s.length,r&&(i+=Ns(r)),i+=s;l=e[t],s=l+"",r=_t-s.length,r&&(i+=Ns(r))}else if(l===0)return"0";for(;l%10===0;)l/=10;return i+l}var rs=function(){function e(s,a){var i,l=0,c=s.length;for(s=s.slice();c--;)i=s[c]*a+l,s[c]=i%ar|0,l=i/ar|0;return l&&s.unshift(l),s}function t(s,a,i,l){var c,d;if(i!=l)d=i>l?1:-1;else for(c=d=0;c<i;c++)if(s[c]!=a[c]){d=s[c]>a[c]?1:-1;break}return d}function r(s,a,i){for(var l=0;i--;)s[i]-=l,l=s[i]<a[i]?1:0,s[i]=l*ar+s[i]-a[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,a,i,l){var c,d,f,h,m,g,v,j,_,y,w,k,N,P,O,T,A,C,E=s.constructor,D=s.s==a.s?1:-1,$=s.d,M=a.d;if(!s.s)return new E(s);if(!a.s)throw Error(un+"Division by zero");for(d=s.e-a.e,A=M.length,O=$.length,v=new E(D),j=v.d=[],f=0;M[f]==($[f]||0);)++f;if(M[f]>($[f]||0)&&--d,i==null?k=i=E.precision:l?k=i+(Ht(s)-Ht(a))+1:k=i,k<0)return new E(0);if(k=k/_t+2|0,f=0,A==1)for(h=0,M=M[0],k++;(f<O||h)&&k--;f++)N=h*ar+($[f]||0),j[f]=N/M|0,h=N%M|0;else{for(h=ar/(M[0]+1)|0,h>1&&(M=e(M,h),$=e($,h),A=M.length,O=$.length),P=A,_=$.slice(0,A),y=_.length;y<A;)_[y++]=0;C=M.slice(),C.unshift(0),T=M[0],M[1]>=ar/2&&++T;do h=0,c=t(M,_,A,y),c<0?(w=_[0],A!=y&&(w=w*ar+(_[1]||0)),h=w/T|0,h>1?(h>=ar&&(h=ar-1),m=e(M,h),g=m.length,y=_.length,c=t(m,_,g,y),c==1&&(h--,r(m,A<g?C:M,g))):(h==0&&(c=h=1),m=M.slice()),g=m.length,g<y&&m.unshift(0),r(_,m,y),c==-1&&(y=_.length,c=t(M,_,A,y),c<1&&(h++,r(_,A<y?C:M,y))),y=_.length):c===0&&(h++,_=[0]),j[f++]=h,c&&_[0]?_[y++]=$[P]||0:(_=[$[P]],y=1);while((P++<O||_[0]!==void 0)&&k--)}return j[0]||j.shift(),v.e=d,ft(v,l?i+Ht(v)+1:i)}}();function J_(e,t){var r,s,a,i,l,c,d=0,f=0,h=e.constructor,m=h.precision;if(Ht(e)>16)throw Error(Um+Ht(e));if(!e.s)return new h(qr);for(kt=!1,c=m,l=new h(.03125);e.abs().gte(.1);)e=e.times(l),f+=5;for(s=Math.log(ta(2,f))/Math.LN10*2+5|0,c+=s,r=a=i=new h(qr),h.precision=c;;){if(a=ft(a.times(e),c),r=r.times(++d),l=i.plus(rs(a,r,c)),An(l.d).slice(0,c)===An(i.d).slice(0,c)){for(;f--;)i=ft(i.times(i),c);return h.precision=m,t==null?(kt=!0,ft(i,m)):i}i=l}}function Ht(e){for(var t=e.e*_t,r=e.d[0];r>=10;r/=10)t++;return t}function Vu(e,t,r){if(t>e.LN10.sd())throw kt=!0,r&&(e.precision=r),Error(un+"LN10 precision limit exceeded");return ft(new e(e.LN10),t)}function Ns(e){for(var t="";e--;)t+="0";return t}function ko(e,t){var r,s,a,i,l,c,d,f,h,m=1,g=10,v=e,j=v.d,_=v.constructor,y=_.precision;if(v.s<1)throw Error(un+(v.s?"NaN":"-Infinity"));if(v.eq(qr))return new _(0);if(t==null?(kt=!1,f=y):f=t,v.eq(10))return t==null&&(kt=!0),Vu(_,f);if(f+=g,_.precision=f,r=An(j),s=r.charAt(0),i=Ht(v),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)v=v.times(e),r=An(v.d),s=r.charAt(0),m++;i=Ht(v),s>1?(v=new _("0."+r),i++):v=new _(s+"."+r.slice(1))}else return d=Vu(_,f+2,y).times(i+""),v=ko(new _(s+"."+r.slice(1)),f-g).plus(d),_.precision=y,t==null?(kt=!0,ft(v,y)):v;for(c=l=v=rs(v.minus(qr),v.plus(qr),f),h=ft(v.times(v),f),a=3;;){if(l=ft(l.times(h),f),d=c.plus(rs(l,new _(a),f)),An(d.d).slice(0,f)===An(c.d).slice(0,f))return c=c.times(2),i!==0&&(c=c.plus(Vu(_,f+2,y).times(i+""))),c=rs(c,new _(m),f),_.precision=y,t==null?(kt=!0,ft(c,y)):c;c=d,a+=2}}function n0(e,t){var r,s,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(r<0&&(r=s),r+=+t.slice(s+1),t=t.substring(0,s)):r<0&&(r=t.length),s=0;t.charCodeAt(s)===48;)++s;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(s,a),t){if(a-=s,r=r-s-1,e.e=Ei(r/_t),e.d=[],s=(r+1)%_t,r<0&&(s+=_t),s<a){for(s&&e.d.push(+t.slice(0,s)),a-=_t;s<a;)e.d.push(+t.slice(s,s+=_t));t=t.slice(s),s=_t-t.length}else s-=a;for(;s--;)t+="0";if(e.d.push(+t),kt&&(e.e>wc||e.e<-wc))throw Error(Um+r)}else e.s=0,e.e=0,e.d=[0];return e}function ft(e,t,r){var s,a,i,l,c,d,f,h,m=e.d;for(l=1,i=m[0];i>=10;i/=10)l++;if(s=t-l,s<0)s+=_t,a=t,f=m[h=0];else{if(h=Math.ceil((s+1)/_t),i=m.length,h>=i)return e;for(f=i=m[h],l=1;i>=10;i/=10)l++;s%=_t,a=s-_t+l}if(r!==void 0&&(i=ta(10,l-a-1),c=f/i%10|0,d=t<0||m[h+1]!==void 0||f%i,d=r<4?(c||d)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||d||r==6&&(s>0?a>0?f/ta(10,l-a):0:m[h-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return d?(i=Ht(e),m.length=1,t=t-i-1,m[0]=ta(10,(_t-t%_t)%_t),e.e=Ei(-t/_t)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(s==0?(m.length=h,i=1,h--):(m.length=h+1,i=ta(10,_t-s),m[h]=a>0?(f/ta(10,l-a)%ta(10,a)|0)*i:0),d)for(;;)if(h==0){(m[0]+=i)==ar&&(m[0]=1,++e.e);break}else{if(m[h]+=i,m[h]!=ar)break;m[h--]=0,i=1}for(s=m.length;m[--s]===0;)m.pop();if(kt&&(e.e>wc||e.e<-wc))throw Error(Um+Ht(e));return e}function Q_(e,t){var r,s,a,i,l,c,d,f,h,m,g=e.constructor,v=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),kt?ft(t,v):t;if(d=e.d,m=t.d,s=t.e,f=e.e,d=d.slice(),l=f-s,l){for(h=l<0,h?(r=d,l=-l,c=m.length):(r=m,s=f,c=d.length),a=Math.max(Math.ceil(v/_t),c)+2,l>a&&(l=a,r.length=1),r.reverse(),a=l;a--;)r.push(0);r.reverse()}else{for(a=d.length,c=m.length,h=a<c,h&&(c=a),a=0;a<c;a++)if(d[a]!=m[a]){h=d[a]<m[a];break}l=0}for(h&&(r=d,d=m,m=r,t.s=-t.s),c=d.length,a=m.length-c;a>0;--a)d[c++]=0;for(a=m.length;a>l;){if(d[--a]<m[a]){for(i=a;i&&d[--i]===0;)d[i]=ar-1;--d[i],d[a]+=ar}d[a]-=m[a]}for(;d[--c]===0;)d.pop();for(;d[0]===0;d.shift())--s;return d[0]?(t.d=d,t.e=s,kt?ft(t,v):t):new g(0)}function wa(e,t,r){var s,a=Ht(e),i=An(e.d),l=i.length;return t?(r&&(s=r-l)>0?i=i.charAt(0)+"."+i.slice(1)+Ns(s):l>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Ns(-a-1)+i,r&&(s=r-l)>0&&(i+=Ns(s))):a>=l?(i+=Ns(a+1-l),r&&(s=r-a-1)>0&&(i=i+"."+Ns(s))):((s=a+1)<l&&(i=i.slice(0,s)+"."+i.slice(s)),r&&(s=r-l)>0&&(a+1===l&&(i+="."),i+=Ns(s))),e.s<0?"-"+i:i}function s0(e,t){if(e.length>t)return e.length=t,!0}function ej(e){var t,r,s;function a(i){var l=this;if(!(l instanceof a))return new a(i);if(l.constructor=a,i instanceof a){l.s=i.s,l.e=i.e,l.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(ga+i);if(i>0)l.s=1;else if(i<0)i=-i,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(i===~~i&&i<1e7){l.e=0,l.d=[i];return}return n0(l,i.toString())}else if(typeof i!="string")throw Error(ga+i);if(i.charCodeAt(0)===45?(i=i.slice(1),l.s=-1):l.s=1,qL.test(i))n0(l,i);else throw Error(ga+i)}if(a.prototype=je,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=ej,a.config=a.set=GL,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(r=s[t++])||(e[r]=this[r]);return a.config(e),a}function GL(e){if(!e||typeof e!="object")throw Error(un+"Object expected");var t,r,s,a=["precision",1,Si,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((s=e[r=a[t]])!==void 0)if(Ei(s)===s&&s>=a[t+1]&&s<=a[t+2])this[r]=s;else throw Error(ga+r+": "+s);if((s=e[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(ga+r+": "+s);return this}var Wm=ej(WL);qr=new Wm(1);const ct=Wm;var HL=e=>e,tj={},rj=e=>e===tj,a0=e=>function t(){return arguments.length===0||arguments.length===1&&rj(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},nj=(e,t)=>e===1?t:a0(function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];var i=s.filter(l=>l!==tj).length;return i>=e?t(...s):nj(e-i,a0(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var f=s.map(h=>rj(h)?c.shift():h);return t(...f,...c)}))}),Td=e=>nj(e.length,e),nf=(e,t)=>{for(var r=[],s=e;s<t;++s)r[s-e]=s;return r},VL=Td((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),KL=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];if(!r.length)return HL;var a=r.reverse(),i=a[0],l=a.slice(1);return function(){return l.reduce((c,d)=>d(c),i(...arguments))}},sf=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),sj=e=>{var t=null,r=null;return function(){for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return t&&a.every((l,c)=>{var d;return l===((d=t)===null||d===void 0?void 0:d[c])})||(t=a,r=e(...a)),r}};function aj(e){var t;return e===0?t=1:t=Math.floor(new ct(e).abs().log(10).toNumber())+1,t}function ij(e,t,r){for(var s=new ct(e),a=0,i=[];s.lt(t)&&a<1e5;)i.push(s.toNumber()),s=s.add(r),a++;return i}Td((e,t,r)=>{var s=+e,a=+t;return s+r*(a-s)});Td((e,t,r)=>{var s=t-+e;return s=s||1/0,(r-e)/s});Td((e,t,r)=>{var s=t-+e;return s=s||1/0,Math.max(0,Math.min(1,(r-e)/s))});var oj=e=>{var[t,r]=e,[s,a]=[t,r];return t>r&&([s,a]=[r,t]),[s,a]},lj=(e,t,r)=>{if(e.lte(0))return new ct(0);var s=aj(e.toNumber()),a=new ct(10).pow(s),i=e.div(a),l=s!==1?.05:.1,c=new ct(Math.ceil(i.div(l).toNumber())).add(r).mul(l),d=c.mul(a);return t?new ct(d.toNumber()):new ct(Math.ceil(d.toNumber()))},ZL=(e,t,r)=>{var s=new ct(1),a=new ct(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(s=new ct(10).pow(aj(e)-1),a=new ct(Math.floor(a.div(s).toNumber())).mul(s)):i>1&&(a=new ct(Math.floor(e)))}else e===0?a=new ct(Math.floor((t-1)/2)):r||(a=new ct(Math.floor(e)));var l=Math.floor((t-1)/2),c=KL(VL(d=>a.add(new ct(d-l).mul(s)).toNumber()),nf);return c(0,t)},cj=function(t,r,s,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(s-1)))return{step:new ct(0),tickMin:new ct(0),tickMax:new ct(0)};var l=lj(new ct(r).sub(t).div(s-1),a,i),c;t<=0&&r>=0?c=new ct(0):(c=new ct(t).add(r).div(2),c=c.sub(new ct(c).mod(l)));var d=Math.ceil(c.sub(t).div(l).toNumber()),f=Math.ceil(new ct(r).sub(c).div(l).toNumber()),h=d+f+1;return h>s?cj(t,r,s,a,i+1):(h<s&&(f=r>0?f+(s-h):f,d=r>0?d:d+(s-h)),{step:l,tickMin:c.sub(new ct(d).mul(l)),tickMax:c.add(new ct(f).mul(l))})};function YL(e){var[t,r]=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(s,2),[l,c]=oj([t,r]);if(l===-1/0||c===1/0){var d=c===1/0?[l,...nf(0,s-1).map(()=>1/0)]:[...nf(0,s-1).map(()=>-1/0),c];return t>r?sf(d):d}if(l===c)return ZL(l,s,a);var{step:f,tickMin:h,tickMax:m}=cj(l,c,i,a,0),g=ij(h,m.add(new ct(.1).mul(f)),f);return t>r?sf(g):g}function XL(e,t){var[r,s]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,l]=oj([r,s]);if(i===-1/0||l===1/0)return[r,s];if(i===l)return[i];var c=Math.max(t,2),d=lj(new ct(l).sub(i).div(c-1),a,0),f=[...ij(new ct(i),new ct(l),d),l];return a===!1&&(f=f.map(h=>Math.round(h))),r>s?sf(f):f}var JL=sj(YL),QL=sj(XL),dj=e=>e.rootProps.maxBarSize,eD=e=>e.rootProps.barGap,uj=e=>e.rootProps.barCategoryGap,tD=e=>e.rootProps.barSize,qo=e=>e.rootProps.stackOffset,qm=e=>e.options.chartName,Gm=e=>e.rootProps.syncId,hj=e=>e.rootProps.syncMethod,Hm=e=>e.options.eventEmitter,Zn={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Wr={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Od=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},rD={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Zn.angleAxisId,includeHidden:!1,name:void 0,reversed:Zn.reversed,scale:Zn.scale,tick:Zn.tick,tickCount:void 0,ticks:void 0,type:Zn.type,unit:void 0},nD={allowDataOverflow:Wr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Wr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Wr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Wr.scale,tick:Wr.tick,tickCount:Wr.tickCount,ticks:void 0,type:Wr.type,unit:void 0},sD={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Zn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Zn.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Zn.scale,tick:Zn.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},aD={allowDataOverflow:Wr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Wr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Wr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Wr.scale,tick:Wr.tick,tickCount:Wr.tickCount,ticks:void 0,type:"category",unit:void 0},Vm=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?sD:rD,Km=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?aD:nD,Md=e=>e.polarOptions,Zm=ee([fs,ms,Jt],Gw),fj=ee([Md,Zm],(e,t)=>{if(e!=null)return _r(e.innerRadius,t,0)}),mj=ee([Md,Zm],(e,t)=>{if(e!=null)return _r(e.outerRadius,t,t*.8)}),iD=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},pj=ee([Md],iD);ee([Vm,pj],Od);var gj=ee([Zm,fj,mj],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});ee([Km,gj],Od);var xj=ee([nt,Md,fj,mj,fs,ms],(e,t,r,s,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||s==null)){var{cx:l,cy:c,startAngle:d,endAngle:f}=t;return{cx:_r(l,a,a/2),cy:_r(c,i,i/2),innerRadius:r,outerRadius:s,startAngle:d,endAngle:f,clockWise:!1}}}),St=(e,t)=>t,Go=(e,t,r)=>r;function Id(e){return e==null?void 0:e.id}var er=e=>{var t=nt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Ci=e=>e.tooltip.settings.axisId,cr=e=>{var t=er(e),r=Ci(e);return Ho(e,t,r)},vj=ee([cr],e=>e==null?void 0:e.dataKey);function yj(e,t,r){var{chartData:s=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,l=new Map;return e.forEach(c=>{var d,f=(d=c.data)!==null&&d!==void 0?d:s;if(!(f==null||f.length===0)){var h=Id(c);f.forEach((m,g)=>{var v=i==null||a?g:String(wt(m,i,null)),j=wt(m,c.dataKey,0),_;l.has(v)?_=l.get(v):_={},Object.assign(_,{[h]:j}),l.set(v,_)})}}),Array.from(l.values())}function Ld(e){return e.stackId!=null&&e.dataKey!=null}function i0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function _c(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i0(Object(r),!0).forEach(function(s){oD(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function oD(e,t,r){return(t=lD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lD(e){var t=cD(e,"string");return typeof t=="symbol"?t:t+""}function cD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var af=[0,"auto"],Fr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},bj=(e,t)=>e.cartesianAxis.xAxis[t],gs=(e,t)=>{var r=bj(e,t);return r??Fr},Ur={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:af,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Ro},wj=(e,t)=>e.cartesianAxis.yAxis[t],xs=(e,t)=>{var r=wj(e,t);return r??Ur},dD={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Ym=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??dD},$t=(e,t,r)=>{switch(t){case"xAxis":return gs(e,r);case"yAxis":return xs(e,r);case"zAxis":return Ym(e,r);case"angleAxis":return Vm(e,r);case"radiusAxis":return Km(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},uD=(e,t,r)=>{switch(t){case"xAxis":return gs(e,r);case"yAxis":return xs(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Ho=(e,t,r)=>{switch(t){case"xAxis":return gs(e,r);case"yAxis":return xs(e,r);case"angleAxis":return Vm(e,r);case"radiusAxis":return Km(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},_j=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Xm(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Dd=e=>e.graphicalItems.cartesianItems,hD=ee([St,Go],Xm),Jm=(e,t,r)=>e.filter(r).filter(s=>(t==null?void 0:t.includeHidden)===!0?!0:!s.hide),Vo=ee([Dd,$t,hD],Jm),jj=ee([Vo],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Ld)),Nj=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),kj=ee([Vo],Nj),Qm=e=>e.map(t=>t.data).filter(Boolean).flat(1),fD=ee([Vo],Qm),ep=(e,t)=>{var{chartData:r=[],dataStartIndex:s,dataEndIndex:a}=t;return e.length>0?e:r.slice(s,a+1)},tp=ee([fD,Ad],ep),rp=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(s=>({value:wt(s,t.dataKey)})):r.length>0?r.map(s=>s.dataKey).flatMap(s=>e.map(a=>({value:wt(a,s)}))):e.map(s=>({value:s})),Rd=ee([tp,$t,Vo],rp);function Sj(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Ea(e){return e.filter(t=>Rn(t)||t instanceof Date).map(Number).filter(t=>Rr(t)===!1)}function mD(e,t,r){return!r||typeof t!="number"||Rr(t)?[]:r.length?Ea(r.flatMap(s=>{var a=wt(e,s.dataKey),i,l;if(Array.isArray(a)?[i,l]=a:i=l=a,!(!gr(i)||!gr(l)))return[t-i,t+l]})):[]}var pD=ee([jj,Ad,cr],yj),Ej=(e,t,r)=>{var s={},a=t.reduce((i,l)=>(l.stackId==null||(i[l.stackId]==null&&(i[l.stackId]=[]),i[l.stackId].push(l)),i),s);return Object.fromEntries(Object.entries(a).map(i=>{var[l,c]=i,d=c.map(Id);return[l,{stackedData:N5(e,d,r),graphicalItems:c}]}))},So=ee([pD,jj,qo],Ej),Cj=(e,t,r)=>{var{dataStartIndex:s,dataEndIndex:a}=t;if(r!=="zAxis"){var i=C5(e,s,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},gD=ee([So,zs,St],Cj),Pj=(e,t,r,s,a)=>r.length>0?e.flatMap(i=>r.flatMap(l=>{var c,d,f=(c=s[l.id])===null||c===void 0?void 0:c.filter(m=>Sj(a,m)),h=wt(i,(d=t.dataKey)!==null&&d!==void 0?d:l.dataKey);return{value:h,errorDomain:mD(i,h,f)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(i=>({value:wt(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),$d=e=>e.errorBars,Aj=(e,t,r)=>e.flatMap(s=>t[s.id]).filter(Boolean).filter(s=>Sj(r,s));ee([kj,$d,St],Aj);var xD=ee([tp,$t,kj,$d,St],Pj);function vD(e){var{value:t}=e;if(Rn(t)||t instanceof Date)return t}var o0=e=>{var t=e.flatMap(s=>[s.value,s.errorDomain]).flat(1),r=Ea(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},yD=(e,t,r)=>{var s=e.map(vD).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&jb(s))?p_(0,e.length):t.allowDuplicatedCategory?s:Array.from(new Set(s))},np=e=>{var t;if(e==null||!("domain"in e))return af;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Ea(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:af},jc=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),l=Math.min(...i),c=Math.max(...i);return[l,c]}},Tj=e=>e.referenceElements.dots,Pi=(e,t,r)=>e.filter(s=>s.ifOverflow==="extendDomain").filter(s=>t==="xAxis"?s.xAxisId===r:s.yAxisId===r),bD=ee([Tj,St,Go],Pi),Oj=e=>e.referenceElements.areas,wD=ee([Oj,St,Go],Pi),Mj=e=>e.referenceElements.lines,_D=ee([Mj,St,Go],Pi),Ij=(e,t)=>{var r=Ea(e.map(s=>t==="xAxis"?s.x:s.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},jD=ee(bD,St,Ij),Lj=(e,t)=>{var r=Ea(e.flatMap(s=>[t==="xAxis"?s.x1:s.y1,t==="xAxis"?s.x2:s.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ND=ee([wD,St],Lj),Dj=(e,t)=>{var r=Ea(e.map(s=>t==="xAxis"?s.x:s.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},kD=ee(_D,St,Dj),SD=ee(jD,kD,ND,(e,t,r)=>jc(e,r,t)),Rj=ee([$t],np),sp=(e,t,r,s,a,i,l)=>{var c=FL(t,e.allowDataOverflow);if(c!=null)return c;var d=i==="vertical"&&l==="xAxis"||i==="horizontal"&&l==="yAxis",f=d?jc(r,a,o0(s)):jc(a,o0(s));return UL(t,f,e.allowDataOverflow)},ED=ee([$t,Rj,gD,xD,SD,nt,St],sp),CD=[0,1],ap=(e,t,r,s,a,i,l)=>{if(!((e==null||r==null||r.length===0)&&l===void 0)){var{dataKey:c,type:d}=e,f=hs(t,i);return f&&c==null?p_(0,r.length):d==="category"?yD(s,e,f):a==="expand"?CD:l}},ip=ee([$t,nt,tp,Rd,qo,St,ED],ap),$j=(e,t,r,s,a)=>{if(e!=null){var{scale:i,type:l}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":l==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof i=="string"){var c="scale".concat(Mo(i));return c in so?c:"point"}}},Ai=ee([$t,nt,_j,qm,St],$j);function PD(e){if(e!=null){if(e in so)return so[e]();var t="scale".concat(Mo(e));if(t in so)return so[t]()}}function op(e,t,r,s){if(!(r==null||s==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(s);var a=PD(t);if(a!=null){var i=a.domain(r).range(s);return y5(i),i}}}var lp=(e,t,r)=>{var s=np(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&xi(e))return JL(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&xi(e))return QL(e,t.tickCount,t.allowDecimals)}},cp=ee([ip,Ho,Ai],lp),dp=(e,t,r,s)=>{if(s!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&xi(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],l=t[1],c=r[r.length-1];return[Math.min(a,i),Math.max(l,c)]}return t},AD=ee([$t,ip,cp,St],dp),TD=ee(Rd,$t,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,s=Array.from(Ea(e.map(c=>c.value))).sort((c,d)=>c-d);if(s.length<2)return 1/0;var a=s[s.length-1]-s[0];if(a===0)return 1/0;for(var i=0;i<s.length-1;i++){var l=s[i+1]-s[i];r=Math.min(r,l)}return r/a}}),zj=ee(TD,nt,uj,Jt,(e,t,r,s)=>s,(e,t,r,s,a)=>{if(!gr(e))return 0;var i=t==="vertical"?s.height:s.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var l=_r(r,e*i),c=e*i/2;return c-l-(c-l)/i*l}return 0}),OD=(e,t)=>{var r=gs(e,t);return r==null||typeof r.padding!="string"?0:zj(e,"xAxis",t,r.padding)},MD=(e,t)=>{var r=xs(e,t);return r==null||typeof r.padding!="string"?0:zj(e,"yAxis",t,r.padding)},ID=ee(gs,OD,(e,t)=>{var r,s;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((s=a.right)!==null&&s!==void 0?s:0)+t}}),LD=ee(xs,MD,(e,t)=>{var r,s;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((s=a.bottom)!==null&&s!==void 0?s:0)+t}}),DD=ee([Jt,ID,wd,bd,(e,t,r)=>r],(e,t,r,s,a)=>{var{padding:i}=s;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),RD=ee([Jt,nt,LD,wd,bd,(e,t,r)=>r],(e,t,r,s,a,i)=>{var{padding:l}=a;return i?[s.height-l.bottom,l.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Ko=(e,t,r,s)=>{var a;switch(t){case"xAxis":return DD(e,r,s);case"yAxis":return RD(e,r,s);case"zAxis":return(a=Ym(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return pj(e);case"radiusAxis":return gj(e,r);default:return}},Bj=ee([$t,Ko],Od),Ti=ee([$t,Ai,AD,Bj],op);ee([Vo,$d,St],Aj);function Fj(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var zd=(e,t)=>t,Bd=(e,t,r)=>r,$D=ee(vd,zd,Bd,(e,t,r)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===r).sort(Fj)),zD=ee(yd,zd,Bd,(e,t,r)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===r).sort(Fj)),Uj=(e,t)=>({width:e.width,height:t.height}),BD=(e,t)=>{var r=typeof t.width=="number"?t.width:Ro;return{width:r,height:e.height}},Wj=ee(Jt,gs,Uj),FD=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},UD=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},WD=ee(ms,Jt,$D,zd,Bd,(e,t,r,s,a)=>{var i={},l;return r.forEach(c=>{var d=Uj(t,c);l==null&&(l=FD(t,s,e));var f=s==="top"&&!a||s==="bottom"&&a;i[c.id]=l-Number(f)*d.height,l+=(f?-1:1)*d.height}),i}),qD=ee(fs,Jt,zD,zd,Bd,(e,t,r,s,a)=>{var i={},l;return r.forEach(c=>{var d=BD(t,c);l==null&&(l=UD(t,s,e));var f=s==="left"&&!a||s==="right"&&a;i[c.id]=l-Number(f)*d.width,l+=(f?-1:1)*d.width}),i}),GD=(e,t)=>{var r=gs(e,t);if(r!=null)return WD(e,r.orientation,r.mirror)},HD=ee([Jt,gs,GD,(e,t)=>t],(e,t,r,s)=>{if(t!=null){var a=r==null?void 0:r[s];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),VD=(e,t)=>{var r=xs(e,t);if(r!=null)return qD(e,r.orientation,r.mirror)},KD=ee([Jt,xs,VD,(e,t)=>t],(e,t,r,s)=>{if(t!=null){var a=r==null?void 0:r[s];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),qj=ee(Jt,xs,(e,t)=>{var r=typeof t.width=="number"?t.width:Ro;return{width:r,height:e.height}}),l0=(e,t,r)=>{switch(t){case"xAxis":return Wj(e,r).width;case"yAxis":return qj(e,r).height;default:return}},Gj=(e,t,r,s)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:l}=r,c=hs(e,s),d=t.map(f=>f.value);if(l&&c&&i==="category"&&a&&jb(d))return d}},up=ee([nt,Rd,$t,St],Gj),Hj=(e,t,r,s)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,l=hs(e,s);if(l&&(a==="number"||i!=="auto"))return t.map(c=>c.value)}},hp=ee([nt,Rd,Ho,St],Hj),c0=ee([nt,uD,Ai,Ti,up,hp,Ko,cp,St],(e,t,r,s,a,i,l,c,d)=>{if(t==null)return null;var f=hs(e,d);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:d,categoricalDomain:i,duplicateDomain:a,isCategorical:f,niceTicks:c,range:l,realScaleType:r,scale:s}}),ZD=(e,t,r,s,a,i,l,c,d)=>{if(!(t==null||s==null)){var f=hs(e,d),{type:h,ticks:m,tickCount:g}=t,v=r==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,j=h==="category"&&s.bandwidth?s.bandwidth()/v:0;j=d==="angleAxis"&&i!=null&&i.length>=2?or(i[0]-i[1])*2*j:j;var _=m||a;if(_){var y=_.map((w,k)=>{var N=l?l.indexOf(w):w;return{index:k,coordinate:s(N)+j,value:w,offset:j}});return y.filter(w=>!Rr(w.coordinate))}return f&&c?c.map((w,k)=>({coordinate:s(w)+j,value:w,index:k,offset:j})):s.ticks?s.ticks(g).map(w=>({coordinate:s(w)+j,value:w,offset:j})):s.domain().map((w,k)=>({coordinate:s(w)+j,value:l?l[w]:w,index:k,offset:j}))}},Vj=ee([nt,Ho,Ai,Ti,cp,Ko,up,hp,St],ZD),YD=(e,t,r,s,a,i,l)=>{if(!(t==null||r==null||s==null||s[0]===s[1])){var c=hs(e,l),{tickCount:d}=t,f=0;return f=l==="angleAxis"&&(s==null?void 0:s.length)>=2?or(s[0]-s[1])*2*f:f,c&&i?i.map((h,m)=>({coordinate:r(h)+f,value:h,index:m,offset:f})):r.ticks?r.ticks(d).map(h=>({coordinate:r(h)+f,value:h,offset:f})):r.domain().map((h,m)=>({coordinate:r(h)+f,value:a?a[h]:h,index:m,offset:f}))}},As=ee([nt,Ho,Ti,Ko,up,hp,St],YD),Ts=ee($t,Ti,(e,t)=>{if(!(e==null||t==null))return _c(_c({},e),{},{scale:t})}),XD=ee([$t,Ai,ip,Bj],op);ee((e,t,r)=>Ym(e,r),XD,(e,t)=>{if(!(e==null||t==null))return _c(_c({},e),{},{scale:t})});var JD=ee([nt,vd,yd],(e,t,r)=>{switch(e){case"horizontal":return t.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Kj=e=>e.options.defaultTooltipEventType,Zj=e=>e.options.validateTooltipEventTypes;function Yj(e,t,r){if(e==null)return t;var s=e?"axis":"item";return r==null?t:r.includes(s)?s:t}function fp(e,t){var r=Kj(e),s=Zj(e);return Yj(t,r,s)}function QD(e){return Ae(t=>fp(t,e))}var Xj=(e,t)=>{var r,s=Number(t);if(!(Rr(s)||t==null))return s>=0?e==null||(r=e[s])===null||r===void 0?void 0:r.value:void 0},e6=e=>e.tooltip.settings,Es={active:!1,index:null,dataKey:void 0,coordinate:void 0},t6={itemInteraction:{click:Es,hover:Es},axisInteraction:{click:Es,hover:Es},keyboardInteraction:Es,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Jj=Zr({name:"tooltip",initialState:t6,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=ts(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:r6,removeTooltipEntrySettings:n6,setTooltipSettingsState:s6,setActiveMouseOverItemIndex:Qj,mouseLeaveItem:a6,mouseLeaveChart:eN,setActiveClickItemIndex:i6,setMouseOverAxisIndex:tN,setMouseClickAxisIndex:o6,setSyncInteraction:of,setKeyboardInteraction:lf}=Jj.actions,l6=Jj.reducer;function d0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Rl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d0(Object(r),!0).forEach(function(s){c6(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function c6(e,t,r){return(t=d6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d6(e){var t=u6(e,"string");return typeof t=="symbol"?t:t+""}function u6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h6(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function f6(e){return e.index!=null}var rN=(e,t,r,s)=>{if(t==null)return Es;var a=h6(e,t,r);if(a==null)return Es;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(f6(a)){if(i)return Rl(Rl({},a),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s};return Rl(Rl({},Es),{},{coordinate:a.coordinate})},mp=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var s=Number(r);if(!gr(s))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(s,i)))},nN=(e,t,r,s,a,i,l,c)=>{if(!(i==null||c==null)){var d=l[0],f=d==null?void 0:c(d.positions,i);if(f!=null)return f;var h=a==null?void 0:a[Number(i)];if(h)switch(r){case"horizontal":return{x:h.coordinate,y:(s.top+t)/2};default:return{x:(s.left+e)/2,y:h.coordinate}}}},sN=(e,t,r,s)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&s!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var l;return((l=i.settings)===null||l===void 0?void 0:l.dataKey)===a})},Zo=e=>e.options.tooltipPayloadSearcher,Oi=e=>e.tooltip;function u0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function h0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u0(Object(r),!0).forEach(function(s){m6(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function m6(e,t,r){return(t=p6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p6(e){var t=g6(e,"string");return typeof t=="symbol"?t:t+""}function g6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function x6(e,t){return e??t}var aN=(e,t,r,s,a,i,l)=>{if(!(t==null||i==null)){var{chartData:c,computedData:d,dataStartIndex:f,dataEndIndex:h}=r,m=[];return e.reduce((g,v)=>{var j,{dataDefinedOnItem:_,settings:y}=v,w=x6(_,c),k=Array.isArray(w)?Hw(w,f,h):w,N=(j=y==null?void 0:y.dataKey)!==null&&j!==void 0?j:s,P=y==null?void 0:y.nameKey,O;if(s&&Array.isArray(k)&&!Array.isArray(k[0])&&l==="axis"?O=Nb(k,s,a):O=i(k,t,d,P),Array.isArray(O))O.forEach(A=>{var C=h0(h0({},y),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});g.push(Jx({tooltipEntrySettings:C,dataKey:A.dataKey,payload:A.payload,value:wt(A.payload,A.dataKey),name:A.name}))});else{var T;g.push(Jx({tooltipEntrySettings:y,dataKey:N,payload:O,value:wt(O,N),name:(T=wt(O,P))!==null&&T!==void 0?T:y==null?void 0:y.name}))}return g},m)}},pp=ee([cr,nt,_j,qm,er],$j),v6=ee([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),y6=ee([er,Ci],Xm),Yo=ee([v6,cr,y6],Jm),b6=ee([Yo],e=>e.filter(Ld)),w6=ee([Yo],Qm),Mi=ee([w6,zs],ep),_6=ee([b6,zs,cr],yj),gp=ee([Mi,cr,Yo],rp),j6=ee([cr],np),N6=ee([Yo],e=>e.filter(Ld)),k6=ee([_6,N6,qo],Ej),S6=ee([k6,zs,er],Cj),E6=ee([Yo],Nj),C6=ee([Mi,cr,E6,$d,er],Pj),P6=ee([Tj,er,Ci],Pi),A6=ee([P6,er],Ij),T6=ee([Oj,er,Ci],Pi),O6=ee([T6,er],Lj),M6=ee([Mj,er,Ci],Pi),I6=ee([M6,er],Dj),L6=ee([A6,I6,O6],jc),D6=ee([cr,j6,S6,C6,L6,nt,er],sp),iN=ee([cr,nt,Mi,gp,qo,er,D6],ap),R6=ee([iN,cr,pp],lp),$6=ee([cr,iN,R6,er],dp),oN=e=>{var t=er(e),r=Ci(e),s=!1;return Ko(e,t,r,s)},lN=ee([cr,oN],Od),cN=ee([cr,pp,$6,lN],op),z6=ee([nt,gp,cr,er],Gj),B6=ee([nt,gp,cr,er],Hj),F6=(e,t,r,s,a,i,l,c)=>{if(t){var{type:d}=t,f=hs(e,c);if(s){var h=r==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,m=d==="category"&&s.bandwidth?s.bandwidth()/h:0;return m=c==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?or(a[0]-a[1])*2*m:m,f&&l?l.map((g,v)=>({coordinate:s(g)+m,value:g,index:v,offset:m})):s.domain().map((g,v)=>({coordinate:s(g)+m,value:i?i[g]:g,index:v,offset:m}))}}},vs=ee([nt,cr,pp,cN,oN,z6,B6,er],F6),xp=ee([Kj,Zj,e6],(e,t,r)=>Yj(r.shared,e,t)),dN=e=>e.tooltip.settings.trigger,vp=e=>e.tooltip.settings.defaultIndex,Fd=ee([Oi,xp,dN,vp],rN),Os=ee([Fd,Mi],mp),uN=ee([vs,Os],Xj),hN=ee([Fd],e=>{if(e)return e.dataKey}),fN=ee([Oi,xp,dN,vp],sN),U6=ee([fs,ms,nt,Jt,vs,vp,fN,Zo],nN),W6=ee([Fd,U6],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),q6=ee([Fd],e=>e.active),G6=ee([fN,Os,zs,vj,uN,Zo,xp],aN),H6=ee([G6],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function f0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function m0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f0(Object(r),!0).forEach(function(s){V6(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function V6(e,t,r){return(t=K6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K6(e){var t=Z6(e,"string");return typeof t=="symbol"?t:t+""}function Z6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y6=()=>Ae(cr),X6=()=>{var e=Y6(),t=Ae(vs),r=Ae(cN);return yo(m0(m0({},e),{},{scale:r}),t)},mN=()=>Ae(qm),yp=(e,t)=>t,pN=(e,t,r)=>r,bp=(e,t,r,s)=>s,J6=ee(vs,e=>hd(e,t=>t.coordinate)),wp=ee([Oi,yp,pN,bp],rN),gN=ee([wp,Mi],mp),Q6=(e,t,r)=>{if(t!=null){var s=Oi(e);return t==="axis"?r==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:r==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},xN=ee([Oi,yp,pN,bp],sN),Nc=ee([fs,ms,nt,Jt,vs,bp,xN,Zo],nN),eR=ee([wp,Nc],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),vN=ee(vs,gN,Xj),tR=ee([xN,gN,zs,vj,vN,Zo,yp],aN),rR=ee([wp],e=>({isActive:e.active,activeIndex:e.index})),nR=(e,t,r,s,a,i,l,c)=>{if(!(!e||!t||!s||!a||!i)){var d=P5(e.chartX,e.chartY,t,r,c);if(d){var f=T5(d,t),h=x5(f,l,i,s,a),m=A5(t,i,h,d);return{activeIndex:String(h),activeCoordinate:m}}}};function cf(){return cf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},cf.apply(null,arguments)}function p0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function $l(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p0(Object(r),!0).forEach(function(s){sR(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function sR(e,t,r){return(t=aR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aR(e){var t=iR(e,"string");return typeof t=="symbol"?t:t+""}function iR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oR(e){var{coordinate:t,payload:r,index:s,offset:a,tooltipAxisBandSize:i,layout:l,cursor:c,tooltipEventType:d,chartName:f}=e,h=t,m=r,g=s;if(!c||!h||f!=="ScatterChart"&&d!=="axis")return null;var v,j;if(f==="ScatterChart")v=h,j=TM;else if(f==="BarChart")v=OM(l,h,a,i),j=l_;else if(l==="radial"){var{cx:_,cy:y,radius:w,startAngle:k,endAngle:N}=c_(h);v={cx:_,cy:y,startAngle:k,endAngle:N,innerRadius:w,outerRadius:w},j=u_}else v={points:uI(l,h,a)},j=lo;var P=typeof c=="object"&&"className"in c?c.className:void 0,O=$l($l($l($l({stroke:"#ccc",pointerEvents:"none"},a),v),Lt(c,!1)),{},{payload:m,payloadIndex:g,className:Ve("recharts-tooltip-cursor",P)});return x.isValidElement(c)?x.cloneElement(c,O):x.createElement(j,O)}function lR(e){var t=X6(),r=Qw(),s=_d(),a=mN();return x.createElement(oR,cf({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:s,tooltipAxisBandSize:t,chartName:a}))}var yN=x.createContext(null),cR=()=>x.useContext(yN),bN={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function a(d,f,h){this.fn=d,this.context=f,this.once=h||!1}function i(d,f,h,m,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,m||d,g),j=r?r+f:f;return d._events[j]?d._events[j].fn?d._events[j]=[d._events[j],v]:d._events[j].push(v):(d._events[j]=v,d._eventsCount++),d}function l(d,f){--d._eventsCount===0?d._events=new s:delete d._events[f]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],h,m;if(this._eventsCount===0)return f;for(m in h=this._events)t.call(h,m)&&f.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},c.prototype.listeners=function(f){var h=r?r+f:f,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var g=0,v=m.length,j=new Array(v);g<v;g++)j[g]=m[g].fn;return j},c.prototype.listenerCount=function(f){var h=r?r+f:f,m=this._events[h];return m?m.fn?1:m.length:0},c.prototype.emit=function(f,h,m,g,v,j){var _=r?r+f:f;if(!this._events[_])return!1;var y=this._events[_],w=arguments.length,k,N;if(y.fn){switch(y.once&&this.removeListener(f,y.fn,void 0,!0),w){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,h),!0;case 3:return y.fn.call(y.context,h,m),!0;case 4:return y.fn.call(y.context,h,m,g),!0;case 5:return y.fn.call(y.context,h,m,g,v),!0;case 6:return y.fn.call(y.context,h,m,g,v,j),!0}for(N=1,k=new Array(w-1);N<w;N++)k[N-1]=arguments[N];y.fn.apply(y.context,k)}else{var P=y.length,O;for(N=0;N<P;N++)switch(y[N].once&&this.removeListener(f,y[N].fn,void 0,!0),w){case 1:y[N].fn.call(y[N].context);break;case 2:y[N].fn.call(y[N].context,h);break;case 3:y[N].fn.call(y[N].context,h,m);break;case 4:y[N].fn.call(y[N].context,h,m,g);break;default:if(!k)for(O=1,k=new Array(w-1);O<w;O++)k[O-1]=arguments[O];y[N].fn.apply(y[N].context,k)}}return!0},c.prototype.on=function(f,h,m){return i(this,f,h,m,!1)},c.prototype.once=function(f,h,m){return i(this,f,h,m,!0)},c.prototype.removeListener=function(f,h,m,g){var v=r?r+f:f;if(!this._events[v])return this;if(!h)return l(this,v),this;var j=this._events[v];if(j.fn)j.fn===h&&(!g||j.once)&&(!m||j.context===m)&&l(this,v);else{for(var _=0,y=[],w=j.length;_<w;_++)(j[_].fn!==h||g&&!j[_].once||m&&j[_].context!==m)&&y.push(j[_]);y.length?this._events[v]=y.length===1?y[0]:y:l(this,v)}return this},c.prototype.removeAllListeners=function(f){var h;return f?(h=r?r+f:f,this._events[h]&&l(this,h)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})(bN);var dR=bN.exports;const uR=zn(dR);var Eo=new uR,df="recharts.syncEvent.tooltip",g0="recharts.syncEvent.brush";function _p(e,t){if(t){var r=Number.parseInt(t,10);if(!Rr(r))return e==null?void 0:e[r]}}var hR={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},wN=Zr({name:"options",initialState:hR,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),fR=wN.reducer,{createEventEmitter:mR}=wN.actions;function pR(e){return e.tooltip.syncInteraction}var gR={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},_N=Zr({name:"chartData",initialState:gR,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:s}=t.payload;r!=null&&(e.dataStartIndex=r),s!=null&&(e.dataEndIndex=s)}}}),{setChartData:x0,setDataStartEndIndexes:xR,setComputedData:g7}=_N.actions,vR=_N.reducer,yR=["x","y"];function v0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Ys(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v0(Object(r),!0).forEach(function(s){bR(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function bR(e,t,r){return(t=wR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wR(e){var t=_R(e,"string");return typeof t=="symbol"?t:t+""}function _R(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jR(e,t){if(e==null)return{};var r,s,a=NR(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function NR(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var jN=()=>{};function kR(){var e=Ae(Gm),t=Ae(Hm),r=Mt(),s=Ae(hj),a=Ae(vs),i=_d(),l=mm(),c=Ae(d=>d.rootProps.className);x.useEffect(()=>{if(e==null)return jN;var d=(f,h,m)=>{if(t!==m&&e===f){if(s==="index"){var g;if(l&&h!==null&&h!==void 0&&(g=h.payload)!==null&&g!==void 0&&g.coordinate){var v=h.payload.coordinate,{x:j,y:_}=v,y=jR(v,yR),w=Ys(Ys(Ys({},y),typeof j=="number"&&{x:Math.max(l.x,Math.min(j,l.x+l.width))}),typeof _=="number"&&{y:Math.max(l.y,Math.min(_,l.y+l.height))}),k=Ys(Ys({},h),{},{payload:Ys(Ys({},h.payload),{},{coordinate:w})});r(k)}else r(h);return}if(a!=null){var N;if(typeof s=="function"){var P={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},O=s(a,P);N=a[O]}else s==="value"&&(N=a.find(z=>String(z.value)===h.payload.label));var{coordinate:T}=h.payload;if(N==null||h.payload.active===!1||T==null||l==null){r(of({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:A,y:C}=T,E=Math.min(A,l.x+l.width),D=Math.min(C,l.y+l.height),$={x:i==="horizontal"?N.coordinate:E,y:i==="horizontal"?D:N.coordinate},M=of({active:h.payload.active,coordinate:$,dataKey:h.payload.dataKey,index:String(N.index),label:h.payload.label});r(M)}}};return Eo.on(df,d),()=>{Eo.off(df,d)}},[c,r,t,e,s,a,i,l])}function SR(){var e=Ae(Gm),t=Ae(Hm),r=Mt();x.useEffect(()=>{if(e==null)return jN;var s=(a,i,l)=>{t!==l&&e===a&&r(xR(i))};return Eo.on(g0,s),()=>{Eo.off(g0,s)}},[r,t,e])}function ER(){var e=Mt();x.useEffect(()=>{e(mR())},[e]),kR(),SR()}function CR(e,t,r,s,a,i){var l=Ae(g=>Q6(g,e,t)),c=Ae(Hm),d=Ae(Gm),f=Ae(hj),h=Ae(pR),m=h==null?void 0:h.active;x.useEffect(()=>{if(!m&&d!=null&&c!=null){var g=of({active:i,coordinate:r,dataKey:l,index:a,label:typeof s=="number"?String(s):s});Eo.emit(df,d,g,c)}},[m,r,l,a,s,c,d,f,i])}function y0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function b0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y0(Object(r),!0).forEach(function(s){PR(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function PR(e,t,r){return(t=AR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AR(e){var t=TR(e,"string");return typeof t=="symbol"?t:t+""}function TR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OR(e){return e.dataKey}function MR(e,t){return x.isValidElement(e)?x.cloneElement(e,t):typeof e=="function"?x.createElement(e,t):x.createElement(cM,t)}var w0=[],IR={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Ds.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Ku(e){var t=xr(e,IR),{active:r,allowEscapeViewBox:s,animationDuration:a,animationEasing:i,content:l,filterNull:c,isAnimationActive:d,offset:f,payloadUniqBy:h,position:m,reverseDirection:g,useTranslate3d:v,wrapperStyle:j,cursor:_,shared:y,trigger:w,defaultIndex:k,portal:N,axisId:P}=t,O=Mt(),T=typeof k=="number"?String(k):k;x.useEffect(()=>{O(s6({shared:y,trigger:w,axisId:P,active:r,defaultIndex:T}))},[O,y,w,P,r,T]);var A=mm(),C=n_(),E=QD(y),{activeIndex:D,isActive:$}=Ae(ie=>rR(ie,E,w,T)),M=Ae(ie=>tR(ie,E,w,T)),z=Ae(ie=>vN(ie,E,w,T)),K=Ae(ie=>eR(ie,E,w,T)),W=M,U=cR(),Y=r??$,[R,H]=bw([W,Y]),J=E==="axis"?z:void 0;CR(E,w,K,J,D,Y);var F=N??U;if(F==null)return null;var V=W??w0;Y||(V=w0),c&&V.length&&(V=lw(W.filter(ie=>ie.value!=null&&(ie.hide!==!0||t.includeHidden)),h,OR));var te=V.length>0,Z=x.createElement(gM,{allowEscapeViewBox:s,animationDuration:a,animationEasing:i,isAnimationActive:d,active:Y,coordinate:K,hasPayload:te,offset:f,position:m,reverseDirection:g,useTranslate3d:v,viewBox:A,wrapperStyle:j,lastBoundingBox:R,innerRef:H,hasPortalFromProps:!!N},MR(l,b0(b0({},t),{},{payload:V,label:J,active:Y,coordinate:K,accessibilityLayer:C})));return x.createElement(x.Fragment,null,Lc.createPortal(Z,F),Y&&x.createElement(lR,{cursor:_,tooltipEventType:E,coordinate:K,payload:W,index:D}))}var NN={},kN={},SN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s,{signal:a,edges:i}={}){let l,c=null;const d=i!=null&&i.includes("leading"),f=i==null||i.includes("trailing"),h=()=>{c!==null&&(r.apply(l,c),l=void 0,c=null)},m=()=>{f&&h(),_()};let g=null;const v=()=>{g!=null&&clearTimeout(g),g=setTimeout(()=>{g=null,m()},s)},j=()=>{g!==null&&(clearTimeout(g),g=null)},_=()=>{j(),l=void 0,c=null},y=()=>{h()},w=function(...k){if(a!=null&&a.aborted)return;l=this,c=k;const N=g==null;v(),d&&N&&h()};return w.schedule=v,w.cancel=_,w.flush=y,a==null||a.addEventListener("abort",_,{once:!0}),w}e.debounce=t})(SN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SN;function r(s,a=0,i={}){typeof i!="object"&&(i={});const{leading:l=!1,trailing:c=!0,maxWait:d}=i,f=Array(2);l&&(f[0]="leading"),c&&(f[1]="trailing");let h,m=null;const g=t.debounce(function(..._){h=s.apply(this,_),m=null},a,{edges:f}),v=function(..._){return d!=null&&(m===null&&(m=Date.now()),Date.now()-m>=d)?(h=s.apply(this,_),m=Date.now(),g.cancel(),g.schedule(),h):(g.apply(this,_),h)},j=()=>(g.flush(),h);return v.cancel=g.cancel,v.flush=j,v}e.debounce=r})(kN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kN;function r(s,a=0,i={}){const{leading:l=!0,trailing:c=!0}=i;return t.debounce(s,a,{leading:l,maxWait:a,trailing:c})}e.throttle=r})(NN);var LR=NN.throttle;const DR=zn(LR);var co=function(t,r){for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i]};function _0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Zu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_0(Object(r),!0).forEach(function(s){RR(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function RR(e,t,r){return(t=$R(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $R(e){var t=zR(e,"string");return typeof t=="symbol"?t:t+""}function zR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yu=x.forwardRef((e,t)=>{var{aspect:r,initialDimension:s={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:l=0,minHeight:c,maxHeight:d,children:f,debounce:h=0,id:m,className:g,onResize:v,style:j={}}=e,_=x.useRef(null),y=x.useRef();y.current=v,x.useImperativeHandle(t,()=>_.current);var[w,k]=x.useState({containerWidth:s.width,containerHeight:s.height}),N=x.useCallback((O,T)=>{k(A=>{var C=Math.round(O),E=Math.round(T);return A.containerWidth===C&&A.containerHeight===E?A:{containerWidth:C,containerHeight:E}})},[]);x.useEffect(()=>{var O=E=>{var D,{width:$,height:M}=E[0].contentRect;N($,M),(D=y.current)===null||D===void 0||D.call(y,$,M)};h>0&&(O=DR(O,h,{trailing:!0,leading:!1}));var T=new ResizeObserver(O),{width:A,height:C}=_.current.getBoundingClientRect();return N(A,C),T.observe(_.current),()=>{T.disconnect()}},[N,h]);var P=x.useMemo(()=>{var{containerWidth:O,containerHeight:T}=w;if(O<0||T<0)return null;co(la(a)||la(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),co(!r||r>0,"The aspect(%s) must be greater than zero.",r);var A=la(a)?O:a,C=la(i)?T:i;return r&&r>0&&(A?C=A/r:C&&(A=C*r),d&&C>d&&(C=d)),co(A>0||C>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,A,C,a,i,l,c,r),x.Children.map(f,E=>x.cloneElement(E,{width:A,height:C,style:Zu({width:A,height:C},E.props.style)}))},[r,f,i,d,c,l,w,a]);return x.createElement("div",{id:m?"".concat(m):void 0,className:Ve("recharts-responsive-container",g),style:Zu(Zu({},j),{},{width:a,height:i,minWidth:l,minHeight:c,maxHeight:d}),ref:_},x.createElement("div",{style:{width:0,height:0,overflow:"visible"}},P))}),Xo=e=>null;Xo.displayName="Cell";function BR(e,t,r){return(t=FR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FR(e){var t=UR(e,"string");return typeof t=="symbol"?t:t+""}function UR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class WR{constructor(t){BR(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function j0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function qR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j0(Object(r),!0).forEach(function(s){GR(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function GR(e,t,r){return(t=HR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HR(e){var t=VR(e,"string");return typeof t=="symbol"?t:t+""}function VR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KR={cacheSize:2e3,enableCache:!0},EN=qR({},KR),N0=new WR(EN.cacheSize),ZR={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},k0="recharts_measurement_span";function YR(e,t){var r=t.fontSize||"",s=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",l=t.letterSpacing||"",c=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(s,"|").concat(a,"|").concat(i,"|").concat(l,"|").concat(c)}var S0=(e,t)=>{try{var r=document.getElementById(k0);r||(r=document.createElement("span"),r.setAttribute("id",k0),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,ZR,t),r.textContent="".concat(e);var s=r.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},uo=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ds.isSsr)return{width:0,height:0};if(!EN.enableCache)return S0(t,r);var s=YR(t,r),a=N0.get(s);if(a)return a;var i=S0(t,r);return N0.set(s,i),i},E0=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,C0=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,XR=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,JR=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,CN={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},QR=Object.keys(CN),Qa="NaN";function e3(e,t){return e*CN[t]}class Or{static parse(t){var r,[,s,a]=(r=JR.exec(t))!==null&&r!==void 0?r:[];return new Or(parseFloat(s),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Rr(t)&&(this.unit=""),r!==""&&!XR.test(r)&&(this.num=NaN,this.unit=""),QR.includes(r)&&(this.num=e3(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Or(NaN,""):new Or(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Or(NaN,""):new Or(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Or(NaN,""):new Or(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Or(NaN,""):new Or(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Rr(this.num)}}function PN(e){if(e.includes(Qa))return Qa;for(var t=e;t.includes("*")||t.includes("/");){var r,[,s,a,i]=(r=E0.exec(t))!==null&&r!==void 0?r:[],l=Or.parse(s??""),c=Or.parse(i??""),d=a==="*"?l.multiply(c):l.divide(c);if(d.isNaN())return Qa;t=t.replace(E0,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,[,h,m,g]=(f=C0.exec(t))!==null&&f!==void 0?f:[],v=Or.parse(h??""),j=Or.parse(g??""),_=m==="+"?v.add(j):v.subtract(j);if(_.isNaN())return Qa;t=t.replace(C0,_.toString())}return t}var P0=/\(([^()]*)\)/;function t3(e){for(var t=e,r;(r=P0.exec(t))!=null;){var[,s]=r;t=t.replace(P0,PN(s))}return t}function r3(e){var t=e.replace(/\s+/g,"");return t=t3(t),t=PN(t),t}function n3(e){try{return r3(e)}catch{return Qa}}function Xu(e){var t=n3(e.slice(5,-1));return t===Qa?"":t}var s3=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],a3=["dx","dy","angle","className","breakAll"];function uf(){return uf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},uf.apply(null,arguments)}function A0(e,t){if(e==null)return{};var r,s,a=i3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function i3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var AN=/[ \f\n\r\t\v\u2028\u2029]+/,TN=e=>{var{children:t,breakAll:r,style:s}=e;try{var a=[];Ot(t)||(r?a=t.toString().split(""):a=t.toString().split(AN));var i=a.map(c=>({word:c,width:uo(c,s).width})),l=r?0:uo("",s).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}},o3=(e,t,r,s,a)=>{var{maxLines:i,children:l,style:c,breakAll:d}=e,f=Pe(i),h=l,m=function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $.reduce((M,z)=>{var{word:K,width:W}=z,U=M[M.length-1];if(U&&(s==null||a||U.width+W+r<Number(s)))U.words.push(K),U.width+=W+r;else{var Y={words:[K],width:W};M.push(Y)}return M},[])},g=m(t),v=D=>D.reduce(($,M)=>$.width>M.width?$:M);if(!f||a)return g;var j=g.length>i||v(g).width>Number(s);if(!j)return g;for(var _="",y=D=>{var $=h.slice(0,D),M=TN({breakAll:d,style:c,children:$+_}).wordsWithComputedWidth,z=m(M),K=z.length>i||v(z).width>Number(s);return[K,z]},w=0,k=h.length-1,N=0,P;w<=k&&N<=h.length-1;){var O=Math.floor((w+k)/2),T=O-1,[A,C]=y(T),[E]=y(O);if(!A&&!E&&(w=O+1),A&&E&&(k=O-1),!A&&E){P=C;break}N++}return P||g},T0=e=>{var t=Ot(e)?[]:e.toString().split(AN);return[{words:t}]},l3=e=>{var{width:t,scaleToFit:r,children:s,style:a,breakAll:i,maxLines:l}=e;if((t||r)&&!Ds.isSsr){var c,d,f=TN({breakAll:i,children:s,style:a});if(f){var{wordsWithComputedWidth:h,spaceWidth:m}=f;c=h,d=m}else return T0(s);return o3({breakAll:i,children:s,maxLines:l,style:a},c,d,t,r)}return T0(s)},O0="#808080",Ud=x.forwardRef((e,t)=>{var{x:r=0,y:s=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:l=!1,textAnchor:c="start",verticalAnchor:d="end",fill:f=O0}=e,h=A0(e,s3),m=x.useMemo(()=>l3({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:l,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,l,h.style,h.width]),{dx:g,dy:v,angle:j,className:_,breakAll:y}=h,w=A0(h,a3);if(!Rn(r)||!Rn(s)||m.length===0)return null;var k=r+(Pe(g)?g:0),N=s+(Pe(v)?v:0),P;switch(d){case"start":P=Xu("calc(".concat(i,")"));break;case"middle":P=Xu("calc(".concat((m.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:P=Xu("calc(".concat(m.length-1," * -").concat(a,")"));break}var O=[];if(l){var T=m[0].width,{width:A}=h;O.push("scale(".concat(Pe(A)?A/T:1,")"))}return j&&O.push("rotate(".concat(j,", ").concat(k,", ").concat(N,")")),O.length&&(w.transform=O.join(" ")),x.createElement("text",uf({},Lt(w,!0),{ref:t,x:k,y:N,className:Ve("recharts-text",_),textAnchor:c,fill:f.includes("url")?O0:f}),m.map((C,E)=>{var D=C.words.join(y?"":" ");return x.createElement("tspan",{x:k,dy:E===0?P:a,key:"".concat(D,"-").concat(E)},D)}))});Ud.displayName="Text";var c3=["labelRef"];function d3(e,t){if(e==null)return{};var r,s,a=u3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function u3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function M0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Rt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M0(Object(r),!0).forEach(function(s){h3(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function h3(e,t,r){return(t=f3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f3(e){var t=m3(e,"string");return typeof t=="symbol"?t:t+""}function m3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yn(){return Yn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yn.apply(null,arguments)}var ON=x.createContext(null),p3=e=>{var{x:t,y:r,width:s,height:a,children:i}=e,l=x.useMemo(()=>({x:t,y:r,width:s,height:a}),[t,r,s,a]);return x.createElement(ON.Provider,{value:l},i)},MN=()=>{var e=x.useContext(ON),t=mm();return e||t},g3=x.createContext(null),x3=()=>{var e=x.useContext(g3),t=Ae(xj);return e||t},v3=e=>{var{value:t,formatter:r}=e,s=Ot(e.children)?t:e.children;return typeof r=="function"?r(s):s},jp=e=>e!=null&&typeof e=="function",y3=(e,t)=>{var r=or(t-e),s=Math.min(Math.abs(t-e),360);return r*s},b3=(e,t,r,s,a)=>{var{offset:i,className:l}=e,{cx:c,cy:d,innerRadius:f,outerRadius:h,startAngle:m,endAngle:g,clockWise:v}=a,j=(f+h)/2,_=y3(m,g),y=_>=0?1:-1,w,k;switch(t){case"insideStart":w=m+y*i,k=v;break;case"insideEnd":w=g-y*i,k=!v;break;case"end":w=g+y*i,k=v;break;default:throw new Error("Unsupported position ".concat(t))}k=_<=0?k:!k;var N=Gt(c,d,j,w),P=Gt(c,d,j,w+(k?1:-1)*359),O="M".concat(N.x,",").concat(N.y,`
    A`).concat(j,",").concat(j,",0,1,").concat(k?0:1,`,
    `).concat(P.x,",").concat(P.y),T=Ot(e.id)?go("recharts-radial-line-"):e.id;return x.createElement("text",Yn({},s,{dominantBaseline:"central",className:Ve("recharts-radial-bar-label",l)}),x.createElement("defs",null,x.createElement("path",{id:T,d:O})),x.createElement("textPath",{xlinkHref:"#".concat(T)},r))},w3=(e,t,r)=>{var{cx:s,cy:a,innerRadius:i,outerRadius:l,startAngle:c,endAngle:d}=e,f=(c+d)/2;if(r==="outside"){var{x:h,y:m}=Gt(s,a,l+t,f);return{x:h,y:m,textAnchor:h>=s?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"end"};var g=(i+l)/2,{x:v,y:j}=Gt(s,a,g,f);return{x:v,y:j,textAnchor:"middle",verticalAnchor:"middle"}},IN=e=>"cx"in e&&Pe(e.cx),_3=(e,t)=>{var{parentViewBox:r,offset:s,position:a}=e,i;r!=null&&!IN(r)&&(i=r);var{x:l,y:c,width:d,height:f}=t,h=f>=0?1:-1,m=h*s,g=h>0?"end":"start",v=h>0?"start":"end",j=d>=0?1:-1,_=j*s,y=j>0?"end":"start",w=j>0?"start":"end";if(a==="top"){var k={x:l+d/2,y:c-h*s,textAnchor:"middle",verticalAnchor:g};return Rt(Rt({},k),i?{height:Math.max(c-i.y,0),width:d}:{})}if(a==="bottom"){var N={x:l+d/2,y:c+f+m,textAnchor:"middle",verticalAnchor:v};return Rt(Rt({},N),i?{height:Math.max(i.y+i.height-(c+f),0),width:d}:{})}if(a==="left"){var P={x:l-_,y:c+f/2,textAnchor:y,verticalAnchor:"middle"};return Rt(Rt({},P),i?{width:Math.max(P.x-i.x,0),height:f}:{})}if(a==="right"){var O={x:l+d+_,y:c+f/2,textAnchor:w,verticalAnchor:"middle"};return Rt(Rt({},O),i?{width:Math.max(i.x+i.width-O.x,0),height:f}:{})}var T=i?{width:d,height:f}:{};return a==="insideLeft"?Rt({x:l+_,y:c+f/2,textAnchor:w,verticalAnchor:"middle"},T):a==="insideRight"?Rt({x:l+d-_,y:c+f/2,textAnchor:y,verticalAnchor:"middle"},T):a==="insideTop"?Rt({x:l+d/2,y:c+m,textAnchor:"middle",verticalAnchor:v},T):a==="insideBottom"?Rt({x:l+d/2,y:c+f-m,textAnchor:"middle",verticalAnchor:g},T):a==="insideTopLeft"?Rt({x:l+_,y:c+m,textAnchor:w,verticalAnchor:v},T):a==="insideTopRight"?Rt({x:l+d-_,y:c+m,textAnchor:y,verticalAnchor:v},T):a==="insideBottomLeft"?Rt({x:l+_,y:c+f-m,textAnchor:w,verticalAnchor:g},T):a==="insideBottomRight"?Rt({x:l+d-_,y:c+f-m,textAnchor:y,verticalAnchor:g},T):a&&typeof a=="object"&&(Pe(a.x)||la(a.x))&&(Pe(a.y)||la(a.y))?Rt({x:l+_r(a.x,d),y:c+_r(a.y,f),textAnchor:"end",verticalAnchor:"end"},T):Rt({x:l+d/2,y:c+f/2,textAnchor:"middle",verticalAnchor:"middle"},T)},j3={offset:5};function ks(e){var t=xr(e,j3),{viewBox:r,position:s,value:a,children:i,content:l,className:c="",textBreakAll:d,labelRef:f}=t,h=x3(),m=MN(),g=s==="center"?m:h??m,v=r||g;if(!v||Ot(a)&&Ot(i)&&!x.isValidElement(l)&&typeof l!="function")return null;var j=Rt(Rt({},t),{},{viewBox:v});if(x.isValidElement(l)){var{labelRef:_}=j,y=d3(j,c3);return x.cloneElement(l,y)}var w;if(typeof l=="function"){if(w=x.createElement(l,j),x.isValidElement(w))return w}else w=v3(t);var k=IN(v),N=Lt(t,!0);if(k&&(s==="insideStart"||s==="insideEnd"||s==="end"))return b3(t,s,w,N,v);var P=k?w3(v,t.offset,t.position):_3(t,v);return x.createElement(Ud,Yn({ref:f,className:Ve("recharts-label",c)},N,P,{breakAll:d}),w)}ks.displayName="Label";var N3=(e,t,r)=>{if(!e)return null;var s={viewBox:t,labelRef:r};return e===!0?x.createElement(ks,Yn({key:"label-implicit"},s)):Rn(e)?x.createElement(ks,Yn({key:"label-implicit",value:e},s)):x.isValidElement(e)?e.type===ks?x.cloneElement(e,Rt({key:"label-implicit"},s)):x.createElement(ks,Yn({key:"label-implicit",content:e},s)):jp(e)?x.createElement(ks,Yn({key:"label-implicit",content:e},s)):e&&typeof e=="object"?x.createElement(ks,Yn({},e,{key:"label-implicit"},s)):null};function k3(e){var{label:t}=e,r=MN();return N3(t,r)||null}var LN={},DN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(DN);var RN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(RN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DN,r=RN,s=dd;function a(i){if(s.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(LN);var S3=LN.last;const E3=zn(S3);var C3=["valueAccessor"],P3=["dataKey","clockWise","id","textBreakAll"];function kc(){return kc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},kc.apply(null,arguments)}function I0(e,t){if(e==null)return{};var r,s,a=A3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function A3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var T3=e=>Array.isArray(e.value)?E3(e.value):e.value,$N=x.createContext(void 0),zN=$N.Provider,BN=x.createContext(void 0),O3=BN.Provider;function M3(){return x.useContext($N)}function I3(){return x.useContext(BN)}function Wl(e){var{valueAccessor:t=T3}=e,r=I0(e,C3),{dataKey:s,clockWise:a,id:i,textBreakAll:l}=r,c=I0(r,P3),d=M3(),f=I3(),h=d||f;return!h||!h.length?null:x.createElement(Vt,{className:"recharts-label-list"},h.map((m,g)=>{var v,j=Ot(s)?t(m,g):wt(m&&m.payload,s),_=Ot(i)?{}:{id:"".concat(i,"-").concat(g)};return x.createElement(ks,kc({},Lt(m,!0),c,_,{fill:(v=r.fill)!==null&&v!==void 0?v:m.fill,parentViewBox:m.parentViewBox,value:j,textBreakAll:l,viewBox:m.viewBox,key:"label-".concat(g),index:g}))}))}Wl.displayName="LabelList";function Np(e){var{label:t}=e;return t?t===!0?x.createElement(Wl,{key:"labelList-implicit"}):x.isValidElement(t)||jp(t)?x.createElement(Wl,{key:"labelList-implicit",content:t}):typeof t=="object"?x.createElement(Wl,kc({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function hf(){return hf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},hf.apply(null,arguments)}var FN=e=>{var{cx:t,cy:r,r:s,className:a}=e,i=Ve("recharts-dot",a);return t===+t&&r===+r&&s===+s?x.createElement("circle",hf({},jn(e),Ff(e),{className:i,cx:t,cy:r,r:s})):null},UN=e=>e.graphicalItems.polarItems,L3=ee([St,Go],Xm),kp=ee([UN,$t,L3],Jm),D3=ee([kp],Qm),Sp=ee([D3,Fm],ep),R3=ee([Sp,$t,kp],rp),$3=ee([Sp,$t,kp],(e,t,r)=>r.length>0?e.flatMap(s=>r.flatMap(a=>{var i,l=wt(s,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(s=>({value:wt(s,t.dataKey),errorDomain:[]})):e.map(s=>({value:s,errorDomain:[]}))),L0=()=>{},z3=ee([$t,Rj,L0,$3,L0,nt,St],sp),WN=ee([$t,nt,Sp,R3,qo,St,z3],ap),B3=ee([WN,$t,Ai],lp);ee([$t,WN,B3,St],dp);var F3={radiusAxis:{},angleAxis:{}},qN=Zr({name:"polarAxis",initialState:F3,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:x7,removeRadiusAxis:v7,addAngleAxis:y7,removeAngleAxis:b7}=qN.actions,U3=qN.reducer;function D0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function R0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D0(Object(r),!0).forEach(function(s){W3(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function W3(e,t,r){return(t=q3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q3(e){var t=G3(e,"string");return typeof t=="symbol"?t:t+""}function G3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H3=(e,t)=>t,Ep=ee([UN,H3],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),V3=[],Cp=(e,t,r)=>(r==null?void 0:r.length)===0?V3:r,GN=ee([Fm,Ep,Cp],(e,t,r)=>{var{chartData:s}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=s,(!a||!a.length)&&r!=null&&(a=r.map(i=>R0(R0({},t.presentationProps),i.props))),a!=null)return a}}),K3=ee([GN,Ep,Cp],(e,t,r)=>{if(!(e==null||t==null))return e.map((s,a)=>{var i,l=wt(s,t.nameKey,t.name),c;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?c=r[a].props.fill:typeof s=="object"&&s!=null&&"fill"in s?c=s.fill:c=t.fill,{value:Ni(l,t.dataKey),color:c,payload:s,type:t.legendType}})}),Z3=ee([GN,Ep,Cp,Jt],(e,t,r,s)=>{if(!(t==null||e==null))return q$({offset:s,pieSettings:t,displayedData:e,cells:r})}),HN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${i}]`}let s=r;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(r)===s}e.isPlainObject=t})(HN);var Y3=HN.isPlainObject;const X3=zn(Y3);function $0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function z0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$0(Object(r),!0).forEach(function(s){J3(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function J3(e,t,r){return(t=Q3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q3(e){var t=e$(e,"string");return typeof t=="symbol"?t:t+""}function e$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sc(){return Sc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Sc.apply(null,arguments)}var B0=(e,t,r,s,a)=>{var i=r-s,l;return l="M ".concat(e,",").concat(t),l+="L ".concat(e+r,",").concat(t),l+="L ".concat(e+r-i/2,",").concat(t+a),l+="L ".concat(e+r-i/2-s,",").concat(t+a),l+="L ".concat(e,",").concat(t," Z"),l},t$={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},r$=e=>{var t=xr(e,t$),{x:r,y:s,upperWidth:a,lowerWidth:i,height:l,className:c}=t,{animationEasing:d,animationDuration:f,animationBegin:h,isUpdateAnimationActive:m}=t,g=x.useRef(),[v,j]=x.useState(-1),_=x.useRef(a),y=x.useRef(i),w=x.useRef(l),k=x.useRef(r),N=x.useRef(s),P=zo(e,"trapezoid-");if(x.useEffect(()=>{if(g.current&&g.current.getTotalLength)try{var K=g.current.getTotalLength();K&&j(K)}catch{}},[]),r!==+r||s!==+s||a!==+a||i!==+i||l!==+l||a===0&&i===0||l===0)return null;var O=Ve("recharts-trapezoid",c);if(!m)return x.createElement("g",null,x.createElement("path",Sc({},Lt(t,!0),{className:O,d:B0(r,s,a,i,l)})));var T=_.current,A=y.current,C=w.current,E=k.current,D=N.current,$="0px ".concat(v===-1?1:v,"px"),M="".concat(v,"px 0px"),z=s_(["strokeDasharray"],f,d);return x.createElement($o,{animationId:P,key:P,canBegin:v>0,duration:f,easing:d,isActive:m,begin:h},K=>{var W=At(T,a,K),U=At(A,i,K),Y=At(C,l,K),R=At(E,r,K),H=At(D,s,K);g.current&&(_.current=W,y.current=U,w.current=Y,k.current=R,N.current=H);var J=K>0?{transition:z,strokeDasharray:M}:{strokeDasharray:$};return x.createElement("path",Sc({},Lt(t,!0),{className:O,d:B0(R,H,W,U,Y),ref:g,style:z0(z0({},J),t.style)}))})},n$=["option","shapeType","propTransformer","activeClassName","isActive"];function s$(e,t){if(e==null)return{};var r,s,a=a$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function a$(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function F0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Ec(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F0(Object(r),!0).forEach(function(s){i$(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function i$(e,t,r){return(t=o$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o$(e){var t=l$(e,"string");return typeof t=="symbol"?t:t+""}function l$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function c$(e,t){return Ec(Ec({},t),e)}function d$(e,t){return e==="symbols"}function U0(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return x.createElement(l_,r);case"trapezoid":return x.createElement(r$,r);case"sector":return x.createElement(u_,r);case"symbols":if(d$(t))return x.createElement(Vf,r);break;default:return null}}function u$(e){return x.isValidElement(e)?e.props:e}function VN(e){var{option:t,shapeType:r,propTransformer:s=c$,activeClassName:a="recharts-active-shape",isActive:i}=e,l=s$(e,n$),c;if(x.isValidElement(t))c=x.cloneElement(t,Ec(Ec({},l),u$(t)));else if(typeof t=="function")c=t(l);else if(X3(t)&&typeof t!="boolean"){var d=s(t,l);c=x.createElement(U0,{shapeType:r,elementProps:d})}else{var f=l;c=x.createElement(U0,{shapeType:r,elementProps:f})}return i?x.createElement(Vt,{className:a},c):c}var Pp=(e,t)=>{var r=Mt();return(s,a)=>i=>{e==null||e(s,a,i),r(Qj({activeIndex:String(a),activeDataKey:t,activeCoordinate:s.tooltipPosition}))}},Ap=e=>{var t=Mt();return(r,s)=>a=>{e==null||e(r,s,a),t(a6())}},Tp=(e,t)=>{var r=Mt();return(s,a)=>i=>{e==null||e(s,a,i),r(i6({activeIndex:String(a),activeDataKey:t,activeCoordinate:s.tooltipPosition}))}};function Op(e){var{fn:t,args:r}=e,s=Mt(),a=$r();return x.useEffect(()=>{if(!a){var i=t(r);return s(r6(i)),()=>{s(n6(i))}}},[t,r,s,a]),null}var KN=()=>{};function ZN(e){var{legendPayload:t}=e,r=Mt(),s=$r();return x.useEffect(()=>s?KN:(r(t_(t)),()=>{r(r_(t))}),[r,s,t]),null}function h$(e){var{legendPayload:t}=e,r=Mt(),s=Ae(nt);return x.useEffect(()=>s!=="centric"&&s!=="radial"?KN:(r(t_(t)),()=>{r(r_(t))}),[r,s,t]),null}var Ju,f$=()=>{var[e]=x.useState(()=>go("uid-"));return e},m$=(Ju=oS.useId)!==null&&Ju!==void 0?Ju:f$;function p$(e,t){var r=m$();return t||(e?"".concat(e,"-").concat(r):r)}var g$=x.createContext(void 0),Mp=e=>{var{id:t,type:r,children:s}=e,a=p$("recharts-".concat(r),t);return x.createElement(g$.Provider,{value:a},s(a))},x$={cartesianItems:[],polarItems:[]},YN=Zr({name:"graphicalItems",initialState:x$,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:s}=t.payload,a=ts(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=s)},removeCartesianGraphicalItem(e,t){var r=ts(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=ts(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:v$,replaceCartesianGraphicalItem:y$,removeCartesianGraphicalItem:b$,addPolarGraphicalItem:w$,removePolarGraphicalItem:_$}=YN.actions,j$=YN.reducer;function XN(e){var t=Mt(),r=x.useRef(null);return x.useEffect(()=>{r.current===null?t(v$(e)):r.current!==e&&t(y$({prev:r.current,next:e})),r.current=e},[t,e]),x.useEffect(()=>()=>{r.current&&(t(b$(r.current)),r.current=null)},[t]),null}function N$(e){var t=Mt();return x.useEffect(()=>(t(w$(e)),()=>{t(_$(e))}),[t,e]),null}var k$=["onMouseEnter","onClick","onMouseLeave"],S$=["id"],E$=["id"];function Ip(e,t){if(e==null)return{};var r,s,a=C$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function C$(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function W0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Nt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W0(Object(r),!0).forEach(function(s){P$(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function P$(e,t,r){return(t=A$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A$(e){var t=T$(e,"string");return typeof t=="symbol"?t:t+""}function T$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ms(){return Ms=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ms.apply(null,arguments)}function O$(e){var t=x.useMemo(()=>Uf(e.children,Xo),[e.children]),r=Ae(s=>K3(s,e.id,t));return r==null?null:x.createElement(h$,{legendPayload:r})}function M$(e){var{dataKey:t,nameKey:r,sectors:s,stroke:a,strokeWidth:i,fill:l,name:c,hide:d,tooltipType:f}=e;return{dataDefinedOnItem:s.map(h=>h.tooltipPayload),positions:s.map(h=>h.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:l,dataKey:t,nameKey:r,name:Ni(c,t),hide:d,type:f,color:l,unit:""}}}var I$=(e,t)=>e>t?"start":e<t?"end":"middle",L$=(e,t,r)=>_r(typeof t=="function"?t(e):t,r,r*.8),D$=(e,t,r)=>{var{top:s,left:a,width:i,height:l}=t,c=Gw(i,l),d=a+_r(e.cx,i,i/2),f=s+_r(e.cy,l,l/2),h=_r(e.innerRadius,c,0),m=L$(r,e.outerRadius,c),g=e.maxRadius||Math.sqrt(i*i+l*l)/2;return{cx:d,cy:f,innerRadius:h,outerRadius:m,maxRadius:g}},R$=(e,t)=>{var r=or(t-e),s=Math.min(Math.abs(t-e),360);return r*s};function $$(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var z$=(e,t)=>{if(x.isValidElement(e))return x.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Ve("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return x.createElement(lo,Ms({},t,{type:"linear",className:r}))},B$=(e,t,r)=>{if(x.isValidElement(e))return x.cloneElement(e,t);var s=r;if(typeof e=="function"&&(s=e(t),x.isValidElement(s)))return s;var a=Ve("recharts-pie-label-text",$$(e));return x.createElement(Ud,Ms({},t,{alignmentBaseline:"middle",className:a}),s)};function F$(e){var{sectors:t,props:r,showLabels:s}=e,{label:a,labelLine:i,dataKey:l}=r;if(!s||!a||!t)return null;var c=jn(r),d=Lt(a,!1),f=Lt(i,!1),h=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,m=t.map((g,v)=>{var j=(g.startAngle+g.endAngle)/2,_=Gt(g.cx,g.cy,g.outerRadius+h,j),y=Nt(Nt(Nt(Nt({},c),g),{},{stroke:"none"},d),{},{index:v,textAnchor:I$(_.x,g.cx)},_),w=Nt(Nt(Nt(Nt({},c),g),{},{fill:"none",stroke:g.fill},f),{},{index:v,points:[Gt(g.cx,g.cy,g.outerRadius,j),_],key:"line"});return x.createElement(Vt,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(v)},i&&z$(i,w),B$(a,y,wt(g,l)))});return x.createElement(Vt,{className:"recharts-pie-labels"},m)}function U$(e){var{sectors:t,props:r,showLabels:s}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?x.createElement(Np,{label:a}):x.createElement(F$,{sectors:t,props:r,showLabels:s})}function W$(e){var{sectors:t,activeShape:r,inactiveShape:s,allOtherPieProps:a}=e,i=Ae(Os),{onMouseEnter:l,onClick:c,onMouseLeave:d}=a,f=Ip(a,k$),h=Pp(l,a.dataKey),m=Ap(d),g=Tp(c,a.dataKey);return t==null||t.length===0?null:x.createElement(x.Fragment,null,t.map((v,j)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&t.length!==1)return null;var _=r&&String(j)===i,y=i?s:null,w=_?r:y,k=Nt(Nt({},v),{},{stroke:v.stroke,tabIndex:-1,[Xw]:j,[Jw]:a.dataKey});return x.createElement(Vt,Ms({tabIndex:-1,className:"recharts-pie-sector"},Io(f,v,j),{onMouseEnter:h(v,j),onMouseLeave:m(v,j),onClick:g(v,j),key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(j)}),x.createElement(VN,Ms({option:w,isActive:_,shapeType:"sector"},k)))}))}function q$(e){var t,{pieSettings:r,displayedData:s,cells:a,offset:i}=e,{cornerRadius:l,startAngle:c,endAngle:d,dataKey:f,nameKey:h,tooltipType:m}=r,g=Math.abs(r.minAngle),v=R$(c,d),j=Math.abs(v),_=s.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=s.filter(T=>wt(T,f,0)!==0).length,w=(j>=360?y:y-1)*_,k=j-y*g-w,N=s.reduce((T,A)=>{var C=wt(A,f,0);return T+(Pe(C)?C:0)},0),P;if(N>0){var O;P=s.map((T,A)=>{var C=wt(T,f,0),E=wt(T,h,A),D=D$(r,i,T),$=(Pe(C)?C:0)/N,M,z=Nt(Nt({},T),a&&a[A]&&a[A].props);A?M=O.endAngle+or(v)*_*(C!==0?1:0):M=c;var K=M+or(v)*((C!==0?g:0)+$*k),W=(M+K)/2,U=(D.innerRadius+D.outerRadius)/2,Y=[{name:E,value:C,payload:z,dataKey:f,type:m}],R=Gt(D.cx,D.cy,U,W);return O=Nt(Nt(Nt(Nt({},r.presentationProps),{},{percent:$,cornerRadius:l,name:E,tooltipPayload:Y,midAngle:W,middleRadius:U,tooltipPosition:R},z),D),{},{value:C,startAngle:M,endAngle:K,payload:z,paddingAngle:or(v)*_}),O})}return P}function G$(e){var{showLabels:t,sectors:r,children:s}=e,a=x.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return x.createElement(O3,{value:t?a:void 0},s)}function H$(e){var{props:t,previousSectorsRef:r}=e,{sectors:s,isAnimationActive:a,animationBegin:i,animationDuration:l,animationEasing:c,activeShape:d,inactiveShape:f,onAnimationStart:h,onAnimationEnd:m}=t,g=zo(t,"recharts-pie-"),v=r.current,[j,_]=x.useState(!1),y=x.useCallback(()=>{typeof m=="function"&&m(),_(!1)},[m]),w=x.useCallback(()=>{typeof h=="function"&&h(),_(!0)},[h]);return x.createElement(G$,{showLabels:!j,sectors:s},x.createElement($o,{animationId:g,begin:i,duration:l,isActive:a,easing:c,onAnimationStart:w,onAnimationEnd:y,key:g},k=>{var N=[],P=s&&s[0],O=P==null?void 0:P.startAngle;return s==null||s.forEach((T,A)=>{var C=v&&v[A],E=A>0?va(T,"paddingAngle",0):0;if(C){var D=At(C.endAngle-C.startAngle,T.endAngle-T.startAngle,k),$=Nt(Nt({},T),{},{startAngle:O+E,endAngle:O+D+E});N.push($),O=$.endAngle}else{var{endAngle:M,startAngle:z}=T,K=At(0,M-z,k),W=Nt(Nt({},T),{},{startAngle:O+E,endAngle:O+K+E});N.push(W),O=W.endAngle}}),r.current=N,x.createElement(Vt,null,x.createElement(W$,{sectors:N,activeShape:d,inactiveShape:f,allOtherPieProps:t}))}),x.createElement(U$,{showLabels:!j,sectors:s,props:t}),t.children)}var V$={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Ds.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function K$(e){var{id:t}=e,r=Ip(e,S$),{hide:s,className:a,rootTabIndex:i}=e,l=x.useMemo(()=>Uf(e.children,Xo),[e.children]),c=Ae(h=>Z3(h,t,l)),d=x.useRef(null),f=Ve("recharts-pie",a);return s||c==null?(d.current=null,x.createElement(Vt,{tabIndex:i,className:f})):x.createElement(x.Fragment,null,x.createElement(Op,{fn:M$,args:Nt(Nt({},e),{},{sectors:c})}),x.createElement(Vt,{tabIndex:i,className:f},x.createElement(H$,{props:Nt(Nt({},r),{},{sectors:c}),previousSectorsRef:d})))}function JN(e){var t=xr(e,V$),{id:r}=t,s=Ip(t,E$),a=jn(s);return x.createElement(Mp,{id:r,type:"pie"},i=>x.createElement(x.Fragment,null,x.createElement(N$,{type:"pie",id:i,data:s.data,dataKey:s.dataKey,hide:s.hide,angleAxisId:0,radiusAxisId:0,name:s.name,nameKey:s.nameKey,tooltipType:s.tooltipType,legendType:s.legendType,fill:s.fill,cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,paddingAngle:s.paddingAngle,minAngle:s.minAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius,cornerRadius:s.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),x.createElement(O$,Ms({},s,{id:i})),x.createElement(K$,Ms({},s,{id:i}))))}JN.displayName="Pie";function q0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function G0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q0(Object(r),!0).forEach(function(s){Z$(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Z$(e,t,r){return(t=Y$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y$(e){var t=X$(e,"string");return typeof t=="symbol"?t:t+""}function X$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J$={xAxis:{},yAxis:{},zAxis:{}},QN=Zr({name:"cartesianAxis",initialState:J$,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:s}=t.payload;e.yAxis[r]&&(e.yAxis[r]=G0(G0({},e.yAxis[r]),{},{width:s}))}}}),{addXAxis:Q$,removeXAxis:ez,addYAxis:tz,removeYAxis:rz,addZAxis:w7,removeZAxis:_7,updateYAxisWidth:nz}=QN.actions,sz=QN.reducer,az=ee([Jt],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),iz=ee([az,fs,ms],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Lp=()=>Ae(iz),oz=()=>Ae(H6);function H0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function V0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H0(Object(r),!0).forEach(function(s){lz(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function lz(e,t,r){return(t=cz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cz(e){var t=dz(e,"string");return typeof t=="symbol"?t:t+""}function dz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uz=e=>{var{point:t,childIndex:r,mainColor:s,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var l=V0(V0({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:s??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Lt(a,!1)),Ff(a)),c;return x.isValidElement(a)?c=x.cloneElement(a,l):typeof a=="function"?c=a(l):c=x.createElement(FN,l),x.createElement(Vt,{className:"recharts-active-dot"},c)};function K0(e){var{points:t,mainColor:r,activeDot:s,itemDataKey:a}=e,i=Ae(Os),l=oz();if(t==null||l==null)return null;var c=t.find(d=>l.includes(d.payload));return Ot(c)?null:uz({point:c,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:s})}var hz="Invariant failed";function fz(e,t){throw new Error(hz)}var mz=["x","y"];function ff(){return ff=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ff.apply(null,arguments)}function Z0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function to(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z0(Object(r),!0).forEach(function(s){pz(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function pz(e,t,r){return(t=gz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gz(e){var t=xz(e,"string");return typeof t=="symbol"?t:t+""}function xz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vz(e,t){if(e==null)return{};var r,s,a=yz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yz(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function bz(e,t){var{x:r,y:s}=e,a=vz(e,mz),i="".concat(r),l=parseInt(i,10),c="".concat(s),d=parseInt(c,10),f="".concat(t.height||a.height),h=parseInt(f,10),m="".concat(t.width||a.width),g=parseInt(m,10);return to(to(to(to(to({},t),a),l?{x:l}:{}),d?{y:d}:{}),{},{height:h,width:g,name:t.name,radius:t.radius})}function Dp(e){return x.createElement(VN,ff({shapeType:"rectangle",propTransformer:bz,activeClassName:"recharts-active-bar"},e))}var wz=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,a)=>{if(Pe(t))return t;var i=Pe(s)||Ot(s);return i?t(s,a):(i||fz(),r)}},_z={},e1=Zr({name:"errorBars",initialState:_z,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:s}=t.payload;e[r]||(e[r]=[]),e[r].push(s)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:s,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===s.dataKey&&i.direction===s.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:s}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==s.dataKey||a.direction!==s.direction))}}}),{addErrorBar:j7,replaceErrorBar:N7,removeErrorBar:k7}=e1.actions,jz=e1.reducer,Nz=["children"];function kz(e,t){if(e==null)return{};var r,s,a=Sz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Sz(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ez={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Cz=x.createContext(Ez);function Pz(e){var{children:t}=e,r=kz(e,Nz);return x.createElement(Cz.Provider,{value:r},t)}function Rp(e,t){var r,s,a=Ae(f=>gs(f,e)),i=Ae(f=>xs(f,t)),l=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Fr.allowDataOverflow,c=(s=i==null?void 0:i.allowDataOverflow)!==null&&s!==void 0?s:Ur.allowDataOverflow,d=l||c;return{needClip:d,needClipX:l,needClipY:c}}function t1(e){var{xAxisId:t,yAxisId:r,clipPathId:s}=e,a=Lp(),{needClipX:i,needClipY:l,needClip:c}=Rp(t,r);if(!c)return null;var{x:d,y:f,width:h,height:m}=a;return x.createElement("clipPath",{id:"clipPath-".concat(s)},x.createElement("rect",{x:i?d:d-h/2,y:l?f:f-m/2,width:i?h:h*2,height:l?m:m*2}))}var Az=["onMouseEnter","onMouseLeave","onClick"],Tz=["value","background","tooltipPosition"],Oz=["id"],Mz=["onMouseEnter","onClick","onMouseLeave"];function Is(){return Is=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Is.apply(null,arguments)}function Y0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y0(Object(r),!0).forEach(function(s){Iz(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Iz(e,t,r){return(t=Lz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lz(e){var t=Dz(e,"string");return typeof t=="symbol"?t:t+""}function Dz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cc(e,t){if(e==null)return{};var r,s,a=Rz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Rz(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var $z=e=>{var{dataKey:t,name:r,fill:s,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:s,value:Ni(r,t),payload:e}]};function zz(e){var{dataKey:t,stroke:r,strokeWidth:s,fill:a,name:i,hide:l,unit:c}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:a,dataKey:t,nameKey:void 0,name:Ni(i,t),hide:l,type:e.tooltipType,color:e.fill,unit:c}}}function Bz(e){var t=Ae(Os),{data:r,dataKey:s,background:a,allOtherBarProps:i}=e,{onMouseEnter:l,onMouseLeave:c,onClick:d}=i,f=Cc(i,Az),h=Pp(l,s),m=Ap(c),g=Tp(d,s);if(!a||r==null)return null;var v=Lt(a,!1);return x.createElement(x.Fragment,null,r.map((j,_)=>{var{value:y,background:w,tooltipPosition:k}=j,N=Cc(j,Tz);if(!w)return null;var P=h(j,_),O=m(j,_),T=g(j,_),A=Sr(Sr(Sr(Sr(Sr({option:a,isActive:String(_)===t},N),{},{fill:"#eee"},w),v),Io(f,j,_)),{},{onMouseEnter:P,onMouseLeave:O,onClick:T,dataKey:s,index:_,className:"recharts-bar-background-rectangle"});return x.createElement(Dp,Is({key:"background-bar-".concat(A.index)},A))}))}function Fz(e){var{showLabels:t,children:r,rects:s}=e,a=s==null?void 0:s.map(i=>{var l={x:i.x,y:i.y,width:i.width,height:i.height};return Sr(Sr({},l),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:l,fill:i.fill})});return x.createElement(zN,{value:t?a:void 0},r)}function Uz(e){var{shape:t,activeBar:r,baseProps:s,entry:a,index:i,dataKey:l}=e,c=Ae(Os),d=Ae(hN),f=r&&String(i)===c&&(d==null||l===d),h=f?r:t;return x.createElement(Dp,Is({},s,a,{isActive:f,option:h,index:i,dataKey:l}))}function Wz(e){var{shape:t,baseProps:r,entry:s,index:a,dataKey:i}=e;return x.createElement(Dp,Is({},r,s,{isActive:!1,option:t,index:a,dataKey:i}))}function qz(e){var{data:t,props:r}=e,s=jn(r),{id:a}=s,i=Cc(s,Oz),{shape:l,dataKey:c,activeBar:d}=r,{onMouseEnter:f,onClick:h,onMouseLeave:m}=r,g=Cc(r,Mz),v=Pp(f,c),j=Ap(m),_=Tp(h,c);return t?x.createElement(x.Fragment,null,t.map((y,w)=>x.createElement(Vt,Is({className:"recharts-bar-rectangle"},Io(g,y,w),{onMouseEnter:v(y,w),onMouseLeave:j(y,w),onClick:_(y,w),key:"rectangle-".concat(y==null?void 0:y.x,"-").concat(y==null?void 0:y.y,"-").concat(y==null?void 0:y.value,"-").concat(w)}),d?x.createElement(Uz,{shape:l,activeBar:d,baseProps:i,entry:y,index:w,dataKey:c}):x.createElement(Wz,{shape:l,baseProps:i,entry:y,index:w,dataKey:c})))):null}function Gz(e){var{props:t,previousRectanglesRef:r}=e,{data:s,layout:a,isAnimationActive:i,animationBegin:l,animationDuration:c,animationEasing:d,onAnimationEnd:f,onAnimationStart:h}=t,m=r.current,g=zo(t,"recharts-bar-"),[v,j]=x.useState(!1),_=!v,y=x.useCallback(()=>{typeof f=="function"&&f(),j(!1)},[f]),w=x.useCallback(()=>{typeof h=="function"&&h(),j(!0)},[h]);return x.createElement(Fz,{showLabels:_,rects:s},x.createElement($o,{animationId:g,begin:l,duration:c,isActive:i,easing:d,onAnimationEnd:y,onAnimationStart:w,key:g},k=>{var N=k===1?s:s==null?void 0:s.map((P,O)=>{var T=m&&m[O];if(T)return Sr(Sr({},P),{},{x:At(T.x,P.x,k),y:At(T.y,P.y,k),width:At(T.width,P.width,k),height:At(T.height,P.height,k)});if(a==="horizontal"){var A=At(0,P.height,k);return Sr(Sr({},P),{},{y:P.y+P.height-A,height:A})}var C=At(0,P.width,k);return Sr(Sr({},P),{},{width:C})});return k>0&&(r.current=N??null),N==null?null:x.createElement(Vt,null,x.createElement(qz,{props:t,data:N}))}),x.createElement(Np,{label:t.label}),t.children)}function Hz(e){var t=x.useRef(null);return x.createElement(Gz,{previousRectanglesRef:t,props:e})}var r1=0,Vz=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:wt(e,t)}};class Kz extends x.PureComponent{render(){var{hide:t,data:r,dataKey:s,className:a,xAxisId:i,yAxisId:l,needClip:c,background:d,id:f}=this.props;if(t||r==null)return null;var h=Ve("recharts-bar",a),m=f;return x.createElement(Vt,{className:h,id:f},c&&x.createElement("defs",null,x.createElement(t1,{clipPathId:m,xAxisId:i,yAxisId:l})),x.createElement(Vt,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(m,")"):void 0},x.createElement(Bz,{data:r,dataKey:s,background:d,allOtherBarProps:this.props}),x.createElement(Hz,this.props)))}}var Zz={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Ds.isSsr,legendType:"rect",minPointSize:r1,xAxisId:0,yAxisId:0};function Yz(e){var{xAxisId:t,yAxisId:r,hide:s,legendType:a,minPointSize:i,activeBar:l,animationBegin:c,animationDuration:d,animationEasing:f,isAnimationActive:h}=e,{needClip:m}=Rp(t,r),g=_d(),v=$r(),j=Uf(e.children,Xo),_=Ae(k=>NB(k,t,r,v,e.id,j));if(g!=="vertical"&&g!=="horizontal")return null;var y,w=_==null?void 0:_[0];return w==null||w.height==null||w.width==null?y=0:y=g==="vertical"?w.height/2:w.width/2,x.createElement(Pz,{xAxisId:t,yAxisId:r,data:_,dataPointFormatter:Vz,errorBarOffset:y},x.createElement(Kz,Is({},e,{layout:g,needClip:m,data:_,xAxisId:t,yAxisId:r,hide:s,legendType:a,minPointSize:i,activeBar:l,animationBegin:c,animationDuration:d,animationEasing:f,isAnimationActive:h})))}function Xz(e){var{layout:t,barSettings:{dataKey:r,minPointSize:s},pos:a,bandSize:i,xAxis:l,yAxis:c,xAxisTicks:d,yAxisTicks:f,stackedData:h,displayedData:m,offset:g,cells:v,parentViewBox:j}=e,_=t==="horizontal"?c:l,y=h?_.scale.domain():null,w=k5({numericAxis:_});return m.map((k,N)=>{var P,O,T,A,C,E;h?P=b5(h[N],y):(P=wt(k,r),Array.isArray(P)||(P=[w,P]));var D=wz(s,r1)(P[1],N);if(t==="horizontal"){var $,[M,z]=[c.scale(P[0]),c.scale(P[1])];O=Zx({axis:l,ticks:d,bandSize:i,offset:a.offset,entry:k,index:N}),T=($=z??M)!==null&&$!==void 0?$:void 0,A=a.size;var K=M-z;if(C=Rr(K)?0:K,E={x:O,y:g.top,width:A,height:g.height},Math.abs(D)>0&&Math.abs(C)<Math.abs(D)){var W=or(C||D)*(Math.abs(D)-Math.abs(C));T-=W,C+=W}}else{var[U,Y]=[l.scale(P[0]),l.scale(P[1])];if(O=U,T=Zx({axis:c,ticks:f,bandSize:i,offset:a.offset,entry:k,index:N}),A=Y-U,C=a.size,E={x:g.left,y:T,width:g.width,height:C},Math.abs(D)>0&&Math.abs(A)<Math.abs(D)){var R=or(A||D)*(Math.abs(D)-Math.abs(A));A+=R}}if(O==null||T==null||A==null||C==null)return null;var H=Sr(Sr({},k),{},{x:O,y:T,width:A,height:C,value:h?P:P[1],payload:k,background:E,tooltipPosition:{x:O+A/2,y:T+C/2},parentViewBox:j},v&&v[N]&&v[N].props);return H}).filter(Boolean)}function Jz(e){var t=xr(e,Zz),r=$r();return x.createElement(Mp,{id:t.id,type:"bar"},s=>x.createElement(x.Fragment,null,x.createElement(ZN,{legendPayload:$z(t)}),x.createElement(Op,{fn:zz,args:t}),x.createElement(XN,{type:"bar",id:s,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:Zw(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),x.createElement(Yz,Is({},t,{id:s}))))}var n1=x.memo(Jz);n1.displayName="Bar";function X0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function zl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X0(Object(r),!0).forEach(function(s){Qz(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X0(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Qz(e,t,r){return(t=eB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eB(e){var t=tB(e,"string");return typeof t=="symbol"?t:t+""}function tB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rB=(e,t)=>t,nB=(e,t,r)=>r,sB=(e,t,r,s)=>s,aB=(e,t,r,s,a)=>a,Jo=ee([Dd,aB],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),iB=ee([Jo],e=>e==null?void 0:e.maxBarSize),oB=(e,t,r,s,a,i)=>i,J0=(e,t,r)=>{var s=r??e;if(!Ot(s))return _r(s,t,0)},lB=ee([nt,Dd,rB,nB,sB],(e,t,r,s,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===s).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),cB=(e,t,r,s)=>{var a=nt(e);return a==="horizontal"?So(e,"yAxis",r,s):So(e,"xAxis",t,s)},dB=(e,t,r)=>{var s=nt(e);return s==="horizontal"?l0(e,"xAxis",t):l0(e,"yAxis",r)},uB=(e,t,r)=>{var s={},a=e.filter(Ld),i=e.filter(f=>f.stackId==null),l=a.reduce((f,h)=>(f[h.stackId]||(f[h.stackId]=[]),f[h.stackId].push(h),f),s),c=Object.entries(l).map(f=>{var[h,m]=f,g=m.map(j=>j.dataKey),v=J0(t,r,m[0].barSize);return{stackId:h,dataKeys:g,barSize:v}}),d=i.map(f=>{var h=[f.dataKey].filter(g=>g!=null),m=J0(t,r,f.barSize);return{stackId:void 0,dataKeys:h,barSize:m}});return[...c,...d]},hB=ee([lB,tD,dB],uB),fB=(e,t,r,s,a)=>{var i,l,c=Jo(e,t,r,s,a);if(c!=null){var d=nt(e),f=dj(e),{maxBarSize:h}=c,m=Ot(h)?f:h,g,v;return d==="horizontal"?(g=Ts(e,"xAxis",t,s),v=As(e,"xAxis",t,s)):(g=Ts(e,"yAxis",r,s),v=As(e,"yAxis",r,s)),(i=(l=yo(g,v,!0))!==null&&l!==void 0?l:m)!==null&&i!==void 0?i:0}},s1=(e,t,r,s)=>{var a=nt(e),i,l;return a==="horizontal"?(i=Ts(e,"xAxis",t,s),l=As(e,"xAxis",t,s)):(i=Ts(e,"yAxis",r,s),l=As(e,"yAxis",r,s)),yo(i,l)};function mB(e,t,r,s,a){var i=s.length;if(!(i<1)){var l=_r(e,r,0,!0),c,d=[];if(gr(s[0].barSize)){var f=!1,h=r/i,m=s.reduce((w,k)=>w+(k.barSize||0),0);m+=(i-1)*l,m>=r&&(m-=(i-1)*l,l=0),m>=r&&h>0&&(f=!0,h*=.9,m=i*h);var g=(r-m)/2>>0,v={offset:g-l,size:0};c=s.reduce((w,k)=>{var N,P={stackId:k.stackId,dataKeys:k.dataKeys,position:{offset:v.offset+v.size+l,size:f?h:(N=k.barSize)!==null&&N!==void 0?N:0}},O=[...w,P];return v=O[O.length-1].position,O},d)}else{var j=_r(t,r,0,!0);r-2*j-(i-1)*l<=0&&(l=0);var _=(r-2*j-(i-1)*l)/i;_>1&&(_>>=0);var y=gr(a)?Math.min(_,a):_;c=s.reduce((w,k,N)=>[...w,{stackId:k.stackId,dataKeys:k.dataKeys,position:{offset:j+(_+l)*N+(_-y)/2,size:y}}],d)}return c}}var pB=(e,t,r,s,a,i,l)=>{var c=Ot(l)?t:l,d=mB(r,s,a!==i?a:i,e,c);return a!==i&&d!=null&&(d=d.map(f=>zl(zl({},f),{},{position:zl(zl({},f.position),{},{offset:f.position.offset-a/2})}))),d},gB=ee([hB,dj,eD,uj,fB,s1,iB],pB),xB=(e,t,r,s)=>Ts(e,"xAxis",t,s),vB=(e,t,r,s)=>Ts(e,"yAxis",r,s),yB=(e,t,r,s)=>As(e,"xAxis",t,s),bB=(e,t,r,s)=>As(e,"yAxis",r,s),wB=ee([gB,Jo],(e,t)=>{if(!(e==null||t==null)){var r=e.find(s=>s.stackId===t.stackId&&t.dataKey!=null&&s.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),_B=(e,t)=>{var r=Id(t);if(!(!e||r==null||t==null)){var{stackId:s}=t;if(s!=null){var a=e[s];if(a){var{stackedData:i}=a;if(i)return i.find(l=>l.key===r)}}}},jB=ee([cB,Jo],_B),NB=ee([Jt,fm,xB,vB,yB,bB,wB,nt,Ad,s1,jB,Jo,oB],(e,t,r,s,a,i,l,c,d,f,h,m,g)=>{var{chartData:v,dataStartIndex:j,dataEndIndex:_}=d;if(!(m==null||l==null||t==null||c!=="horizontal"&&c!=="vertical"||r==null||s==null||a==null||i==null||f==null)){var{data:y}=m,w;if(y!=null&&y.length>0?w=y:w=v==null?void 0:v.slice(j,_+1),w!=null)return Xz({layout:c,barSettings:m,pos:l,parentViewBox:t,bandSize:f,xAxis:r,yAxis:s,xAxisTicks:a,yAxisTicks:i,stackedData:h,displayedData:w,offset:e,cells:g})}}),a1=e=>{var{chartData:t}=e,r=Mt(),s=$r();return x.useEffect(()=>s?()=>{}:(r(x0(t)),()=>{r(x0(void 0))}),[t,r,s]),null},Q0={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},i1=Zr({name:"brush",initialState:Q0,reducers:{setBrushSettings(e,t){return t.payload==null?Q0:t.payload}}}),{setBrushSettings:S7}=i1.actions,kB=i1.reducer;function SB(e,t,r){return(t=EB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EB(e){var t=CB(e,"string");return typeof t=="symbol"?t:t+""}function CB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class $p{static create(t){return new $p(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(s)switch(s){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+l}return this.scale(t)}}isInRange(t){var r=this.range(),s=r[0],a=r[r.length-1];return s<=a?t>=s&&t<=a:t>=a&&t<=s}}SB($p,"EPS",1e-4);function PB(e){return(e%180+180)%180}var AB=function(t){var{width:r,height:s}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=PB(a),l=i*Math.PI/180,c=Math.atan(s/r),d=l>c&&l<Math.PI-c?s/Math.sin(l):r/Math.cos(l);return Math.abs(d)},TB={dots:[],areas:[],lines:[]},o1=Zr({name:"referenceElements",initialState:TB,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=ts(e).dots.findIndex(s=>s===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=ts(e).areas.findIndex(s=>s===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=ts(e).lines.findIndex(s=>s===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:E7,removeDot:C7,addArea:P7,removeArea:A7,addLine:T7,removeLine:O7}=o1.actions,OB=o1.reducer,MB=x.createContext(void 0),IB=e=>{var{children:t}=e,[r]=x.useState("".concat(go("recharts"),"-clip")),s=Lp();if(s==null)return null;var{x:a,y:i,width:l,height:c}=s;return x.createElement(MB.Provider,{value:r},x.createElement("defs",null,x.createElement("clipPath",{id:r},x.createElement("rect",{x:a,y:i,height:c,width:l}))),t)};function vi(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var s in t)if({}.hasOwnProperty.call(t,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function l1(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var s=[],a=0;a<e.length;a+=t)s.push(e[a]);return s}function LB(e,t,r){var s={width:e.width+t.width,height:e.height+t.height};return AB(s,r)}function DB(e,t,r){var s=r==="width",{x:a,y:i,width:l,height:c}=e;return t===1?{start:s?a:i,end:s?a+l:i+c}:{start:s?a+l:i+c,end:s?a:i}}function Pc(e,t,r,s,a){if(e*t<e*s||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-s)>=0&&e*(t+e*i/2-a)<=0}function RB(e,t){return l1(e,t+1)}function $B(e,t,r,s,a){for(var i=(s||[]).slice(),{start:l,end:c}=t,d=0,f=1,h=l,m=function(){var j=s==null?void 0:s[d];if(j===void 0)return{v:l1(s,f)};var _=d,y,w=()=>(y===void 0&&(y=r(j,_)),y),k=j.coordinate,N=d===0||Pc(e,k,w,h,c);N||(d=0,h=l,f+=1),N&&(h=k+e*(w()/2+a),d+=f)},g;f<=i.length;)if(g=m(),g)return g.v;return[]}function ey(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ey(Object(r),!0).forEach(function(s){zB(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ey(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function zB(e,t,r){return(t=BB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BB(e){var t=FB(e,"string");return typeof t=="symbol"?t:t+""}function FB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UB(e,t,r,s,a){for(var i=(s||[]).slice(),l=i.length,{start:c}=t,{end:d}=t,f=function(g){var v=i[g],j,_=()=>(j===void 0&&(j=r(v,g)),j);if(g===l-1){var y=e*(v.coordinate+e*_()/2-d);i[g]=v=br(br({},v),{},{tickCoord:y>0?v.coordinate-y*e:v.coordinate})}else i[g]=v=br(br({},v),{},{tickCoord:v.coordinate});var w=Pc(e,v.tickCoord,_,c,d);w&&(d=v.tickCoord-e*(_()/2+a),i[g]=br(br({},v),{},{isShow:!0}))},h=l-1;h>=0;h--)f(h);return i}function WB(e,t,r,s,a,i){var l=(s||[]).slice(),c=l.length,{start:d,end:f}=t;if(i){var h=s[c-1],m=r(h,c-1),g=e*(h.coordinate+e*m/2-f);l[c-1]=h=br(br({},h),{},{tickCoord:g>0?h.coordinate-g*e:h.coordinate});var v=Pc(e,h.tickCoord,()=>m,d,f);v&&(f=h.tickCoord-e*(m/2+a),l[c-1]=br(br({},h),{},{isShow:!0}))}for(var j=i?c-1:c,_=function(k){var N=l[k],P,O=()=>(P===void 0&&(P=r(N,k)),P);if(k===0){var T=e*(N.coordinate-e*O()/2-d);l[k]=N=br(br({},N),{},{tickCoord:T<0?N.coordinate-T*e:N.coordinate})}else l[k]=N=br(br({},N),{},{tickCoord:N.coordinate});var A=Pc(e,N.tickCoord,O,d,f);A&&(d=N.tickCoord+e*(O()/2+a),l[k]=br(br({},N),{},{isShow:!0}))},y=0;y<j;y++)_(y);return l}function zp(e,t,r){var{tick:s,ticks:a,viewBox:i,minTickGap:l,orientation:c,interval:d,tickFormatter:f,unit:h,angle:m}=e;if(!a||!a.length||!s)return[];if(Pe(d)||Ds.isSsr){var g;return(g=RB(a,Pe(d)?d:0))!==null&&g!==void 0?g:[]}var v=[],j=c==="top"||c==="bottom"?"width":"height",_=h&&j==="width"?uo(h,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(N,P)=>{var O=typeof f=="function"?f(N.value,P):N.value;return j==="width"?LB(uo(O,{fontSize:t,letterSpacing:r}),_,m):uo(O,{fontSize:t,letterSpacing:r})[j]},w=a.length>=2?or(a[1].coordinate-a[0].coordinate):1,k=DB(i,w,j);return d==="equidistantPreserveStart"?$B(w,k,y,a,l):(d==="preserveStart"||d==="preserveStartEnd"?v=WB(w,k,y,a,l,d==="preserveStartEnd"):v=UB(w,k,y,a,l),v.filter(N=>N.isShow))}var qB=e=>{var{ticks:t,label:r,labelGapWithTick:s=5,tickSize:a=0,tickMargin:i=0}=e,l=0;if(t){t.forEach(h=>{if(h){var m=h.getBoundingClientRect();m.width>l&&(l=m.width)}});var c=r?r.getBoundingClientRect().width:0,d=a+i,f=l+d+c+(r?s:0);return Math.round(f)}return 0},GB=["axisLine","width","height","className","hide","ticks"],HB=["viewBox"],VB=["viewBox"];function mf(e,t){if(e==null)return{};var r,s,a=KB(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function KB(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function _a(){return _a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_a.apply(null,arguments)}function ty(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ty(Object(r),!0).forEach(function(s){ZB(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ty(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function ZB(e,t,r){return(t=YB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YB(e){var t=XB(e,"string");return typeof t=="symbol"?t:t+""}function XB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bp={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function JB(e){var{x:t,y:r,width:s,height:a,orientation:i,mirror:l,axisLine:c,otherSvgProps:d}=e;if(!c)return null;var f=Xt(Xt(Xt({},d),Lt(c,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var h=+(i==="top"&&!l||i==="bottom"&&l);f=Xt(Xt({},f),{},{x1:t,y1:r+h*a,x2:t+s,y2:r+h*a})}else{var m=+(i==="left"&&!l||i==="right"&&l);f=Xt(Xt({},f),{},{x1:t+m*s,y1:r,x2:t+m*s,y2:r+a})}return x.createElement("line",_a({},f,{className:Ve("recharts-cartesian-axis-line",va(c,"className"))}))}function QB(e,t,r,s,a,i,l,c,d){var f,h,m,g,v,j,_=c?-1:1,y=e.tickSize||l,w=Pe(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":f=h=e.coordinate,g=r+ +!c*a,m=g-_*y,j=m-_*d,v=w;break;case"left":m=g=e.coordinate,h=t+ +!c*s,f=h-_*y,v=f-_*d,j=w;break;case"right":m=g=e.coordinate,h=t+ +c*s,f=h+_*y,v=f+_*d,j=w;break;default:f=h=e.coordinate,g=r+ +c*a,m=g+_*y,j=m+_*d,v=w;break}return{line:{x1:f,y1:m,x2:h,y2:g},tick:{x:v,y:j}}}function eF(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function tF(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function rF(e){var{option:t,tickProps:r,value:s}=e,a,i=Ve(r.className,"recharts-cartesian-axis-tick-value");if(x.isValidElement(t))a=x.cloneElement(t,Xt(Xt({},r),{},{className:i}));else if(typeof t=="function")a=t(Xt(Xt({},r),{},{className:i}));else{var l="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(l=Ve(l,t==null?void 0:t.className)),a=x.createElement(Ud,_a({},r,{className:l}),s)}return a}function nF(e){var{ticks:t=[],tick:r,tickLine:s,stroke:a,tickFormatter:i,unit:l,padding:c,tickTextProps:d,orientation:f,mirror:h,x:m,y:g,width:v,height:j,tickSize:_,tickMargin:y,fontSize:w,letterSpacing:k,getTicksConfig:N,events:P}=e,O=zp(Xt(Xt({},N),{},{ticks:t}),w,k),T=eF(f,h),A=tF(f,h),C=jn(N),E=Lt(r,!1),D=Xt(Xt({},C),{},{fill:"none"},Lt(s,!1)),$=O.map((M,z)=>{var{line:K,tick:W}=QB(M,m,g,v,j,f,_,h,y),U=Xt(Xt(Xt(Xt({textAnchor:T,verticalAnchor:A},C),{},{stroke:"none",fill:a},E),W),{},{index:z,payload:M,visibleTicksCount:O.length,tickFormatter:i,padding:c},d);return x.createElement(Vt,_a({className:"recharts-cartesian-axis-tick",key:"tick-".concat(M.value,"-").concat(M.coordinate,"-").concat(M.tickCoord)},Io(P,M,z)),s&&x.createElement("line",_a({},D,K,{className:Ve("recharts-cartesian-axis-tick-line",va(s,"className"))})),r&&x.createElement(rF,{option:r,tickProps:U,value:"".concat(typeof i=="function"?i(M.value,z):M.value).concat(l||"")}))});return $.length>0?x.createElement("g",{className:"recharts-cartesian-axis-ticks"},$):null}var sF=x.forwardRef((e,t)=>{var{axisLine:r,width:s,height:a,className:i,hide:l,ticks:c}=e,d=mf(e,GB),[f,h]=x.useState(""),[m,g]=x.useState(""),v=x.useRef([]);x.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var _;return qB({ticks:v.current,label:(_=e.labelRef)===null||_===void 0?void 0:_.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var j=x.useCallback(_=>{if(_){var y=_.getElementsByClassName("recharts-cartesian-axis-tick-value");v.current=Array.from(y);var w=y[0];if(w){var k=window.getComputedStyle(w),N=k.fontSize,P=k.letterSpacing;(N!==f||P!==m)&&(h(N),g(P))}}},[f,m]);return l||s!=null&&s<=0||a!=null&&a<=0?null:x.createElement(Vt,{className:Ve("recharts-cartesian-axis",i),ref:j},x.createElement(JB,{x:e.x,y:e.y,width:s,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:jn(e)}),x.createElement(nF,{ticks:c,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:f,letterSpacing:m,getTicksConfig:e,events:d}),x.createElement(p3,{x:e.x,y:e.y,width:e.width,height:e.height},x.createElement(k3,{label:e.label}),e.children))}),aF=x.memo(sF,(e,t)=>{var{viewBox:r}=e,s=mf(e,HB),{viewBox:a}=t,i=mf(t,VB);return vi(r,a)&&vi(s,i)}),Fp=x.forwardRef((e,t)=>{var r=xr(e,Bp);return x.createElement(aF,_a({},r,{ref:t}))});Fp.displayName="CartesianAxis";var iF=["x1","y1","x2","y2","key"],oF=["offset"],lF=["xAxisId","yAxisId"],cF=["xAxisId","yAxisId"];function ry(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function wr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ry(Object(r),!0).forEach(function(s){dF(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ry(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function dF(e,t,r){return(t=uF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uF(e){var t=hF(e,"string");return typeof t=="symbol"?t:t+""}function hF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ua(){return ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ua.apply(null,arguments)}function Ac(e,t){if(e==null)return{};var r,s,a=fF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fF(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var mF=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:s,y:a,width:i,height:l,ry:c}=e;return x.createElement("rect",{x:s,y:a,ry:c,width:i,height:l,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function c1(e,t){var r;if(x.isValidElement(e))r=x.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:s,y1:a,x2:i,y2:l,key:c}=t,d=Ac(t,iF),f=jn(d),{offset:h}=f,m=Ac(f,oF);r=x.createElement("line",ua({},m,{x1:s,y1:a,x2:i,y2:l,fill:"none",key:c}))}return r}function pF(e){var{x:t,width:r,horizontal:s=!0,horizontalPoints:a}=e;if(!s||!a||!a.length)return null;var{xAxisId:i,yAxisId:l}=e,c=Ac(e,lF),d=a.map((f,h)=>{var m=wr(wr({},c),{},{x1:t,y1:f,x2:t+r,y2:f,key:"line-".concat(h),index:h});return c1(s,m)});return x.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function gF(e){var{y:t,height:r,vertical:s=!0,verticalPoints:a}=e;if(!s||!a||!a.length)return null;var{xAxisId:i,yAxisId:l}=e,c=Ac(e,cF),d=a.map((f,h)=>{var m=wr(wr({},c),{},{x1:f,y1:t,x2:f,y2:t+r,key:"line-".concat(h),index:h});return c1(s,m)});return x.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function xF(e){var{horizontalFill:t,fillOpacity:r,x:s,y:a,width:i,height:l,horizontalPoints:c,horizontal:d=!0}=e;if(!d||!t||!t.length)return null;var f=c.map(m=>Math.round(m+a-a)).sort((m,g)=>m-g);a!==f[0]&&f.unshift(0);var h=f.map((m,g)=>{var v=!f[g+1],j=v?a+l-m:f[g+1]-m;if(j<=0)return null;var _=g%t.length;return x.createElement("rect",{key:"react-".concat(g),y:m,x:s,height:j,width:i,stroke:"none",fill:t[_],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function vF(e){var{vertical:t=!0,verticalFill:r,fillOpacity:s,x:a,y:i,width:l,height:c,verticalPoints:d}=e;if(!t||!r||!r.length)return null;var f=d.map(m=>Math.round(m+a-a)).sort((m,g)=>m-g);a!==f[0]&&f.unshift(0);var h=f.map((m,g)=>{var v=!f[g+1],j=v?a+l-m:f[g+1]-m;if(j<=0)return null;var _=g%r.length;return x.createElement("rect",{key:"react-".concat(g),x:m,y:i,width:j,height:c,stroke:"none",fill:r[_],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var yF=(e,t)=>{var{xAxis:r,width:s,height:a,offset:i}=e;return Vw(zp(wr(wr(wr({},Bp),r),{},{ticks:Kw(r),viewBox:{x:0,y:0,width:s,height:a}})),i.left,i.left+i.width,t)},bF=(e,t)=>{var{yAxis:r,width:s,height:a,offset:i}=e;return Vw(zp(wr(wr(wr({},Bp),r),{},{ticks:Kw(r),viewBox:{x:0,y:0,width:s,height:a}})),i.top,i.top+i.height,t)},wF={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function pf(e){var t=pm(),r=gm(),s=Qw(),a=wr(wr({},xr(e,wF)),{},{x:Pe(e.x)?e.x:s.left,y:Pe(e.y)?e.y:s.top,width:Pe(e.width)?e.width:s.width,height:Pe(e.height)?e.height:s.height}),{xAxisId:i,yAxisId:l,x:c,y:d,width:f,height:h,syncWithTicks:m,horizontalValues:g,verticalValues:v}=a,j=$r(),_=Ae(E=>c0(E,"xAxis",i,j)),y=Ae(E=>c0(E,"yAxis",l,j));if(!Pe(f)||f<=0||!Pe(h)||h<=0||!Pe(c)||c!==+c||!Pe(d)||d!==+d)return null;var w=a.verticalCoordinatesGenerator||yF,k=a.horizontalCoordinatesGenerator||bF,{horizontalPoints:N,verticalPoints:P}=a;if((!N||!N.length)&&typeof k=="function"){var O=g&&g.length,T=k({yAxis:y?wr(wr({},y),{},{ticks:O?g:y.ticks}):void 0,width:t,height:r,offset:s},O?!0:m);co(Array.isArray(T),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(N=T)}if((!P||!P.length)&&typeof w=="function"){var A=v&&v.length,C=w({xAxis:_?wr(wr({},_),{},{ticks:A?v:_.ticks}):void 0,width:t,height:r,offset:s},A?!0:m);co(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof C,"]")),Array.isArray(C)&&(P=C)}return x.createElement("g",{className:"recharts-cartesian-grid"},x.createElement(mF,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),x.createElement(xF,ua({},a,{horizontalPoints:N})),x.createElement(vF,ua({},a,{verticalPoints:P})),x.createElement(pF,ua({},a,{offset:s,horizontalPoints:N,xAxis:_,yAxis:y})),x.createElement(gF,ua({},a,{offset:s,verticalPoints:P,xAxis:_,yAxis:y})))}pf.displayName="CartesianGrid";var d1=(e,t,r,s)=>Ts(e,"xAxis",t,s),u1=(e,t,r,s)=>As(e,"xAxis",t,s),h1=(e,t,r,s)=>Ts(e,"yAxis",r,s),f1=(e,t,r,s)=>As(e,"yAxis",r,s),_F=ee([nt,d1,h1,u1,f1],(e,t,r,s,a)=>hs(e,"xAxis")?yo(t,s,!1):yo(r,a,!1)),jF=(e,t,r,s,a)=>a,m1=ee([Dd,jF],(e,t)=>e.filter(r=>r.type==="area").find(r=>r.id===t)),NF=(e,t,r,s,a)=>{var i,l=m1(e,t,r,s,a);if(l!=null){var c=nt(e),d=hs(c,"xAxis"),f;if(d?f=So(e,"yAxis",r,s):f=So(e,"xAxis",t,s),f!=null){var{stackId:h}=l,m=Id(l);if(!(h==null||m==null)){var g=(i=f[h])===null||i===void 0?void 0:i.stackedData;return g==null?void 0:g.find(v=>v.key===m)}}}},kF=ee([nt,d1,h1,u1,f1,NF,Ad,_F,m1],(e,t,r,s,a,i,l,c,d)=>{var{chartData:f,dataStartIndex:h,dataEndIndex:m}=l;if(!(d==null||e!=="horizontal"&&e!=="vertical"||t==null||r==null||s==null||a==null||s.length===0||a.length===0||c==null)){var{data:g}=d,v;if(g&&g.length>0?v=g:v=f==null?void 0:f.slice(h,m+1),v!=null){var j=void 0;return HF({layout:e,xAxis:t,yAxis:r,xAxisTicks:s,yAxisTicks:a,dataStartIndex:h,areaSettings:d,stackedData:i,displayedData:v,chartBaseValue:j,bandSize:c})}}}),SF=["id"],EF=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function p1(e,t){if(e==null)return{};var r,s,a=CF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CF(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function ny(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function es(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ny(Object(r),!0).forEach(function(s){PF(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ny(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function PF(e,t,r){return(t=AF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AF(e){var t=TF(e,"string");return typeof t=="symbol"?t:t+""}function TF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(){return ns=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ns.apply(null,arguments)}function Tc(e,t){return e&&e!=="none"?e:t}var OF=e=>{var{dataKey:t,name:r,stroke:s,fill:a,legendType:i,hide:l}=e;return[{inactive:l,dataKey:t,type:i,color:Tc(s,a),value:Ni(r,t),payload:e}]};function MF(e){var{dataKey:t,data:r,stroke:s,strokeWidth:a,fill:i,name:l,hide:c,unit:d}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:s,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:Ni(l,t),hide:c,type:e.tooltipType,color:Tc(s,i),unit:d}}}var IF=(e,t)=>{var r;if(x.isValidElement(e))r=x.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var s=Ve("recharts-area-dot",typeof e!="boolean"?e.className:"");r=x.createElement(FN,ns({},t,{className:s}))}return r};function LF(e,t){return e==null?!1:t?!0:e.length===1}function DF(e){var{clipPathId:t,points:r,props:s}=e,{needClip:a,dot:i,dataKey:l}=s;if(!LF(r,i))return null;var c=Eb(i),d=jn(s),f=Lt(i,!0),h=r.map((g,v)=>{var j=es(es(es({key:"dot-".concat(v),r:3},d),f),{},{index:v,cx:g.x,cy:g.y,dataKey:l,value:g.value,payload:g.payload,points:r});return IF(i,j)}),m={clipPath:a?"url(#clipPath-".concat(c?"":"dots-").concat(t,")"):void 0};return x.createElement(Vt,ns({className:"recharts-area-dots"},m),h)}function RF(e){var{showLabels:t,children:r,points:s}=e,a=s.map(i=>{var l={x:i.x,y:i.y,width:0,height:0};return es(es({},l),{},{value:i.value,payload:i.payload,parentViewBox:void 0,viewBox:l,fill:void 0})});return x.createElement(zN,{value:t?a:null},r)}function sy(e){var{points:t,baseLine:r,needClip:s,clipPathId:a,props:i}=e,{layout:l,type:c,stroke:d,connectNulls:f,isRange:h}=i,{id:m}=i,g=p1(i,SF),v=jn(g);return x.createElement(x.Fragment,null,(t==null?void 0:t.length)>1&&x.createElement(Vt,{clipPath:s?"url(#clipPath-".concat(a,")"):void 0},x.createElement(lo,ns({},v,{id:m,points:t,connectNulls:f,type:c,baseLine:r,layout:l,stroke:"none",className:"recharts-area-area"})),d!=="none"&&x.createElement(lo,ns({},v,{className:"recharts-area-curve",layout:l,type:c,connectNulls:f,fill:"none",points:t})),d!=="none"&&h&&x.createElement(lo,ns({},v,{className:"recharts-area-curve",layout:l,type:c,connectNulls:f,fill:"none",points:r}))),x.createElement(DF,{points:t,props:g,clipPathId:a}))}function $F(e){var{alpha:t,baseLine:r,points:s,strokeWidth:a}=e,i=s[0].y,l=s[s.length-1].y;if(!gr(i)||!gr(l))return null;var c=t*Math.abs(i-l),d=Math.max(...s.map(f=>f.x||0));return Pe(r)?d=Math.max(r,d):r&&Array.isArray(r)&&r.length&&(d=Math.max(...r.map(f=>f.x||0),d)),Pe(d)?x.createElement("rect",{x:0,y:i<l?i:i-c,width:d+(a?parseInt("".concat(a),10):1),height:Math.floor(c)}):null}function zF(e){var{alpha:t,baseLine:r,points:s,strokeWidth:a}=e,i=s[0].x,l=s[s.length-1].x;if(!gr(i)||!gr(l))return null;var c=t*Math.abs(i-l),d=Math.max(...s.map(f=>f.y||0));return Pe(r)?d=Math.max(r,d):r&&Array.isArray(r)&&r.length&&(d=Math.max(...r.map(f=>f.y||0),d)),Pe(d)?x.createElement("rect",{x:i<l?i:i-c,y:0,width:c,height:Math.floor(d+(a?parseInt("".concat(a),10):1))}):null}function BF(e){var{alpha:t,layout:r,points:s,baseLine:a,strokeWidth:i}=e;return r==="vertical"?x.createElement($F,{alpha:t,points:s,baseLine:a,strokeWidth:i}):x.createElement(zF,{alpha:t,points:s,baseLine:a,strokeWidth:i})}function FF(e){var{needClip:t,clipPathId:r,props:s,previousPointsRef:a,previousBaselineRef:i}=e,{points:l,baseLine:c,isAnimationActive:d,animationBegin:f,animationDuration:h,animationEasing:m,onAnimationStart:g,onAnimationEnd:v}=s,j=zo(s,"recharts-area-"),[_,y]=x.useState(!1),w=!_,k=x.useCallback(()=>{typeof v=="function"&&v(),y(!1)},[v]),N=x.useCallback(()=>{typeof g=="function"&&g(),y(!0)},[g]),P=a.current,O=i.current;return x.createElement(RF,{showLabels:w,points:l},s.children,x.createElement($o,{animationId:j,begin:f,duration:h,isActive:d,easing:m,onAnimationEnd:k,onAnimationStart:N,key:j},T=>{if(P){var A=P.length/l.length,C=T===1?l:l.map((D,$)=>{var M=Math.floor($*A);if(P[M]){var z=P[M];return es(es({},D),{},{x:At(z.x,D.x,T),y:At(z.y,D.y,T)})}return D}),E;return Pe(c)?E=At(O,c,T):Ot(c)||Rr(c)?E=At(O,0,T):E=c.map((D,$)=>{var M=Math.floor($*A);if(Array.isArray(O)&&O[M]){var z=O[M];return es(es({},D),{},{x:At(z.x,D.x,T),y:At(z.y,D.y,T)})}return D}),T>0&&(a.current=C,i.current=E),x.createElement(sy,{points:C,baseLine:E,needClip:t,clipPathId:r,props:s})}return T>0&&(a.current=l,i.current=c),x.createElement(Vt,null,d&&x.createElement("defs",null,x.createElement("clipPath",{id:"animationClipPath-".concat(r)},x.createElement(BF,{alpha:T,points:l,baseLine:c,layout:s.layout,strokeWidth:s.strokeWidth}))),x.createElement(Vt,{clipPath:"url(#animationClipPath-".concat(r,")")},x.createElement(sy,{points:l,baseLine:c,needClip:t,clipPathId:r,props:s})))}),x.createElement(Np,{label:s.label}))}function UF(e){var{needClip:t,clipPathId:r,props:s}=e,a=x.useRef(null),i=x.useRef();return x.createElement(FF,{needClip:t,clipPathId:r,props:s,previousPointsRef:a,previousBaselineRef:i})}class WF extends x.PureComponent{render(){var t,{hide:r,dot:s,points:a,className:i,top:l,left:c,needClip:d,xAxisId:f,yAxisId:h,width:m,height:g,id:v,baseLine:j}=this.props;if(r)return null;var _=Ve("recharts-area",i),y=v,{r:w=3,strokeWidth:k=2}=(t=Lt(s,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},N=Eb(s),P=w*2+k;return x.createElement(x.Fragment,null,x.createElement(Vt,{className:_},d&&x.createElement("defs",null,x.createElement(t1,{clipPathId:y,xAxisId:f,yAxisId:h}),!N&&x.createElement("clipPath",{id:"clipPath-dots-".concat(y)},x.createElement("rect",{x:c-P/2,y:l-P/2,width:m+P,height:g+P}))),x.createElement(UF,{needClip:d,clipPathId:y,props:this.props})),x.createElement(K0,{points:a,mainColor:Tc(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(j)&&x.createElement(K0,{points:j,mainColor:Tc(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var g1={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Ds.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function qF(e){var t,r=xr(e,g1),{activeDot:s,animationBegin:a,animationDuration:i,animationEasing:l,connectNulls:c,dot:d,fill:f,fillOpacity:h,hide:m,isAnimationActive:g,legendType:v,stroke:j,xAxisId:_,yAxisId:y}=r,w=p1(r,EF),k=_d(),N=mN(),{needClip:P}=Rp(_,y),O=$r(),{points:T,isRange:A,baseLine:C}=(t=Ae(K=>kF(K,_,y,O,e.id)))!==null&&t!==void 0?t:{},E=Lp();if(k!=="horizontal"&&k!=="vertical"||E==null||N!=="AreaChart"&&N!=="ComposedChart")return null;var{height:D,width:$,x:M,y:z}=E;return!T||!T.length?null:x.createElement(WF,ns({},w,{activeDot:s,animationBegin:a,animationDuration:i,animationEasing:l,baseLine:C,connectNulls:c,dot:d,fill:f,fillOpacity:h,height:D,hide:m,layout:k,isAnimationActive:g,isRange:A,legendType:v,needClip:P,points:T,stroke:j,width:$,left:M,top:z,xAxisId:_,yAxisId:y}))}var GF=(e,t,r,s,a)=>{var i=r??t;if(Pe(i))return i;var l=e==="horizontal"?a:s,c=l.scale.domain();if(l.type==="number"){var d=Math.max(c[0],c[1]),f=Math.min(c[0],c[1]);return i==="dataMin"?f:i==="dataMax"||d<0?d:Math.max(Math.min(c[0],c[1]),0)}return i==="dataMin"?c[0]:i==="dataMax"?c[1]:c[0]};function HF(e){var{areaSettings:{connectNulls:t,baseValue:r,dataKey:s},stackedData:a,layout:i,chartBaseValue:l,xAxis:c,yAxis:d,displayedData:f,dataStartIndex:h,xAxisTicks:m,yAxisTicks:g,bandSize:v}=e,j=a&&a.length,_=GF(i,l,r,c,d),y=i==="horizontal",w=!1,k=f.map((P,O)=>{var T;j?T=a[h+O]:(T=wt(P,s),Array.isArray(T)?w=!0:T=[_,T]);var A=T[1]==null||j&&!t&&wt(P,s)==null;return y?{x:Kx({axis:c,ticks:m,bandSize:v,entry:P,index:O}),y:A?null:d.scale(T[1]),value:T,payload:P}:{x:A?null:c.scale(T[1]),y:Kx({axis:d,ticks:g,bandSize:v,entry:P,index:O}),value:T,payload:P}}),N;return j||w?N=k.map(P=>{var O=Array.isArray(P.value)?P.value[0]:null;return y?{x:P.x,y:O!=null&&P.y!=null?d.scale(O):null,payload:P.payload}:{x:O!=null?c.scale(O):null,y:P.y,payload:P.payload}}):N=y?d.scale(_):c.scale(_),{points:k,baseLine:N,isRange:w}}function VF(e){var t=xr(e,g1),r=$r();return x.createElement(Mp,{id:t.id,type:"area"},s=>x.createElement(x.Fragment,null,x.createElement(ZN,{legendPayload:OF(t)}),x.createElement(Op,{fn:MF,args:t}),x.createElement(XN,{type:"area",id:s,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:Zw(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:r,connectNulls:t.connectNulls}),x.createElement(qF,ns({},t,{id:s}))))}var gf=x.memo(VF);gf.displayName="Area";var KF=["dangerouslySetInnerHTML","ticks"],ZF=["id"],YF=["domain"],XF=["domain"];function xf(){return xf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},xf.apply(null,arguments)}function Oc(e,t){if(e==null)return{};var r,s,a=JF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JF(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function QF(e){var t=Mt();return x.useEffect(()=>(t(Q$(e)),()=>{t(ez(e))}),[e,t]),null}var e8=e=>{var{xAxisId:t,className:r}=e,s=Ae(fm),a=$r(),i="xAxis",l=Ae(y=>Ti(y,i,t,a)),c=Ae(y=>Vj(y,i,t,a)),d=Ae(y=>Wj(y,t)),f=Ae(y=>HD(y,t)),h=Ae(y=>bj(y,t));if(d==null||f==null||h==null)return null;var{dangerouslySetInnerHTML:m,ticks:g}=e,v=Oc(e,KF),{id:j}=h,_=Oc(h,ZF);return x.createElement(Fp,xf({},v,_,{scale:l,x:f.x,y:f.y,width:d.width,height:d.height,className:Ve("recharts-".concat(i," ").concat(i),r),viewBox:s,ticks:c}))},t8={allowDataOverflow:Fr.allowDataOverflow,allowDecimals:Fr.allowDecimals,allowDuplicatedCategory:Fr.allowDuplicatedCategory,height:Fr.height,hide:!1,mirror:Fr.mirror,orientation:Fr.orientation,padding:Fr.padding,reversed:Fr.reversed,scale:Fr.scale,tickCount:Fr.tickCount,type:Fr.type,xAxisId:0},r8=e=>{var t,r,s,a,i,l=xr(e,t8);return x.createElement(x.Fragment,null,x.createElement(QF,{interval:(t=l.interval)!==null&&t!==void 0?t:"preserveEnd",id:l.xAxisId,scale:l.scale,type:l.type,padding:l.padding,allowDataOverflow:l.allowDataOverflow,domain:l.domain,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,includeHidden:(r=l.includeHidden)!==null&&r!==void 0?r:!1,reversed:l.reversed,ticks:l.ticks,height:l.height,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(s=l.angle)!==null&&s!==void 0?s:0,minTickGap:(a=l.minTickGap)!==null&&a!==void 0?a:5,tick:(i=l.tick)!==null&&i!==void 0?i:!0,tickFormatter:l.tickFormatter}),x.createElement(e8,l))},n8=(e,t)=>{var{domain:r}=e,s=Oc(e,YF),{domain:a}=t,i=Oc(t,XF);return vi(s,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:vi({domain:r},{domain:a}):!1},vf=x.memo(r8,n8);vf.displayName="XAxis";var s8=["dangerouslySetInnerHTML","ticks"],a8=["id"],i8=["domain"],o8=["domain"];function yf(){return yf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},yf.apply(null,arguments)}function Mc(e,t){if(e==null)return{};var r,s,a=l8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function l8(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function c8(e){var t=Mt();return x.useEffect(()=>(t(tz(e)),()=>{t(rz(e))}),[e,t]),null}var d8=e=>{var{yAxisId:t,className:r,width:s,label:a}=e,i=x.useRef(null),l=x.useRef(null),c=Ae(fm),d=$r(),f=Mt(),h="yAxis",m=Ae(O=>Ti(O,h,t,d)),g=Ae(O=>qj(O,t)),v=Ae(O=>KD(O,t)),j=Ae(O=>Vj(O,h,t,d)),_=Ae(O=>wj(O,t));if(x.useLayoutEffect(()=>{if(!(s!=="auto"||!g||jp(a)||x.isValidElement(a)||_==null)){var O=i.current;if(O){var T=O.getCalculatedWidth();Math.round(g.width)!==Math.round(T)&&f(nz({id:t,width:T}))}}},[j,g,f,a,t,s,_]),g==null||v==null||_==null)return null;var{dangerouslySetInnerHTML:y,ticks:w}=e,k=Mc(e,s8),{id:N}=_,P=Mc(_,a8);return x.createElement(Fp,yf({},k,P,{ref:i,labelRef:l,scale:m,x:v.x,y:v.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:g.width,height:g.height,className:Ve("recharts-".concat(h," ").concat(h),r),viewBox:c,ticks:j}))},u8={allowDataOverflow:Ur.allowDataOverflow,allowDecimals:Ur.allowDecimals,allowDuplicatedCategory:Ur.allowDuplicatedCategory,hide:!1,mirror:Ur.mirror,orientation:Ur.orientation,padding:Ur.padding,reversed:Ur.reversed,scale:Ur.scale,tickCount:Ur.tickCount,type:Ur.type,width:Ur.width,yAxisId:0},h8=e=>{var t,r,s,a,i,l=xr(e,u8);return x.createElement(x.Fragment,null,x.createElement(c8,{interval:(t=l.interval)!==null&&t!==void 0?t:"preserveEnd",id:l.yAxisId,scale:l.scale,type:l.type,domain:l.domain,allowDataOverflow:l.allowDataOverflow,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,padding:l.padding,includeHidden:(r=l.includeHidden)!==null&&r!==void 0?r:!1,reversed:l.reversed,ticks:l.ticks,width:l.width,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(s=l.angle)!==null&&s!==void 0?s:0,minTickGap:(a=l.minTickGap)!==null&&a!==void 0?a:5,tick:(i=l.tick)!==null&&i!==void 0?i:!0,tickFormatter:l.tickFormatter}),x.createElement(d8,l))},f8=(e,t)=>{var{domain:r}=e,s=Mc(e,i8),{domain:a}=t,i=Mc(t,o8);return vi(s,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:vi({domain:r},{domain:a}):!1},bf=x.memo(h8,f8);bf.displayName="YAxis";var m8={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qo=x;function p8(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var g8=typeof Object.is=="function"?Object.is:p8,x8=Qo.useSyncExternalStore,v8=Qo.useRef,y8=Qo.useEffect,b8=Qo.useMemo,w8=Qo.useDebugValue;m8.useSyncExternalStoreWithSelector=function(e,t,r,s,a){var i=v8(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=b8(function(){function d(v){if(!f){if(f=!0,h=v,v=s(v),a!==void 0&&l.hasValue){var j=l.value;if(a(j,v))return m=j}return m=v}if(j=m,g8(h,v))return j;var _=s(v);return a!==void 0&&a(j,_)?(h=v,j):(h=v,m=_)}var f=!1,h,m,g=r===void 0?null:r;return[function(){return d(t())},g===null?void 0:function(){return d(g())}]},[t,r,s,a]);var c=x8(e,i[0],i[1]);return y8(function(){l.hasValue=!0,l.value=c},[c]),w8(c),c};function _8(e){e()}function j8(){let e=null,t=null;return{clear(){e=null,t=null},notify(){_8(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=e;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!s||e===null||(s=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var ay={notify(){},get:()=>[]};function N8(e,t){let r,s=ay,a=0,i=!1;function l(_){h();const y=s.subscribe(_);let w=!1;return()=>{w||(w=!0,y(),m())}}function c(){s.notify()}function d(){j.onStateChange&&j.onStateChange()}function f(){return i}function h(){a++,r||(r=e.subscribe(d),s=j8())}function m(){a--,r&&a===0&&(r(),r=void 0,s.clear(),s=ay)}function g(){i||(i=!0,h())}function v(){i&&(i=!1,m())}const j={addNestedSub:l,notifyNestedSubs:c,handleChangeWrapper:d,isSubscribed:f,trySubscribe:g,tryUnsubscribe:v,getListeners:()=>s};return j}var k8=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",S8=k8(),E8=()=>typeof navigator<"u"&&navigator.product==="ReactNative",C8=E8(),P8=()=>S8||C8?x.useLayoutEffect:x.useEffect,A8=P8(),Qu=Symbol.for("react-redux-context"),eh=typeof globalThis<"u"?globalThis:{};function T8(){if(!x.createContext)return{};const e=eh[Qu]??(eh[Qu]=new Map);let t=e.get(x.createContext);return t||(t=x.createContext(null),e.set(x.createContext,t)),t}var O8=T8();function M8(e){const{children:t,context:r,serverState:s,store:a}=e,i=x.useMemo(()=>{const d=N8(a);return{store:a,subscription:d,getServerState:s?()=>s:void 0}},[a,s]),l=x.useMemo(()=>a.getState(),[a]);A8(()=>{const{subscription:d}=i;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),l!==a.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[i,l]);const c=r||O8;return x.createElement(c.Provider,{value:i},t)}var I8=M8,L8=(e,t)=>t,Up=ee([L8,nt,xj,er,lN,vs,J6,Jt],nR),Wp=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,s=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/s)}},x1=dn("mouseClick"),v1=Do();v1.startListening({actionCreator:x1,effect:(e,t)=>{var r=e.payload,s=Up(t.getState(),Wp(r));(s==null?void 0:s.activeIndex)!=null&&t.dispatch(o6({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var wf=dn("mouseMove"),y1=Do();y1.startListening({actionCreator:wf,effect:(e,t)=>{var r=e.payload,s=t.getState(),a=fp(s,s.tooltip.settings.shared),i=Up(s,Wp(r));a==="axis"&&((i==null?void 0:i.activeIndex)!=null?t.dispatch(tN({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(eN()))}});var iy={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},b1=Zr({name:"rootProps",initialState:iy,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:iy.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),D8=b1.reducer,{updateOptions:R8}=b1.actions,w1=Zr({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:$8}=w1.actions,z8=w1.reducer,_1=dn("keyDown"),j1=dn("focus"),qp=Do();qp.startListening({actionCreator:_1,effect:(e,t)=>{var r=t.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var l=Number(mp(a,Mi(r))),c=vs(r);if(i==="Enter"){var d=Nc(r,"axis","hover",String(a.index));t.dispatch(lf({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:d}));return}var f=JD(r),h=f==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,g=l+m*h;if(!(c==null||g>=c.length||g<0)){var v=Nc(r,"axis","hover",String(g));t.dispatch(lf({active:!0,activeIndex:g.toString(),activeDataKey:void 0,activeCoordinate:v}))}}}}});qp.startListening({actionCreator:j1,effect:(e,t)=>{var r=t.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",l=Nc(r,"axis","hover",String(i));t.dispatch(lf({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:l}))}}}});var nn=dn("externalEvent"),N1=Do();N1.startListening({actionCreator:nn,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),s={activeCoordinate:W6(r),activeDataKey:hN(r),activeIndex:Os(r),activeLabel:uN(r),activeTooltipIndex:Os(r),isTooltipActive:q6(r)};e.payload.handler(s,e.payload.reactEvent)}}});var B8=ee([Oi],e=>e.tooltipItemPayloads),F8=ee([B8,Zo,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,s)=>{var a=e.find(c=>c.settings.dataKey===s);if(a!=null){var{positions:i}=a;if(i!=null){var l=t(i,r);return l}}}),k1=dn("touchMove"),S1=Do();S1.startListening({actionCreator:k1,effect:(e,t)=>{var r=e.payload,s=t.getState(),a=fp(s,s.tooltip.settings.shared);if(a==="axis"){var i=Up(s,Wp({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&t.dispatch(tN({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0],d=document.elementFromPoint(c.clientX,c.clientY);if(!d||!d.getAttribute)return;var f=d.getAttribute(Xw),h=(l=d.getAttribute(Jw))!==null&&l!==void 0?l:void 0,m=F8(t.getState(),f,h);t.dispatch(Qj({activeDataKey:h,activeIndex:f,activeCoordinate:m}))}}});var U8=_w({brush:kB,cartesianAxis:sz,chartData:vR,errorBars:jz,graphicalItems:j$,layout:s5,legend:V5,options:fR,polarAxis:U3,polarOptions:z8,referenceElements:OB,rootProps:D8,tooltip:l6}),W8=function(t){return PO({reducer:U8,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([v1.middleware,y1.middleware,qp.middleware,N1.middleware,S1.middleware]),devTools:Ds.devToolsEnabled})};function E1(e){var{preloadedState:t,children:r,reduxStoreName:s}=e,a=$r(),i=x.useRef(null);if(a)return r;i.current==null&&(i.current=W8(t));var l=am;return x.createElement(I8,{context:l,store:i.current},r)}function C1(e){var{layout:t,width:r,height:s,margin:a}=e,i=Mt(),l=$r();return x.useEffect(()=>{l||(i(t5(t)),i(r5({width:r,height:s})),i(e5(a)))},[i,l,t,r,s,a]),null}function P1(e){var t=Mt();return x.useEffect(()=>{t(R8(e))},[t,e]),null}var q8=["children"];function G8(e,t){if(e==null)return{};var r,s,a=H8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function H8(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Ic(){return Ic=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ic.apply(null,arguments)}var V8={width:"100%",height:"100%"},K8=x.forwardRef((e,t)=>{var r=pm(),s=gm(),a=n_();if(!fi(r)||!fi(s))return null;var{children:i,otherAttributes:l,title:c,desc:d}=e,f,h;return typeof l.tabIndex=="number"?f=l.tabIndex:f=a?0:void 0,typeof l.role=="string"?h=l.role:h=a?"application":void 0,x.createElement(Wf,Ic({},l,{title:c,desc:d,role:h,tabIndex:f,width:r,height:s,style:V8,ref:t}),i)}),Z8=e=>{var{children:t}=e,r=Ae(wd);if(!r)return null;var{width:s,height:a,y:i,x:l}=r;return x.createElement(Wf,{width:s,height:a,x:l,y:i},t)},oy=x.forwardRef((e,t)=>{var{children:r}=e,s=G8(e,q8),a=$r();return a?x.createElement(Z8,null,r):x.createElement(K8,Ic({ref:t},s),r)});function Y8(){var e=Mt(),[t,r]=x.useState(null),s=Ae(O5);return x.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;gr(i)&&i!==s&&e(n5(i))}},[t,e,s]),r}function ly(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function X8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ly(Object(r),!0).forEach(function(s){J8(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ly(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function J8(e,t,r){return(t=Q8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q8(e){var t=eU(e,"string");return typeof t=="symbol"?t:t+""}function eU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tU=x.forwardRef((e,t)=>{var{children:r,className:s,height:a,onClick:i,onContextMenu:l,onDoubleClick:c,onMouseDown:d,onMouseEnter:f,onMouseLeave:h,onMouseMove:m,onMouseUp:g,onTouchEnd:v,onTouchMove:j,onTouchStart:_,style:y,width:w}=e,k=Mt(),[N,P]=x.useState(null),[O,T]=x.useState(null);ER();var A=Y8(),C=x.useCallback(V=>{A(V),typeof t=="function"&&t(V),P(V),T(V)},[A,t,P,T]),E=x.useCallback(V=>{k(x1(V)),k(nn({handler:i,reactEvent:V}))},[k,i]),D=x.useCallback(V=>{k(wf(V)),k(nn({handler:f,reactEvent:V}))},[k,f]),$=x.useCallback(V=>{k(eN()),k(nn({handler:h,reactEvent:V}))},[k,h]),M=x.useCallback(V=>{k(wf(V)),k(nn({handler:m,reactEvent:V}))},[k,m]),z=x.useCallback(()=>{k(j1())},[k]),K=x.useCallback(V=>{k(_1(V.key))},[k]),W=x.useCallback(V=>{k(nn({handler:l,reactEvent:V}))},[k,l]),U=x.useCallback(V=>{k(nn({handler:c,reactEvent:V}))},[k,c]),Y=x.useCallback(V=>{k(nn({handler:d,reactEvent:V}))},[k,d]),R=x.useCallback(V=>{k(nn({handler:g,reactEvent:V}))},[k,g]),H=x.useCallback(V=>{k(nn({handler:_,reactEvent:V}))},[k,_]),J=x.useCallback(V=>{k(k1(V)),k(nn({handler:j,reactEvent:V}))},[k,j]),F=x.useCallback(V=>{k(nn({handler:v,reactEvent:V}))},[k,v]);return x.createElement(yN.Provider,{value:N},x.createElement(Cb.Provider,{value:O},x.createElement("div",{className:Ve("recharts-wrapper",s),style:X8({position:"relative",cursor:"default",width:w,height:a},y),onClick:E,onContextMenu:W,onDoubleClick:U,onFocus:z,onKeyDown:K,onMouseDown:Y,onMouseEnter:D,onMouseLeave:$,onMouseMove:M,onMouseUp:R,onTouchEnd:F,onTouchMove:J,onTouchStart:H,ref:C},r)))}),rU=["children","className","width","height","style","compact","title","desc"];function nU(e,t){if(e==null)return{};var r,s,a=sU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sU(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var A1=x.forwardRef((e,t)=>{var{children:r,className:s,width:a,height:i,style:l,compact:c,title:d,desc:f}=e,h=nU(e,rU),m=jn(h);return c?x.createElement(oy,{otherAttributes:m,title:d,desc:f},r):x.createElement(tU,{className:s,style:l,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},x.createElement(oy,{otherAttributes:m,title:d,desc:f,ref:t},x.createElement(IB,null,r)))}),aU=["width","height"];function _f(){return _f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_f.apply(null,arguments)}function iU(e,t){if(e==null)return{};var r,s,a=oU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oU(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var lU={top:5,right:5,bottom:5,left:5},cU={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:lU,reverseStackOrder:!1,syncMethod:"index"},T1=x.forwardRef(function(t,r){var s,a=xr(t.categoricalChartProps,cU),{width:i,height:l}=a,c=iU(a,aU);if(!fi(i)||!fi(l))return null;var{chartName:d,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:m,categoricalChartProps:g}=t,v={chartName:d,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:m,eventEmitter:void 0};return x.createElement(E1,{preloadedState:{options:v},reduxStoreName:(s=g.id)!==null&&s!==void 0?s:d},x.createElement(a1,{chartData:g.data}),x.createElement(C1,{width:i,height:l,layout:a.layout,margin:a.margin}),x.createElement(P1,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),x.createElement(A1,_f({},c,{width:i,height:l,ref:r})))}),dU=["axis","item"],uU=x.forwardRef((e,t)=>x.createElement(T1,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:dU,tooltipPayloadSearcher:_p,categoricalChartProps:e,ref:t}));function hU(e){var t=Mt();return x.useEffect(()=>{t($8(e))},[t,e]),null}var fU=["width","height","layout"];function jf(){return jf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},jf.apply(null,arguments)}function mU(e,t){if(e==null)return{};var r,s,a=pU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pU(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var gU={top:5,right:5,bottom:5,left:5},xU={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:gU,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},vU=x.forwardRef(function(t,r){var s,a=xr(t.categoricalChartProps,xU),{width:i,height:l,layout:c}=a,d=mU(a,fU);if(!fi(i)||!fi(l))return null;var{chartName:f,defaultTooltipEventType:h,validateTooltipEventTypes:m,tooltipPayloadSearcher:g}=t,v={chartName:f,defaultTooltipEventType:h,validateTooltipEventTypes:m,tooltipPayloadSearcher:g,eventEmitter:void 0};return x.createElement(E1,{preloadedState:{options:v},reduxStoreName:(s=a.id)!==null&&s!==void 0?s:f},x.createElement(a1,{chartData:a.data}),x.createElement(C1,{width:i,height:l,layout:c,margin:a.margin}),x.createElement(P1,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),x.createElement(hU,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),x.createElement(A1,jf({width:i,height:l},d,{ref:r})))}),yU=["item"],bU={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},wU=x.forwardRef((e,t)=>{var r=xr(e,bU);return x.createElement(vU,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:yU,tooltipPayloadSearcher:_p,categoricalChartProps:r,ref:t})}),_U=["axis"],jU=x.forwardRef((e,t)=>x.createElement(T1,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:_U,tooltipPayloadSearcher:_p,categoricalChartProps:e,ref:t}));const O1=async e=>{try{const{data:t,error:r}=await B.from("event_analytics").select("*").eq("event_id",e).single();if(r)throw r;return t?{success:!0,data:t}:{success:!0,data:await NU(e)}}catch(t){return{success:!1,error:{code:"ANALYTICS_FETCH_ERROR",message:t instanceof Error?t.message:"Failed to fetch analytics"}}}},NU=async e=>{var m;const{data:t}=await B.from("events").select("name, start_date, end_date").eq("id",e).single(),{data:r}=await B.from("checkin_logs").select("*, wristbands(category)").eq("event_id",e).eq("is_test_data",!1),{data:s}=await B.from("gates").select("id").eq("event_id",e);let a=[];try{const{data:g,error:v}=await B.from("event_access").select("user_id").eq("event_id",e).eq("is_active",!0);v?console.warn("event_access table not available:",v.message):a=g||[]}catch(g){console.warn("Error fetching staff assignments:",g)}const i=new Set((r==null?void 0:r.map(g=>g.wristband_id))||[]).size,l=(r==null?void 0:r.length)||0,c=(r==null?void 0:r.reduce((g,v)=>g+(v.processing_time_ms||0),0))/l||0,d={};r==null||r.forEach(g=>{var j;const v=((j=g.wristbands)==null?void 0:j.category)||"unknown";d[v]=(d[v]||0)+1});const f={};r==null||r.forEach(g=>{const v=new Date(g.timestamp).toISOString().substring(0,13);f[v]=(f[v]||0)+1});const h=Object.entries(f).sort((g,v)=>v[1]-g[1])[0];return{event_id:e,event_name:(t==null?void 0:t.name)||"",start_date:(t==null?void 0:t.start_date)||"",end_date:(t==null?void 0:t.end_date)||"",unique_attendees:i,total_checkins:l,last_checkin:(m=r==null?void 0:r[r.length-1])==null?void 0:m.timestamp,avg_processing_time:c,gates_used:(s==null?void 0:s.length)||0,staff_worked:(a==null?void 0:a.length)||0,category_distribution:d,peak_attendance_time:h==null?void 0:h[0],capacity_utilization:0}},M1=async(e,t="hour")=>{try{const{data:r,error:s}=await B.from("checkin_logs").select("timestamp").eq("event_id",e).eq("is_test_data",!1).order("timestamp",{ascending:!0});if(s)throw s;const a=new Map;let i=0;return r==null||r.forEach(c=>{const d=new Date(c.timestamp);let f;t==="hour"?f=d.toISOString().substring(0,13)+":00:00":f=d.toISOString().substring(0,10)+"T00:00:00",a.set(f,(a.get(f)||0)+1)}),{success:!0,data:Array.from(a.entries()).sort((c,d)=>c[0].localeCompare(d[0])).map(([c,d])=>(i+=d,{timestamp:c,checkins:d,cumulative_checkins:i}))}}catch(r){return{success:!1,error:{code:"TIME_SERIES_ERROR",message:r instanceof Error?r.message:"Failed to fetch time series data"}}}},I1=async e=>{try{const{data:t,error:r}=await B.from("gates").select("id, name").eq("event_id",e);if(r)throw r;const s=await Promise.all((t||[]).map(async a=>{const{data:i}=await B.from("checkin_logs").select("processing_time_ms, timestamp").eq("event_id",e).eq("location",a.name).eq("is_test_data",!1),l=(i==null?void 0:i.length)||0,c=l>0?((i==null?void 0:i.reduce((_,y)=>_+(y.processing_time_ms||0),0))||0)/l:0,d=await kU(e),f=l*(c/1e3),h=d>0?f/d*100:0,{data:m}=await B.from("staff_gate_assignments").select("staff_id").eq("gate_id",a.id).eq("status","completed"),g=(m==null?void 0:m.length)||1,v=g>0?l/g:0,j=c>2e3?Math.min(c/100,100):0;return{gate_id:a.id,gate_name:a.name,total_checkins:l,avg_processing_time_ms:c,utilization_percentage:h,staff_efficiency:v,bottleneck_score:j}}));return s.sort((a,i)=>i.total_checkins-a.total_checkins),{success:!0,data:s}}catch(t){return{success:!1,error:{code:"GATE_PERFORMANCE_ERROR",message:t instanceof Error?t.message:"Failed to fetch gate performance"}}}},kU=async e=>{const{data:t}=await B.from("events").select("start_date, end_date").eq("id",e).single();if(!t)return 0;const r=new Date(t.start_date).getTime();return(new Date(t.end_date||t.start_date).getTime()-r)/1e3},L1=async e=>{try{const{data:t,error:r}=await B.from("wristbands").select("id, category, status, checkin_logs(timestamp, location)").eq("event_id",e);if(r)throw r;const s=new Map;t==null||t.forEach(i=>{const l=i.category||"Uncategorized";s.has(l)||s.set(l,{category:l,total_wristbands:0,total_checkins:0,no_show_count:0,no_show_rate:0,avg_checkin_time:"",preferred_gates:[]});const c=s.get(l);c.total_wristbands++;const d=i.checkin_logs||[];d.length>0?c.total_checkins+=d.length:c.no_show_count++});const a=await Promise.all(Array.from(s.values()).map(async i=>{i.no_show_rate=i.total_wristbands>0?i.no_show_count/i.total_wristbands*100:0;const{data:l}=await B.from("checkin_logs").select("timestamp, location").eq("event_id",e).in("wristband_id",(t==null?void 0:t.filter(c=>c.category===i.category).map(c=>c.id))||[]);if(l&&l.length>0){const c=l.reduce((f,h)=>f+new Date(h.timestamp).getTime(),0)/l.length;i.avg_checkin_time=new Date(c).toISOString();const d=new Map;l.forEach(f=>{d.set(f.location,(d.get(f.location)||0)+1)}),i.preferred_gates=Array.from(d.entries()).sort((f,h)=>h[1]-f[1]).slice(0,3).map(f=>f[0])}return i}));return a.sort((i,l)=>l.total_wristbands-i.total_wristbands),{success:!0,data:a}}catch(t){return{success:!1,error:{code:"CATEGORY_INSIGHTS_ERROR",message:t instanceof Error?t.message:"Failed to fetch category insights"}}}},Bl=["#7B61FF","#FF6B6B","#4ECDC4","#FFE66D","#95E1D3","#F38181"],SU=({eventId:e})=>{var O;const[t,r]=x.useState(null),[s,a]=x.useState([]),[i,l]=x.useState([]),[c,d]=x.useState([]),[f,h]=x.useState(!0),[m,g]=x.useState(!1),[v,j]=x.useState("hour"),[_,y]=x.useState(null);if(!e)return n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ir,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No event selected for analytics"})]})});const w=async()=>{if(e){h(!0),y(null);try{const T=await Promise.allSettled([O1(e),M1(e,v),I1(e),L1(e)]),[A,C,E,D]=T;A.status==="fulfilled"&&A.value.success&&A.value.data?r(A.value.data):A.status==="rejected"&&console.warn("Analytics fetch failed:",A.reason),C.status==="fulfilled"&&C.value.success&&C.value.data?a(C.value.data):C.status==="rejected"&&console.warn("Time series fetch failed:",C.reason),E.status==="fulfilled"&&E.value.success&&E.value.data?l(E.value.data):E.status==="rejected"&&console.warn("Gate performance fetch failed:",E.reason),D.status==="fulfilled"&&D.value.success&&D.value.data?d(D.value.data):D.status==="rejected"&&console.warn("Category insights fetch failed:",D.reason)}catch(T){console.error("Error loading analytics:",T),y(T instanceof Error?T.message:"Failed to load analytics")}finally{h(!1)}}};x.useEffect(()=>{const T=new AbortController;let A=!0;return e&&w().catch(C=>{C.name!=="AbortError"&&A&&(console.error("Error in useEffect:",C),y(C instanceof Error?C.message:"Failed to initialize analytics"),h(!1))}),()=>{A=!1,T.abort()}},[e,v]);const k=async()=>{g(!0),await w(),g(!1)},N=()=>{var U;if(!t)return;const T={event_information:{name:t.event_name,start_date:t.start_date,end_date:t.end_date,exported_at:new Date().toISOString()},summary_metrics:{unique_attendees:t.unique_attendees,total_checkins:t.total_checkins,avg_processing_time_ms:t.avg_processing_time,gates_used:t.gates_used,staff_worked:t.staff_worked,capacity_utilization:t.capacity_utilization,peak_attendance_time:t.peak_attendance_time},category_distribution:t.category_distribution,time_series:s,gate_performance:i,category_insights:c},A=JSON.stringify(T,null,2),C=new Blob([A],{type:"application/json"}),E=URL.createObjectURL(C),D=document.createElement("a");D.href=E,D.download=`${t.event_name.replace(/\s+/g,"_")}_Analytics_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(E);const M=[["Event Analytics Report"],["Event Name",t.event_name],["Start Date",t.start_date],["End Date",t.end_date],["Exported",new Date().toLocaleString()],[],["Summary Metrics"],["Unique Attendees",t.unique_attendees],["Total Check-ins",t.total_checkins],["Avg Processing Time (ms)",t.avg_processing_time.toFixed(2)],["Gates Used",t.gates_used],["Staff Members",t.staff_worked],["Capacity Utilization (%)",((U=t.capacity_utilization)==null?void 0:U.toFixed(2))||"N/A"],[],["Gate Performance"],["Gate Name","Total Check-ins","Avg Processing Time (ms)","Utilization %","Staff Efficiency"],...i.map(Y=>[Y.gate_name,Y.total_checkins,Y.avg_processing_time_ms.toFixed(2),Y.utilization_percentage.toFixed(2),Y.staff_efficiency.toFixed(2)]),[],["Category Insights"],["Category","Total Wristbands","Total Check-ins","No-Show Rate %"],...c.map(Y=>[Y.category,Y.total_wristbands,Y.total_checkins,Y.no_show_rate.toFixed(2)])].map(Y=>Y.join(",")).join(`
`),z=new Blob([M],{type:"text/csv"}),K=URL.createObjectURL(z),W=document.createElement("a");W.href=K,W.download=`${t.event_name.replace(/\s+/g,"_")}_Analytics_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(K)};if(_)return n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ir,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600 mb-2",children:"Error loading analytics"}),n.jsx("p",{className:"text-sm text-gray-500 mb-4",children:_}),n.jsx("button",{onClick:w,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Retry"})]})});if(f)return n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),n.jsx("p",{className:"mt-4 text-gray-600",children:"Loading analytics..."})]})});if(!t)return n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ir,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Failed to load analytics"}),n.jsx("button",{onClick:w,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Retry"})]})});let P=[];try{P=t.category_distribution?Object.entries(t.category_distribution).map(([T,A])=>({name:T,value:A})):[]}catch(T){console.warn("Error preparing category distribution data:",T)}return n.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t.event_name}),n.jsxs("p",{className:"text-gray-600",children:["Comprehensive Analytics  ",Eu(t.start_date)," -"," ",Eu(t.end_date)]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs(ht,{onClick:k,disabled:m,variant:"outline",size:"sm",children:[n.jsx(Gr,{className:`w-4 h-4 mr-2 ${m?"animate-spin":""}`}),"Refresh"]}),n.jsxs(ht,{onClick:N,variant:"default",size:"sm",children:[n.jsx(_n,{className:"w-4 h-4 mr-2"}),"Export Report"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsx(ve,{children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Attendance"}),n.jsx("p",{className:"text-3xl font-bold text-gray-900",children:t.unique_attendees.toLocaleString()}),n.jsxs("p",{className:"text-sm text-gray-500",children:[t.total_checkins.toLocaleString()," check-ins"]})]}),n.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:n.jsx(lt,{className:"w-6 h-6 text-blue-600"})})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Processing Time"}),n.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[t.avg_processing_time.toFixed(1),n.jsx("span",{className:"text-lg text-gray-500",children:"ms"})]}),n.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[n.jsx(Xa,{className:"w-3 h-3 mr-1"}),"Excellent"]})]}),n.jsx("div",{className:"p-3 rounded-lg bg-green-50",children:n.jsx(Vr,{className:"w-6 h-6 text-green-600"})})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Gates Used"}),n.jsx("p",{className:"text-3xl font-bold text-gray-900",children:t.gates_used}),n.jsxs("p",{className:"text-sm text-gray-500",children:[t.staff_worked," staff members"]})]}),n.jsx("div",{className:"p-3 rounded-lg bg-purple-50",children:n.jsx(qt,{className:"w-6 h-6 text-purple-600"})})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Capacity Utilization"}),n.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[((O=t.capacity_utilization)==null?void 0:O.toFixed(1))||"N/A",n.jsx("span",{className:"text-lg text-gray-500",children:"%"})]}),n.jsx("p",{className:"text-sm text-gray-500",children:"Peak efficiency"})]}),n.jsx("div",{className:"p-3 rounded-lg bg-orange-50",children:n.jsx(Mn,{className:"w-6 h-6 text-orange-600"})})]})})})]}),n.jsxs(Hc,{defaultValue:"timeline",className:"space-y-6",children:[n.jsxs(Vc,{className:"grid w-full grid-cols-4",children:[n.jsx(mr,{value:"timeline",children:"Timeline Analysis"}),n.jsx(mr,{value:"gates",children:"Gate Performance"}),n.jsx(mr,{value:"categories",children:"Category Insights"}),n.jsx(mr,{value:"summary",children:"Event Summary"})]}),n.jsx(sr,{value:"timeline",children:n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Re,{children:"Check-in Timeline"}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(ht,{variant:v==="hour"?"default":"outline",size:"sm",onClick:()=>j("hour"),children:"Hourly"}),n.jsx(ht,{variant:v==="day"?"default":"outline",size:"sm",onClick:()=>j("day"),children:"Daily"})]})]})}),n.jsxs(ye,{children:[n.jsx("div",{className:"h-[400px]",children:n.jsx(Yu,{width:"100%",height:"100%",children:n.jsxs(jU,{data:s,children:[n.jsx(pf,{strokeDasharray:"3 3",stroke:"#e0e4e7"}),n.jsx(vf,{dataKey:"timestamp",stroke:"#6b7280",fontSize:12,tickFormatter:T=>v==="hour"?new Date(T).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):Eu(T)}),n.jsx(bf,{stroke:"#6b7280",fontSize:12}),n.jsx(Ku,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e0e4e7"}}),n.jsx(jd,{}),n.jsx(gf,{type:"monotone",dataKey:"checkins",stroke:"#7B61FF",fill:"#7B61FF",fillOpacity:.3,name:"Check-ins"}),n.jsx(gf,{type:"monotone",dataKey:"cumulative_checkins",stroke:"#4ECDC4",fill:"#4ECDC4",fillOpacity:.1,name:"Cumulative"})]})})}),t.peak_attendance_time&&n.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:n.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Peak Attendance: ",new Date(t.peak_attendance_time).toLocaleString()]})})]})]})}),n.jsx(sr,{value:"gates",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Gate Check-in Volume"})}),n.jsx(ye,{children:n.jsx("div",{className:"h-[350px]",children:n.jsx(Yu,{width:"100%",height:"100%",children:n.jsxs(uU,{data:i,layout:"vertical",children:[n.jsx(pf,{strokeDasharray:"3 3",stroke:"#e0e4e7"}),n.jsx(vf,{type:"number",stroke:"#6b7280",fontSize:12}),n.jsx(bf,{type:"category",dataKey:"gate_name",stroke:"#6b7280",fontSize:12,width:120}),n.jsx(Ku,{}),n.jsx(n1,{dataKey:"total_checkins",fill:"#7B61FF",radius:[0,4,4,0]})]})})})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Gate Efficiency Metrics"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-4",children:i.map(T=>n.jsxs("div",{className:"p-4 border rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:T.gate_name}),n.jsxs("span",{className:"text-sm text-gray-500",children:[T.total_checkins," check-ins"]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Avg Time"}),n.jsxs("p",{className:"font-medium",children:[T.avg_processing_time_ms.toFixed(0),"ms"]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Utilization"}),n.jsxs("p",{className:"font-medium",children:[T.utilization_percentage.toFixed(1),"%"]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Efficiency"}),n.jsx("p",{className:"font-medium",children:T.staff_efficiency.toFixed(1)})]})]}),T.bottleneck_score>50&&n.jsx("div",{className:"mt-2 p-2 bg-yellow-50 rounded text-xs text-yellow-800",children:" Potential bottleneck detected"})]},T.gate_id))})})]})]})}),n.jsx(sr,{value:"categories",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Category Distribution"})}),n.jsx(ye,{children:n.jsx("div",{className:"h-[350px]",children:n.jsx(Yu,{width:"100%",height:"100%",children:n.jsxs(wU,{children:[n.jsx(JN,{data:P,cx:"50%",cy:"50%",outerRadius:100,dataKey:"value",label:T=>`${T.name} (${(T.percent*100).toFixed(0)}%)`,children:P.map((T,A)=>n.jsx(Xo,{fill:Bl[A%Bl.length]},`cell-${A}`))}),n.jsx(Ku,{})]})})})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Category Performance Details"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-4 max-h-[350px] overflow-y-auto",children:c.map((T,A)=>n.jsxs("div",{className:"p-4 border rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:T.category}),n.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:Bl[A%Bl.length]}})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Total Wristbands"}),n.jsx("p",{className:"font-medium",children:T.total_wristbands})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Check-ins"}),n.jsx("p",{className:"font-medium",children:T.total_checkins})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"No-Show Rate"}),n.jsxs("p",{className:`font-medium ${T.no_show_rate>20?"text-red-600":"text-green-600"}`,children:[T.no_show_rate.toFixed(1),"%"]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Avg Check-in"}),n.jsx("p",{className:"font-medium text-xs",children:T.avg_checkin_time?new Date(T.avg_checkin_time).toLocaleTimeString():"N/A"})]})]}),T.preferred_gates.length>0&&n.jsxs("div",{className:"pt-2 border-t",children:[n.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Preferred Gates:"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:T.preferred_gates.map(C=>n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:C},C))})]})]},A))})})]})]})}),n.jsx(sr,{value:"summary",children:n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Event Summary Report"})}),n.jsx(ye,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Attendance Summary"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Unique Attendees:"}),n.jsx("span",{className:"font-medium",children:t.unique_attendees.toLocaleString()})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Total Check-ins:"}),n.jsx("span",{className:"font-medium",children:t.total_checkins.toLocaleString()})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Avg Check-ins per Attendee:"}),n.jsx("span",{className:"font-medium",children:(t.total_checkins/t.unique_attendees).toFixed(2)})]})]})]}),n.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Operational Metrics"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Gates Deployed:"}),n.jsx("span",{className:"font-medium",children:t.gates_used})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Staff Members:"}),n.jsx("span",{className:"font-medium",children:t.staff_worked})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Avg Processing Time:"}),n.jsxs("span",{className:"font-medium",children:[t.avg_processing_time.toFixed(1),"ms"]})]})]})]})]}),n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Key Insights"}),n.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[n.jsxs("li",{className:"flex items-start",children:[n.jsx(Xa,{className:"w-4 h-4 mr-2 mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:["Processing times averaged ",t.avg_processing_time.toFixed(1),"ms, indicating ",t.avg_processing_time<2e3?"excellent":"good"," ","gate efficiency"]})]}),i.length>0&&n.jsxs("li",{className:"flex items-start",children:[n.jsx(Xa,{className:"w-4 h-4 mr-2 mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:["Busiest gate: ",i[0].gate_name," with"," ",i[0].total_checkins," check-ins"]})]}),c.length>0&&n.jsxs("li",{className:"flex items-start",children:[n.jsx(Xa,{className:"w-4 h-4 mr-2 mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:["Most popular category: ",c[0].category," (",c[0].total_wristbands," wristbands)"]})]})]})]})]})})]})})]})]})})},D1=({eventId:e,eventName:t})=>{const[r]=x.useState([{id:"checkin_log",name:"Complete Check-in Log",description:"All check-in records with timestamps, staff, and locations",type:"csv",fields:["timestamp","wristband_id","location","staff_name","status","category"],filters:{}},{id:"attendance_summary",name:"Attendance Summary",description:"High-level attendance metrics and statistics",type:"pdf",fields:["total_attendance","unique_attendees","peak_times","category_breakdown"],filters:{}},{id:"gate_performance",name:"Gate Performance Report",description:"Detailed analysis of gate efficiency and throughput",type:"excel",fields:["gate_name","total_checkins","avg_processing_time","peak_hours","staff_assignments"],filters:{}},{id:"staff_performance",name:"Staff Performance Review",description:"Individual staff metrics and efficiency scores",type:"excel",fields:["staff_name","total_scans","hours_worked","efficiency_score","error_rate"],filters:{}},{id:"security_incidents",name:"Security & Fraud Report",description:"All security incidents and fraud detection events",type:"csv",fields:["incident_type","timestamp","wristband_id","location","resolution"],filters:{}},{id:"compliance_audit",name:"Compliance Audit Trail",description:"Complete audit log for compliance requirements",type:"json",fields:["action","user","timestamp","table_name","old_values","new_values"],filters:{}}]),[s,a]=x.useState([]),[i,l]=x.useState(null),[c,d]=x.useState({}),[f,h]=x.useState(""),[m,g]=x.useState([]),[v,j]=x.useState(!1);x.useEffect(()=>{_(),y()},[e]);const _=async()=>{try{const M=JSON.parse(localStorage.getItem(`export_jobs_${e}`)||"[]");a(M)}catch(M){console.error("Error fetching export jobs:",M)}},y=async()=>{try{const{data:M,error:z}=await B.from("scheduled_reports").select("*").eq("event_id",e);if(z)throw z;g(M||[])}catch(M){console.error("Error fetching scheduled reports:",M)}},w=async M=>{j(!0);try{let z=[],K="";switch(M.id){case"checkin_log":z=await k(),K=`checkin-log-${e}-${new Date().toISOString().split("T")[0]}`;break;case"attendance_summary":z=await N(),K=`attendance-summary-${e}-${new Date().toISOString().split("T")[0]}`;break;case"gate_performance":z=await P(),K=`gate-performance-${e}-${new Date().toISOString().split("T")[0]}`;break;case"staff_performance":z=await O(),K=`staff-performance-${e}-${new Date().toISOString().split("T")[0]}`;break;case"security_incidents":z=await T(),K=`security-report-${e}-${new Date().toISOString().split("T")[0]}`;break;case"compliance_audit":z=await A(),K=`audit-trail-${e}-${new Date().toISOString().split("T")[0]}`;break}C(z,M.type,K);const W={id:Date.now().toString(),template_id:M.id,status:"completed",created_at:new Date().toISOString(),completed_at:new Date().toISOString()},U=JSON.parse(localStorage.getItem(`export_jobs_${e}`)||"[]");U.unshift(W),localStorage.setItem(`export_jobs_${e}`,JSON.stringify(U.slice(0,20))),a(U)}catch(z){console.error("Error generating report:",z),alert("Error generating report")}finally{j(!1)}},k=async()=>{const{data:M,error:z}=await B.from("checkin_logs").select(`
        timestamp,
        wristband_id,
        location,
        status,
        staff_id,
        wristbands(category),
        profiles:staff_id(full_name)
      `).eq("event_id",e).order("timestamp",{ascending:!1});if(z)throw z;return(M||[]).map(K=>{var W,U;return{Timestamp:new Date(K.timestamp).toLocaleString(),"Wristband ID":K.wristband_id,Location:K.location||"Unknown","Staff Name":((W=K.profiles)==null?void 0:W.full_name)||"System",Status:K.status,Category:((U=K.wristbands)==null?void 0:U.category)||"Unknown"}})},N=async()=>{var R,H;const{data:M}=await B.from("checkin_logs").select("wristband_id, timestamp, status").eq("event_id",e),{data:z}=await B.from("events").select("name, start_date, end_date, config").eq("id",e).single(),K=(M==null?void 0:M.filter(J=>J.status==="success"))||[],W=new Set(K.map(J=>J.wristband_id)).size,U=K.reduce((J,F)=>{const V=new Date(F.timestamp).getHours();return J[V]=(J[V]||0)+1,J},{}),Y=Object.entries(U).reduce((J,[F,V])=>V>J.count?{hour:F,count:V}:J,{hour:"0",count:0});return[{"Event Name":(z==null?void 0:z.name)||t,"Event Date":z!=null&&z.start_date?new Date(z.start_date).toLocaleDateString():"Unknown","Total Check-ins":K.length,"Unique Attendees":W,"Peak Hour":`${Y.hour}:00 (${Y.count} check-ins)`,"Capacity Utilization":(H=(R=z==null?void 0:z.config)==null?void 0:R.capacity_settings)!=null&&H.max_capacity?`${(W/z.config.capacity_settings.max_capacity*100).toFixed(1)}%`:"N/A","Generated At":new Date().toLocaleString()}]},P=async()=>{const{data:M}=await B.from("gates").select("id, name").eq("event_id",e);return(await Promise.all((M||[]).map(async K=>{const{data:W}=await B.from("checkin_logs").select("timestamp, status").eq("event_id",e).eq("location",K.name),U=(W==null?void 0:W.filter(H=>H.status==="success"))||[],Y=(W==null?void 0:W.length)||0,R=Y>0?(Y-U.length)/Y*100:0;return{"Gate Name":K.name,"Total Check-ins":Y,"Successful Check-ins":U.length,"Error Rate":`${R.toFixed(1)}%`,"Efficiency Score":`${Math.max(0,100-R).toFixed(0)}%`,"First Check-in":U.length>0?new Date(Math.min(...U.map(H=>new Date(H.timestamp).getTime()))).toLocaleString():"N/A","Last Check-in":U.length>0?new Date(Math.max(...U.map(H=>new Date(H.timestamp).getTime()))).toLocaleString():"N/A"}}))).sort((K,W)=>W["Total Check-ins"]-K["Total Check-ins"])},O=async()=>{const{data:M}=await B.from("staff_performance_cache").select(`
        user_id,
        total_scans,
        successful_scans,
        error_rate,
        scans_per_hour,
        efficiency_score,
        hours_worked,
        profiles:user_id(full_name, email)
      `).eq("event_id",e);return(M||[]).map(z=>{var K,W;return{"Staff Name":((K=z.profiles)==null?void 0:K.full_name)||"Unknown",Email:((W=z.profiles)==null?void 0:W.email)||"N/A","Total Scans":z.total_scans,"Successful Scans":z.successful_scans,"Error Rate":`${z.error_rate}%`,"Scans per Hour":z.scans_per_hour,"Efficiency Score":`${z.efficiency_score}%`,"Hours Worked":z.hours_worked}}).sort((z,K)=>K["Efficiency Score"].localeCompare(z["Efficiency Score"]))},T=async()=>{const{data:M}=await B.from("system_alerts").select("*").eq("event_id",e).order("created_at",{ascending:!1});return(M||[]).map(z=>({"Incident Type":z.alert_type,Severity:z.severity,Message:z.message,Timestamp:new Date(z.created_at).toLocaleString(),Status:z.resolved?"Resolved":"Open","Resolution Time":z.resolved_at?new Date(z.resolved_at).toLocaleString():"N/A",Data:JSON.stringify(z.data||{})}))},A=async()=>{const{data:M}=await B.from("audit_log").select("*").eq("event_id",e).order("created_at",{ascending:!1});return(M||[]).map(z=>({action:z.action,user_id:z.user_id,timestamp:z.created_at,table_name:z.table_name,record_id:z.record_id,old_values:z.old_values,new_values:z.new_values,ip_address:z.ip_address,user_agent:z.user_agent}))},C=(M,z,K)=>{let W,U;switch(z){case"csv":const H=ti.unparse(M);W=new Blob([H],{type:"text/csv"}),U="csv";break;case"json":W=new Blob([JSON.stringify(M,null,2)],{type:"application/json"}),U="json";break;case"excel":const J=ti.unparse(M);W=new Blob([J],{type:"text/csv"}),U="csv";break;default:const F=ti.unparse(M);W=new Blob([F],{type:"text/csv"}),U="csv"}const Y=URL.createObjectURL(W),R=document.createElement("a");R.href=Y,R.download=`${K}.${U}`,R.click(),URL.revokeObjectURL(Y)},E=async(M,z,K)=>{try{const{error:W}=await B.from("scheduled_reports").insert({event_id:e,template_id:M.id,template_name:M.name,schedule:z,recipients:K.split(",").map(U=>U.trim()),is_active:!0});if(W)throw W;await y(),alert("Report scheduled successfully")}catch(W){console.error("Error scheduling report:",W),alert("Error scheduling report")}},D=M=>{switch(M){case"completed":return"text-green-600 bg-green-100";case"processing":return"text-blue-600 bg-blue-100";case"failed":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},$=M=>{switch(M){case"csv":return sa;case"pdf":return sa;case"excel":return ai;case"json":return sa;default:return sa}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export & Reporting"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Generate and schedule comprehensive reports"})]})}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(M=>{const z=$(M.type);return n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsxs("div",{className:"flex items-center mb-4",children:[n.jsx(z,{className:"w-8 h-8 text-blue-600"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:M.name}),n.jsx("p",{className:"text-sm text-gray-600 uppercase",children:M.type})]})]}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:M.description}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("button",{onClick:()=>w(M),disabled:v,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:[n.jsx(_n,{className:"w-4 h-4 mr-2"}),"Generate Now"]}),n.jsxs("button",{onClick:()=>l(M),className:"w-full flex items-center justify-center px-4 py-2 text-blue-600 border border-blue-600 rounded-md hover:bg-blue-50",children:[n.jsx(On,{className:"w-4 h-4 mr-2"}),"Schedule"]})]})]},M.id)})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Export History"}),s.length===0?n.jsx("p",{className:"text-gray-500 text-center py-4",children:"No exports generated yet"}):n.jsx("div",{className:"space-y-3",children:s.slice(0,10).map(M=>{const z=r.find(K=>K.id===M.template_id);return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(sa,{className:"w-5 h-5 text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:(z==null?void 0:z.name)||"Unknown Report"}),n.jsxs("p",{className:"text-xs text-gray-500",children:["Generated: ",new Date(M.created_at).toLocaleString()]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${D(M.status)}`,children:M.status}),M.status==="completed"&&n.jsx("button",{onClick:()=>w(z),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Re-download"})]})]},M.id)})})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Scheduled Reports"}),m.length===0?n.jsx("p",{className:"text-gray-500 text-center py-4",children:"No scheduled reports"}):n.jsx("div",{className:"space-y-3",children:m.map(M=>{var z;return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Vr,{className:"w-5 h-5 text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:M.template_name}),n.jsxs("p",{className:"text-xs text-gray-500",children:[M.schedule,"  ",((z=M.recipients)==null?void 0:z.length)||0," recipients"]})]})]}),n.jsx("div",{className:"flex items-center space-x-2",children:n.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${M.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:M.is_active?"Active":"Inactive"})})]},M.id)})})]}),i&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Schedule Report"}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{children:n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Report: ",i.name]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Schedule"}),n.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:M=>d({...c,schedule:M.target.value}),children:[n.jsx("option",{value:"",children:"Select frequency"}),n.jsx("option",{value:"daily",children:"Daily"}),n.jsx("option",{value:"weekly",children:"Weekly"}),n.jsx("option",{value:"monthly",children:"Monthly"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Recipients (comma-separated)"}),n.jsx("textarea",{value:f,onChange:M=>h(M.target.value),placeholder:"admin@company.com, manager@company.com",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[n.jsx("button",{onClick:()=>l(null),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:()=>{c.schedule&&f&&(E(i,c.schedule,f),l(null),h(""),d({}))},disabled:!c.schedule||!f,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:"Schedule Report"})]})]})})]})},EU=({eventId:e,eventName:t})=>{const[r,s]=x.useState(null),[a,i]=x.useState(0),[l,c]=x.useState(1e3),[d,f]=x.useState([]),[h,m]=x.useState([]),[g,v]=x.useState([]),[j,_]=x.useState(""),[y,w]=x.useState(!0);x.useEffect(()=>{k(),N(),P(),O()},[e]);const k=async()=>{var U;try{const{data:Y,error:R}=await B.from("events").select("config").eq("id",e).single();if(R)throw R;const H=(U=Y.config)==null?void 0:U.emergency_state;H!=null&&H.is_active&&s(H)}catch(Y){console.error("Error fetching emergency state:",Y)}},N=async()=>{var U,Y;try{const{data:R}=await B.from("checkin_logs").select("id").eq("event_id",e).eq("status","success"),{data:H}=await B.from("events").select("config").eq("id",e).single(),{data:J}=await B.from("gates").select("*").eq("event_id",e).eq("status","approved"),F=new Date(Date.now()-5*60*1e3).toISOString(),{data:V}=await B.from("checkin_logs").select("staff_id, profiles:staff_id(full_name)").eq("event_id",e).gte("timestamp",F).not("staff_id","is",null);i((R==null?void 0:R.length)||0),c(((Y=(U=H==null?void 0:H.config)==null?void 0:U.capacity_settings)==null?void 0:Y.max_capacity)||1e3),f(J||[]);const te=Array.from(new Map((V==null?void 0:V.map(Z=>[Z.staff_id,Z]))||[]).values());m(te)}catch(R){console.error("Error fetching metrics:",R)}finally{w(!1)}},P=async()=>{try{const{data:U,error:Y}=await B.from("audit_log").select("*").eq("event_id",e).ilike("action","%emergency%").order("created_at",{ascending:!1}).limit(20);if(Y)throw Y;v(U||[])}catch(U){console.error("Error fetching emergency log:",U)}},O=()=>{const U=B.channel(`emergency_${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"events",filter:`id=eq.${e}`},Y=>{var H;const R=(H=Y.new.config)==null?void 0:H.emergency_state;(R==null?void 0:R.is_active)!==(r==null?void 0:r.is_active)&&s(R!=null&&R.is_active?R:null)}).subscribe();return()=>U.unsubscribe()},T=async(U,Y,R)=>{var H;try{const{data:J}=await B.auth.getUser(),F={is_active:!0,type:U,reason:Y,activated_at:new Date().toISOString(),activated_by:((H=J.user)==null?void 0:H.id)||"",affected_areas:[],restrictions:R},{data:V}=await B.from("events").select("config").eq("id",e).single(),te={...V==null?void 0:V.config,emergency_state:F,check_ins_enabled:!R.checkins_disabled},{error:Z}=await B.from("events").update({config:te}).eq("id",e);if(Z)throw Z;await B.from("audit_log").insert({event_id:e,action:"emergency_activated",table_name:"events",record_id:e,new_values:{type:U,reason:Y,restrictions:R}}),s(F),await M(`EMERGENCY ACTIVATED: ${U.toUpperCase()} - ${Y}`),alert("Emergency mode activated successfully")}catch(J){console.error("Error activating emergency:",J),alert("Error activating emergency mode")}},A=async()=>{if(confirm("Are you sure you want to deactivate emergency mode?"))try{const{data:U}=await B.from("events").select("config").eq("id",e).single(),Y={...U==null?void 0:U.config,emergency_state:{is_active:!1},check_ins_enabled:!0},{error:R}=await B.from("events").update({config:Y}).eq("id",e);if(R)throw R;await B.from("audit_log").insert({event_id:e,action:"emergency_deactivated",table_name:"events",record_id:e,new_values:{deactivated_at:new Date().toISOString()}}),s(null),await M("Emergency mode has been deactivated. Normal operations resumed."),alert("Emergency mode deactivated")}catch(U){console.error("Error deactivating emergency:",U),alert("Error deactivating emergency mode")}},C=async()=>{await T("capacity","Maximum capacity reached",{checkins_disabled:!0,specific_gates_closed:[],categories_blocked:[],staff_only_mode:!1})},E=async()=>{const U=prompt("Security incident reason:");U&&await T("security",U,{checkins_disabled:!0,specific_gates_closed:d.map(Y=>Y.id),categories_blocked:[],staff_only_mode:!0})},D=async()=>{const U=prompt("Evacuation reason:");U&&(await T("evacuation",U,{checkins_disabled:!0,specific_gates_closed:[],categories_blocked:[],staff_only_mode:!0}),await M(`EVACUATION NOTICE: ${U}. Please follow evacuation procedures immediately.`))},$=async(U,Y)=>{try{const{error:R}=await B.from("gates").update({status:"inactive"}).eq("id",U);if(R)throw R;await M(`Gate ${Y} has been closed for security reasons.`),N()}catch(R){console.error("Error closing gate:",R)}},M=async U=>{var Y;try{const{data:R}=await B.auth.getUser(),{data:H}=await B.from("event_access").select("user_id").eq("event_id",e).eq("is_active",!0);if(H){const J=H.map(F=>F.user_id);for(const F of J)await B.from("staff_messages").insert({event_id:e,from_user_id:(Y=R.user)==null?void 0:Y.id,to_user_id:F,message_type:"alert",subject:"EMERGENCY ALERT",message:U,priority:"urgent"})}}catch(R){console.error("Error sending emergency alert:",R)}},z=async()=>{if(j.trim())try{await M(j),_(""),alert("Broadcast message sent to all staff")}catch(U){console.error("Error sending broadcast:",U),alert("Error sending broadcast message")}},K=async()=>{try{const U={event_id:e,event_name:t,timestamp:new Date().toISOString(),emergency_state:r,current_capacity:a,max_capacity:l,capacity_percentage:a/l*100,active_gates:d.length,online_staff:h.length,gates:d.map(J=>({id:J.id,name:J.name,status:J.status})),staff:h.map(J=>{var F;return{id:J.staff_id,name:((F=J.profiles)==null?void 0:F.full_name)||"Unknown"}})},Y=new Blob([JSON.stringify(U,null,2)],{type:"application/json"}),R=URL.createObjectURL(Y),H=document.createElement("a");H.href=R,H.download=`emergency-state-${e}-${new Date().toISOString().split("T")[0]}.json`,H.click(),URL.revokeObjectURL(R)}catch(U){console.error("Error exporting state:",U)}},W=a/l*100;return y?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-6",children:[(r==null?void 0:r.is_active)&&n.jsx("div",{className:"bg-red-600 text-white p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx(bt,{className:"w-6 h-6 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold text-lg",children:"EMERGENCY MODE ACTIVE"}),n.jsxs("p",{className:"text-sm",children:["Type: ",r.type.toUpperCase()," | Reason: ",r.reason," | Since: ",new Date(r.activated_at).toLocaleString()]})]})]}),n.jsx("button",{onClick:A,className:"px-4 py-2 bg-red-700 text-white rounded-md hover:bg-red-800",children:"Deactivate Emergency"})]})}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Emergency Control Center"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Crisis management and emergency response"})]}),n.jsx("div",{className:"flex items-center space-x-3",children:n.jsxs("button",{onClick:K,className:"flex items-center px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:[n.jsx(_n,{className:"w-4 h-4 mr-2"}),"Export State"]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:`p-4 rounded-lg border ${W>95?"bg-red-100 border-red-200":W>85?"bg-yellow-100 border-yellow-200":"bg-green-100 border-green-200"}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium",children:"Current Capacity"}),n.jsxs("p",{className:"text-2xl font-bold",children:[W.toFixed(1),"%"]}),n.jsxs("p",{className:"text-xs",children:[a," / ",l]})]}),n.jsx(lt,{className:"w-8 h-8 opacity-60"})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Gates"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.length})]}),n.jsx(cn,{className:"w-8 h-8 text-blue-600"})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Staff Online"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.length})]}),n.jsx(jr,{className:"w-8 h-8 text-green-600"})]})}),n.jsx("div",{className:`p-4 rounded-lg border ${r!=null&&r.is_active?"bg-red-100 border-red-200":"bg-green-100 border-green-200"}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium",children:"System Status"}),n.jsx("p",{className:"text-lg font-bold",children:r!=null&&r.is_active?"EMERGENCY":"NORMAL"})]}),n.jsx(Gc,{className:`w-8 h-8 ${r!=null&&r.is_active?"text-red-600":"text-green-600"}`})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Emergency Actions"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("button",{onClick:C,disabled:r==null?void 0:r.is_active,className:"w-full flex items-center justify-center px-4 py-3 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(If,{className:"w-5 h-5 mr-2"}),"Capacity Lockdown"]}),n.jsxs("button",{onClick:E,disabled:r==null?void 0:r.is_active,className:"w-full flex items-center justify-center px-4 py-3 bg-orange-600 text-white rounded-md hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(jr,{className:"w-5 h-5 mr-2"}),"Security Lockdown"]}),n.jsxs("button",{onClick:D,disabled:r==null?void 0:r.is_active,className:"w-full flex items-center justify-center px-4 py-3 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(bt,{className:"w-5 h-5 mr-2"}),"Evacuation Mode"]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Emergency Broadcast"}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("textarea",{value:j,onChange:U=>_(U.target.value),placeholder:"Enter emergency message to broadcast to all staff...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),n.jsxs("button",{onClick:z,disabled:!j.trim(),className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Fl,{className:"w-4 h-4 mr-2"}),"Send to All Staff (",h.length,")"]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Gate Controls"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(U=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h5",{className:"font-medium text-gray-900",children:U.name}),n.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${U.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:U.status})]}),n.jsx("button",{onClick:()=>$(U.id,U.name),className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded-md hover:bg-red-700",children:"Emergency Close"})]},U.id))})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Emergency Log"}),n.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:g.length===0?n.jsx("p",{className:"text-gray-500 text-center py-4",children:"No emergency events recorded"}):g.map(U=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Vr,{className:"w-4 h-4 text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.action}),n.jsx("p",{className:"text-xs text-gray-500",children:new Date(U.created_at).toLocaleString()})]})]}),U.new_values&&n.jsxs("div",{className:"text-right text-xs text-gray-500",children:[U.new_values.type&&n.jsxs("p",{children:["Type: ",U.new_values.type]}),U.new_values.reason&&n.jsxs("p",{children:["Reason: ",U.new_values.reason]})]})]},U.id))})]})]})},CU=({eventId:e,eventName:t})=>{const[r,s]=x.useState(!1),[a,i]=x.useState([]),[l,c]=x.useState(!1),[d,f]=x.useState({checkin_rate:10,duration_minutes:5,gate_patterns:["Main Entrance","VIP Gate","Side Entry"],category_distribution:{General:70,VIP:20,Staff:10},failure_rate:5}),[h,m]=x.useState({});x.useEffect(()=>{g(),j()},[e]);const g=async()=>{var R;try{const{data:H,error:J}=await B.from("events").select("config").eq("id",e).single();if(J)throw J;s(((R=H.config)==null?void 0:R.test_mode)||!1)}catch(H){console.error("Error checking test mode:",H)}},v=async()=>{try{const{data:R}=await B.from("events").select("config").eq("id",e).single(),H={...R==null?void 0:R.config,test_mode:!r},{error:J}=await B.from("events").update({config:H}).eq("id",e);if(J)throw J;s(!r)}catch(R){console.error("Error toggling test mode:",R)}},j=async()=>{const R={staff_assigned:await _(),wristbands_uploaded:await y(),security_configured:await w(),capacity_set:await k(),categories_defined:await N(),app_connectivity:await P()};m(R)},_=async()=>{try{const{data:R,error:H}=await B.from("event_access").select("id").eq("event_id",e).eq("is_active",!0);if(H)throw H;const J=(R==null?void 0:R.length)||0;return{passed:J>0,message:J>0?`${J} staff members assigned`:"No staff assigned to event",count:J}}catch{return{passed:!1,message:"Error checking staff assignments"}}},y=async()=>{try{const{data:R,error:H}=await B.from("wristbands").select("id").eq("event_id",e);if(H)throw H;const J=(R==null?void 0:R.length)||0;return{passed:J>0,message:J>0?`${J} wristbands ready`:"No wristbands uploaded",count:J}}catch{return{passed:!1,message:"Error checking wristbands"}}},w=async()=>{var R;try{const{data:H,error:J}=await B.from("events").select("config").eq("id",e).single();if(J)throw J;const F=(R=H.config)==null?void 0:R.security_mode;return{passed:!!F,message:F?`Security mode: ${F}`:"Security mode not configured"}}catch{return{passed:!1,message:"Error checking security configuration"}}},k=async()=>{var R,H;try{const{data:J,error:F}=await B.from("events").select("config").eq("id",e).single();if(F)throw F;const V=(H=(R=J.config)==null?void 0:R.capacity_settings)==null?void 0:H.max_capacity;return{passed:!!V,message:V?`Max capacity: ${V}`:"Capacity limit not set"}}catch{return{passed:!1,message:"Error checking capacity settings"}}},N=async()=>{try{const{data:R,error:H}=await B.from("categories").select("id");if(H)throw H;const J=(R==null?void 0:R.length)||0;return{passed:J>0,message:J>0?`${J} categories defined`:"No wristband categories defined",count:J}}catch{return{passed:!1,message:"Error checking categories"}}},P=async()=>new Promise(R=>{setTimeout(()=>{R({passed:!0,message:"App connectivity verified"})},1e3)}),O=async R=>{const H=Date.now().toString(),J=Date.now(),F={id:H,test_name:R,status:"running",result:null,duration:0,timestamp:new Date().toISOString()};i(V=>[F,...V]);try{let V;switch(R){case"Database Connection":V=await T();break;case"Staff Authentication":V=await A();break;case"Wristband Validation":V=await C();break;case"Check-in Process":V=await E();break;case"Capacity Alerts":V=await D();break;case"Real-time Sync":V=await $();break;default:V={success:!1,message:"Unknown test"}}const te=Date.now()-J;i(Z=>Z.map(ie=>ie.id===H?{...ie,status:V.success?"passed":"failed",result:V.message,duration:te}:ie))}catch(V){const te=Date.now()-J;i(Z=>Z.map(ie=>ie.id===H?{...ie,status:"failed",result:V instanceof Error?V.message:"Test failed",duration:te}:ie))}},T=async()=>{const{data:R,error:H}=await B.from("events").select("id").limit(1);return{success:!H,message:H?H.message:"Database connection successful"}},A=async()=>{const{data:R,error:H}=await B.from("event_access").select("id").eq("event_id",e).limit(1);return{success:!H,message:H?H.message:"Staff authentication system working"}},C=async()=>{const{data:R,error:H}=await B.from("wristbands").select("nfc_id, category, status").eq("event_id",e).limit(5);return H?{success:!1,message:H.message}:!R||R.length===0?{success:!1,message:"No wristbands found for testing"}:{success:!0,message:`Validated ${R.length} wristbands successfully`}},E=async()=>{const R={event_id:e,wristband_id:"TEST-"+Date.now(),location:"Test Gate",timestamp:new Date().toISOString(),is_test_data:!0},{error:H}=await B.from("checkin_logs").insert(R);return{success:!H,message:H?H.message:"Check-in process test successful"}},D=async()=>{var F,V;const{data:R,error:H}=await B.from("events").select("config").eq("id",e).single();return H?{success:!1,message:H.message}:{success:!0,message:((V=(F=R.config)==null?void 0:F.capacity_settings)==null?void 0:V.alerts_enabled)?"Capacity alerts configured":"Capacity alerts disabled"}},$=async()=>new Promise(R=>{const H=B.channel("test-sync").on("postgres_changes",{event:"*",schema:"public",table:"checkin_logs"},()=>{H.unsubscribe(),R({success:!0,message:"Real-time sync working"})}).subscribe();setTimeout(()=>{H.unsubscribe(),R({success:!1,message:"Real-time sync timeout"})},5e3)}),M=async()=>{c(!0);const R=d.checkin_rate*d.duration_minutes,H=60*1e3/d.checkin_rate;for(let J=0;J<R&&l;J++){await new Promise(fe=>setTimeout(fe,H));const F=Object.keys(d.category_distribution),V=F[Math.floor(Math.random()*F.length)],te=d.gate_patterns[Math.floor(Math.random()*d.gate_patterns.length)],Z=Math.random()*100<d.failure_rate,ie={event_id:e,wristband_id:`SIM-${Date.now()}-${J}`,location:te,timestamp:new Date().toISOString(),status:Z?"failed":"success",is_test_data:!0,metadata:{simulation:!0,category:V}};await B.from("checkin_logs").insert(ie)}c(!1)},z=()=>{c(!1)},K=async()=>{if(confirm("Delete all test data? This cannot be undone."))try{const{error:R}=await B.from("checkin_logs").delete().eq("event_id",e).eq("is_test_data",!0);if(R)throw R;alert("Test data cleared successfully")}catch(R){console.error("Error clearing test data:",R),alert("Error clearing test data")}},W=R=>{switch(R){case"passed":return n.jsx(Tt,{className:"w-5 h-5 text-green-600"});case"failed":return n.jsx(In,{className:"w-5 h-5 text-red-600"});case"running":return n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"});default:return n.jsx(li,{className:"w-5 h-5 text-gray-400"})}},U=R=>R?n.jsx(Tt,{className:"w-5 h-5 text-green-600"}):n.jsx(In,{className:"w-5 h-5 text-red-600"}),Y=["Database Connection","Staff Authentication","Wristband Validation","Check-in Process","Capacity Alerts","Real-time Sync"];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pre-Event Testing Suite"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Validate your event setup before going live"})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Test Mode:"}),n.jsx("button",{onClick:v,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r?"bg-blue-600":"bg-gray-200"}`,children:n.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r?"translate-x-6":"translate-x-1"}`})})]}),n.jsxs("button",{onClick:K,className:"flex items-center px-3 py-2 text-red-600 border border-red-300 rounded-md hover:bg-red-50",children:[n.jsx(wn,{className:"w-4 h-4 mr-2"}),"Clear Test Data"]})]})]}),r&&n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(bt,{className:"w-5 h-5 text-yellow-600 mr-2"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Test Mode Active"}),n.jsx("p",{className:"text-sm text-yellow-700",children:"All check-ins will be marked as test data and can be deleted"})]})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Event Readiness Checklist"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(h).map(([R,H])=>n.jsxs("div",{className:"flex items-center space-x-3",children:[U(H.passed),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900 capitalize",children:R.replace("_"," ")}),n.jsx("p",{className:"text-xs text-gray-500",children:H.message})]})]},R))}),n.jsx("button",{onClick:j,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Re-run Checklist"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"System Tests"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:Y.map(R=>n.jsxs("button",{onClick:()=>O(R),className:"flex items-center justify-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[n.jsx(li,{className:"w-4 h-4 mr-2"}),R]},R))}),a.length>0&&n.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[n.jsx("h5",{className:"text-sm font-medium text-gray-900",children:"Recent Test Results"}),a.map(R=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[W(R.status),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:R.test_name}),n.jsx("p",{className:"text-xs text-gray-500",children:R.result})]})]}),n.jsxs("div",{className:"text-right text-xs text-gray-500",children:[n.jsxs("p",{children:[R.duration,"ms"]}),n.jsx("p",{children:new Date(R.timestamp).toLocaleTimeString()})]})]},R.id))]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Check-in Simulation"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Check-ins per minute"}),n.jsx("input",{type:"number",value:d.checkin_rate,onChange:R=>f({...d,checkin_rate:parseInt(R.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (minutes)"}),n.jsx("input",{type:"number",value:d.duration_minutes,onChange:R=>f({...d,duration_minutes:parseInt(R.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"60"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Failure rate (%)"}),n.jsx("input",{type:"number",value:d.failure_rate,onChange:R=>f({...d,failure_rate:parseInt(R.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"50"})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Simulation Preview"}),n.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[n.jsxs("p",{children:["Total check-ins: ",d.checkin_rate*d.duration_minutes]}),n.jsxs("p",{children:["Expected failures: ",Math.round(d.checkin_rate*d.duration_minutes*d.failure_rate/100)]}),n.jsxs("p",{children:["Gates: ",d.gate_patterns.join(", ")]})]})]}),n.jsx("div",{className:"flex space-x-2",children:l?n.jsxs("button",{onClick:z,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:[n.jsx(aP,{className:"w-4 h-4 mr-2"}),"Stop Simulation"]}):n.jsxs("button",{onClick:M,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[n.jsx(tP,{className:"w-4 h-4 mr-2"}),"Start Simulation"]})})]})]})]})]})};function PU({eventId:e}){const[t,r]=x.useState([]),[s,a]=x.useState([]),[i,l]=x.useState(!0),[c,d]=x.useState(!1);x.useEffect(()=>{e&&(f(),h())},[e]);async function f(){var _;try{l(!0);const{data:y,error:w}=await B.from("event_category_limits").select("*").eq("event_id",e).order("category");if(w){if((_=w.message)!=null&&_.includes("relation")||w.code==="42P01"){console.warn("event_category_limits table does not exist yet. Please run the migration."),r([]),l(!1);return}throw w}r(y||[])}catch(y){console.error("Error fetching category limits:",y),r([])}finally{l(!1)}}async function h(){try{const{data:_,error:y}=await B.from("wristbands").select("category").eq("event_id",e).not("category","is",null);if(y){console.error("Error fetching categories:",y),a([]);return}const w=Array.from(new Set(_==null?void 0:_.map(k=>k.category).filter(k=>k!==null)));a(w)}catch(_){console.error("Error fetching categories:",_),a([])}}function m(){const _=s.filter(w=>!t.some(k=>k.category===w));if(_.length===0){ge.warning("All categories are already configured");return}const y={event_id:e,category:_[0],max_wristbands:1};r([...t,y])}function g(_,y,w){const k=[...t];k[_]={...k[_],[y]:w},r(k)}function v(_){r(t.filter((y,w)=>w!==_))}async function j(){try{if(d(!0),t.some(k=>!k.category)){ge.error("Please select a category for all limits");return}if(t.some(k=>!k.max_wristbands||k.max_wristbands<1)){ge.error("Wristband limits must be at least 1");return}const{error:w}=await B.from("event_category_limits").delete().eq("event_id",e);if(w)throw w;if(t.length>0){const{error:k}=await B.from("event_category_limits").insert(t.map(N=>({event_id:e,category:N.category,max_wristbands:N.max_wristbands})));if(k)throw k}ge.success("Category limits saved successfully"),await f()}catch(_){console.error("Error saving category limits:",_),ge.error("Failed to save category limits")}finally{d(!1)}}return i?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx(Gr,{className:"h-6 w-6 animate-spin text-gray-400"})}):n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"card-title",children:"Wristband Category Limits"}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Control how many wristbands of each category can be linked to a single ticket"})]}),n.jsx("button",{onClick:j,disabled:c,className:"btn btn-primary",children:c?n.jsxs(n.Fragment,{children:[n.jsx(Gr,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx(rP,{className:"h-4 w-4 mr-2"}),"Save Limits"]})})]}),n.jsxs("div",{className:"card-body",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(ZC,{className:"h-5 w-5 text-blue-600 mr-3 mt-0.5 flex-shrink-0"}),n.jsxs("div",{className:"text-sm text-blue-900",children:[n.jsx("p",{className:"font-medium mb-1",children:"How Category Limits Work"}),n.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-800",children:[n.jsx("li",{children:"Each ticket can be linked to multiple wristbands"}),n.jsx("li",{children:"The limit applies per wristband category, not total wristbands"}),n.jsx("li",{children:"Example: If VIP limit is 1 and TABLE limit is 5, a ticket can have 1 VIP wristband AND 5 TABLE wristbands"}),n.jsx("li",{children:"Categories are automatically detected from your uploaded wristbands"})]})]})]})}),s.length===0?n.jsxs("div",{className:"text-center py-8",children:[n.jsx(ir,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600 mb-2",children:"No wristband categories found"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Upload wristbands first to configure category limits"})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"space-y-3 mb-4",children:[t.map((_,y)=>n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Wristband Category"}),n.jsx("select",{value:_.category,onChange:w=>g(y,"category",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:s.map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{className:"w-48",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Max Wristbands per Ticket"}),n.jsx("input",{type:"number",min:"1",value:_.max_wristbands,onChange:w=>g(y,"max_wristbands",parseInt(w.target.value,10)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),n.jsx("button",{onClick:()=>v(y),className:"mt-5 p-2 text-red-600 hover:bg-red-50 rounded",title:"Remove limit",children:n.jsx(wn,{className:"h-4 w-4"})})]},y)),t.length===0&&n.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[n.jsx("p",{className:"text-gray-500 mb-2",children:"No limits configured yet"}),n.jsx("p",{className:"text-sm text-gray-400",children:'Click "Add Category Limit" to get started'})]})]}),t.length<s.length&&n.jsxs("button",{onClick:m,className:"btn btn-secondary w-full",children:[n.jsx(po,{className:"h-4 w-4 mr-2"}),"Add Category Limit"]})]}),t.length>0&&n.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Configuration Summary"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:t.map(_=>n.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-3 border border-blue-200",children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:_.category}),n.jsx("p",{className:"text-lg font-bold text-blue-900",children:_.max_wristbands}),n.jsxs("p",{className:"text-xs text-gray-600",children:["wristband",_.max_wristbands!==1?"s":""," max"]})]},_.category))})]})]})]})}function R1(e,t){const r=x.useRef(t);x.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}const AU=1;function TU(e){return Object.freeze({__version:AU,map:e})}function $1(e,t){return Object.freeze({...e,...t})}const z1=x.createContext(null),B1=z1.Provider;function Gp(){const e=x.useContext(z1);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function OU(e){function t(r,s){const{instance:a,context:i}=e(r).current;return x.useImperativeHandle(s,()=>a),r.children==null?null:at.createElement(B1,{value:i},r.children)}return x.forwardRef(t)}function MU(e){function t(r,s){const[a,i]=x.useState(!1),{instance:l}=e(r,i).current;x.useImperativeHandle(s,()=>l),x.useEffect(function(){a&&l.update()},[l,a,r.children]);const c=l._contentNode;return c?Lc.createPortal(r.children,c):null}return x.forwardRef(t)}function IU(e){function t(r,s){const{instance:a}=e(r).current;return x.useImperativeHandle(s,()=>a),null}return x.forwardRef(t)}function F1(e,t){const r=x.useRef();x.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function Hp(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function LU(e,t){return function(s,a){const i=Gp(),l=e(Hp(s,i),i);return R1(i.map,s.attribution),F1(l.current,s.eventHandlers),t(l.current,i,s,a),l}}var Nf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,s){s(t)})(Dr,function(r){var s="1.9.4";function a(o){var u,p,b,S;for(p=1,b=arguments.length;p<b;p++){S=arguments[p];for(u in S)o[u]=S[u]}return o}var i=Object.create||function(){function o(){}return function(u){return o.prototype=u,new o}}();function l(o,u){var p=Array.prototype.slice;if(o.bind)return o.bind.apply(o,p.call(arguments,1));var b=p.call(arguments,2);return function(){return o.apply(u,b.length?b.concat(p.call(arguments)):arguments)}}var c=0;function d(o){return"_leaflet_id"in o||(o._leaflet_id=++c),o._leaflet_id}function f(o,u,p){var b,S,I,q;return q=function(){b=!1,S&&(I.apply(p,S),S=!1)},I=function(){b?S=arguments:(o.apply(p,arguments),setTimeout(q,u),b=!0)},I}function h(o,u,p){var b=u[1],S=u[0],I=b-S;return o===b&&p?o:((o-S)%I+I)%I+S}function m(){return!1}function g(o,u){if(u===!1)return o;var p=Math.pow(10,u===void 0?6:u);return Math.round(o*p)/p}function v(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function j(o){return v(o).split(/\s+/)}function _(o,u){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?i(o.options):{});for(var p in u)o.options[p]=u[p];return o.options}function y(o,u,p){var b=[];for(var S in o)b.push(encodeURIComponent(p?S.toUpperCase():S)+"="+encodeURIComponent(o[S]));return(!u||u.indexOf("?")===-1?"?":"&")+b.join("&")}var w=/\{ *([\w_ -]+) *\}/g;function k(o,u){return o.replace(w,function(p,b){var S=u[b];if(S===void 0)throw new Error("No value provided for variable "+p);return typeof S=="function"&&(S=S(u)),S})}var N=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function P(o,u){for(var p=0;p<o.length;p++)if(o[p]===u)return p;return-1}var O="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function T(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var A=0;function C(o){var u=+new Date,p=Math.max(0,16-(u-A));return A=u+p,window.setTimeout(o,p)}var E=window.requestAnimationFrame||T("RequestAnimationFrame")||C,D=window.cancelAnimationFrame||T("CancelAnimationFrame")||T("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function $(o,u,p){if(p&&E===C)o.call(u);else return E.call(window,l(o,u))}function M(o){o&&D.call(window,o)}var z={__proto__:null,extend:a,create:i,bind:l,get lastId(){return c},stamp:d,throttle:f,wrapNum:h,falseFn:m,formatNum:g,trim:v,splitWords:j,setOptions:_,getParamString:y,template:k,isArray:N,indexOf:P,emptyImageUrl:O,requestFn:E,cancelFn:D,requestAnimFrame:$,cancelAnimFrame:M};function K(){}K.extend=function(o){var u=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=u.__super__=this.prototype,b=i(p);b.constructor=u,u.prototype=b;for(var S in this)Object.prototype.hasOwnProperty.call(this,S)&&S!=="prototype"&&S!=="__super__"&&(u[S]=this[S]);return o.statics&&a(u,o.statics),o.includes&&(W(o.includes),a.apply(null,[b].concat(o.includes))),a(b,o),delete b.statics,delete b.includes,b.options&&(b.options=p.options?i(p.options):{},a(b.options,o.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var I=0,q=b._initHooks.length;I<q;I++)b._initHooks[I].call(this)}},u},K.include=function(o){var u=this.prototype.options;return a(this.prototype,o),o.options&&(this.prototype.options=u,this.mergeOptions(o.options)),this},K.mergeOptions=function(o){return a(this.prototype.options,o),this},K.addInitHook=function(o){var u=Array.prototype.slice.call(arguments,1),p=typeof o=="function"?o:function(){this[o].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function W(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=N(o)?o:[o];for(var u=0;u<o.length;u++)o[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var U={on:function(o,u,p){if(typeof o=="object")for(var b in o)this._on(b,o[b],u);else{o=j(o);for(var S=0,I=o.length;S<I;S++)this._on(o[S],u,p)}return this},off:function(o,u,p){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var b in o)this._off(b,o[b],u);else{o=j(o);for(var S=arguments.length===1,I=0,q=o.length;I<q;I++)S?this._off(o[I]):this._off(o[I],u,p)}return this},_on:function(o,u,p,b){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(o,u,p)===!1){p===this&&(p=void 0);var S={fn:u,ctx:p};b&&(S.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(S)}},_off:function(o,u,p){var b,S,I;if(this._events&&(b=this._events[o],!!b)){if(arguments.length===1){if(this._firingCount)for(S=0,I=b.length;S<I;S++)b[S].fn=m;delete this._events[o];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var q=this._listens(o,u,p);if(q!==!1){var Q=b[q];this._firingCount&&(Q.fn=m,this._events[o]=b=b.slice()),b.splice(q,1)}}},fire:function(o,u,p){if(!this.listens(o,p))return this;var b=a({},u,{type:o,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var S=this._events[o];if(S){this._firingCount=this._firingCount+1||1;for(var I=0,q=S.length;I<q;I++){var Q=S[I],re=Q.fn;Q.once&&this.off(o,re,Q.ctx),re.call(Q.ctx||this,b)}this._firingCount--}}return p&&this._propagateEvent(b),this},listens:function(o,u,p,b){typeof o!="string"&&console.warn('"string" type argument expected');var S=u;typeof u!="function"&&(b=!!u,S=void 0,p=void 0);var I=this._events&&this._events[o];if(I&&I.length&&this._listens(o,S,p)!==!1)return!0;if(b){for(var q in this._eventParents)if(this._eventParents[q].listens(o,u,p,b))return!0}return!1},_listens:function(o,u,p){if(!this._events)return!1;var b=this._events[o]||[];if(!u)return!!b.length;p===this&&(p=void 0);for(var S=0,I=b.length;S<I;S++)if(b[S].fn===u&&b[S].ctx===p)return S;return!1},once:function(o,u,p){if(typeof o=="object")for(var b in o)this._on(b,o[b],u,!0);else{o=j(o);for(var S=0,I=o.length;S<I;S++)this._on(o[S],u,p,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[d(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[d(o)],this},_propagateEvent:function(o){for(var u in this._eventParents)this._eventParents[u].fire(o.type,a({layer:o.target,propagatedFrom:o.target},o),!0)}};U.addEventListener=U.on,U.removeEventListener=U.clearAllEventListeners=U.off,U.addOneTimeEventListener=U.once,U.fireEvent=U.fire,U.hasEventListeners=U.listens;var Y=K.extend(U);function R(o,u,p){this.x=p?Math.round(o):o,this.y=p?Math.round(u):u}var H=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};R.prototype={clone:function(){return new R(this.x,this.y)},add:function(o){return this.clone()._add(J(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(J(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new R(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new R(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=H(this.x),this.y=H(this.y),this},distanceTo:function(o){o=J(o);var u=o.x-this.x,p=o.y-this.y;return Math.sqrt(u*u+p*p)},equals:function(o){return o=J(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=J(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function J(o,u,p){return o instanceof R?o:N(o)?new R(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new R(o.x,o.y):new R(o,u,p)}function F(o,u){if(o)for(var p=u?[o,u]:o,b=0,S=p.length;b<S;b++)this.extend(p[b])}F.prototype={extend:function(o){var u,p;if(!o)return this;if(o instanceof R||typeof o[0]=="number"||"x"in o)u=p=J(o);else if(o=V(o),u=o.min,p=o.max,!u||!p)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=p.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(o){return J((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return J(this.min.x,this.max.y)},getTopRight:function(){return J(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var u,p;return typeof o[0]=="number"||o instanceof R?o=J(o):o=V(o),o instanceof F?(u=o.min,p=o.max):u=p=o,u.x>=this.min.x&&p.x<=this.max.x&&u.y>=this.min.y&&p.y<=this.max.y},intersects:function(o){o=V(o);var u=this.min,p=this.max,b=o.min,S=o.max,I=S.x>=u.x&&b.x<=p.x,q=S.y>=u.y&&b.y<=p.y;return I&&q},overlaps:function(o){o=V(o);var u=this.min,p=this.max,b=o.min,S=o.max,I=S.x>u.x&&b.x<p.x,q=S.y>u.y&&b.y<p.y;return I&&q},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var u=this.min,p=this.max,b=Math.abs(u.x-p.x)*o,S=Math.abs(u.y-p.y)*o;return V(J(u.x-b,u.y-S),J(p.x+b,p.y+S))},equals:function(o){return o?(o=V(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function V(o,u){return!o||o instanceof F?o:new F(o,u)}function te(o,u){if(o)for(var p=u?[o,u]:o,b=0,S=p.length;b<S;b++)this.extend(p[b])}te.prototype={extend:function(o){var u=this._southWest,p=this._northEast,b,S;if(o instanceof ie)b=o,S=o;else if(o instanceof te){if(b=o._southWest,S=o._northEast,!b||!S)return this}else return o?this.extend(fe(o)||Z(o)):this;return!u&&!p?(this._southWest=new ie(b.lat,b.lng),this._northEast=new ie(S.lat,S.lng)):(u.lat=Math.min(b.lat,u.lat),u.lng=Math.min(b.lng,u.lng),p.lat=Math.max(S.lat,p.lat),p.lng=Math.max(S.lng,p.lng)),this},pad:function(o){var u=this._southWest,p=this._northEast,b=Math.abs(u.lat-p.lat)*o,S=Math.abs(u.lng-p.lng)*o;return new te(new ie(u.lat-b,u.lng-S),new ie(p.lat+b,p.lng+S))},getCenter:function(){return new ie((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ie(this.getNorth(),this.getWest())},getSouthEast:function(){return new ie(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof ie||"lat"in o?o=fe(o):o=Z(o);var u=this._southWest,p=this._northEast,b,S;return o instanceof te?(b=o.getSouthWest(),S=o.getNorthEast()):b=S=o,b.lat>=u.lat&&S.lat<=p.lat&&b.lng>=u.lng&&S.lng<=p.lng},intersects:function(o){o=Z(o);var u=this._southWest,p=this._northEast,b=o.getSouthWest(),S=o.getNorthEast(),I=S.lat>=u.lat&&b.lat<=p.lat,q=S.lng>=u.lng&&b.lng<=p.lng;return I&&q},overlaps:function(o){o=Z(o);var u=this._southWest,p=this._northEast,b=o.getSouthWest(),S=o.getNorthEast(),I=S.lat>u.lat&&b.lat<p.lat,q=S.lng>u.lng&&b.lng<p.lng;return I&&q},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,u){return o?(o=Z(o),this._southWest.equals(o.getSouthWest(),u)&&this._northEast.equals(o.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Z(o,u){return o instanceof te?o:new te(o,u)}function ie(o,u,p){if(isNaN(o)||isNaN(u))throw new Error("Invalid LatLng object: ("+o+", "+u+")");this.lat=+o,this.lng=+u,p!==void 0&&(this.alt=+p)}ie.prototype={equals:function(o,u){if(!o)return!1;o=fe(o);var p=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return p<=(u===void 0?1e-9:u)},toString:function(o){return"LatLng("+g(this.lat,o)+", "+g(this.lng,o)+")"},distanceTo:function(o){return xe.distance(this,fe(o))},wrap:function(){return xe.wrapLatLng(this)},toBounds:function(o){var u=180*o/40075017,p=u/Math.cos(Math.PI/180*this.lat);return Z([this.lat-u,this.lng-p],[this.lat+u,this.lng+p])},clone:function(){return new ie(this.lat,this.lng,this.alt)}};function fe(o,u,p){return o instanceof ie?o:N(o)&&typeof o[0]!="object"?o.length===3?new ie(o[0],o[1],o[2]):o.length===2?new ie(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new ie(o.lat,"lng"in o?o.lng:o.lon,o.alt):u===void 0?null:new ie(o,u,p)}var be={latLngToPoint:function(o,u){var p=this.projection.project(o),b=this.scale(u);return this.transformation._transform(p,b)},pointToLatLng:function(o,u){var p=this.scale(u),b=this.transformation.untransform(o,p);return this.projection.unproject(b)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var u=this.projection.bounds,p=this.scale(o),b=this.transformation.transform(u.min,p),S=this.transformation.transform(u.max,p);return new F(b,S)},infinite:!1,wrapLatLng:function(o){var u=this.wrapLng?h(o.lng,this.wrapLng,!0):o.lng,p=this.wrapLat?h(o.lat,this.wrapLat,!0):o.lat,b=o.alt;return new ie(p,u,b)},wrapLatLngBounds:function(o){var u=o.getCenter(),p=this.wrapLatLng(u),b=u.lat-p.lat,S=u.lng-p.lng;if(b===0&&S===0)return o;var I=o.getSouthWest(),q=o.getNorthEast(),Q=new ie(I.lat-b,I.lng-S),re=new ie(q.lat-b,q.lng-S);return new te(Q,re)}},xe=a({},be,{wrapLng:[-180,180],R:6371e3,distance:function(o,u){var p=Math.PI/180,b=o.lat*p,S=u.lat*p,I=Math.sin((u.lat-o.lat)*p/2),q=Math.sin((u.lng-o.lng)*p/2),Q=I*I+Math.cos(b)*Math.cos(S)*q*q,re=2*Math.atan2(Math.sqrt(Q),Math.sqrt(1-Q));return this.R*re}}),oe=6378137,de={R:oe,MAX_LATITUDE:85.0511287798,project:function(o){var u=Math.PI/180,p=this.MAX_LATITUDE,b=Math.max(Math.min(p,o.lat),-p),S=Math.sin(b*u);return new R(this.R*o.lng*u,this.R*Math.log((1+S)/(1-S))/2)},unproject:function(o){var u=180/Math.PI;return new ie((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*u,o.x*u/this.R)},bounds:function(){var o=oe*Math.PI;return new F([-o,-o],[o,o])}()};function ce(o,u,p,b){if(N(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=u,this._c=p,this._d=b}ce.prototype={transform:function(o,u){return this._transform(o.clone(),u)},_transform:function(o,u){return u=u||1,o.x=u*(this._a*o.x+this._b),o.y=u*(this._c*o.y+this._d),o},untransform:function(o,u){return u=u||1,new R((o.x/u-this._b)/this._a,(o.y/u-this._d)/this._c)}};function ne(o,u,p,b){return new ce(o,u,p,b)}var Oe=a({},xe,{code:"EPSG:3857",projection:de,transformation:function(){var o=.5/(Math.PI*de.R);return ne(o,.5,-o,.5)}()}),Ce=a({},Oe,{code:"EPSG:900913"});function $e(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function Ne(o,u){var p="",b,S,I,q,Q,re;for(b=0,I=o.length;b<I;b++){for(Q=o[b],S=0,q=Q.length;S<q;S++)re=Q[S],p+=(S?"L":"M")+re.x+" "+re.y;p+=u?ke.svg?"z":"x":""}return p||"M0 0"}var G=document.documentElement.style,se="ActiveXObject"in window,ue=se&&!document.addEventListener,he="msLaunchUri"in navigator&&!("documentMode"in document),me=jt("webkit"),Me=jt("android"),Qe=jt("android 2")||jt("android 3"),Xe=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ut=Me&&jt("Google")&&Xe<537&&!("AudioNode"in window),tt=!!window.opera,ae=!he&&jt("chrome"),Te=jt("gecko")&&!me&&!tt&&!se,We=!ae&&jt("safari"),tr=jt("phantom"),It="OTransition"in G,zt=navigator.platform.indexOf("Win")===0,Et=se&&"transition"in G,dr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Qe,Yr="MozPerspective"in G,Pr=!window.L_DISABLE_3D&&(Et||dr||Yr)&&!It&&!tr,et=typeof orientation<"u"||jt("mobile"),zr=et&&me,Ca=et&&dr,Bs=!window.PointerEvent&&window.MSPointerEvent,X=!!(window.PointerEvent||Bs),we="ontouchstart"in window||!!window.TouchEvent,Ie=!window.L_NO_TOUCH&&(we||X),Fe=et&&tt,ze=et&&Te,qe=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,pt=function(){var o=!1;try{var u=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",m,u),window.removeEventListener("testPassiveEventSupport",m,u)}catch{}return o}(),rt=function(){return!!document.createElement("canvas").getContext}(),Ue=!!(document.createElementNS&&$e("svg").createSVGRect),Ct=!!Ue&&function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),vr=!Ue&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var u=o.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}}(),yr=navigator.platform.indexOf("Mac")===0,Kt=navigator.platform.indexOf("Linux")===0;function jt(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var ke={ie:se,ielt9:ue,edge:he,webkit:me,android:Me,android23:Qe,androidStock:ut,opera:tt,chrome:ae,gecko:Te,safari:We,phantom:tr,opera12:It,win:zt,ie3d:Et,webkit3d:dr,gecko3d:Yr,any3d:Pr,mobile:et,mobileWebkit:zr,mobileWebkit3d:Ca,msPointer:Bs,pointer:X,touch:Ie,touchNative:we,mobileOpera:Fe,mobileGecko:ze,retina:qe,passiveEvents:pt,canvas:rt,svg:Ue,vml:vr,inlineSvg:Ct,mac:yr,linux:Kt},mn=ke.msPointer?"MSPointerDown":"pointerdown",Bn=ke.msPointer?"MSPointerMove":"pointermove",Pa=ke.msPointer?"MSPointerUp":"pointerup",Aa=ke.msPointer?"MSPointerCancel":"pointercancel",Fs={touchstart:mn,touchmove:Bn,touchend:Pa,touchcancel:Aa},el={touchstart:sk,touchmove:tl,touchend:tl,touchcancel:tl},Fn={},Kp=!1;function Q1(o,u,p){return u==="touchstart"&&nk(),el[u]?(p=el[u].bind(this,p),o.addEventListener(Fs[u],p,!1),p):(console.warn("wrong event specified:",u),m)}function ek(o,u,p){if(!Fs[u]){console.warn("wrong event specified:",u);return}o.removeEventListener(Fs[u],p,!1)}function tk(o){Fn[o.pointerId]=o}function rk(o){Fn[o.pointerId]&&(Fn[o.pointerId]=o)}function Zp(o){delete Fn[o.pointerId]}function nk(){Kp||(document.addEventListener(mn,tk,!0),document.addEventListener(Bn,rk,!0),document.addEventListener(Pa,Zp,!0),document.addEventListener(Aa,Zp,!0),Kp=!0)}function tl(o,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var p in Fn)u.touches.push(Fn[p]);u.changedTouches=[u],o(u)}}function sk(o,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&ur(u),tl(o,u)}function ak(o){var u={},p,b;for(b in o)p=o[b],u[b]=p&&p.bind?p.bind(o):p;return o=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var ik=200;function ok(o,u){o.addEventListener("dblclick",u);var p=0,b;function S(I){if(I.detail!==1){b=I.detail;return}if(!(I.pointerType==="mouse"||I.sourceCapabilities&&!I.sourceCapabilities.firesTouchEvents)){var q=eg(I);if(!(q.some(function(re){return re instanceof HTMLLabelElement&&re.attributes.for})&&!q.some(function(re){return re instanceof HTMLInputElement||re instanceof HTMLSelectElement}))){var Q=Date.now();Q-p<=ik?(b++,b===2&&u(ak(I))):b=1,p=Q}}}return o.addEventListener("click",S),{dblclick:u,simDblclick:S}}function lk(o,u){o.removeEventListener("dblclick",u.dblclick),o.removeEventListener("click",u.simDblclick)}var Gd=sl(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ii=sl(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Yp=Ii==="webkitTransition"||Ii==="OTransition"?Ii+"End":"transitionend";function Xp(o){return typeof o=="string"?document.getElementById(o):o}function Li(o,u){var p=o.style[u]||o.currentStyle&&o.currentStyle[u];if((!p||p==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(o,null);p=b?b[u]:null}return p==="auto"?null:p}function it(o,u,p){var b=document.createElement(o);return b.className=u||"",p&&p.appendChild(b),b}function Pt(o){var u=o.parentNode;u&&u.removeChild(o)}function rl(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function Ta(o){var u=o.parentNode;u&&u.lastChild!==o&&u.appendChild(o)}function Oa(o){var u=o.parentNode;u&&u.firstChild!==o&&u.insertBefore(o,u.firstChild)}function Hd(o,u){if(o.classList!==void 0)return o.classList.contains(u);var p=nl(o);return p.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(p)}function Ke(o,u){if(o.classList!==void 0)for(var p=j(u),b=0,S=p.length;b<S;b++)o.classList.add(p[b]);else if(!Hd(o,u)){var I=nl(o);Vd(o,(I?I+" ":"")+u)}}function Dt(o,u){o.classList!==void 0?o.classList.remove(u):Vd(o,v((" "+nl(o)+" ").replace(" "+u+" "," ")))}function Vd(o,u){o.className.baseVal===void 0?o.className=u:o.className.baseVal=u}function nl(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function Xr(o,u){"opacity"in o.style?o.style.opacity=u:"filter"in o.style&&ck(o,u)}function ck(o,u){var p=!1,b="DXImageTransform.Microsoft.Alpha";try{p=o.filters.item(b)}catch{if(u===1)return}u=Math.round(u*100),p?(p.Enabled=u!==100,p.Opacity=u):o.style.filter+=" progid:"+b+"(opacity="+u+")"}function sl(o){for(var u=document.documentElement.style,p=0;p<o.length;p++)if(o[p]in u)return o[p];return!1}function Us(o,u,p){var b=u||new R(0,0);o.style[Gd]=(ke.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(p?" scale("+p+")":"")}function Bt(o,u){o._leaflet_pos=u,ke.any3d?Us(o,u):(o.style.left=u.x+"px",o.style.top=u.y+"px")}function Ws(o){return o._leaflet_pos||new R(0,0)}var Di,Ri,Kd;if("onselectstart"in document)Di=function(){He(window,"selectstart",ur)},Ri=function(){gt(window,"selectstart",ur)};else{var $i=sl(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Di=function(){if($i){var o=document.documentElement.style;Kd=o[$i],o[$i]="none"}},Ri=function(){$i&&(document.documentElement.style[$i]=Kd,Kd=void 0)}}function Zd(){He(window,"dragstart",ur)}function Yd(){gt(window,"dragstart",ur)}var al,Xd;function Jd(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(il(),al=o,Xd=o.style.outlineStyle,o.style.outlineStyle="none",He(window,"keydown",il))}function il(){al&&(al.style.outlineStyle=Xd,al=void 0,Xd=void 0,gt(window,"keydown",il))}function Jp(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function Qd(o){var u=o.getBoundingClientRect();return{x:u.width/o.offsetWidth||1,y:u.height/o.offsetHeight||1,boundingClientRect:u}}var dk={__proto__:null,TRANSFORM:Gd,TRANSITION:Ii,TRANSITION_END:Yp,get:Xp,getStyle:Li,create:it,remove:Pt,empty:rl,toFront:Ta,toBack:Oa,hasClass:Hd,addClass:Ke,removeClass:Dt,setClass:Vd,getClass:nl,setOpacity:Xr,testProp:sl,setTransform:Us,setPosition:Bt,getPosition:Ws,get disableTextSelection(){return Di},get enableTextSelection(){return Ri},disableImageDrag:Zd,enableImageDrag:Yd,preventOutline:Jd,restoreOutline:il,getSizedParentNode:Jp,getScale:Qd};function He(o,u,p,b){if(u&&typeof u=="object")for(var S in u)tu(o,S,u[S],p);else{u=j(u);for(var I=0,q=u.length;I<q;I++)tu(o,u[I],p,b)}return this}var kn="_leaflet_events";function gt(o,u,p,b){if(arguments.length===1)Qp(o),delete o[kn];else if(u&&typeof u=="object")for(var S in u)ru(o,S,u[S],p);else if(u=j(u),arguments.length===2)Qp(o,function(Q){return P(u,Q)!==-1});else for(var I=0,q=u.length;I<q;I++)ru(o,u[I],p,b);return this}function Qp(o,u){for(var p in o[kn]){var b=p.split(/\d/)[0];(!u||u(b))&&ru(o,b,null,null,p)}}var eu={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function tu(o,u,p,b){var S=u+d(p)+(b?"_"+d(b):"");if(o[kn]&&o[kn][S])return this;var I=function(Q){return p.call(b||o,Q||window.event)},q=I;!ke.touchNative&&ke.pointer&&u.indexOf("touch")===0?I=Q1(o,u,I):ke.touch&&u==="dblclick"?I=ok(o,I):"addEventListener"in o?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?o.addEventListener(eu[u]||u,I,ke.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(I=function(Q){Q=Q||window.event,su(o,Q)&&q(Q)},o.addEventListener(eu[u],I,!1)):o.addEventListener(u,q,!1):o.attachEvent("on"+u,I),o[kn]=o[kn]||{},o[kn][S]=I}function ru(o,u,p,b,S){S=S||u+d(p)+(b?"_"+d(b):"");var I=o[kn]&&o[kn][S];if(!I)return this;!ke.touchNative&&ke.pointer&&u.indexOf("touch")===0?ek(o,u,I):ke.touch&&u==="dblclick"?lk(o,I):"removeEventListener"in o?o.removeEventListener(eu[u]||u,I,!1):o.detachEvent("on"+u,I),o[kn][S]=null}function qs(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function nu(o){return tu(o,"wheel",qs),this}function zi(o){return He(o,"mousedown touchstart dblclick contextmenu",qs),o._leaflet_disable_click=!0,this}function ur(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function Gs(o){return ur(o),qs(o),this}function eg(o){if(o.composedPath)return o.composedPath();for(var u=[],p=o.target;p;)u.push(p),p=p.parentNode;return u}function tg(o,u){if(!u)return new R(o.clientX,o.clientY);var p=Qd(u),b=p.boundingClientRect;return new R((o.clientX-b.left)/p.x-u.clientLeft,(o.clientY-b.top)/p.y-u.clientTop)}var uk=ke.linux&&ke.chrome?window.devicePixelRatio:ke.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function rg(o){return ke.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/uk:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function su(o,u){var p=u.relatedTarget;if(!p)return!0;try{for(;p&&p!==o;)p=p.parentNode}catch{return!1}return p!==o}var hk={__proto__:null,on:He,off:gt,stopPropagation:qs,disableScrollPropagation:nu,disableClickPropagation:zi,preventDefault:ur,stop:Gs,getPropagationPath:eg,getMousePosition:tg,getWheelDelta:rg,isExternalTarget:su,addListener:He,removeListener:gt},ng=Y.extend({run:function(o,u,p,b){this.stop(),this._el=o,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=Ws(o),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=$(this._animate,this),this._step()},_step:function(o){var u=+new Date-this._startTime,p=this._duration*1e3;u<p?this._runFrame(this._easeOut(u/p),o):(this._runFrame(1),this._complete())},_runFrame:function(o,u){var p=this._startPos.add(this._offset.multiplyBy(o));u&&p._round(),Bt(this._el,p),this.fire("step")},_complete:function(){M(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),st=Y.extend({options:{crs:Oe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,u){u=_(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(fe(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ii&&ke.any3d&&!ke.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),He(this._proxy,Yp,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,u,p){if(u=u===void 0?this._zoom:this._limitZoom(u),o=this._limitCenter(fe(o),u,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=a({animate:p.animate},p.zoom),p.pan=a({animate:p.animate,duration:p.duration},p.pan));var b=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,u,p.zoom):this._tryAnimatedPan(o,p.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(o,u,p.pan&&p.pan.noMoveStart),this},setZoom:function(o,u){return this._loaded?this.setView(this.getCenter(),o,{zoom:u}):(this._zoom=o,this)},zoomIn:function(o,u){return o=o||(ke.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,u)},zoomOut:function(o,u){return o=o||(ke.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,u)},setZoomAround:function(o,u,p){var b=this.getZoomScale(u),S=this.getSize().divideBy(2),I=o instanceof R?o:this.latLngToContainerPoint(o),q=I.subtract(S).multiplyBy(1-1/b),Q=this.containerPointToLatLng(S.add(q));return this.setView(Q,u,{zoom:p})},_getBoundsCenterZoom:function(o,u){u=u||{},o=o.getBounds?o.getBounds():Z(o);var p=J(u.paddingTopLeft||u.padding||[0,0]),b=J(u.paddingBottomRight||u.padding||[0,0]),S=this.getBoundsZoom(o,!1,p.add(b));if(S=typeof u.maxZoom=="number"?Math.min(u.maxZoom,S):S,S===1/0)return{center:o.getCenter(),zoom:S};var I=b.subtract(p).divideBy(2),q=this.project(o.getSouthWest(),S),Q=this.project(o.getNorthEast(),S),re=this.unproject(q.add(Q).divideBy(2).add(I),S);return{center:re,zoom:S}},fitBounds:function(o,u){if(o=Z(o),!o.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(o,u);return this.setView(p.center,p.zoom,u)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,u){return this.setView(o,this._zoom,{pan:u})},panBy:function(o,u){if(o=J(o).round(),u=u||{},!o.x&&!o.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ng,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){Ke(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,p,u.duration||.25,u.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,u,p){if(p=p||{},p.animate===!1||!ke.any3d)return this.setView(o,u,p);this._stop();var b=this.project(this.getCenter()),S=this.project(o),I=this.getSize(),q=this._zoom;o=fe(o),u=u===void 0?q:u;var Q=Math.max(I.x,I.y),re=Q*this.getZoomScale(q,u),le=S.distanceTo(b)||1,_e=1.42,Be=_e*_e;function Je(Ft){var vl=Ft?-1:1,eS=Ft?re:Q,tS=re*re-Q*Q+vl*Be*Be*le*le,rS=2*eS*Be*le,pu=tS/rS,Rg=Math.sqrt(pu*pu+1)-pu,nS=Rg<1e-9?-18:Math.log(Rg);return nS}function Nr(Ft){return(Math.exp(Ft)-Math.exp(-Ft))/2}function rr(Ft){return(Math.exp(Ft)+Math.exp(-Ft))/2}function Qr(Ft){return Nr(Ft)/rr(Ft)}var Ar=Je(0);function $a(Ft){return Q*(rr(Ar)/rr(Ar+_e*Ft))}function Yk(Ft){return Q*(rr(Ar)*Qr(Ar+_e*Ft)-Nr(Ar))/Be}function Xk(Ft){return 1-Math.pow(1-Ft,1.5)}var Jk=Date.now(),Lg=(Je(1)-Ar)/_e,Qk=p.duration?1e3*p.duration:1e3*Lg*.8;function Dg(){var Ft=(Date.now()-Jk)/Qk,vl=Xk(Ft)*Lg;Ft<=1?(this._flyToFrame=$(Dg,this),this._move(this.unproject(b.add(S.subtract(b).multiplyBy(Yk(vl)/le)),q),this.getScaleZoom(Q/$a(vl),q),{flyTo:!0})):this._move(o,u)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),Dg.call(this),this},flyToBounds:function(o,u){var p=this._getBoundsCenterZoom(o,u);return this.flyTo(p.center,p.zoom,u)},setMaxBounds:function(o){return o=Z(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var u=this.options.minZoom;return this.options.minZoom=o,this._loaded&&u!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var u=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&u!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,u){this._enforcingBounds=!0;var p=this.getCenter(),b=this._limitCenter(p,this._zoom,Z(o));return p.equals(b)||this.panTo(b,u),this._enforcingBounds=!1,this},panInside:function(o,u){u=u||{};var p=J(u.paddingTopLeft||u.padding||[0,0]),b=J(u.paddingBottomRight||u.padding||[0,0]),S=this.project(this.getCenter()),I=this.project(o),q=this.getPixelBounds(),Q=V([q.min.add(p),q.max.subtract(b)]),re=Q.getSize();if(!Q.contains(I)){this._enforcingBounds=!0;var le=I.subtract(Q.getCenter()),_e=Q.extend(I).getSize().subtract(re);S.x+=le.x<0?-_e.x:_e.x,S.y+=le.y<0?-_e.y:_e.y,this.panTo(this.unproject(S),u),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=a({animate:!1,pan:!0},o===!0?{animate:!0}:o);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),b=u.divideBy(2).round(),S=p.divideBy(2).round(),I=b.subtract(S);return!I.x&&!I.y?this:(o.animate&&o.pan?this.panBy(I):(o.pan&&this._rawPanBy(I),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=a({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=l(this._handleGeolocationResponse,this),p=l(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,p,o):navigator.geolocation.getCurrentPosition(u,p,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var u=o.code,p=o.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var u=o.coords.latitude,p=o.coords.longitude,b=new ie(u,p),S=b.toBounds(o.coords.accuracy*2),I=this._locateOptions;if(I.setView){var q=this.getBoundsZoom(S);this.setView(b,I.maxZoom?Math.min(q,I.maxZoom):q)}var Q={latlng:b,bounds:S,timestamp:o.timestamp};for(var re in o.coords)typeof o.coords[re]=="number"&&(Q[re]=o.coords[re]);this.fire("locationfound",Q)}},addHandler:function(o,u){if(!u)return this;var p=this[o]=new u(this);return this._handlers.push(p),this.options[o]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Pt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(M(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)Pt(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,u){var p="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),b=it("div",p,u||this._mapPane);return o&&(this._panes[o]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),u=this.unproject(o.getBottomLeft()),p=this.unproject(o.getTopRight());return new te(u,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,u,p){o=Z(o),p=J(p||[0,0]);var b=this.getZoom()||0,S=this.getMinZoom(),I=this.getMaxZoom(),q=o.getNorthWest(),Q=o.getSouthEast(),re=this.getSize().subtract(p),le=V(this.project(Q,b),this.project(q,b)).getSize(),_e=ke.any3d?this.options.zoomSnap:1,Be=re.x/le.x,Je=re.y/le.y,Nr=u?Math.max(Be,Je):Math.min(Be,Je);return b=this.getScaleZoom(Nr,b),_e&&(b=Math.round(b/(_e/100))*(_e/100),b=u?Math.ceil(b/_e)*_e:Math.floor(b/_e)*_e),Math.max(S,Math.min(I,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new R(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,u){var p=this._getTopLeftPoint(o,u);return new F(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,u){var p=this.options.crs;return u=u===void 0?this._zoom:u,p.scale(o)/p.scale(u)},getScaleZoom:function(o,u){var p=this.options.crs;u=u===void 0?this._zoom:u;var b=p.zoom(o*p.scale(u));return isNaN(b)?1/0:b},project:function(o,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(fe(o),u)},unproject:function(o,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(J(o),u)},layerPointToLatLng:function(o){var u=J(o).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(o){var u=this.project(fe(o))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(fe(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(Z(o))},distance:function(o,u){return this.options.crs.distance(fe(o),fe(u))},containerPointToLayerPoint:function(o){return J(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return J(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var u=this.containerPointToLayerPoint(J(o));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(fe(o)))},mouseEventToContainerPoint:function(o){return tg(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var u=this._container=Xp(o);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");He(u,"scroll",this._onScroll,this),this._containerId=d(u)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&ke.any3d,Ke(o,"leaflet-container"+(ke.touch?" leaflet-touch":"")+(ke.retina?" leaflet-retina":"")+(ke.ielt9?" leaflet-oldie":"")+(ke.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=Li(o,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Bt(this._mapPane,new R(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ke(o.markerPane,"leaflet-zoom-hide"),Ke(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,u,p){Bt(this._mapPane,new R(0,0));var b=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var S=this._zoom!==u;this._moveStart(S,p)._move(o,u)._moveEnd(S),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(o,u){return o&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(o,u,p,b){u===void 0&&(u=this._zoom);var S=this._zoom!==u;return this._zoom=u,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),b?p&&p.pinch&&this.fire("zoom",p):((S||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return M(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){Bt(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[d(this._container)]=this;var u=o?gt:He;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),ke.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){M(this._resizeRequest),this._resizeRequest=$(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,u){for(var p=[],b,S=u==="mouseout"||u==="mouseover",I=o.target||o.srcElement,q=!1;I;){if(b=this._targets[d(I)],b&&(u==="click"||u==="preclick")&&this._draggableMoved(b)){q=!0;break}if(b&&b.listens(u,!0)&&(S&&!su(I,o)||(p.push(b),S))||I===this._container)break;I=I.parentNode}return!p.length&&!q&&!S&&this.listens(u,!0)&&(p=[this]),p},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var u=o.target||o.srcElement;if(!(!this._loaded||u._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(u))){var p=o.type;p==="mousedown"&&Jd(u),this._fireDOMEvent(o,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,u,p){if(o.type==="click"){var b=a({},o);b.type="preclick",this._fireDOMEvent(b,b.type,p)}var S=this._findEventTargets(o,u);if(p){for(var I=[],q=0;q<p.length;q++)p[q].listens(u,!0)&&I.push(p[q]);S=I.concat(S)}if(S.length){u==="contextmenu"&&ur(o);var Q=S[0],re={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var le=Q.getLatLng&&(!Q._radius||Q._radius<=10);re.containerPoint=le?this.latLngToContainerPoint(Q.getLatLng()):this.mouseEventToContainerPoint(o),re.layerPoint=this.containerPointToLayerPoint(re.containerPoint),re.latlng=le?Q.getLatLng():this.layerPointToLatLng(re.layerPoint)}for(q=0;q<S.length;q++)if(S[q].fire(u,re,!0),re.originalEvent._stopped||S[q].options.bubblingMouseEvents===!1&&P(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,u=this._handlers.length;o<u;o++)this._handlers[o].disable()},whenReady:function(o,u){return this._loaded?o.call(u||this,{target:this}):this.on("load",o,u),this},_getMapPanePos:function(){return Ws(this._mapPane)||new R(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,u){var p=o&&u!==void 0?this._getNewPixelOrigin(o,u):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,u){var p=this.getSize()._divideBy(2);return this.project(o,u)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,u,p){var b=this._getNewPixelOrigin(p,u);return this.project(o,u)._subtract(b)},_latLngBoundsToNewLayerBounds:function(o,u,p){var b=this._getNewPixelOrigin(p,u);return V([this.project(o.getSouthWest(),u)._subtract(b),this.project(o.getNorthWest(),u)._subtract(b),this.project(o.getSouthEast(),u)._subtract(b),this.project(o.getNorthEast(),u)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,u,p){if(!p)return o;var b=this.project(o,u),S=this.getSize().divideBy(2),I=new F(b.subtract(S),b.add(S)),q=this._getBoundsOffset(I,p,u);return Math.abs(q.x)<=1&&Math.abs(q.y)<=1?o:this.unproject(b.add(q),u)},_limitOffset:function(o,u){if(!u)return o;var p=this.getPixelBounds(),b=new F(p.min.add(o),p.max.add(o));return o.add(this._getBoundsOffset(b,u))},_getBoundsOffset:function(o,u,p){var b=V(this.project(u.getNorthEast(),p),this.project(u.getSouthWest(),p)),S=b.min.subtract(o.min),I=b.max.subtract(o.max),q=this._rebound(S.x,-I.x),Q=this._rebound(S.y,-I.y);return new R(q,Q)},_rebound:function(o,u){return o+u>0?Math.round(o-u)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(u))},_limitZoom:function(o){var u=this.getMinZoom(),p=this.getMaxZoom(),b=ke.any3d?this.options.zoomSnap:1;return b&&(o=Math.round(o/b)*b),Math.max(u,Math.min(p,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Dt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,u){var p=this._getCenterOffset(o)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,u),!0)},_createAnimProxy:function(){var o=this._proxy=it("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(u){var p=Gd,b=this._proxy.style[p];Us(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),b===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Pt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),u=this.getZoom();Us(this._proxy,this.project(o,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,u,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(u),S=this._getCenterOffset(o)._divideBy(1-1/b);return p.animate!==!0&&!this.getSize().contains(S)?!1:($(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(o,u,!0)},this),!0)},_animateZoom:function(o,u,p,b){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=u,Ke(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:u,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Dt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function fk(o,u){return new st(o,u)}var pn=K.extend({options:{position:"topright"},initialize:function(o){_(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var u=this._map;return u&&u.removeControl(this),this.options.position=o,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var u=this._container=this.onAdd(o),p=this.getPosition(),b=o._controlCorners[p];return Ke(u,"leaflet-control"),p.indexOf("bottom")!==-1?b.insertBefore(u,b.firstChild):b.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Pt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),Bi=function(o){return new pn(o)};st.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},u="leaflet-",p=this._controlContainer=it("div",u+"control-container",this._container);function b(S,I){var q=u+S+" "+u+I;o[S+I]=it("div",q,p)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)Pt(this._controlCorners[o]);Pt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var sg=pn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,u,p,b){return p<b?-1:b<p?1:0}},initialize:function(o,u,p){_(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in o)this._addLayer(o[b],b);for(b in u)this._addLayer(u[b],b,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return pn.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,u){return this._addLayer(o,u),this._map?this._update():this},addOverlay:function(o,u){return this._addLayer(o,u,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var u=this._getLayer(d(o));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){Ke(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(Ke(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):Dt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Dt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",u=this._container=it("div",o),p=this.options.collapsed;u.setAttribute("aria-haspopup",!0),zi(u),nu(u);var b=this._section=it("section",o+"-list");p&&(this._map.on("click",this.collapse,this),He(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var S=this._layersLink=it("a",o+"-toggle",u);S.href="#",S.title="Layers",S.setAttribute("role","button"),He(S,{keydown:function(I){I.keyCode===13&&this._expandSafely()},click:function(I){ur(I),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=it("div",o+"-base",b),this._separator=it("div",o+"-separator",b),this._overlaysList=it("div",o+"-overlays",b),u.appendChild(b)},_getLayer:function(o){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&d(this._layers[u].layer)===o)return this._layers[u]},_addLayer:function(o,u,p){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:u,overlay:p}),this.options.sortLayers&&this._layers.sort(l(function(b,S){return this.options.sortFunction(b.layer,S.layer,b.name,S.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;rl(this._baseLayersList),rl(this._overlaysList),this._layerControlInputs=[];var o,u,p,b,S=0;for(p=0;p<this._layers.length;p++)b=this._layers[p],this._addItem(b),u=u||b.overlay,o=o||!b.overlay,S+=b.overlay?0:1;return this.options.hideSingleBase&&(o=o&&S>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=u&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var u=this._getLayer(d(o.target)),p=u.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;p&&this._map.fire(p,u)},_createRadioElement:function(o,u){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(u?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=p,b.firstChild},_addItem:function(o){var u=document.createElement("label"),p=this._map.hasLayer(o.layer),b;o.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=p):b=this._createRadioElement("leaflet-base-layers_"+d(this),p),this._layerControlInputs.push(b),b.layerId=d(o.layer),He(b,"click",this._onInputClick,this);var S=document.createElement("span");S.innerHTML=" "+o.name;var I=document.createElement("span");u.appendChild(I),I.appendChild(b),I.appendChild(S);var q=o.overlay?this._overlaysList:this._baseLayersList;return q.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,u,p,b=[],S=[];this._handlingClick=!0;for(var I=o.length-1;I>=0;I--)u=o[I],p=this._getLayer(u.layerId).layer,u.checked?b.push(p):u.checked||S.push(p);for(I=0;I<S.length;I++)this._map.hasLayer(S[I])&&this._map.removeLayer(S[I]);for(I=0;I<b.length;I++)this._map.hasLayer(b[I])||this._map.addLayer(b[I]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,u,p,b=this._map.getZoom(),S=o.length-1;S>=0;S--)u=o[S],p=this._getLayer(u.layerId).layer,u.disabled=p.options.minZoom!==void 0&&b<p.options.minZoom||p.options.maxZoom!==void 0&&b>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,He(o,"click",ur),this.expand();var u=this;setTimeout(function(){gt(o,"click",ur),u._preventClick=!1})}}),mk=function(o,u,p){return new sg(o,u,p)},au=pn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var u="leaflet-control-zoom",p=it("div",u+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,u+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,u+"-out",p,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,u,p,b,S){var I=it("a",p,b);return I.innerHTML=o,I.href="#",I.title=u,I.setAttribute("role","button"),I.setAttribute("aria-label",u),zi(I),He(I,"click",Gs),He(I,"click",S,this),He(I,"click",this._refocusOnMap,this),I},_updateDisabled:function(){var o=this._map,u="leaflet-disabled";Dt(this._zoomInButton,u),Dt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(Ke(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(Ke(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});st.mergeOptions({zoomControl:!0}),st.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new au,this.addControl(this.zoomControl))});var pk=function(o){return new au(o)},ag=pn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var u="leaflet-control-scale",p=it("div",u),b=this.options;return this._addScales(b,u+"-line",p),o.on(b.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),p},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,u,p){o.metric&&(this._mScale=it("div",u,p)),o.imperial&&(this._iScale=it("div",u,p))},_update:function(){var o=this._map,u=o.getSize().y/2,p=o.distance(o.containerPointToLatLng([0,u]),o.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(p)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var u=this._getRoundNum(o),p=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,p,u/o)},_updateImperial:function(o){var u=o*3.2808399,p,b,S;u>5280?(p=u/5280,b=this._getRoundNum(p),this._updateScale(this._iScale,b+" mi",b/p)):(S=this._getRoundNum(u),this._updateScale(this._iScale,S+" ft",S/u))},_updateScale:function(o,u,p){o.style.width=Math.round(this.options.maxWidth*p)+"px",o.innerHTML=u},_getRoundNum:function(o){var u=Math.pow(10,(Math.floor(o)+"").length-1),p=o/u;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,u*p}}),gk=function(o){return new ag(o)},xk='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',iu=pn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ke.inlineSvg?xk+" ":"")+"Leaflet</a>"},initialize:function(o){_(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=it("div","leaflet-control-attribution"),zi(this._container);for(var u in o._layers)o._layers[u].getAttribution&&this.addAttribution(o._layers[u].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var u in this._attributions)this._attributions[u]&&o.push(u);var p=[];this.options.prefix&&p.push(this.options.prefix),o.length&&p.push(o.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});st.mergeOptions({attributionControl:!0}),st.addInitHook(function(){this.options.attributionControl&&new iu().addTo(this)});var vk=function(o){return new iu(o)};pn.Layers=sg,pn.Zoom=au,pn.Scale=ag,pn.Attribution=iu,Bi.layers=mk,Bi.zoom=pk,Bi.scale=gk,Bi.attribution=vk;var Sn=K.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Sn.addTo=function(o,u){return o.addHandler(u,this),this};var yk={Events:U},ig=ke.touch?"touchstart mousedown":"mousedown",ys=Y.extend({options:{clickTolerance:3},initialize:function(o,u,p,b){_(this,b),this._element=o,this._dragStartTarget=u||o,this._preventOutline=p},enable:function(){this._enabled||(He(this._dragStartTarget,ig,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ys._dragging===this&&this.finishDrag(!0),gt(this._dragStartTarget,ig,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!Hd(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){ys._dragging===this&&this.finishDrag();return}if(!(ys._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(ys._dragging=this,this._preventOutline&&Jd(this._element),Zd(),Di(),!this._moving)){this.fire("down");var u=o.touches?o.touches[0]:o,p=Jp(this._element);this._startPoint=new R(u.clientX,u.clientY),this._startPos=Ws(this._element),this._parentScale=Qd(p);var b=o.type==="mousedown";He(document,b?"mousemove":"touchmove",this._onMove,this),He(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var u=o.touches&&o.touches.length===1?o.touches[0]:o,p=new R(u.clientX,u.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,ur(o),this._moved||(this.fire("dragstart"),this._moved=!0,Ke(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ke(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),Bt(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){Dt(document.body,"leaflet-dragging"),this._lastTarget&&(Dt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),gt(document,"mousemove touchmove",this._onMove,this),gt(document,"mouseup touchend touchcancel",this._onUp,this),Yd(),Ri();var u=this._moved&&this._moving;this._moving=!1,ys._dragging=!1,u&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function og(o,u,p){var b,S=[1,4,2,8],I,q,Q,re,le,_e,Be,Je;for(I=0,_e=o.length;I<_e;I++)o[I]._code=Hs(o[I],u);for(Q=0;Q<4;Q++){for(Be=S[Q],b=[],I=0,_e=o.length,q=_e-1;I<_e;q=I++)re=o[I],le=o[q],re._code&Be?le._code&Be||(Je=ol(le,re,Be,u,p),Je._code=Hs(Je,u),b.push(Je)):(le._code&Be&&(Je=ol(le,re,Be,u,p),Je._code=Hs(Je,u),b.push(Je)),b.push(re));o=b}return o}function lg(o,u){var p,b,S,I,q,Q,re,le,_e;if(!o||o.length===0)throw new Error("latlngs not passed");Jr(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var Be=fe([0,0]),Je=Z(o),Nr=Je.getNorthWest().distanceTo(Je.getSouthWest())*Je.getNorthEast().distanceTo(Je.getNorthWest());Nr<1700&&(Be=ou(o));var rr=o.length,Qr=[];for(p=0;p<rr;p++){var Ar=fe(o[p]);Qr.push(u.project(fe([Ar.lat-Be.lat,Ar.lng-Be.lng])))}for(Q=re=le=0,p=0,b=rr-1;p<rr;b=p++)S=Qr[p],I=Qr[b],q=S.y*I.x-I.y*S.x,re+=(S.x+I.x)*q,le+=(S.y+I.y)*q,Q+=q*3;Q===0?_e=Qr[0]:_e=[re/Q,le/Q];var $a=u.unproject(J(_e));return fe([$a.lat+Be.lat,$a.lng+Be.lng])}function ou(o){for(var u=0,p=0,b=0,S=0;S<o.length;S++){var I=fe(o[S]);u+=I.lat,p+=I.lng,b++}return fe([u/b,p/b])}var bk={__proto__:null,clipPolygon:og,polygonCenter:lg,centroid:ou};function cg(o,u){if(!u||!o.length)return o.slice();var p=u*u;return o=jk(o,p),o=_k(o,p),o}function dg(o,u,p){return Math.sqrt(Fi(o,u,p,!0))}function wk(o,u,p){return Fi(o,u,p)}function _k(o,u){var p=o.length,b=typeof Uint8Array<"u"?Uint8Array:Array,S=new b(p);S[0]=S[p-1]=1,lu(o,S,u,0,p-1);var I,q=[];for(I=0;I<p;I++)S[I]&&q.push(o[I]);return q}function lu(o,u,p,b,S){var I=0,q,Q,re;for(Q=b+1;Q<=S-1;Q++)re=Fi(o[Q],o[b],o[S],!0),re>I&&(q=Q,I=re);I>p&&(u[q]=1,lu(o,u,p,b,q),lu(o,u,p,q,S))}function jk(o,u){for(var p=[o[0]],b=1,S=0,I=o.length;b<I;b++)Nk(o[b],o[S])>u&&(p.push(o[b]),S=b);return S<I-1&&p.push(o[I-1]),p}var ug;function hg(o,u,p,b,S){var I=b?ug:Hs(o,p),q=Hs(u,p),Q,re,le;for(ug=q;;){if(!(I|q))return[o,u];if(I&q)return!1;Q=I||q,re=ol(o,u,Q,p,S),le=Hs(re,p),Q===I?(o=re,I=le):(u=re,q=le)}}function ol(o,u,p,b,S){var I=u.x-o.x,q=u.y-o.y,Q=b.min,re=b.max,le,_e;return p&8?(le=o.x+I*(re.y-o.y)/q,_e=re.y):p&4?(le=o.x+I*(Q.y-o.y)/q,_e=Q.y):p&2?(le=re.x,_e=o.y+q*(re.x-o.x)/I):p&1&&(le=Q.x,_e=o.y+q*(Q.x-o.x)/I),new R(le,_e,S)}function Hs(o,u){var p=0;return o.x<u.min.x?p|=1:o.x>u.max.x&&(p|=2),o.y<u.min.y?p|=4:o.y>u.max.y&&(p|=8),p}function Nk(o,u){var p=u.x-o.x,b=u.y-o.y;return p*p+b*b}function Fi(o,u,p,b){var S=u.x,I=u.y,q=p.x-S,Q=p.y-I,re=q*q+Q*Q,le;return re>0&&(le=((o.x-S)*q+(o.y-I)*Q)/re,le>1?(S=p.x,I=p.y):le>0&&(S+=q*le,I+=Q*le)),q=o.x-S,Q=o.y-I,b?q*q+Q*Q:new R(S,I)}function Jr(o){return!N(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function fg(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Jr(o)}function mg(o,u){var p,b,S,I,q,Q,re,le;if(!o||o.length===0)throw new Error("latlngs not passed");Jr(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var _e=fe([0,0]),Be=Z(o),Je=Be.getNorthWest().distanceTo(Be.getSouthWest())*Be.getNorthEast().distanceTo(Be.getNorthWest());Je<1700&&(_e=ou(o));var Nr=o.length,rr=[];for(p=0;p<Nr;p++){var Qr=fe(o[p]);rr.push(u.project(fe([Qr.lat-_e.lat,Qr.lng-_e.lng])))}for(p=0,b=0;p<Nr-1;p++)b+=rr[p].distanceTo(rr[p+1])/2;if(b===0)le=rr[0];else for(p=0,I=0;p<Nr-1;p++)if(q=rr[p],Q=rr[p+1],S=q.distanceTo(Q),I+=S,I>b){re=(I-b)/S,le=[Q.x-re*(Q.x-q.x),Q.y-re*(Q.y-q.y)];break}var Ar=u.unproject(J(le));return fe([Ar.lat+_e.lat,Ar.lng+_e.lng])}var kk={__proto__:null,simplify:cg,pointToSegmentDistance:dg,closestPointOnSegment:wk,clipSegment:hg,_getEdgeIntersection:ol,_getBitCode:Hs,_sqClosestPointOnSegment:Fi,isFlat:Jr,_flat:fg,polylineCenter:mg},cu={project:function(o){return new R(o.lng,o.lat)},unproject:function(o){return new ie(o.y,o.x)},bounds:new F([-180,-90],[180,90])},du={R:6378137,R_MINOR:6356752314245179e-9,bounds:new F([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var u=Math.PI/180,p=this.R,b=o.lat*u,S=this.R_MINOR/p,I=Math.sqrt(1-S*S),q=I*Math.sin(b),Q=Math.tan(Math.PI/4-b/2)/Math.pow((1-q)/(1+q),I/2);return b=-p*Math.log(Math.max(Q,1e-10)),new R(o.lng*u*p,b)},unproject:function(o){for(var u=180/Math.PI,p=this.R,b=this.R_MINOR/p,S=Math.sqrt(1-b*b),I=Math.exp(-o.y/p),q=Math.PI/2-2*Math.atan(I),Q=0,re=.1,le;Q<15&&Math.abs(re)>1e-7;Q++)le=S*Math.sin(q),le=Math.pow((1-le)/(1+le),S/2),re=Math.PI/2-2*Math.atan(I*le)-q,q+=re;return new ie(q*u,o.x*u/p)}},Sk={__proto__:null,LonLat:cu,Mercator:du,SphericalMercator:de},Ek=a({},xe,{code:"EPSG:3395",projection:du,transformation:function(){var o=.5/(Math.PI*du.R);return ne(o,.5,-o,.5)}()}),pg=a({},xe,{code:"EPSG:4326",projection:cu,transformation:ne(1/180,1,-1/180,.5)}),Ck=a({},be,{projection:cu,transformation:ne(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,u){var p=u.lng-o.lng,b=u.lat-o.lat;return Math.sqrt(p*p+b*b)},infinite:!0});be.Earth=xe,be.EPSG3395=Ek,be.EPSG3857=Oe,be.EPSG900913=Ce,be.EPSG4326=pg,be.Simple=Ck;var gn=Y.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[d(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[d(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var u=o.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var p=this.getEvents();u.on(p,this),this.once("remove",function(){u.off(p,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});st.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var u=d(o);return this._layers[u]?this:(this._layers[u]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var u=d(o);return this._layers[u]?(this._loaded&&o.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return d(o)in this._layers},eachLayer:function(o,u){for(var p in this._layers)o.call(u,this._layers[p]);return this},_addLayers:function(o){o=o?N(o)?o:[o]:[];for(var u=0,p=o.length;u<p;u++)this.addLayer(o[u])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[d(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var u=d(o);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,u=-1/0,p=this._getZoomSpan();for(var b in this._zoomBoundLayers){var S=this._zoomBoundLayers[b].options;o=S.minZoom===void 0?o:Math.min(o,S.minZoom),u=S.maxZoom===void 0?u:Math.max(u,S.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=o===1/0?void 0:o,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ma=gn.extend({initialize:function(o,u){_(this,u),this._layers={};var p,b;if(o)for(p=0,b=o.length;p<b;p++)this.addLayer(o[p])},addLayer:function(o){var u=this.getLayerId(o);return this._layers[u]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var u=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(o){var u=typeof o=="number"?o:this.getLayerId(o);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var u=Array.prototype.slice.call(arguments,1),p,b;for(p in this._layers)b=this._layers[p],b[o]&&b[o].apply(b,u);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,u){for(var p in this._layers)o.call(u,this._layers[p]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return d(o)}}),Pk=function(o,u){return new Ma(o,u)},Un=Ma.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Ma.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Ma.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new te;for(var u in this._layers){var p=this._layers[u];o.extend(p.getBounds?p.getBounds():p.getLatLng())}return o}}),Ak=function(o,u){return new Un(o,u)},Ia=K.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){_(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,u){var p=this._getIconUrl(o);if(!p){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(p,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(b,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(o,u){var p=this.options,b=p[u+"Size"];typeof b=="number"&&(b=[b,b]);var S=J(b),I=J(u==="shadow"&&p.shadowAnchor||p.iconAnchor||S&&S.divideBy(2,!0));o.className="leaflet-marker-"+u+" "+(p.className||""),I&&(o.style.marginLeft=-I.x+"px",o.style.marginTop=-I.y+"px"),S&&(o.style.width=S.x+"px",o.style.height=S.y+"px")},_createImg:function(o,u){return u=u||document.createElement("img"),u.src=o,u},_getIconUrl:function(o){return ke.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function Tk(o){return new Ia(o)}var Ui=Ia.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof Ui.imagePath!="string"&&(Ui.imagePath=this._detectIconPath()),(this.options.imagePath||Ui.imagePath)+Ia.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var u=function(p,b,S){var I=b.exec(p);return I&&I[S]};return o=u(o,/^url\((['"])?(.+)\1\)$/,2),o&&u(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=it("div","leaflet-default-icon-path",document.body),u=Li(o,"background-image")||Li(o,"backgroundImage");if(document.body.removeChild(o),u=this._stripUrl(u),u)return u;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),gg=Sn.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new ys(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ke(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Dt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var u=this._marker,p=u._map,b=this._marker.options.autoPanSpeed,S=this._marker.options.autoPanPadding,I=Ws(u._icon),q=p.getPixelBounds(),Q=p.getPixelOrigin(),re=V(q.min._subtract(Q).add(S),q.max._subtract(Q).subtract(S));if(!re.contains(I)){var le=J((Math.max(re.max.x,I.x)-re.max.x)/(q.max.x-re.max.x)-(Math.min(re.min.x,I.x)-re.min.x)/(q.min.x-re.min.x),(Math.max(re.max.y,I.y)-re.max.y)/(q.max.y-re.max.y)-(Math.min(re.min.y,I.y)-re.min.y)/(q.min.y-re.min.y)).multiplyBy(b);p.panBy(le,{animate:!1}),this._draggable._newPos._add(le),this._draggable._startPos._add(le),Bt(u._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=$(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(M(this._panRequest),this._panRequest=$(this._adjustPan.bind(this,o)))},_onDrag:function(o){var u=this._marker,p=u._shadow,b=Ws(u._icon),S=u._map.layerPointToLatLng(b);p&&Bt(p,b),u._latlng=S,o.latlng=S,o.oldLatLng=this._oldLatLng,u.fire("move",o).fire("drag",o)},_onDragEnd:function(o){M(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),ll=gn.extend({options:{icon:new Ui,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,u){_(this,u),this._latlng=fe(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var u=this._latlng;return this._latlng=fe(o),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=o.icon.createIcon(this._icon),b=!1;p!==this._icon&&(this._icon&&this._removeIcon(),b=!0,o.title&&(p.title=o.title),p.tagName==="IMG"&&(p.alt=o.alt||"")),Ke(p,u),o.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&He(p,"focus",this._panOnFocus,this);var S=o.icon.createShadow(this._shadow),I=!1;S!==this._shadow&&(this._removeShadow(),I=!0),S&&(Ke(S,u),S.alt=""),this._shadow=S,o.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),S&&I&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&gt(this._icon,"focus",this._panOnFocus,this),Pt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Pt(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&Bt(this._icon,o),this._shadow&&Bt(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var u=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(Ke(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),gg)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new gg(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&Xr(this._icon,o),this._shadow&&Xr(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var u=this.options.icon.options,p=u.iconSize?J(u.iconSize):J(0,0),b=u.iconAnchor?J(u.iconAnchor):J(0,0);o.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:p.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Ok(o,u){return new ll(o,u)}var bs=gn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return _(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),cl=bs.extend({options:{fill:!0,radius:10},initialize:function(o,u){_(this,u),this._latlng=fe(o),this._radius=this.options.radius},setLatLng:function(o){var u=this._latlng;return this._latlng=fe(o),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var u=o&&o.radius||this._radius;return bs.prototype.setStyle.call(this,o),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,u=this._radiusY||o,p=this._clickTolerance(),b=[o+p,u+p];this._pxBounds=new F(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Mk(o,u){return new cl(o,u)}var uu=cl.extend({initialize:function(o,u,p){if(typeof u=="number"&&(u=a({},p,{radius:u})),_(this,u),this._latlng=fe(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new te(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:bs.prototype.setStyle,_project:function(){var o=this._latlng.lng,u=this._latlng.lat,p=this._map,b=p.options.crs;if(b.distance===xe.distance){var S=Math.PI/180,I=this._mRadius/xe.R/S,q=p.project([u+I,o]),Q=p.project([u-I,o]),re=q.add(Q).divideBy(2),le=p.unproject(re).lat,_e=Math.acos((Math.cos(I*S)-Math.sin(u*S)*Math.sin(le*S))/(Math.cos(u*S)*Math.cos(le*S)))/S;(isNaN(_e)||_e===0)&&(_e=I/Math.cos(Math.PI/180*u)),this._point=re.subtract(p.getPixelOrigin()),this._radius=isNaN(_e)?0:re.x-p.project([le,o-_e]).x,this._radiusY=re.y-q.y}else{var Be=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(Be).x}this._updateBounds()}});function Ik(o,u,p){return new uu(o,u,p)}var Wn=bs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,u){_(this,u),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var u=1/0,p=null,b=Fi,S,I,q=0,Q=this._parts.length;q<Q;q++)for(var re=this._parts[q],le=1,_e=re.length;le<_e;le++){S=re[le-1],I=re[le];var Be=b(o,S,I,!0);Be<u&&(u=Be,p=b(o,S,I))}return p&&(p.distance=Math.sqrt(u)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return mg(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,u){return u=u||this._defaultShape(),o=fe(o),u.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new te,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return Jr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var u=[],p=Jr(o),b=0,S=o.length;b<S;b++)p?(u[b]=fe(o[b]),this._bounds.extend(u[b])):u[b]=this._convertLatLngs(o[b]);return u},_project:function(){var o=new F;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),u=new R(o,o);this._rawPxBounds&&(this._pxBounds=new F([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(o,u,p){var b=o[0]instanceof ie,S=o.length,I,q;if(b){for(q=[],I=0;I<S;I++)q[I]=this._map.latLngToLayerPoint(o[I]),p.extend(q[I]);u.push(q)}else for(I=0;I<S;I++)this._projectLatlngs(o[I],u,p)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,p,b,S,I,q,Q,re;for(p=0,S=0,I=this._rings.length;p<I;p++)for(re=this._rings[p],b=0,q=re.length;b<q-1;b++)Q=hg(re[b],re[b+1],o,b,!0),Q&&(u[S]=u[S]||[],u[S].push(Q[0]),(Q[1]!==re[b+1]||b===q-2)&&(u[S].push(Q[1]),S++))}},_simplifyPoints:function(){for(var o=this._parts,u=this.options.smoothFactor,p=0,b=o.length;p<b;p++)o[p]=cg(o[p],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,u){var p,b,S,I,q,Q,re=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(p=0,I=this._parts.length;p<I;p++)for(Q=this._parts[p],b=0,q=Q.length,S=q-1;b<q;S=b++)if(!(!u&&b===0)&&dg(o,Q[S],Q[b])<=re)return!0;return!1}});function Lk(o,u){return new Wn(o,u)}Wn._flat=fg;var La=Wn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return lg(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var u=Wn.prototype._convertLatLngs.call(this,o),p=u.length;return p>=2&&u[0]instanceof ie&&u[0].equals(u[p-1])&&u.pop(),u},_setLatLngs:function(o){Wn.prototype._setLatLngs.call(this,o),Jr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Jr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,u=this.options.weight,p=new R(u,u);if(o=new F(o.min.subtract(p),o.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,S=this._rings.length,I;b<S;b++)I=og(this._rings[b],o,!0),I.length&&this._parts.push(I)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var u=!1,p,b,S,I,q,Q,re,le;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(I=0,re=this._parts.length;I<re;I++)for(p=this._parts[I],q=0,le=p.length,Q=le-1;q<le;Q=q++)b=p[q],S=p[Q],b.y>o.y!=S.y>o.y&&o.x<(S.x-b.x)*(o.y-b.y)/(S.y-b.y)+b.x&&(u=!u);return u||Wn.prototype._containsPoint.call(this,o,!0)}});function Dk(o,u){return new La(o,u)}var qn=Un.extend({initialize:function(o,u){_(this,u),this._layers={},o&&this.addData(o)},addData:function(o){var u=N(o)?o:o.features,p,b,S;if(u){for(p=0,b=u.length;p<b;p++)S=u[p],(S.geometries||S.geometry||S.features||S.coordinates)&&this.addData(S);return this}var I=this.options;if(I.filter&&!I.filter(o))return this;var q=dl(o,I);return q?(q.feature=fl(o),q.defaultOptions=q.options,this.resetStyle(q),I.onEachFeature&&I.onEachFeature(o,q),this.addLayer(q)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=a({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(u){this._setLayerStyle(u,o)},this)},_setLayerStyle:function(o,u){o.setStyle&&(typeof u=="function"&&(u=u(o.feature)),o.setStyle(u))}});function dl(o,u){var p=o.type==="Feature"?o.geometry:o,b=p?p.coordinates:null,S=[],I=u&&u.pointToLayer,q=u&&u.coordsToLatLng||hu,Q,re,le,_e;if(!b&&!p)return null;switch(p.type){case"Point":return Q=q(b),xg(I,o,Q,u);case"MultiPoint":for(le=0,_e=b.length;le<_e;le++)Q=q(b[le]),S.push(xg(I,o,Q,u));return new Un(S);case"LineString":case"MultiLineString":return re=ul(b,p.type==="LineString"?0:1,q),new Wn(re,u);case"Polygon":case"MultiPolygon":return re=ul(b,p.type==="Polygon"?1:2,q),new La(re,u);case"GeometryCollection":for(le=0,_e=p.geometries.length;le<_e;le++){var Be=dl({geometry:p.geometries[le],type:"Feature",properties:o.properties},u);Be&&S.push(Be)}return new Un(S);case"FeatureCollection":for(le=0,_e=p.features.length;le<_e;le++){var Je=dl(p.features[le],u);Je&&S.push(Je)}return new Un(S);default:throw new Error("Invalid GeoJSON object.")}}function xg(o,u,p,b){return o?o(u,p):new ll(p,b&&b.markersInheritOptions&&b)}function hu(o){return new ie(o[1],o[0],o[2])}function ul(o,u,p){for(var b=[],S=0,I=o.length,q;S<I;S++)q=u?ul(o[S],u-1,p):(p||hu)(o[S]),b.push(q);return b}function fu(o,u){return o=fe(o),o.alt!==void 0?[g(o.lng,u),g(o.lat,u),g(o.alt,u)]:[g(o.lng,u),g(o.lat,u)]}function hl(o,u,p,b){for(var S=[],I=0,q=o.length;I<q;I++)S.push(u?hl(o[I],Jr(o[I])?0:u-1,p,b):fu(o[I],b));return!u&&p&&S.length>0&&S.push(S[0].slice()),S}function Da(o,u){return o.feature?a({},o.feature,{geometry:u}):fl(u)}function fl(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var mu={toGeoJSON:function(o){return Da(this,{type:"Point",coordinates:fu(this.getLatLng(),o)})}};ll.include(mu),uu.include(mu),cl.include(mu),Wn.include({toGeoJSON:function(o){var u=!Jr(this._latlngs),p=hl(this._latlngs,u?1:0,!1,o);return Da(this,{type:(u?"Multi":"")+"LineString",coordinates:p})}}),La.include({toGeoJSON:function(o){var u=!Jr(this._latlngs),p=u&&!Jr(this._latlngs[0]),b=hl(this._latlngs,p?2:u?1:0,!0,o);return u||(b=[b]),Da(this,{type:(p?"Multi":"")+"Polygon",coordinates:b})}}),Ma.include({toMultiPoint:function(o){var u=[];return this.eachLayer(function(p){u.push(p.toGeoJSON(o).geometry.coordinates)}),Da(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(o){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(o);var p=u==="GeometryCollection",b=[];return this.eachLayer(function(S){if(S.toGeoJSON){var I=S.toGeoJSON(o);if(p)b.push(I.geometry);else{var q=fl(I);q.type==="FeatureCollection"?b.push.apply(b,q.features):b.push(q)}}}),p?Da(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function vg(o,u){return new qn(o,u)}var Rk=vg,ml=gn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,u,p){this._url=o,this._bounds=Z(u),_(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ke(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Pt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&Ta(this._image),this},bringToBack:function(){return this._map&&Oa(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=Z(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",u=this._image=o?this._url:it("img");if(Ke(u,"leaflet-image-layer"),this._zoomAnimated&&Ke(u,"leaflet-zoom-animated"),this.options.className&&Ke(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onload=l(this.fire,this,"load"),u.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(o){var u=this._map.getZoomScale(o.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;Us(this._image,p,u)},_reset:function(){var o=this._image,u=new F(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=u.getSize();Bt(o,u.min),o.style.width=p.x+"px",o.style.height=p.y+"px"},_updateOpacity:function(){Xr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),$k=function(o,u,p){return new ml(o,u,p)},yg=ml.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",u=this._image=o?this._url:it("video");if(Ke(u,"leaflet-image-layer"),this._zoomAnimated&&Ke(u,"leaflet-zoom-animated"),this.options.className&&Ke(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onloadeddata=l(this.fire,this,"load"),o){for(var p=u.getElementsByTagName("source"),b=[],S=0;S<p.length;S++)b.push(p[S].src);this._url=p.length>0?b:[u.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var I=0;I<this._url.length;I++){var q=it("source");q.src=this._url[I],u.appendChild(q)}}});function zk(o,u,p){return new yg(o,u,p)}var bg=ml.extend({_initImage:function(){var o=this._image=this._url;Ke(o,"leaflet-image-layer"),this._zoomAnimated&&Ke(o,"leaflet-zoom-animated"),this.options.className&&Ke(o,this.options.className),o.onselectstart=m,o.onmousemove=m}});function Bk(o,u,p){return new bg(o,u,p)}var En=gn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,u){o&&(o instanceof ie||N(o))?(this._latlng=fe(o),_(this,u)):(_(this,o),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&Xr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&Xr(this._container,1),this.bringToFront(),this.options.interactive&&(Ke(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(Xr(this._container,0),this._removeTimeout=setTimeout(l(Pt,void 0,this._container),200)):Pt(this._container),this.options.interactive&&(Dt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=fe(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ta(this._container),this},bringToBack:function(){return this._map&&Oa(this._container),this},_prepareOpen:function(o){var u=this._source;if(!u._map)return!1;if(u instanceof Un){u=null;var p=this._source._layers;for(var b in p)if(p[b]._map){u=p[b];break}if(!u)return!1;this._source=u}if(!o)if(u.getCenter)o=u.getCenter();else if(u.getLatLng)o=u.getLatLng();else if(u.getBounds)o=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")o.innerHTML=u;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),u=J(this.options.offset),p=this._getAnchor();this._zoomAnimated?Bt(this._container,o.add(p)):u=u.add(o).add(p);var b=this._containerBottom=-u.y,S=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=b+"px",this._container.style.left=S+"px"}},_getAnchor:function(){return[0,0]}});st.include({_initOverlay:function(o,u,p,b){var S=u;return S instanceof o||(S=new o(b).setContent(u)),p&&S.setLatLng(p),S}}),gn.include({_initOverlay:function(o,u,p,b){var S=p;return S instanceof o?(_(S,b),S._source=this):(S=u&&!b?u:new o(b,this),S.setContent(p)),S}});var pl=En.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,En.prototype.openOn.call(this,o)},onAdd:function(o){En.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof bs||this._source.on("preclick",qs))},onRemove:function(o){En.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof bs||this._source.off("preclick",qs))},getEvents:function(){var o=En.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",u=this._container=it("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=it("div",o+"-content-wrapper",u);if(this._contentNode=it("div",o+"-content",p),zi(u),nu(this._contentNode),He(u,"contextmenu",qs),this._tipContainer=it("div",o+"-tip-container",u),this._tip=it("div",o+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=it("a",o+"-close-button",u);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',He(b,"click",function(S){ur(S),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,u=o.style;u.width="",u.whiteSpace="nowrap";var p=o.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),u.width=p+1+"px",u.whiteSpace="",u.height="";var b=o.offsetHeight,S=this.options.maxHeight,I="leaflet-popup-scrolled";S&&b>S?(u.height=S+"px",Ke(o,I)):Dt(o,I),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var u=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),p=this._getAnchor();Bt(this._container,u.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,u=parseInt(Li(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+u,b=this._containerWidth,S=new R(this._containerLeft,-p-this._containerBottom);S._add(Ws(this._container));var I=o.layerPointToContainerPoint(S),q=J(this.options.autoPanPadding),Q=J(this.options.autoPanPaddingTopLeft||q),re=J(this.options.autoPanPaddingBottomRight||q),le=o.getSize(),_e=0,Be=0;I.x+b+re.x>le.x&&(_e=I.x+b-le.x+re.x),I.x-_e-Q.x<0&&(_e=I.x-Q.x),I.y+p+re.y>le.y&&(Be=I.y+p-le.y+re.y),I.y-Be-Q.y<0&&(Be=I.y-Q.y),(_e||Be)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([_e,Be]))}},_getAnchor:function(){return J(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Fk=function(o,u){return new pl(o,u)};st.mergeOptions({closePopupOnClick:!0}),st.include({openPopup:function(o,u,p){return this._initOverlay(pl,o,u,p).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),gn.include({bindPopup:function(o,u){return this._popup=this._initOverlay(pl,this._popup,o,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof Un||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){Gs(o);var u=o.layer||o.target;if(this._popup._source===u&&!(u instanceof bs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=u,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var gl=En.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){En.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){En.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=En.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",u=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=it("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var u,p,b=this._map,S=this._container,I=b.latLngToContainerPoint(b.getCenter()),q=b.layerPointToContainerPoint(o),Q=this.options.direction,re=S.offsetWidth,le=S.offsetHeight,_e=J(this.options.offset),Be=this._getAnchor();Q==="top"?(u=re/2,p=le):Q==="bottom"?(u=re/2,p=0):Q==="center"?(u=re/2,p=le/2):Q==="right"?(u=0,p=le/2):Q==="left"?(u=re,p=le/2):q.x<I.x?(Q="right",u=0,p=le/2):(Q="left",u=re+(_e.x+Be.x)*2,p=le/2),o=o.subtract(J(u,p,!0)).add(_e).add(Be),Dt(S,"leaflet-tooltip-right"),Dt(S,"leaflet-tooltip-left"),Dt(S,"leaflet-tooltip-top"),Dt(S,"leaflet-tooltip-bottom"),Ke(S,"leaflet-tooltip-"+Q),Bt(S,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&Xr(this._container,o)},_animateZoom:function(o){var u=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(u)},_getAnchor:function(){return J(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Uk=function(o,u){return new gl(o,u)};st.include({openTooltip:function(o,u,p){return this._initOverlay(gl,o,u,p).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),gn.include({bindTooltip:function(o,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(gl,this._tooltip,o,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var u=o?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[u](p),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof Un||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var u=typeof o.getElement=="function"&&o.getElement();u&&(He(u,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),He(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var u=typeof o.getElement=="function"&&o.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var u=o.latlng,p,b;this._tooltip.options.sticky&&o.originalEvent&&(p=this._map.mouseEventToContainerPoint(o.originalEvent),b=this._map.containerPointToLayerPoint(p),u=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(u)}});var wg=Ia.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var u=o&&o.tagName==="DIV"?o:document.createElement("div"),p=this.options;if(p.html instanceof Element?(rl(u),u.appendChild(p.html)):u.innerHTML=p.html!==!1?p.html:"",p.bgPos){var b=J(p.bgPos);u.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function Wk(o){return new wg(o)}Ia.Default=Ui;var Wi=gn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ke.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){_(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),Pt(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ta(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Oa(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof R?o:new R(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var u=this.getPane().children,p=-o(-1/0,1/0),b=0,S=u.length,I;b<S;b++)I=u[b].style.zIndex,u[b]!==this._container&&I&&(p=o(p,+I));isFinite(p)&&(this.options.zIndex=p+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ke.ielt9){Xr(this._container,this.options.opacity);var o=+new Date,u=!1,p=!1;for(var b in this._tiles){var S=this._tiles[b];if(!(!S.current||!S.loaded)){var I=Math.min(1,(o-S.loaded)/200);Xr(S.el,I),I<1?u=!0:(S.active?p=!0:this._onOpaqueTile(S),S.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),u&&(M(this._fadeFrame),this._fadeFrame=$(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=it("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,u=this.options.maxZoom;if(o!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===o?(this._levels[p].el.style.zIndex=u-Math.abs(o-p),this._onUpdateLevel(p)):(Pt(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var b=this._levels[o],S=this._map;return b||(b=this._levels[o]={},b.el=it("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=u,b.origin=S.project(S.unproject(S.getPixelOrigin()),o).round(),b.zoom=o,this._setZoomTransform(b,S.getCenter(),S.getZoom()),m(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var o,u,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)u=this._tiles[o],u.retain=u.current;for(o in this._tiles)if(u=this._tiles[o],u.current&&!u.active){var b=u.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var u in this._tiles)this._tiles[u].coords.z===o&&this._removeTile(u)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)Pt(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,u,p,b){var S=Math.floor(o/2),I=Math.floor(u/2),q=p-1,Q=new R(+S,+I);Q.z=+q;var re=this._tileCoordsToKey(Q),le=this._tiles[re];return le&&le.active?(le.retain=!0,!0):(le&&le.loaded&&(le.retain=!0),q>b?this._retainParent(S,I,q,b):!1)},_retainChildren:function(o,u,p,b){for(var S=2*o;S<2*o+2;S++)for(var I=2*u;I<2*u+2;I++){var q=new R(S,I);q.z=p+1;var Q=this._tileCoordsToKey(q),re=this._tiles[Q];if(re&&re.active){re.retain=!0;continue}else re&&re.loaded&&(re.retain=!0);p+1<b&&this._retainChildren(S,I,p+1,b)}},_resetView:function(o){var u=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var u=this.options;return u.minNativeZoom!==void 0&&o<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<o?u.maxNativeZoom:o},_setView:function(o,u,p,b){var S=Math.round(u);this.options.maxZoom!==void 0&&S>this.options.maxZoom||this.options.minZoom!==void 0&&S<this.options.minZoom?S=void 0:S=this._clampZoom(S);var I=this.options.updateWhenZooming&&S!==this._tileZoom;(!b||I)&&(this._tileZoom=S,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),S!==void 0&&this._update(o),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(o,u)},_setZoomTransforms:function(o,u){for(var p in this._levels)this._setZoomTransform(this._levels[p],o,u)},_setZoomTransform:function(o,u,p){var b=this._map.getZoomScale(p,o.zoom),S=o.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(u,p)).round();ke.any3d?Us(o.el,S,b):Bt(o.el,S)},_resetGrid:function(){var o=this._map,u=o.options.crs,p=this._tileSize=this.getTileSize(),b=this._tileZoom,S=this._map.getPixelWorldBounds(this._tileZoom);S&&(this._globalTileRange=this._pxBoundsToTileRange(S)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,u.wrapLng[0]],b).x/p.x),Math.ceil(o.project([0,u.wrapLng[1]],b).x/p.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([u.wrapLat[0],0],b).y/p.x),Math.ceil(o.project([u.wrapLat[1],0],b).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var u=this._map,p=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),b=u.getZoomScale(p,this._tileZoom),S=u.project(o,this._tileZoom).floor(),I=u.getSize().divideBy(b*2);return new F(S.subtract(I),S.add(I))},_update:function(o){var u=this._map;if(u){var p=this._clampZoom(u.getZoom());if(o===void 0&&(o=u.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(o),S=this._pxBoundsToTileRange(b),I=S.getCenter(),q=[],Q=this.options.keepBuffer,re=new F(S.getBottomLeft().subtract([Q,-Q]),S.getTopRight().add([Q,-Q]));if(!(isFinite(S.min.x)&&isFinite(S.min.y)&&isFinite(S.max.x)&&isFinite(S.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var le in this._tiles){var _e=this._tiles[le].coords;(_e.z!==this._tileZoom||!re.contains(new R(_e.x,_e.y)))&&(this._tiles[le].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(o,p);return}for(var Be=S.min.y;Be<=S.max.y;Be++)for(var Je=S.min.x;Je<=S.max.x;Je++){var Nr=new R(Je,Be);if(Nr.z=this._tileZoom,!!this._isValidTile(Nr)){var rr=this._tiles[this._tileCoordsToKey(Nr)];rr?rr.current=!0:q.push(Nr)}}if(q.sort(function(Ar,$a){return Ar.distanceTo(I)-$a.distanceTo(I)}),q.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Qr=document.createDocumentFragment();for(Je=0;Je<q.length;Je++)this._addTile(q[Je],Qr);this._level.el.appendChild(Qr)}}}},_isValidTile:function(o){var u=this._map.options.crs;if(!u.infinite){var p=this._globalTileRange;if(!u.wrapLng&&(o.x<p.min.x||o.x>p.max.x)||!u.wrapLat&&(o.y<p.min.y||o.y>p.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(o);return Z(this.options.bounds).overlaps(b)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var u=this._map,p=this.getTileSize(),b=o.scaleBy(p),S=b.add(p),I=u.unproject(b,o.z),q=u.unproject(S,o.z);return[I,q]},_tileCoordsToBounds:function(o){var u=this._tileCoordsToNwSe(o),p=new te(u[0],u[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var u=o.split(":"),p=new R(+u[0],+u[1]);return p.z=+u[2],p},_removeTile:function(o){var u=this._tiles[o];u&&(Pt(u.el),delete this._tiles[o],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){Ke(o,"leaflet-tile");var u=this.getTileSize();o.style.width=u.x+"px",o.style.height=u.y+"px",o.onselectstart=m,o.onmousemove=m,ke.ielt9&&this.options.opacity<1&&Xr(o,this.options.opacity)},_addTile:function(o,u){var p=this._getTilePos(o),b=this._tileCoordsToKey(o),S=this.createTile(this._wrapCoords(o),l(this._tileReady,this,o));this._initTile(S),this.createTile.length<2&&$(l(this._tileReady,this,o,null,S)),Bt(S,p),this._tiles[b]={el:S,coords:o,current:!0},u.appendChild(S),this.fire("tileloadstart",{tile:S,coords:o})},_tileReady:function(o,u,p){u&&this.fire("tileerror",{error:u,tile:p,coords:o});var b=this._tileCoordsToKey(o);p=this._tiles[b],p&&(p.loaded=+new Date,this._map._fadeAnimated?(Xr(p.el,0),M(this._fadeFrame),this._fadeFrame=$(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),u||(Ke(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ke.ielt9||!this._map._fadeAnimated?$(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var u=new R(this._wrapX?h(o.x,this._wrapX):o.x,this._wrapY?h(o.y,this._wrapY):o.y);return u.z=o.z,u},_pxBoundsToTileRange:function(o){var u=this.getTileSize();return new F(o.min.unscaleBy(u).floor(),o.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function qk(o){return new Wi(o)}var Ra=Wi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,u){this._url=o,u=_(this,u),u.detectRetina&&ke.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,u){return this._url===o&&u===void 0&&(u=!0),this._url=o,u||this.redraw(),this},createTile:function(o,u){var p=document.createElement("img");return He(p,"load",l(this._tileOnLoad,this,u,p)),He(p,"error",l(this._tileOnError,this,u,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(o),p},getTileUrl:function(o){var u={r:ke.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-o.y;this.options.tms&&(u.y=p),u["-y"]=p}return k(this._url,a(u,this.options))},_tileOnLoad:function(o,u){ke.ielt9?setTimeout(l(o,this,null,u),0):o(null,u)},_tileOnError:function(o,u,p){var b=this.options.errorTileUrl;b&&u.getAttribute("src")!==b&&(u.src=b),o(p,u)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,u=this.options.maxZoom,p=this.options.zoomReverse,b=this.options.zoomOffset;return p&&(o=u-o),o+b},_getSubdomain:function(o){var u=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var o,u;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(u=this._tiles[o].el,u.onload=m,u.onerror=m,!u.complete)){u.src=O;var p=this._tiles[o].coords;Pt(u),delete this._tiles[o],this.fire("tileabort",{tile:u,coords:p})}},_removeTile:function(o){var u=this._tiles[o];if(u)return u.el.setAttribute("src",O),Wi.prototype._removeTile.call(this,o)},_tileReady:function(o,u,p){if(!(!this._map||p&&p.getAttribute("src")===O))return Wi.prototype._tileReady.call(this,o,u,p)}});function _g(o,u){return new Ra(o,u)}var jg=Ra.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,u){this._url=o;var p=a({},this.defaultWmsParams);for(var b in u)b in this.options||(p[b]=u[b]);u=_(this,u);var S=u.detectRetina&&ke.retina?2:1,I=this.getTileSize();p.width=I.x*S,p.height=I.y*S,this.wmsParams=p},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,Ra.prototype.onAdd.call(this,o)},getTileUrl:function(o){var u=this._tileCoordsToNwSe(o),p=this._crs,b=V(p.project(u[0]),p.project(u[1])),S=b.min,I=b.max,q=(this._wmsVersion>=1.3&&this._crs===pg?[S.y,S.x,I.y,I.x]:[S.x,S.y,I.x,I.y]).join(","),Q=Ra.prototype.getTileUrl.call(this,o);return Q+y(this.wmsParams,Q,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+q},setParams:function(o,u){return a(this.wmsParams,o),u||this.redraw(),this}});function Gk(o,u){return new jg(o,u)}Ra.WMS=jg,_g.wms=Gk;var Gn=gn.extend({options:{padding:.1},initialize:function(o){_(this,o),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ke(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,u){var p=this._map.getZoomScale(u,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),S=this._map.project(this._center,u),I=b.multiplyBy(-p).add(S).subtract(this._map._getNewPixelOrigin(o,u));ke.any3d?Us(this._container,I,p):Bt(this._container,I)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,u=this._map.getSize(),p=this._map.containerPointToLayerPoint(u.multiplyBy(-o)).round();this._bounds=new F(p,p.add(u.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ng=Gn.extend({options:{tolerance:0},getEvents:function(){var o=Gn.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Gn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");He(o,"mousemove",this._onMouseMove,this),He(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),He(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){M(this._redrawRequest),delete this._ctx,Pt(this._container),gt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var u in this._layers)o=this._layers[u],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Gn.prototype._update.call(this);var o=this._bounds,u=this._container,p=o.getSize(),b=ke.retina?2:1;Bt(u,o.min),u.width=b*p.x,u.height=b*p.y,u.style.width=p.x+"px",u.style.height=p.y+"px",ke.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){Gn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[d(o)]=o;var u=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var u=o._order,p=u.next,b=u.prev;p?p.prev=b:this._drawLast=b,b?b.next=p:this._drawFirst=p,delete o._order,delete this._layers[d(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var u=o.options.dashArray.split(/[, ]+/),p=[],b,S;for(S=0;S<u.length;S++){if(b=Number(u[S]),isNaN(b))return;p.push(b)}o.options._dashArray=p}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||$(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var u=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new F,this._redrawBounds.extend(o._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(o._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var u=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,u=this._redrawBounds;if(this._ctx.save(),u){var p=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)o=b.layer,(!u||o._pxBounds&&o._pxBounds.intersects(u))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,u){if(this._drawing){var p,b,S,I,q=o._parts,Q=q.length,re=this._ctx;if(Q){for(re.beginPath(),p=0;p<Q;p++){for(b=0,S=q[p].length;b<S;b++)I=q[p][b],re[b?"lineTo":"moveTo"](I.x,I.y);u&&re.closePath()}this._fillStroke(re,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var u=o._point,p=this._ctx,b=Math.max(Math.round(o._radius),1),S=(Math.max(Math.round(o._radiusY),1)||b)/b;S!==1&&(p.save(),p.scale(1,S)),p.beginPath(),p.arc(u.x,u.y/S,b,0,Math.PI*2,!1),S!==1&&p.restore(),this._fillStroke(p,o)}},_fillStroke:function(o,u){var p=u.options;p.fill&&(o.globalAlpha=p.fillOpacity,o.fillStyle=p.fillColor||p.color,o.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(o.setLineDash&&o.setLineDash(u.options&&u.options._dashArray||[]),o.globalAlpha=p.opacity,o.lineWidth=p.weight,o.strokeStyle=p.color,o.lineCap=p.lineCap,o.lineJoin=p.lineJoin,o.stroke())},_onClick:function(o){for(var u=this._map.mouseEventToLayerPoint(o),p,b,S=this._drawFirst;S;S=S.next)p=S.layer,p.options.interactive&&p._containsPoint(u)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(p))&&(b=p);this._fireEvent(b?[b]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,u)}},_handleMouseOut:function(o){var u=this._hoveredLayer;u&&(Dt(this._container,"leaflet-interactive"),this._fireEvent([u],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,u){if(!this._mouseHoverThrottled){for(var p,b,S=this._drawFirst;S;S=S.next)p=S.layer,p.options.interactive&&p._containsPoint(u)&&(b=p);b!==this._hoveredLayer&&(this._handleMouseOut(o),b&&(Ke(this._container,"leaflet-interactive"),this._fireEvent([b],o,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,u,p){this._map._fireDOMEvent(u,p||u.type,o)},_bringToFront:function(o){var u=o._order;if(u){var p=u.next,b=u.prev;if(p)p.prev=b;else return;b?b.next=p:p&&(this._drawFirst=p),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(o)}},_bringToBack:function(o){var u=o._order;if(u){var p=u.next,b=u.prev;if(b)b.next=p;else return;p?p.prev=b:b&&(this._drawLast=b),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(o)}}});function kg(o){return ke.canvas?new Ng(o):null}var qi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Hk={_initContainer:function(){this._container=it("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Gn.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var u=o._container=qi("shape");Ke(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",o._path=qi("path"),u.appendChild(o._path),this._updateStyle(o),this._layers[d(o)]=o},_addPath:function(o){var u=o._container;this._container.appendChild(u),o.options.interactive&&o.addInteractiveTarget(u)},_removePath:function(o){var u=o._container;Pt(u),o.removeInteractiveTarget(u),delete this._layers[d(o)]},_updateStyle:function(o){var u=o._stroke,p=o._fill,b=o.options,S=o._container;S.stroked=!!b.stroke,S.filled=!!b.fill,b.stroke?(u||(u=o._stroke=qi("stroke")),S.appendChild(u),u.weight=b.weight+"px",u.color=b.color,u.opacity=b.opacity,b.dashArray?u.dashStyle=N(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=b.lineCap.replace("butt","flat"),u.joinstyle=b.lineJoin):u&&(S.removeChild(u),o._stroke=null),b.fill?(p||(p=o._fill=qi("fill")),S.appendChild(p),p.color=b.fillColor||b.color,p.opacity=b.fillOpacity):p&&(S.removeChild(p),o._fill=null)},_updateCircle:function(o){var u=o._point.round(),p=Math.round(o._radius),b=Math.round(o._radiusY||p);this._setPath(o,o._empty()?"M0 0":"AL "+u.x+","+u.y+" "+p+","+b+" 0,"+65535*360)},_setPath:function(o,u){o._path.v=u},_bringToFront:function(o){Ta(o._container)},_bringToBack:function(o){Oa(o._container)}},xl=ke.vml?qi:$e,Gi=Gn.extend({_initContainer:function(){this._container=xl("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=xl("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Pt(this._container),gt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Gn.prototype._update.call(this);var o=this._bounds,u=o.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,p.setAttribute("width",u.x),p.setAttribute("height",u.y)),Bt(p,o.min),p.setAttribute("viewBox",[o.min.x,o.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(o){var u=o._path=xl("path");o.options.className&&Ke(u,o.options.className),o.options.interactive&&Ke(u,"leaflet-interactive"),this._updateStyle(o),this._layers[d(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){Pt(o._path),o.removeInteractiveTarget(o._path),delete this._layers[d(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var u=o._path,p=o.options;u&&(p.stroke?(u.setAttribute("stroke",p.color),u.setAttribute("stroke-opacity",p.opacity),u.setAttribute("stroke-width",p.weight),u.setAttribute("stroke-linecap",p.lineCap),u.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?u.setAttribute("stroke-dasharray",p.dashArray):u.removeAttribute("stroke-dasharray"),p.dashOffset?u.setAttribute("stroke-dashoffset",p.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),p.fill?(u.setAttribute("fill",p.fillColor||p.color),u.setAttribute("fill-opacity",p.fillOpacity),u.setAttribute("fill-rule",p.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(o,u){this._setPath(o,Ne(o._parts,u))},_updateCircle:function(o){var u=o._point,p=Math.max(Math.round(o._radius),1),b=Math.max(Math.round(o._radiusY),1)||p,S="a"+p+","+b+" 0 1,0 ",I=o._empty()?"M0 0":"M"+(u.x-p)+","+u.y+S+p*2+",0 "+S+-p*2+",0 ";this._setPath(o,I)},_setPath:function(o,u){o._path.setAttribute("d",u)},_bringToFront:function(o){Ta(o._path)},_bringToBack:function(o){Oa(o._path)}});ke.vml&&Gi.include(Hk);function Sg(o){return ke.svg||ke.vml?new Gi(o):null}st.include({getRenderer:function(o){var u=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var u=this._paneRenderers[o];return u===void 0&&(u=this._createRenderer({pane:o}),this._paneRenderers[o]=u),u},_createRenderer:function(o){return this.options.preferCanvas&&kg(o)||Sg(o)}});var Eg=La.extend({initialize:function(o,u){La.prototype.initialize.call(this,this._boundsToLatLngs(o),u)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=Z(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function Vk(o,u){return new Eg(o,u)}Gi.create=xl,Gi.pointsToPath=Ne,qn.geometryToLayer=dl,qn.coordsToLatLng=hu,qn.coordsToLatLngs=ul,qn.latLngToCoords=fu,qn.latLngsToCoords=hl,qn.getFeature=Da,qn.asFeature=fl,st.mergeOptions({boxZoom:!0});var Cg=Sn.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){He(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){gt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Pt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Di(),Zd(),this._startPoint=this._map.mouseEventToContainerPoint(o),He(document,{contextmenu:Gs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=it("div","leaflet-zoom-box",this._container),Ke(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var u=new F(this._point,this._startPoint),p=u.getSize();Bt(this._box,u.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(Pt(this._box),Dt(this._container,"leaflet-crosshair")),Ri(),Yd(),gt(document,{contextmenu:Gs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var u=new te(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});st.addInitHook("addHandler","boxZoom",Cg),st.mergeOptions({doubleClickZoom:!0});var Pg=Sn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var u=this._map,p=u.getZoom(),b=u.options.zoomDelta,S=o.originalEvent.shiftKey?p-b:p+b;u.options.doubleClickZoom==="center"?u.setZoom(S):u.setZoomAround(o.containerPoint,S)}});st.addInitHook("addHandler","doubleClickZoom",Pg),st.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ag=Sn.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new ys(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}Ke(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Dt(this._map._container,"leaflet-grab"),Dt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=Z(this._map.options.maxBounds);this._offsetLimit=V(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var u=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(u),this._prunePositions(u)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,u){return o-(o-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;o.x<u.min.x&&(o.x=this._viscousLimit(o.x,u.min.x)),o.y<u.min.y&&(o.y=this._viscousLimit(o.y,u.min.y)),o.x>u.max.x&&(o.x=this._viscousLimit(o.x,u.max.x)),o.y>u.max.y&&(o.y=this._viscousLimit(o.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,u=Math.round(o/2),p=this._initialWorldOffset,b=this._draggable._newPos.x,S=(b-u+p)%o+u-p,I=(b+u+p)%o-u-p,q=Math.abs(S+p)<Math.abs(I+p)?S:I;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=q},_onDragEnd:function(o){var u=this._map,p=u.options,b=!p.inertia||o.noInertia||this._times.length<2;if(u.fire("dragend",o),b)u.fire("moveend");else{this._prunePositions(+new Date);var S=this._lastPos.subtract(this._positions[0]),I=(this._lastTime-this._times[0])/1e3,q=p.easeLinearity,Q=S.multiplyBy(q/I),re=Q.distanceTo([0,0]),le=Math.min(p.inertiaMaxSpeed,re),_e=Q.multiplyBy(le/re),Be=le/(p.inertiaDeceleration*q),Je=_e.multiplyBy(-Be/2).round();!Je.x&&!Je.y?u.fire("moveend"):(Je=u._limitOffset(Je,u.options.maxBounds),$(function(){u.panBy(Je,{duration:Be,easeLinearity:q,noMoveStart:!0,animate:!0})}))}}});st.addInitHook("addHandler","dragging",Ag),st.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Tg=Sn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),He(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),gt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,u=document.documentElement,p=o.scrollTop||u.scrollTop,b=o.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(b,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var u=this._panKeys={},p=this.keyCodes,b,S;for(b=0,S=p.left.length;b<S;b++)u[p.left[b]]=[-1*o,0];for(b=0,S=p.right.length;b<S;b++)u[p.right[b]]=[o,0];for(b=0,S=p.down.length;b<S;b++)u[p.down[b]]=[0,o];for(b=0,S=p.up.length;b<S;b++)u[p.up[b]]=[0,-1*o]},_setZoomDelta:function(o){var u=this._zoomKeys={},p=this.keyCodes,b,S;for(b=0,S=p.zoomIn.length;b<S;b++)u[p.zoomIn[b]]=o;for(b=0,S=p.zoomOut.length;b<S;b++)u[p.zoomOut[b]]=-o},_addHooks:function(){He(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){gt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var u=o.keyCode,p=this._map,b;if(u in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(b=this._panKeys[u],o.shiftKey&&(b=J(b).multiplyBy(3)),p.options.maxBounds&&(b=p._limitOffset(J(b),p.options.maxBounds)),p.options.worldCopyJump){var S=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(b)));p.panTo(S)}else p.panBy(b)}else if(u in this._zoomKeys)p.setZoom(p.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Gs(o)}}});st.addInitHook("addHandler","keyboard",Tg),st.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Og=Sn.extend({addHooks:function(){He(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){gt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var u=rg(o),p=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var b=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),b),Gs(o)},_performZoom:function(){var o=this._map,u=o.getZoom(),p=this._map.options.zoomSnap||0;o._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),S=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,I=p?Math.ceil(S/p)*p:S,q=o._limitZoom(u+(this._delta>0?I:-I))-u;this._delta=0,this._startTime=null,q&&(o.options.scrollWheelZoom==="center"?o.setZoom(u+q):o.setZoomAround(this._lastMousePos,u+q))}});st.addInitHook("addHandler","scrollWheelZoom",Og);var Kk=600;st.mergeOptions({tapHold:ke.touchNative&&ke.safari&&ke.mobile,tapTolerance:15});var Mg=Sn.extend({addHooks:function(){He(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){gt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var u=o.touches[0];this._startPos=this._newPos=new R(u.clientX,u.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(He(document,"touchend",ur),He(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),Kk),He(document,"touchend touchcancel contextmenu",this._cancel,this),He(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){gt(document,"touchend",ur),gt(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),gt(document,"touchend touchcancel contextmenu",this._cancel,this),gt(document,"touchmove",this._onMove,this)},_onMove:function(o){var u=o.touches[0];this._newPos=new R(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,u){var p=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});p._simulated=!0,u.target.dispatchEvent(p)}});st.addInitHook("addHandler","tapHold",Mg),st.mergeOptions({touchZoom:ke.touch,bounceAtZoomLimits:!0});var Ig=Sn.extend({addHooks:function(){Ke(this._map._container,"leaflet-touch-zoom"),He(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Dt(this._map._container,"leaflet-touch-zoom"),gt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var u=this._map;if(!(!o.touches||o.touches.length!==2||u._animatingZoom||this._zooming)){var p=u.mouseEventToContainerPoint(o.touches[0]),b=u.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(p.add(b)._divideBy(2))),this._startDist=p.distanceTo(b),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),He(document,"touchmove",this._onTouchMove,this),He(document,"touchend touchcancel",this._onTouchEnd,this),ur(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var u=this._map,p=u.mouseEventToContainerPoint(o.touches[0]),b=u.mouseEventToContainerPoint(o.touches[1]),S=p.distanceTo(b)/this._startDist;if(this._zoom=u.getScaleZoom(S,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&S<1||this._zoom>u.getMaxZoom()&&S>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,S===1)return}else{var I=p._add(b)._divideBy(2)._subtract(this._centerPoint);if(S===1&&I.x===0&&I.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(I),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),M(this._animRequest);var q=l(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=$(q,this,!0),ur(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,M(this._animRequest),gt(document,"touchmove",this._onTouchMove,this),gt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});st.addInitHook("addHandler","touchZoom",Ig),st.BoxZoom=Cg,st.DoubleClickZoom=Pg,st.Drag=Ag,st.Keyboard=Tg,st.ScrollWheelZoom=Og,st.TapHold=Mg,st.TouchZoom=Ig,r.Bounds=F,r.Browser=ke,r.CRS=be,r.Canvas=Ng,r.Circle=uu,r.CircleMarker=cl,r.Class=K,r.Control=pn,r.DivIcon=wg,r.DivOverlay=En,r.DomEvent=hk,r.DomUtil=dk,r.Draggable=ys,r.Evented=Y,r.FeatureGroup=Un,r.GeoJSON=qn,r.GridLayer=Wi,r.Handler=Sn,r.Icon=Ia,r.ImageOverlay=ml,r.LatLng=ie,r.LatLngBounds=te,r.Layer=gn,r.LayerGroup=Ma,r.LineUtil=kk,r.Map=st,r.Marker=ll,r.Mixin=yk,r.Path=bs,r.Point=R,r.PolyUtil=bk,r.Polygon=La,r.Polyline=Wn,r.Popup=pl,r.PosAnimation=ng,r.Projection=Sk,r.Rectangle=Eg,r.Renderer=Gn,r.SVG=Gi,r.SVGOverlay=bg,r.TileLayer=Ra,r.Tooltip=gl,r.Transformation=ce,r.Util=z,r.VideoOverlay=yg,r.bind=l,r.bounds=V,r.canvas=kg,r.circle=Ik,r.circleMarker=Mk,r.control=Bi,r.divIcon=Wk,r.extend=a,r.featureGroup=Ak,r.geoJSON=vg,r.geoJson=Rk,r.gridLayer=qk,r.icon=Tk,r.imageOverlay=$k,r.latLng=fe,r.latLngBounds=Z,r.layerGroup=Pk,r.map=fk,r.marker=Ok,r.point=J,r.polygon=Dk,r.polyline=Lk,r.popup=Fk,r.rectangle=Vk,r.setOptions=_,r.stamp=d,r.svg=Sg,r.svgOverlay=Bk,r.tileLayer=_g,r.tooltip=Uk,r.transformation=ne,r.version=s,r.videoOverlay=zk;var Zk=window.L;r.noConflict=function(){return window.L=Zk,this},window.L=r})})(Nf,Nf.exports);var ss=Nf.exports;const Tn=zn(ss);function Wd(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function Vp(e,t){return t==null?function(s,a){const i=x.useRef();return i.current||(i.current=e(s,a)),i}:function(s,a){const i=x.useRef();i.current||(i.current=e(s,a));const l=x.useRef(s),{instance:c}=i.current;return x.useEffect(function(){l.current!==s&&(t(c,s,l.current),l.current=s)},[c,s,a]),i}}function DU(e,t){x.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var i;(i=t.layerContainer)==null||i.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function U1(e){return function(r){const s=Gp(),a=e(Hp(r,s),s);return R1(s.map,r.attribution),F1(a.current,r.eventHandlers),DU(a.current,s),a}}function W1(e,t){const r=Vp(e,t),s=U1(r);return OU(s)}function RU(e,t){const r=Vp(e),s=LU(r,t);return MU(s)}function $U(e,t){const r=Vp(e,t),s=U1(r);return IU(s)}function zU(e,t,r){const{opacity:s,zIndex:a}=t;s!=null&&s!==r.opacity&&e.setOpacity(s),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function BU(e,t,r){t.bounds instanceof ss.LatLngBounds&&t.bounds!==r.bounds&&e.setBounds(t.bounds),t.opacity!=null&&t.opacity!==r.opacity&&e.setOpacity(t.opacity),t.zIndex!=null&&t.zIndex!==r.zIndex&&e.setZIndex(t.zIndex)}function FU(){return Gp().map}const UU=W1(function({bounds:t,url:r,...s},a){const i=new ss.ImageOverlay(r,t,s);return Wd(i,$1(a,{overlayContainer:i}))},function(t,r,s){if(BU(t,r,s),r.bounds!==s.bounds){const a=r.bounds instanceof ss.LatLngBounds?r.bounds:new ss.LatLngBounds(r.bounds);t.setBounds(a)}r.url!==s.url&&t.setUrl(r.url)});function kf(){return kf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},kf.apply(this,arguments)}function WU({bounds:e,boundsOptions:t,center:r,children:s,className:a,id:i,placeholder:l,style:c,whenReady:d,zoom:f,...h},m){const[g]=x.useState({className:a,id:i,style:c}),[v,j]=x.useState(null);x.useImperativeHandle(m,()=>(v==null?void 0:v.map)??null,[v]);const _=x.useCallback(w=>{if(w!==null&&v===null){const k=new ss.Map(w,h);r!=null&&f!=null?k.setView(r,f):e!=null&&k.fitBounds(e,t),d!=null&&k.whenReady(d),j(TU(k))}},[]);x.useEffect(()=>()=>{v==null||v.map.remove()},[v]);const y=v?at.createElement(B1,{value:v},s):l??null;return at.createElement("div",kf({},g,{ref:_}),y)}const cy=x.forwardRef(WU),qU=W1(function({position:t,...r},s){const a=new ss.Marker(t,r);return Wd(a,$1(s,{overlayContainer:a}))},function(t,r,s){r.position!==s.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==s.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==s.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==s.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),GU=RU(function(t,r){const s=new ss.Popup(t,r.overlayContainer);return Wd(s,r)},function(t,r,{position:s},a){x.useEffect(function(){const{instance:l}=t;function c(f){f.popup===l&&(l.update(),a(!0))}function d(f){f.popup===l&&a(!1)}return r.map.on({popupopen:c,popupclose:d}),r.overlayContainer==null?(s!=null&&l.setLatLng(s),l.openOn(r.map)):r.overlayContainer.bindPopup(l),function(){var h;r.map.off({popupopen:c,popupclose:d}),(h=r.overlayContainer)==null||h.unbindPopup(),r.map.removeLayer(l)}},[t,r,a,s])}),HU=$U(function({url:t,...r},s){const a=new ss.TileLayer(t,Hp(r,s));return Wd(a,s)},function(t,r,s){zU(t,r,s);const{url:a}=r;a!=null&&a!==s.url&&t.setUrl(a)});function VU(e){const t=e.filter(l=>{const c=l.latitude??l.lat,d=l.longitude??l.lon;return typeof c=="number"&&typeof d=="number"}).map(l=>{const c=l.latitude??l.lat,d=l.longitude??l.lon;return[c,d]});if(!t.length)return null;const r=Tn.latLngBounds(t),s=.001,a=r.getCenter();if(Math.max(r.getNorth()-r.getSouth(),r.getEast()-r.getWest())<s){const l=s/2;return Tn.latLngBounds([[a.lat-l,a.lng-l],[a.lat+l,a.lng+l]])}return r}function KU(e,t){const r=e.filter(j=>typeof j.x=="number"&&typeof j.y=="number");if(!r.length)return null;const s=r.map(j=>j.x),a=r.map(j=>j.y);let i=Math.min(...s),l=Math.max(...s),c=Math.min(...a),d=Math.max(...a);const f=50,h=(i+l)/2,m=(c+d)/2,g=l-i,v=d-c;if(g<f){const j=f/2;i=h-j,l=h+j}if(v<f){const j=f/2;c=m-j,d=m+j}return t&&(i=Math.max(0,i),l=Math.min(t.width,l),c=Math.max(0,c),d=Math.min(t.height,d)),[[c,i],[d,l]]}delete Tn.Icon.Default.prototype._getIconUrl;Tn.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function dy({bounds:e,padding:t,minZoom:r,maxZoom:s}){const a=FU();return x.useEffect(()=>{if(e)try{const i=a.getBoundsZoom(e,!1),l=Math.min(Math.max(i,r),s);a.fitBounds(e,{padding:Tn.point(t[0],t[1]),maxZoom:l})}catch(i){console.warn("Failed to fit bounds:",i);const l=e&&Array.isArray(e)&&e.length>0?e[0]:null;l&&Array.isArray(l)&&a.setView(l,Math.max(r,10))}},[a,e,t,r,s]),null}function uy({gate:e,position:t,customIcon:r,onGateClick:s}){const a=()=>{if(r)return r;const i=e.status||"active",l=e.health_score||100;let c="#10B981";return i==="inactive"?c="#6B7280":i==="maintenance"?c="#F59E0B":l<70?c="#EF4444":l<90&&(c="#F97316"),new Tn.DivIcon({html:`
        <div style="
          background-color: ${c};
          width: 32px;
          height: 32px;
          border-radius: 50%;
          border: 4px solid white;
          box-shadow: 0 4px 8px rgba(0,0,0,0.3);
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
        ">
          <svg width="16" height="16" fill="white" viewBox="0 0 24 24">
            <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
        </div>
      `,className:"custom-gate-marker",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]})};return n.jsx(qU,{position:t,icon:a(),eventHandlers:{click:()=>s==null?void 0:s(e)},children:n.jsx(GU,{children:n.jsxs("div",{className:"p-2 min-w-[200px]",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:e.name||e.id}),n.jsxs("div",{className:"space-y-1 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Status:"}),n.jsx("span",{className:`font-medium ${e.status==="active"?"text-green-600":e.status==="maintenance"?"text-yellow-600":"text-gray-600"}`,children:e.status||"Active"})]}),e.health_score!==void 0&&n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Health:"}),n.jsxs("span",{className:"font-medium",children:[e.health_score,"%"]})]}),e.checkin_count!==void 0&&n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Check-ins:"}),n.jsx("span",{className:"font-medium",children:e.checkin_count})]}),n.jsxs("div",{className:"pt-2 border-t text-xs text-gray-500",children:["ID: ",e.id]})]})]})})})}function ZU({onZoomToFit:e,gateCount:t,isImageMode:r}){return n.jsxs("div",{className:"absolute top-4 right-4 z-[1000] space-y-2",children:[n.jsx("div",{className:"bg-white rounded-lg shadow-lg p-2",children:n.jsxs("button",{onClick:s=>{const a=s.target;a.style.backgroundColor="lightblue",setTimeout(()=>{a.style.backgroundColor=""},200),e()},className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded",title:"Zoom to fit all gates",children:[n.jsx(hP,{size:16}),n.jsxs("span",{children:["Fit All (",t,")"]})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-3 text-xs",children:[n.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[n.jsx(cn,{size:14,className:"text-blue-500"}),n.jsxs("span",{className:"font-medium",children:[t," Gates"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(XC,{size:14,className:"text-gray-500"}),n.jsx("span",{className:"text-gray-600",children:r?"Image Mode":"Geographic"})]})]})]})}function q1({gates:e,backgroundImage:t=null,fitPadding:r=[80,40],minZoom:s=1,maxZoom:a=18,onGateClick:i,style:l,showControls:c=!0,customIcon:d}){const[f,h]=x.useState(null),m=!!t,g=m?[t.height/2,t.width/2]:[0,0],v=Math.max(s,3),j=e||[];let _=null,y=null;try{_=!m&&j.length>0?VU(j):null,y=m&&j.length>0&&t?KU(j,t):null}catch(O){console.warn("Error computing bounds:",O),_=null,y=null}const w=j.map(O=>{if(m&&typeof O.x=="number"&&typeof O.y=="number")return{id:O.id,pos:[O.y,O.x],gate:O};const T=O.latitude??O.lat,A=O.longitude??O.lon;return!m&&typeof T=="number"&&typeof A=="number"?{id:O.id,pos:[T,A],gate:O}:null}).filter(Boolean),k=m?{crs:Tn.CRS.Simple,center:g,zoom:v,minZoom:s,maxZoom:a,scrollWheelZoom:!0,zoomControl:!1}:{center:w.length>0?w[0].pos:[.35,32.6],zoom:w.length>0?15:v,minZoom:s,maxZoom:a,scrollWheelZoom:!0,zoomControl:!1},N={width:"100%",height:"100%",minHeight:400,position:"relative",...l},P=x.useCallback(()=>{if(f&&w.length!==0)try{const T=new Tn.FeatureGroup(w.map(A=>Tn.marker(A.pos))).getBounds();T.isValid()?f.fitBounds(T,{padding:Tn.point(r[0],r[1]),maxZoom:16}):f.setView(w[0].pos,15)}catch(O){console.warn("Failed to zoom to fit:",O),w.length>0&&f.setView(w[0].pos,15)}},[f,w,r]);return x.useEffect(()=>{if(f&&w.length>0){const O=setTimeout(()=>{P()},100);return()=>clearTimeout(O)}},[f,w.length]),j.length===0?n.jsx("div",{style:N,className:"flex items-center justify-center bg-gray-50 rounded-lg",children:n.jsxs("div",{className:"text-center",children:[n.jsx(cn,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Gates Available"}),n.jsx("p",{className:"text-gray-500",children:"Add gates with coordinates to see them on the map."})]})}):w.length===0?n.jsx("div",{style:N,className:"flex items-center justify-center bg-gray-50 rounded-lg",children:n.jsxs("div",{className:"text-center",children:[n.jsx(QC,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Coordinates Available"}),n.jsxs("p",{className:"text-gray-500",children:["Gates don't have ",m?"x/y pixel":"latitude/longitude"," coordinates yet."]})]})}):n.jsxs("div",{style:N,children:[m?n.jsxs(cy,{...k,style:{width:"100%",height:"100%"},ref:h,children:[n.jsx(UU,{url:t.url,bounds:[[0,0],[t.height,t.width]],interactive:!1}),n.jsx(dy,{bounds:y,padding:r,minZoom:s,maxZoom:a}),w.map(O=>n.jsx(uy,{gate:O.gate,position:O.pos,customIcon:d,onGateClick:i},O.id))]}):n.jsxs(cy,{...k,style:{width:"100%",height:"100%"},ref:h,children:[n.jsx(HU,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),n.jsx(dy,{bounds:_,padding:r,minZoom:s,maxZoom:a}),w.map(O=>n.jsx(uy,{gate:O.gate,position:O.pos,customIcon:d,onGateClick:i},O.id))]}),c&&n.jsx(ZU,{onZoomToFit:P,gateCount:w.length,isImageMode:m})]})}const YU=()=>{var Ca,Bs;const{id:e}=ja(),[t,r]=x.useState(null),[s,a]=x.useState({totalWristbands:0,checkedIn:0,categories:[]}),[i,l]=x.useState([]),[c,d]=x.useState(!0),[f,h]=x.useState("overview"),[m,g]=x.useState(!1),[v,j]=x.useState(!1),[_,y]=x.useState([]),[w,k]=x.useState([]),[N,P]=x.useState(92),[O,T]=x.useState(98),[A,C]=x.useState([]),[E,D]=x.useState({total:0,active:0,avgHealth:0,pendingApproval:0}),[$,M]=x.useState("list"),[z,K]=x.useState(null),[W,U]=x.useState(!1),[Y,R]=x.useState(!1),H=x.useRef(null),J=x.useRef(null),F=x.useRef(null),V=x.useRef(null),te=x.useRef(null),[Z,ie]=x.useState([]),[fe,be]=x.useState(!1),[xe,oe]=x.useState(""),[de,ce]=x.useState("all"),[ne,Oe]=x.useState(!1),[Ce,$e]=x.useState(null),[Ne,G]=x.useState("created_at"),[se,ue]=x.useState("desc"),[he,me]=x.useState({ticket_number:"",holder_name:"",holder_email:"",ticket_category:""}),[,Me]=x.useState(null);x.useEffect(()=>{e&&(ut(e),Qe(e))},[e]);const Qe=async X=>{be(!0);try{const{data:we,error:Ie}=await B.from("tickets").select(`
          *,
          event:events(id, name),
          wristband:wristbands!tickets_linked_wristband_id_fkey(id, nfc_id, category)
        `).eq("event_id",X).order(Ne,{ascending:se==="asc"});if(Ie)throw Ie;ie(we||[])}catch(we){console.error("Error fetching tickets:",we)}finally{be(!1)}},Xe=X=>{Ne===X?ue(se==="asc"?"desc":"asc"):(G(X),ue("asc"))};x.useEffect(()=>{e&&Qe(e)},[Ne,se]);const ut=async X=>{d(!0);try{const{data:we,error:Ie}=await B.from("events").select("*").eq("id",X).single();if(Ie)throw Ie;r(we);const{data:Fe,error:ze}=await B.from("wristbands").select("id, category, is_active").eq("event_id",X);if(ze)throw ze;const{data:qe,error:pt}=await B.from("checkin_logs").select("wristband_id").eq("event_id",X);if(pt)throw pt;const rt=(Fe==null?void 0:Fe.length)||0,Ue=(qe==null?void 0:qe.length)||0,Ct=new Map;Fe==null||Fe.forEach(ke=>{const mn=ke.category||"Uncategorized",Bn=Ct.get(mn)||{total:0,checkedIn:0};Bn.total++,qe!=null&&qe.some(Pa=>Pa.wristband_id===ke.id)&&Bn.checkedIn++,Ct.set(mn,Bn)});const vr=Array.from(Ct.entries()).map(([ke,mn])=>({name:ke,total:mn.total,checkedIn:mn.checkedIn}));a({totalWristbands:rt,checkedIn:Ue,categories:vr});const{data:yr,error:Kt}=await B.from("event_access").select(`
          id,
          user_id,
          event_id,
          access_level,
          granted_by,
          created_at,
          is_active
        `).eq("event_id",X);if(Kt)throw Kt;const jt=await bP(B,yr||[]);l(jt),await Promise.all([tt(X),ae(X),Te(X),We(X)])}catch(we){console.error("Error fetching event details:",we);const Ie=we instanceof Error?we.message:"Failed to load event details";Me(Ie)}finally{d(!1)}},tt=async X=>{try{const{data:we,error:Ie}=await B.from("checkin_logs").select(`
          id,
          timestamp,
          wristband_id,
          gate_id,
          wristbands!inner(nfc_id, category)
        `).eq("event_id",X).order("timestamp",{ascending:!1}).limit(10);if(Ie)throw Ie;const Fe=(we==null?void 0:we.map(ze=>{const qe=Array.isArray(ze.wristbands)?ze.wristbands[0]:ze.wristbands;return{id:ze.id,type:"checkin",message:`${(qe==null?void 0:qe.nfc_id)||"Unknown Wristband"} checked in${ze.gate_id?` at Gate ${ze.gate_id.slice(-4)}`:""}`,category:(qe==null?void 0:qe.category)||"Unknown",timestamp:ze.timestamp,timeAgo:dr(new Date(ze.timestamp))}}))||[];y(Fe)}catch(we){console.error("Error fetching recent activity:",we),y([])}},ae=async X=>{try{const{data:we,error:Ie}=await B.from("system_alerts").select("*").eq("event_id",X).eq("resolved",!1).order("created_at",{ascending:!1});if(Ie)throw Ie;k(we||[])}catch(we){console.error("Error fetching system alerts:",we),k([])}},Te=async X=>{try{const{data:we,error:Ie}=await B.from("gates").select("health_score, status").eq("event_id",X);if(Ie)throw Ie;if(we&&we.length>0){const qe=we.filter(rt=>rt.status==="active"),pt=qe.reduce((rt,Ue)=>rt+(Ue.health_score||100),0)/qe.length;P(Math.round(pt))}const{data:Fe,error:ze}=await B.from("fraud_detections").select("severity").eq("event_id",X);if(!ze&&Fe){const qe=Fe.filter(rt=>rt.severity==="critical").length,pt=Math.max(70,100-qe*5);T(pt)}}catch(we){console.error("Error fetching gate metrics:",we)}},We=async X=>{try{try{const{data:rt,error:Ue}=await B.rpc("execute_complete_gate_pipeline_v2",{p_event_id:X});if(!Ue&&rt){C(rt.gates||[]),D(rt.stats||{total:0,active:0,avgHealth:100,pendingApproval:0});return}}catch(rt){console.warn("Gate Discovery v2 pipeline not available, falling back to direct query:",rt)}const{data:we,error:Ie}=await B.from("gates").select(`
          id,
          name,
          location_lat as latitude,
          location_lng as longitude,
          status,
          created_at,
          location_description
        `).eq("event_id",X).order("created_at",{ascending:!1});if(Ie)throw Ie;if(!we||we.length===0){C([]),D({total:0,active:0,avgHealth:100,pendingApproval:0});return}const Fe=await Promise.all(we.map(async rt=>{const{count:Ue,error:Ct}=await B.from("checkin_logs").select("*",{count:"exact",head:!0}).eq("gate_id",rt.id);return Ct?(console.error("Error counting check-ins for gate:",rt.id,Ct),{...rt,checkin_count:0}):{...rt,checkin_count:Ue||0}})),ze=Fe.filter(rt=>rt.checkin_count>0);C(Fe);const qe=Fe.filter(rt=>rt.status==="active"),pt=ze.length>0?ze.reduce((rt,Ue)=>rt+(Ue.health_score||100),0)/ze.length:100;D({total:ze.length,active:qe.length,avgHealth:Math.round(pt),pendingApproval:0})}catch(we){console.error("Error fetching gates:",we),C([]),D({total:0,active:0,avgHealth:100,pendingApproval:0})}},tr=async()=>{if(t!=null&&t.id)try{const X=new Map;A.forEach(Fe=>{const ze=`${Fe.name}_${Math.round(Fe.latitude*1e3)}_${Math.round(Fe.longitude*1e3)}`;X.has(ze)||X.set(ze,[]),X.get(ze).push(Fe)});const we=[];if(X.forEach(Fe=>{if(Fe.length>1){Fe.sort((ze,qe)=>new Date(ze.created_at).getTime()-new Date(qe.created_at).getTime());for(let ze=1;ze<Fe.length;ze++)we.push(Fe[ze].id)}}),we.length===0){alert("No duplicate gates found!");return}const{error:Ie}=await B.from("gates").delete().in("id",we);if(Ie)throw Ie;alert(`Successfully removed ${we.length} duplicate gates!`),await We(t.id)}catch(X){console.error("Error cleaning up duplicate gates:",X),alert("Failed to clean up duplicate gates. Please try again.")}},It=async(X,we)=>{if(t!=null&&t.id)try{const{count:Ie,error:Fe}=await B.from("checkin_logs").select("id",{count:"exact"}).eq("gate_id",X);if(Fe)throw Fe;if(Ie&&Ie>0){alert(`This gate can't be deleted because it has ${Ie} check-ins.`);return}const{error:ze}=await B.from("gates").delete().eq("id",X);if(ze)throw ze;alert(`Gate "${we}" deleted successfully!`),await We(t.id)}catch(Ie){console.error("Error deleting gate:",Ie),alert(`Failed to delete gate "${we}". Please try again.`)}},zt=async()=>{var X,we,Ie,Fe,ze,qe,pt,rt,Ue,Ct,vr,yr,Kt;if(!z){alert("No gate selected for configuration.");return}try{const jt=(we=(X=H.current)==null?void 0:X.value)==null?void 0:we.trim(),ke=(Ie=J.current)==null?void 0:Ie.value,mn=(ze=(Fe=F.current)==null?void 0:Fe.value)==null?void 0:ze.trim(),Bn=(pt=(qe=V.current)==null?void 0:qe.value)==null?void 0:pt.trim(),Pa=(Ue=(rt=te.current)==null?void 0:rt.value)==null?void 0:Ue.trim();if(!jt){alert("Gate name is required."),(Ct=H.current)==null||Ct.focus();return}if(!ke){alert("Gate status is required."),(vr=J.current)==null||vr.focus();return}let Aa=null,Fs=null;if(mn&&(Aa=parseFloat(mn),isNaN(Aa))){alert("Invalid latitude value. Please enter a valid number."),(yr=F.current)==null||yr.focus();return}if(Bn&&(Fs=parseFloat(Bn),isNaN(Fs))){alert("Invalid longitude value. Please enter a valid number."),(Kt=V.current)==null||Kt.focus();return}const el={name:jt,status:ke,location_lat:Aa,location_lng:Fs,location_description:Pa||null,updated_at:new Date().toISOString()},{error:Fn}=await B.from("gates").update(el).eq("id",z.id);if(Fn)throw Fn;alert("Gate configuration saved successfully!"),U(!1),t!=null&&t.id&&await We(t.id)}catch(jt){console.error("Error saving gate configuration:",jt),alert(`Failed to save gate configuration: ${jt instanceof Error?jt.message:"Unknown error"}`)}},Et=async X=>{try{const{data:we,error:Ie}=await B.from("checkin_logs").select("id, app_lat, app_lon, timestamp, location").eq("event_id",X).is("gate_id",null).not("app_lat","is",null).not("app_lon","is",null);if(Ie)throw Ie;if(!we||we.length===0){console.log("No orphaned check-ins found");return}console.log(`Found ${we.length} orphaned check-ins`);const Fe=new Map;we.forEach(Ue=>{const Ct=Math.round(Ue.app_lat*1e4)/1e4,vr=Math.round(Ue.app_lon*1e4)/1e4,yr=`${Ct},${vr}`;Fe.has(yr)||Fe.set(yr,{lat:Ct,lon:vr,checkins:[],first_seen:Ue.timestamp,last_seen:Ue.timestamp});const Kt=Fe.get(yr);Kt.checkins.push(Ue),Ue.timestamp<Kt.first_seen&&(Kt.first_seen=Ue.timestamp),Ue.timestamp>Kt.last_seen&&(Kt.last_seen=Ue.timestamp)});const ze=Array.from(Fe.values()).filter(Ue=>Ue.checkins.length>=3);console.log(`Found ${ze.length} valid gate locations:`),ze.forEach((Ue,Ct)=>{console.log(`  Location ${Ct+1}: ${Ue.lat}, ${Ue.lon} (${Ue.checkins.length} check-ins)`)});const qe=ze.map((Ue,Ct)=>({event_id:X,name:`Auto-discovered Gate ${Ct+1}`,latitude:Ue.lat,longitude:Ue.lon,status:"active",health_score:100,location_description:`Discovered from ${Ue.checkins.length} check-ins between ${new Date(Ue.first_seen).toLocaleDateString()} and ${new Date(Ue.last_seen).toLocaleDateString()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}));if(qe.length===0){console.log("No valid gate clusters found (need at least 3 check-ins per location)");return}const{data:pt,error:rt}=await B.from("gates").insert(qe).select();if(rt)throw rt;console.log(`Successfully created ${pt.length} gates:`,pt);for(let Ue=0;Ue<ze.length;Ue++){const Ct=ze[Ue],vr=pt[Ue],yr=Ct.checkins.map(jt=>jt.id),{error:Kt}=await B.from("checkin_logs").update({gate_id:vr.id}).in("id",yr);Kt?console.error(`Error linking check-ins to gate ${vr.id}:`,Kt):console.log(`Linked ${yr.length} check-ins to gate: ${vr.name}`)}alert(`Successfully created ${pt.length} gates from orphaned check-ins!

Refreshing gates list...`),await We(X)}catch(we){console.error("Error creating gates from orphaned check-ins:",we),alert("Failed to create gates from check-ins. Check console for details.")}},dr=X=>{const Ie=Math.floor((new Date().getTime()-X.getTime())/1e3);return Ie<60?`${Ie} seconds ago`:Ie<3600?`${Math.floor(Ie/60)} minutes ago`:Ie<86400?`${Math.floor(Ie/3600)} hours ago`:`${Math.floor(Ie/86400)} days ago`};if(c)return n.jsx(nb,{});if(!t)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx("h2",{className:"text-xl font-medium text-gray-900",children:"Event not found"}),n.jsx("p",{className:"mt-2 text-gray-500",children:"The event you're looking for doesn't exist or you don't have access to it."}),n.jsx(dt,{to:"/events",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Back to events"})]});const Yr=t!=null&&t.start_date?new Date(t.start_date):new Date,Pr=t!=null&&t.end_date?new Date(t.end_date):new Date,et=t&&new Date>=Yr&&new Date<=Pr,zr=t&&new Date>Pr;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-4 sm:space-y-0",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:(t==null?void 0:t.name)||"Loading..."}),et&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"}),zr&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Past"})]}),n.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[Yr.toLocaleDateString()," - ",Pr.toLocaleDateString(),(t==null?void 0:t.location)&&`  ${t.location}`]})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsxs("button",{onClick:()=>ut(e),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(Gr,{size:14,className:"mr-1.5"}),"Refresh"]}),n.jsxs(dt,{to:`/events/${t==null?void 0:t.id}/edit`,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(ii,{size:14,className:"mr-1.5"}),"Edit"]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("nav",{className:"flex space-x-8 px-6",role:"tablist",children:[{id:"overview",label:"Overview"},{id:"wristbands",label:"Wristbands"},{id:"guests",label:"Guest List"},{id:"gates",label:"Gates & Entry Points"},{id:"analytics",label:"Analytics"},{id:"access",label:"Team Access"},{id:"settings",label:"Settings"}].map(X=>n.jsx("button",{"data-tab":X.id,className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${f===X.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>h(X.id),children:X.label},X.id))})}),n.jsxs("div",{className:"p-6",children:[f==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(qt,{className:"h-5 w-5 mr-2 text-blue-600"}),"Event Health Score"]})}),n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"relative w-20 h-20",children:[n.jsxs("svg",{className:"w-20 h-20 transform -rotate-90",viewBox:"0 0 36 36",children:[n.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#e5e7eb",strokeWidth:"2"}),n.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:s.totalWristbands>0&&s.checkedIn>0?"#10b981":"#6b7280",strokeWidth:"2",strokeDasharray:`${Math.min(85,s.checkedIn/Math.max(s.totalWristbands,1)*100)}, 100`})]}),n.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n.jsx("span",{className:"text-xl font-bold text-gray-900",children:s.totalWristbands>0?Math.min(85,Math.round(s.checkedIn/s.totalWristbands*100)):0})})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Composite Score"}),n.jsx("p",{className:"text-xs text-gray-500",children:"Gate Health (40%) + Security (30%) + Operations (30%)"})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Last Updated"}),n.jsx("p",{className:"text-xs text-gray-500",children:new Date().toLocaleTimeString()})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-green-600",children:"Gate Health"}),n.jsxs("p",{className:"text-lg font-semibold",children:[N,"%"]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Security"}),n.jsxs("p",{className:"text-lg font-semibold",children:[O,"%"]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Operations"}),n.jsxs("p",{className:"text-lg font-semibold",children:[s.totalWristbands>0?Math.round(s.checkedIn/s.totalWristbands*100):0,"%"]})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(lt,{className:"h-5 w-5 mr-2 text-purple-600"}),"Live Capacity Tracking"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Current Attendance"}),n.jsx("span",{className:"text-lg font-semibold",children:s.checkedIn.toLocaleString()})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Capacity Limit"}),n.jsx("span",{className:"text-lg font-semibold",children:t.total_capacity>0?t.total_capacity.toLocaleString():"Unlimited"})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:n.jsx("div",{className:`h-3 rounded-full ${t.total_capacity>0&&s.checkedIn/t.total_capacity>.9?"bg-red-500":t.total_capacity>0&&s.checkedIn/t.total_capacity>.75?"bg-orange-500":"bg-green-500"}`,style:{width:t.total_capacity>0?`${Math.min(100,s.checkedIn/t.total_capacity*100)}%`:"0%"}})}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Occupancy"}),n.jsx("span",{className:`text-lg font-semibold ${t.total_capacity>0&&s.checkedIn/t.total_capacity>.9?"text-red-600":t.total_capacity>0&&s.checkedIn/t.total_capacity>.75?"text-orange-600":"text-green-600"}`,children:t.total_capacity>0?`${Math.round(s.checkedIn/t.total_capacity*100)}%`:""})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(Mn,{className:"h-5 w-5 mr-2 text-indigo-600"}),"Event Lifecycle Status"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Current Status"}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium capitalize ${t.lifecycle_status==="active"?"bg-green-100 text-green-800":t.lifecycle_status==="draft"?"bg-gray-100 text-gray-800":t.lifecycle_status==="completed"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:t.lifecycle_status||"Draft"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Event Start"}),n.jsx("span",{children:new Date(t.start_date).toLocaleDateString()})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Event End"}),n.jsx("span",{children:new Date(t.end_date).toLocaleDateString()})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Days Until Start"}),n.jsx("span",{className:"font-medium",children:Math.max(0,Math.ceil((new Date(t.start_date).getTime()-new Date().getTime())/(1e3*60*60*24)))})]})]}),n.jsx("div",{className:"pt-2",children:n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"bg-indigo-500 h-2 rounded-full",style:{width:`${Math.min(100,Math.max(0,(new Date().getTime()-new Date(t.start_date).getTime())/(new Date(t.end_date).getTime()-new Date(t.start_date).getTime())*100))}%`}})})})]})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Total Wristbands"}),n.jsx("p",{className:"text-2xl font-semibold text-blue-900 mt-1",children:s.totalWristbands.toLocaleString()})]}),n.jsx(lt,{className:"h-8 w-8 text-blue-600"})]})}),n.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-green-800",children:"Checked In"}),n.jsx("p",{className:"text-2xl font-semibold text-green-900 mt-1",children:s.checkedIn.toLocaleString()})]}),n.jsx(Tt,{className:"h-8 w-8 text-green-600"})]})}),n.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-orange-800",children:"Check-in Rate"}),n.jsx("p",{className:"text-2xl font-semibold text-orange-900 mt-1",children:s.totalWristbands>0?`${Math.round(s.checkedIn/s.totalWristbands*100)}%`:""})]}),n.jsx(Mn,{className:"h-8 w-8 text-orange-600"})]})}),n.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-red-800",children:"Active Alerts"}),n.jsx("p",{className:"text-2xl font-semibold text-red-900 mt-1",children:w.length})]}),n.jsx(bt,{className:"h-8 w-8 text-red-600"})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header",children:[n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(qt,{className:"h-5 w-5 mr-2 text-green-600"}),"Live Activity Feed"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),n.jsx("span",{className:"text-xs text-gray-500",children:"Live"})]})]}),n.jsxs("div",{className:"card-body",children:[n.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:_.length>0?_.map(X=>n.jsxs("div",{className:"flex items-start space-x-3 p-2 rounded-lg bg-green-50",children:[n.jsx(Tt,{className:"h-4 w-4 text-green-600 mt-0.5"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm text-gray-900",children:X.message}),n.jsxs("p",{className:"text-xs text-gray-500",children:[X.category,"  ",X.timeAgo]})]})]},X.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx(qt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-500 mb-2",children:"No recent activity"}),n.jsx("p",{className:"text-xs text-gray-400",children:"Check-ins will appear here"})]})}),n.jsx("div",{className:"mt-4 pt-4 border-t",children:n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Showing last 50 activities"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800 font-medium",children:"View All"})]})})]})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header",children:[n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(bt,{className:"h-5 w-5 mr-2 text-red-600"}),"Critical Alerts"]}),n.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${w.length>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:[w.length," Active"]})]}),n.jsxs("div",{className:"card-body",children:[w.length>0?n.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:w.map(X=>n.jsxs("div",{className:`flex items-start space-x-3 p-2 rounded-lg ${X.severity==="critical"?"bg-red-50":X.severity==="error"?"bg-orange-50":X.severity==="warning"?"bg-yellow-50":"bg-blue-50"}`,children:[n.jsx(bt,{className:`h-4 w-4 mt-0.5 ${X.severity==="critical"?"text-red-600":X.severity==="error"?"text-orange-600":X.severity==="warning"?"text-yellow-600":"text-blue-600"}`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm text-gray-900",children:X.message}),n.jsxs("p",{className:"text-xs text-gray-500 capitalize",children:[X.severity,"  ",dr(new Date(X.created_at))]})]})]},X.id))}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx(jr,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-500 mb-2",children:"No active alerts"}),n.jsx("p",{className:"text-xs text-gray-400",children:"All systems operational"})]}),n.jsx("div",{className:"mt-4 pt-4 border-t",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-lg font-semibold text-green-600",children:[Math.round((N+O)/2),"%"]}),n.jsx("p",{className:"text-xs text-gray-500",children:"System Health"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-lg font-semibold text-blue-600",children:w.filter(X=>X.resolved).length}),n.jsx("p",{className:"text-xs text-gray-500",children:"Resolved Today"})]})]})})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(ha,{className:"h-5 w-5 mr-2 text-yellow-600"}),"Emergency Controls"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("button",{className:"btn btn-danger justify-center",children:[n.jsx(bt,{className:"h-4 w-4 mr-2"}),"Emergency Lockdown"]}),n.jsxs("button",{className:"btn btn-warning justify-center",children:[n.jsx(lt,{className:"h-4 w-4 mr-2"}),"Broadcast Alert"]}),n.jsxs("button",{className:"btn btn-secondary justify-center",children:[n.jsx(qt,{className:"h-4 w-4 mr-2"}),"Generate Report"]}),n.jsxs("button",{className:"btn btn-secondary justify-center",children:[n.jsx(Mn,{className:"h-4 w-4 mr-2"}),"Adjust Capacity"]})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"card-title",children:"Event Information"})}),n.jsxs("div",{className:"card-body space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Duration"}),n.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:[Yr.toLocaleDateString()," - ",Pr.toLocaleDateString()]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Location"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.location||""})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Capacity"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.total_capacity>0?t.total_capacity:"Unlimited"})]}),t.description&&n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Description"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.description})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"card-title",children:"Quick Actions"})}),n.jsxs("div",{className:"card-body space-y-3",children:[n.jsx("button",{onClick:()=>h("wristbands"),className:"btn btn-secondary w-full justify-start",children:"Manage Wristbands"}),n.jsx("button",{onClick:()=>h("command-center"),className:"btn btn-secondary w-full justify-start",children:"Live Operations"}),n.jsx("button",{onClick:()=>h("analytics"),className:"btn btn-secondary w-full justify-start",children:"View Analytics"}),n.jsx(dt,{to:`/events/${t.id}/edit`,className:"btn btn-secondary w-full justify-start",children:"Edit Event"})]})]})]}),s.categories.length>0&&n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Category Breakdown"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Active"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Checked In"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-in Rate"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.categories.map(X=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:X.name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.total}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.checkedIn}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.checkedIn}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.total>0?`${Math.round(X.checkedIn/X.total*100)}%`:"-"})]},X.name))})]})})]})]}),f==="wristbands"&&t&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Access Control Center"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"Enterprise wristband management with ticket integration and bulk operations"})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsxs("button",{onClick:()=>g(!0),className:"btn btn-secondary",children:[n.jsx(lt,{className:"h-4 w-4 mr-2"}),"Upload Tickets"]}),n.jsxs("button",{onClick:()=>j(!0),className:"btn btn-primary",children:[n.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Upload Wristbands"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.totalWristbands}),n.jsx("p",{className:"text-sm text-gray-600",children:"Total Wristbands"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:Math.round(s.totalWristbands*.85)}),n.jsx("p",{className:"text-sm text-gray-600",children:"Activated"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-orange-600",children:s.checkedIn}),n.jsx("p",{className:"text-sm text-gray-600",children:"Checked In"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Math.round(s.totalWristbands*.75)}),n.jsx("p",{className:"text-sm text-gray-600",children:"Linked to Tickets"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-red-600",children:"0"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Blocked"})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"card-title",children:"Advanced Search & Filtering"})}),n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search NFC ID"}),n.jsx("input",{type:"text",placeholder:"Enter NFC ID...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attendee Name"}),n.jsx("input",{type:"text",placeholder:"Search by name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),n.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Categories"}),s.categories.map(X=>n.jsx("option",{value:X.name,children:X.name},X.name))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),n.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Statuses"}),n.jsx("option",{value:"pending",children:"Pending"}),n.jsx("option",{value:"activated",children:"Activated"}),n.jsx("option",{value:"checked-in",children:"Checked In"}),n.jsx("option",{value:"blocked",children:"Blocked"})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Never checked in"})]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Multiple check-ins"})]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Unlinked tickets"})]})]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{className:"btn btn-secondary btn-sm",children:"Clear Filters"}),n.jsx("button",{className:"btn btn-primary btn-sm",children:"Apply Filters"})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(lt,{className:"h-5 w-5 mr-2 text-blue-600"}),"Ticket Integration"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Linking Mode"}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium capitalize ${t.ticket_linking_mode==="required"?"bg-red-100 text-red-800":t.ticket_linking_mode==="optional"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.ticket_linking_mode||"Disabled"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Unlinked Entry"}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.allow_unlinked_entry?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.allow_unlinked_entry?"Allowed":"Blocked"})]}),n.jsx("div",{className:"pt-4 border-t",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-lg font-semibold text-blue-600",children:Math.round(s.totalWristbands*.75)}),n.jsx("p",{className:"text-xs text-gray-500",children:"Linked"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-lg font-semibold text-orange-600",children:Math.round(s.totalWristbands*.25)}),n.jsx("p",{className:"text-xs text-gray-500",children:"Unlinked"})]})]})})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(qt,{className:"h-5 w-5 mr-2 text-green-600"}),"Bulk Operations"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("button",{className:"btn btn-secondary w-full justify-start",children:[n.jsx(Tt,{className:"h-4 w-4 mr-2"}),"Bulk Activate Selected"]}),n.jsxs("button",{className:"btn btn-secondary w-full justify-start",children:[n.jsx(lt,{className:"h-4 w-4 mr-2"}),"Auto-Link by Email"]}),n.jsxs("button",{className:"btn btn-secondary w-full justify-start",children:[n.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Change Category"]}),n.jsxs("button",{className:"btn btn-danger w-full justify-start",children:[n.jsx(bt,{className:"h-4 w-4 mr-2"}),"Block Selected"]})]})})]})]}),n.jsx(jP,{eventId:t.id})]}),f==="access"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"User Access"}),n.jsxs(dt,{to:`/access/new?eventId=${t.id}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[n.jsx(lt,{size:16,className:"mr-2"}),"Grant Access"]})]}),i.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Access Level"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted By"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted On"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(X=>{var we,Ie,Fe;return n.jsxs("tr",{children:[n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:((we=X.profiles)==null?void 0:we.full_name)||"Unnamed User"}),n.jsx("div",{className:"text-sm text-gray-500",children:(Ie=X.profiles)==null?void 0:Ie.email})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${X.access_level==="owner"?"bg-purple-100 text-purple-800":X.access_level==="admin"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:X.access_level})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((Fe=X.grantedBy)==null?void 0:Fe.email)||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(X.created_at).toLocaleDateString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsx(dt,{to:`/access/${X.id}/edit`,className:"text-blue-600 hover:text-blue-900",children:"Edit"})})]},X.id)})})]})}):n.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[n.jsx("p",{className:"text-gray-500 mb-4",children:"No users have been granted access to this event yet."}),n.jsx(dt,{to:`/access/new?eventId=${t.id}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Grant access to users"})]})]}),f==="guests"&&t&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Guest List Management"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"Manage tickets and guest data from ticketing platforms"})]}),n.jsx("div",{className:"flex space-x-3",children:n.jsxs("button",{onClick:()=>Oe(!0),className:"btn btn-primary",children:[n.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Upload Tickets"]})})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Z.length}),n.jsx("p",{className:"text-sm text-gray-600",children:"Total Tickets"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:Z.filter(X=>X.wristband).length}),n.jsx("p",{className:"text-sm text-gray-600",children:"Linked to Wristbands"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-orange-600",children:Z.filter(X=>X.status==="linked").length}),n.jsx("p",{className:"text-sm text-gray-600",children:"Active"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Z.filter(X=>!X.wristband).length}),n.jsx("p",{className:"text-sm text-gray-600",children:"Unlinked"})]})})]}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"Search guests...",value:xe,onChange:X=>oe(X.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md"})]})}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("select",{value:de,onChange:X=>ce(X.target.value),className:"px-3 py-2 border border-gray-300 rounded-md",children:[n.jsx("option",{value:"all",children:"All Status"}),n.jsx("option",{value:"unused",children:"Unused"}),n.jsx("option",{value:"linked",children:"Linked"}),n.jsx("option",{value:"cancelled",children:"Cancelled"})]}),n.jsx("button",{onClick:()=>{oe(""),ce("all"),me({ticket_number:"",holder_name:"",holder_email:"",ticket_category:""})},className:"px-3 py-2 border border-gray-300 rounded-md text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-50",children:"Clear All Filters"})]})]})})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body p-0",children:fe?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"overflow-x-auto",children:[n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("div",{className:"flex flex-col space-y-1",children:[n.jsxs("button",{onClick:()=>Xe("ticket_number"),className:"flex items-center space-x-1 hover:text-gray-700",children:[n.jsx("span",{children:"Ticket #"}),Ne==="ticket_number"&&(se==="asc"?n.jsx(oa,{className:"h-3 w-3"}):n.jsx(Ja,{className:"h-3 w-3"}))]}),n.jsx("input",{type:"text",placeholder:"Filter...",value:he.ticket_number,onChange:X=>me({...he,ticket_number:X.target.value}),className:"text-xs px-2 py-1 border border-gray-200 rounded",onClick:X=>X.stopPropagation()})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("div",{className:"flex flex-col space-y-1",children:[n.jsxs("button",{onClick:()=>Xe("holder_name"),className:"flex items-center space-x-1 hover:text-gray-700",children:[n.jsx("span",{children:"Guest Details"}),Ne==="holder_name"&&(se==="asc"?n.jsx(oa,{className:"h-3 w-3"}):n.jsx(Ja,{className:"h-3 w-3"}))]}),n.jsx("input",{type:"text",placeholder:"Filter...",value:he.holder_name,onChange:X=>me({...he,holder_name:X.target.value}),className:"text-xs px-2 py-1 border border-gray-200 rounded",onClick:X=>X.stopPropagation()})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("div",{className:"flex flex-col space-y-1",children:[n.jsxs("button",{onClick:()=>Xe("ticket_category"),className:"flex items-center space-x-1 hover:text-gray-700",children:[n.jsx("span",{children:"Category"}),Ne==="ticket_category"&&(se==="asc"?n.jsx(oa,{className:"h-3 w-3"}):n.jsx(Ja,{className:"h-3 w-3"}))]}),n.jsx("input",{type:"text",placeholder:"Filter...",value:he.ticket_category,onChange:X=>me({...he,ticket_category:X.target.value}),className:"text-xs px-2 py-1 border border-gray-200 rounded",onClick:X=>X.stopPropagation()})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsx("div",{className:"flex flex-col space-y-1",children:n.jsxs("button",{onClick:()=>Xe("status"),className:"flex items-center space-x-1 hover:text-gray-700",children:[n.jsx("span",{children:"Status"}),Ne==="status"&&(se==="asc"?n.jsx(oa,{className:"h-3 w-3"}):n.jsx(Ja,{className:"h-3 w-3"}))]})})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Wristband"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.filter(X=>{var rt,Ue,Ct,vr,yr,Kt,jt;const we=!xe||((rt=X.ticket_number)==null?void 0:rt.toLowerCase().includes(xe.toLowerCase()))||((Ue=X.holder_name)==null?void 0:Ue.toLowerCase().includes(xe.toLowerCase()))||((Ct=X.holder_email)==null?void 0:Ct.toLowerCase().includes(xe.toLowerCase())),Ie=de==="all"||X.status===de,Fe=!he.ticket_number||((vr=X.ticket_number)==null?void 0:vr.toLowerCase().includes(he.ticket_number.toLowerCase())),ze=!he.holder_name||((yr=X.holder_name)==null?void 0:yr.toLowerCase().includes(he.holder_name.toLowerCase())),qe=!he.holder_email||((Kt=X.holder_email)==null?void 0:Kt.toLowerCase().includes(he.holder_email.toLowerCase())),pt=!he.ticket_category||((jt=X.ticket_category)==null?void 0:jt.toLowerCase().includes(he.ticket_category.toLowerCase()));return we&&Ie&&Fe&&ze&&qe&&pt}).map(X=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:X.ticket_number}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.holder_name||"Unknown"}),n.jsx("div",{className:"text-sm text-gray-500",children:X.holder_email}),X.holder_phone&&n.jsx("div",{className:"text-xs text-gray-400",children:X.holder_phone})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:X.ticket_category})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${X.status==="linked"?"bg-green-100 text-green-800":X.status==="unused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:X.status==="linked"?"Linked":X.status==="unused"?"Unused":"Cancelled"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.wristband?n.jsxs("div",{className:"flex items-center",children:[n.jsx(bh,{className:"h-4 w-4 text-green-500 mr-1"}),n.jsx("span",{className:"font-medium",children:X.wristband.nfc_id})]}):n.jsx("span",{className:"text-gray-400",children:"Not linked"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsx("button",{onClick:()=>$e(Ce===X.id?null:X.id),className:"text-gray-400 hover:text-gray-600",children:n.jsx(rb,{className:"h-4 w-4"})})})]},X.id))})]}),Z.length===0&&!fe&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(lt,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No guests found"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by uploading your guest list."}),n.jsx("div",{className:"mt-6",children:n.jsxs("button",{onClick:()=>Oe(!0),className:"btn btn-primary",children:[n.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Upload Guest List"]})})]})]})})})]}),f==="gates"&&t&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Entry Point Control"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"Manage gates, monitor performance, and control access points"})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsxs("button",{onClick:()=>alert("Add Gate functionality - would open gate creation modal"),className:"btn btn-secondary",children:[n.jsx(cn,{className:"h-4 w-4 mr-2"}),"Add Gate"]}),n.jsxs("button",{onClick:()=>alert("Live Monitor - would open real-time gate monitoring dashboard"),className:"btn btn-primary",children:[n.jsx(qt,{className:"h-4 w-4 mr-2"}),"Live Monitor"]}),A.length>5&&n.jsxs("button",{onClick:async()=>{confirm(`You have ${A.length} gates. Would you like to clean up duplicates?

This will remove gates with identical names and very similar GPS coordinates.`)&&await tr()},className:"btn btn-warning",children:[n.jsx(wn,{className:"h-4 w-4 mr-2"}),"Clean Duplicates"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-blue-600",children:E.total}),n.jsx("p",{className:"text-sm text-gray-600",children:"Total Gates"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:E.active}),n.jsx("p",{className:"text-sm text-gray-600",children:"Active"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[E.avgHealth,"%"]}),n.jsx("p",{className:"text-sm text-gray-600",children:"Avg Health"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-purple-600",children:E.pendingApproval}),n.jsx("p",{className:"text-sm text-gray-600",children:"Pending Approval"})]})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header",children:[n.jsx("h3",{className:"card-title",children:"All Gates"}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:()=>M("map"),className:`btn btn-sm ${$==="map"?"btn-primary":"btn-secondary"}`,children:"Map View"}),n.jsx("button",{onClick:()=>M("list"),className:`btn btn-sm ${$==="list"?"btn-primary":"btn-secondary"}`,children:"List View"})]})]}),n.jsx("div",{className:"card-body",children:n.jsx("div",{className:"space-y-4",children:A.length===0?n.jsxs("div",{className:"text-center py-8",children:[n.jsx(cn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Active Gates"}),n.jsx("p",{className:"text-gray-500 mb-4",children:"No gates with successful check-ins found. If you have check-ins in your system, they might be orphaned (not linked to gates)."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[n.jsxs("button",{onClick:()=>(t==null?void 0:t.id)&&Et(t.id),className:"btn btn-primary",disabled:!(t!=null&&t.id),children:[n.jsx(qt,{className:"h-4 w-4 mr-2"}),"Auto-Create Gates from Check-ins"]}),n.jsxs("button",{className:"btn btn-secondary",children:[n.jsx(cn,{className:"h-4 w-4 mr-2"}),"Add Gate Manually"]})]}),n.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"Auto-create will find check-in locations and create gates for them"})]}):$==="map"?n.jsx(q1,{gates:A.map(X=>({id:X.id,name:X.name,latitude:X.latitude,longitude:X.longitude,status:X.status,health_score:X.health_score,checkin_count:X.checkin_count})),fitPadding:[40,40],minZoom:2,maxZoom:18,onGateClick:X=>{console.log("Gate clicked:",X)},showControls:!0}):A.map((X,we)=>{const Ie=(qe,pt)=>qe==="inactive"?"bg-gray-500":qe==="maintenance"?"bg-yellow-500":pt<70?"bg-red-500":pt<90?"bg-orange-500":"bg-green-500",Fe=(qe,pt)=>qe==="inactive"?"Inactive":qe==="maintenance"?"Maintenance":pt<70?"Connection Issues":pt<90?"Warning":"Active",ze=typeof X.id=="object"?JSON.stringify(X.id):String(X.id||we);return n.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${Ie(X.status,X.health_score||100)}`}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900",children:String(X.name||"Unnamed Gate")}),n.jsxs("p",{className:"text-sm text-gray-500",children:[X.latitude&&X.longitude?n.jsxs(n.Fragment,{children:["GPS: ",X.latitude.toFixed(4),", ",X.longitude.toFixed(4),"  "]}):X.location_description&&n.jsxs(n.Fragment,{children:[String(X.location_description),"  "]}),"Health: ",X.health_score||100,"%"]})]})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:Fe(X.status||"active",X.health_score||100)}),n.jsxs("p",{className:"text-xs text-gray-500",children:[X.checkin_count||0," successful check-ins"]}),n.jsxs("p",{className:"text-xs text-gray-400",children:["Created ",X.created_at?new Date(X.created_at).toLocaleDateString():"Unknown"]})]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:()=>{K(X),U(!0)},className:"btn btn-secondary btn-sm",children:"Configure"}),n.jsx("button",{onClick:()=>{K(X),R(!0)},className:"btn btn-primary btn-sm",children:"Monitor"}),n.jsx("button",{onClick:async()=>{const qe=String(X.name||"Unnamed Gate");confirm(`Delete gate "${qe}"?

This action cannot be undone.`)&&await It(X.id,qe)},className:"btn btn-danger btn-sm",title:"Delete Gate",children:n.jsx(wn,{className:"h-4 w-4"})})]})]})]},ze)})})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"card-title",children:"Performance Analytics"})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Total Throughput"}),n.jsxs("span",{className:"text-lg font-semibold",children:[s.checkedIn," scans"]})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Success Rate"}),n.jsx("span",{className:"text-lg font-semibold text-green-600",children:"97.8%"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Avg Processing Time"}),n.jsx("span",{className:"text-lg font-semibold",children:"1.2s"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Peak Hour"}),n.jsx("span",{className:"text-lg font-semibold",children:"14:00 - 15:00"})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"card-title",children:"Category Bindings"})}),n.jsx("div",{className:"card-body",children:n.jsx("div",{className:"space-y-3",children:s.categories.map((X,we)=>n.jsxs("div",{className:"flex items-center justify-between p-2 rounded bg-gray-50",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${we===0?"bg-blue-500":we===1?"bg-purple-500":we===2?"bg-green-500":"bg-orange-500"}`}),n.jsx("span",{className:"text-sm font-medium",children:X.name})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-xs text-gray-500",children:"3 gates"}),n.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"Enforced"})]})]},X.name))})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"card-title flex items-center",children:[n.jsx(bt,{className:"h-5 w-5 mr-2 text-red-600"}),"Emergency Gate Controls"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("button",{className:"btn btn-danger justify-center",children:[n.jsx(bt,{className:"h-4 w-4 mr-2"}),"Close All Gates"]}),n.jsxs("button",{className:"btn btn-warning justify-center",children:[n.jsx(jr,{className:"h-4 w-4 mr-2"}),"Emergency Mode"]}),n.jsxs("button",{className:"btn btn-secondary justify-center",children:[n.jsx(Tt,{className:"h-4 w-4 mr-2"}),"Open All Gates"]}),n.jsxs("button",{className:"btn btn-secondary justify-center",children:[n.jsx(qt,{className:"h-4 w-4 mr-2"}),"Reset All"]})]})})]})]}),f==="fraud"&&t&&n.jsx(fA,{eventId:t.id}),f==="analytics"&&t&&n.jsx(SU,{eventId:t.id}),f==="export"&&t&&n.jsx(D1,{eventId:t.id,eventName:t.name}),f==="emergency"&&t&&n.jsx(EU,{eventId:t.id,eventName:t.name}),f==="testing"&&t&&n.jsx(CU,{eventId:t.id,eventName:t.name}),f==="settings"&&t&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Event Settings"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"Configure event parameters and operational settings"})]}),n.jsxs(dt,{to:`/events/${t.id}/edit`,className:"btn btn-primary",children:[n.jsx(ii,{className:"h-4 w-4 mr-2"}),"Edit Event"]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"card-title",children:"Basic Information"})}),n.jsxs("div",{className:"card-body space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Event Name"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.name})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Location"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.location||"Not specified"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Capacity"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.total_capacity>0?t.total_capacity.toLocaleString():"Unlimited"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Duration"}),n.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:[new Date(t.start_date).toLocaleDateString()," - ",new Date(t.end_date).toLocaleDateString()]})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"card-title",children:"Operational Configuration"})}),n.jsxs("div",{className:"card-body space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Ticket Linking"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1 capitalize",children:t.ticket_linking_mode||"Disabled"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Unlinked Entry"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.allow_unlinked_entry?"Allowed":"Not Allowed"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Public Event"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.is_public?"Yes":"No"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Status"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1 capitalize",children:t.lifecycle_status||"Draft"})]})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header",children:[n.jsx("h3",{className:"card-title",children:"Advanced Configuration"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Event-specific settings and features"})]}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:"Security"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Fraud Detection"}),n.jsx("span",{className:"text-green-600 font-medium",children:"Enabled"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Real-time Monitoring"}),n.jsx("span",{className:"text-green-600 font-medium",children:"Active"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Access Control"}),n.jsx("span",{className:"text-blue-600 font-medium",children:"Role-based"})]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:"Gate Management"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Auto Discovery"}),n.jsx("span",{className:"text-green-600 font-medium",children:"Enabled"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Gate Approval"}),n.jsx("span",{className:"text-orange-600 font-medium",children:"Manual"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Health Monitoring"}),n.jsx("span",{className:"text-green-600 font-medium",children:"Active"})]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:"Analytics"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Real-time Analytics"}),n.jsx("span",{className:"text-green-600 font-medium",children:"Enabled"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Export Reports"}),n.jsx("span",{className:"text-blue-600 font-medium",children:"Available"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Data Retention"}),n.jsx("span",{className:"text-gray-600 font-medium",children:"365 days"})]})]})]})]})})]}),n.jsx(PU,{eventId:t.id}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"card-title",children:"Quick Actions"})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx("button",{onClick:()=>h("wristbands"),className:"btn btn-secondary justify-center",children:"Manage Wristbands"}),n.jsx("button",{onClick:()=>h("command-center"),className:"btn btn-secondary justify-center",children:"Live Operations"}),n.jsx("button",{onClick:()=>h("analytics"),className:"btn btn-secondary justify-center",children:"View Analytics"}),n.jsx("button",{onClick:()=>h("access"),className:"btn btn-secondary justify-center",children:"Team Access"})]})})]})]})]})]}),m&&t&&n.jsx(_P,{eventId:t.id,onUploadComplete:()=>{ut(e)},onClose:()=>g(!1)}),v&&t&&n.jsx(ab,{eventId:t.id,onUploadComplete:()=>{ut(e)},onClose:()=>j(!1)}),ne&&t&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Upload Guest List"}),n.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Upload ticket data for event: ",n.jsx("span",{className:"font-medium text-gray-700",children:t.name})]})]}),n.jsx("button",{onClick:()=>Oe(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(In,{className:"h-6 w-6"})})]}),n.jsx("div",{className:"p-6",children:n.jsx(ib,{eventId:t.id,onUploadComplete:()=>{Qe(t.id),Oe(!1)},onClose:()=>Oe(!1)})})]})}),W&&z&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Configure Gate"}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:z.name})]}),n.jsx("button",{onClick:()=>U(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(In,{className:"h-6 w-6"})})]}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gate Name"}),n.jsx("input",{ref:H,type:"text",defaultValue:z.name,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),n.jsxs("select",{ref:J,defaultValue:z.status,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"active",children:"Active"}),n.jsx("option",{value:"inactive",children:"Inactive"}),n.jsx("option",{value:"maintenance",children:"Maintenance"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude"}),n.jsx("input",{ref:F,type:"number",step:"0.000001",defaultValue:z.latitude,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude"}),n.jsx("input",{ref:V,type:"number",step:"0.000001",defaultValue:z.longitude,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location Description"}),n.jsx("textarea",{ref:te,rows:3,defaultValue:z.location_description||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe the gate location..."})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Gate Statistics"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Total Check-ins:"}),n.jsx("span",{className:"ml-2 font-medium",children:z.checkin_count})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Health Score:"}),n.jsxs("span",{className:"ml-2 font-medium",children:[z.health_score||100,"%"]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Created:"}),n.jsx("span",{className:"ml-2 font-medium",children:new Date(z.created_at).toLocaleDateString()})]})]})]})]})}),n.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 bg-gray-50 border-t",children:[n.jsx("button",{onClick:()=>U(!1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:zt,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Save Changes"})]})]})}),Y&&z&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Gate Monitor"}),n.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[z.name," - Real-time Monitoring"]})]}),n.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(In,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[n.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Tt,{className:"h-8 w-8 text-green-600"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("p",{className:"text-sm font-medium text-green-900",children:"Total Check-ins"}),n.jsx("p",{className:"text-2xl font-bold text-green-600",children:z.checkin_count})]})]})}),n.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(qt,{className:"h-8 w-8 text-blue-600"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Health Score"}),n.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[z.health_score||100,"%"]})]})]})}),n.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Vr,{className:"h-8 w-8 text-purple-600"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Status"}),n.jsx("p",{className:"text-lg font-bold text-purple-600 capitalize",children:z.status})]})]})})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Gate Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Location:"}),n.jsx("span",{className:"ml-2",children:z.location_description||"No description"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"GPS Coordinates:"}),n.jsxs("span",{className:"ml-2",children:[(Ca=z.latitude)==null?void 0:Ca.toFixed(6),", ",(Bs=z.longitude)==null?void 0:Bs.toFixed(6)]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Created:"}),n.jsx("span",{className:"ml-2",children:new Date(z.created_at).toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Gate ID:"}),n.jsx("span",{className:"ml-2 font-mono text-xs",children:z.id})]})]})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(bt,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Live Monitoring"}),n.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Real-time check-in monitoring, performance analytics, and alert notifications would be displayed here. This includes scan rates, success/failure ratios, and connection status."})]})]})})]}),n.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 bg-gray-50 border-t",children:[n.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Close"}),n.jsx("button",{onClick:()=>alert("Export gate data functionality would be implemented here"),className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Export Data"})]})]})})]})},Xn={async getUserOrganizations(){const{data:{user:e}}=await B.auth.getUser();if(!e)throw new Error("Not authenticated");const{data:t,error:r}=await B.from("organizations").select(`
        *,
        organization_members!inner(user_id, role, status)
      `).eq("organization_members.user_id",e.id).eq("organization_members.status","active").order("created_at",{ascending:!1});if(r)throw r;return t},async getOrganization(e){const{data:t,error:r}=await B.from("organizations").select("*").eq("id",e).single();if(r)throw r;return t},async getOrganizationWithSettings(e){const[t,r]=await Promise.all([this.getOrganization(e),this.getOrganizationSettings(e)]);return{organization:t,settings:r}},async createOrganization(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("Not authenticated");const{data:r,error:s}=await B.from("organizations").insert({...e,created_by:t.id}).select().single();if(s)throw s;const{error:a}=await B.from("organization_members").insert({organization_id:r.id,user_id:t.id,role:"owner",status:"active"});if(a)throw a;const{error:i}=await B.from("organization_settings").insert({organization_id:r.id});if(i)throw i;return r},async updateOrganization(e,t){const{data:r,error:s}=await B.from("organizations").update(t).eq("id",e).select().single();if(s)throw s;return r},async deleteOrganization(e){const{error:t}=await B.from("organizations").delete().eq("id",e);if(t)throw t},async getOrganizationMembers(e){const{data:t,error:r}=await B.from("organization_members").select(`
        *,
        user:profiles!organization_members_user_id_fkey(id, email, full_name)
      `).eq("organization_id",e).order("created_at",{ascending:!1});if(r)throw r;return t},async getUserMembership(e){const{data:{user:t}}=await B.auth.getUser();if(!t)return null;const{data:r,error:s}=await B.from("organization_members").select("*").eq("organization_id",e).eq("user_id",t.id).single();if(s){if(s.code==="PGRST116")return null;throw s}return r},async inviteMember(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("Not authenticated");const{data:r}=await B.from("profiles").select("id").eq("email",e.email).single();if(!r)throw new Error("User not found. They must create an account first.");const{error:s}=await B.from("organization_members").insert({organization_id:e.organization_id,user_id:r.id,role:e.role,permissions:e.permissions||{},status:"invited",invited_by:t.id,invited_at:new Date().toISOString()});if(s)throw s;try{await B.from("notifications").insert({user_id:r.id,type:"organization_invite",title:"Organization Invitation",message:"You've been invited to join an organization",data:{organization_id:e.organization_id,role:e.role,invited_by:t.id},read:!1})}catch(a){console.error("Failed to create notification:",a)}},async updateMemberRole(e,t,r){const{error:s}=await B.from("organization_members").update({role:r}).eq("organization_id",e).eq("user_id",t);if(s)throw s},async removeMember(e,t){const{error:r}=await B.from("organization_members").delete().eq("organization_id",e).eq("user_id",t);if(r)throw r},async acceptInvitation(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("Not authenticated");const{error:r}=await B.from("organization_members").update({status:"active",joined_at:new Date().toISOString()}).eq("organization_id",e).eq("user_id",t.id).eq("status","invited");if(r)throw r},async getOrganizationSettings(e){const{data:t,error:r}=await B.from("organization_settings").select("*").eq("organization_id",e).single();if(r)throw r;return t},async updateOrganizationSettings(e,t){const{data:r,error:s}=await B.from("organization_settings").update(t).eq("organization_id",e).select().single();if(s)throw s;return r},async toggleFeature(e,t,r){const a={...(await this.getOrganizationSettings(e)).features,[t]:r};await this.updateOrganizationSettings(e,{features:a})},async hasRole(e,t){const r=await this.getUserMembership(e);return r?t.includes(r.role):!1},async isAdmin(e){return this.hasRole(e,["owner","admin"])},async getCurrentOrganization(){const e=await this.getUserOrganizations();if(e.length===0)return null;const t=localStorage.getItem("current_organization_id");if(t){const r=e.find(s=>s.id===t);if(r)return r}return e[0]},async setCurrentOrganization(e){const{secureStorage:t}=await as(async()=>{const{secureStorage:r}=await import("./secureStorage-BLm_y47z.js");return{secureStorage:r}},[]);t.setItem("current_organization_id",e,{encrypt:!0,expiry:7*24*60*60*1e3})}},G1=x.createContext(void 0),qd=()=>{const e=x.useContext(G1);if(!e)throw new Error("useOrganization must be used within OrganizationProvider");return e},XU=({children:e})=>{const[t,r]=x.useState(null),[s,a]=x.useState(null),[i,l]=x.useState([]),[c,d]=x.useState(!0),f=async()=>{try{d(!0);const g="00000000-0000-4000-8000-000000000001";try{const v=await Xn.getOrganization(g),j=await Xn.getUserMembership(g);l([v]),r(v),a(j)}catch(v){console.warn("Default organization not found, using fallback:",v);const j={id:g,name:"QuickStrap Admin",slug:"quickstrap-admin",description:"Admin portal organization",logo_url:null,website:null,primary_color:"#3B82F6",secondary_color:"#1E40AF",custom_domain:null,subscription_tier:"enterprise",max_events:999999,max_wristbands:999999,max_team_members:999999,settings:{},created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by:null};l([j]),r(j),a(null)}}catch(g){console.error("Failed to load organization:",g)}finally{d(!1)}},h=g=>{const v=i.find(j=>j.id===g);v&&(r(v),Xn.setCurrentOrganization(g),Xn.getUserMembership(g).then(a))},m=async()=>{await f()};return x.useEffect(()=>{f()},[]),n.jsx(G1.Provider,{value:{currentOrganization:t,userMembership:s,allOrganizations:i,loading:c,switchOrganization:h,refreshOrganization:m},children:e})},JU=()=>{const{currentOrganization:e}=qd(),[t,r]=x.useState(1),[s,a]=x.useState(!1),[i,l]=x.useState({startDate:"",endDate:""}),[c,d]=x.useState({name:"",description:"",location:"",start_date:"",end_date:"",capacity:null,config:{security_mode:"optional",gate_settings:{auto_create:!0,enforce_categories:!1,scan_mode:"single"},capacity_settings:{alerts_enabled:!0,alert_threshold:90,max_capacity:null},checkin_window:{enabled:!1,start_time:null,end_time:null},activation:{status:"draft"}}}),f=[{id:1,title:"Basic Information",icon:On},{id:2,title:"Security Settings",icon:jr},{id:3,title:"Gate Configuration",icon:oi},{id:4,title:"Capacity & Alerts",icon:lt},{id:5,title:"Check-in Window",icon:Vr},{id:6,title:"Activation & Launch",icon:oi}],h=()=>{const N=new Date,P=N.getFullYear(),O=String(N.getMonth()+1).padStart(2,"0"),T=String(N.getDate()).padStart(2,"0"),A=String(N.getHours()).padStart(2,"0"),C=String(N.getMinutes()).padStart(2,"0");return`${P}-${O}-${T}T${A}:${C}`},m=N=>N?new Date(N)<new Date?(l(T=>({...T,startDate:"Start date cannot be in the past"})),!1):(l(T=>({...T,startDate:""})),!0):(l(T=>({...T,startDate:""})),!0),g=(N,P)=>{if(!N)return l(A=>({...A,endDate:""})),!0;if(!P)return l(A=>({...A,endDate:"Please set a start date first"})),!1;const O=new Date(N),T=new Date(P);return O<=T?(l(A=>({...A,endDate:"End date must be after start date"})),!1):(l(A=>({...A,endDate:""})),!0)},v=N=>{d({...c,start_date:N}),m(N),c.end_date&&g(c.end_date,N)},j=N=>{d({...c,end_date:N}),g(N,c.start_date)},_=()=>{if(t===1){const N=m(c.start_date),P=g(c.end_date,c.start_date);if(!N||!P)return;if(!c.name.trim()){alert("Please enter an event name");return}if(!c.location.trim()){alert("Please enter an event location");return}if(!c.start_date){alert("Please select a start date");return}if(!c.end_date){alert("Please select an end date");return}}if(t===6){if(c.config.activation.status==="scheduled"&&!c.config.activation.scheduled_time){alert("Please select a scheduled activation time");return}if(c.config.activation.status==="scheduled"&&c.config.activation.scheduled_time&&new Date(c.config.activation.scheduled_time)<=new Date){alert("Scheduled activation time must be in the future");return}}t<f.length&&r(t+1)},y=()=>{t>1&&r(t-1)},w=async()=>{var N;try{a(!0),console.log("Creating event:",c);const P="00000000-0000-4000-8000-000000000001",O=(e==null?void 0:e.id)||P,{data:T,error:A}=await B.from("events").insert([{name:c.name,description:c.description,location:c.location,start_date:c.start_date,end_date:c.end_date,capacity:c.capacity||0,is_active:c.config.activation.status==="active",config:c.config,organization_id:O,lifecycle_status:"draft",created_by:(N=(await B.auth.getUser()).data.user)==null?void 0:N.id}]).select().single();if(A){console.error("Error creating event:",A),alert("Error creating event: "+A.message);return}console.log("Event created successfully:",T),alert("Event created successfully!"),T!=null&&T.id?window.location.href=`/events/${T.id}`:window.location.href="/events"}catch(P){console.error("Error creating event:",P),alert("Error creating event. Please try again.")}finally{a(!1)}},k=()=>{var N,P,O,T;switch(t){case 1:return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Event Details"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Name *"}),n.jsx("input",{type:"text",value:c.name,onChange:A=>d({...c,name:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"MEATINGS, MEAT, FRIENDS & VIBES"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location *"}),n.jsx("input",{type:"text",value:c.location,onChange:A=>d({...c,location:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Main Venue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),n.jsx("input",{type:"datetime-local",value:c.start_date,min:h(),onChange:A=>v(A.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${i.startDate?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`}),i.startDate&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.startDate})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date *"}),n.jsx("input",{type:"datetime-local",value:c.end_date,min:c.start_date||h(),onChange:A=>j(A.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${i.endDate?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`}),i.endDate&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.endDate})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),n.jsx("textarea",{value:c.description,onChange:A=>d({...c,description:A.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Event description..."})]})]});case 2:return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Security Configuration"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Ticket Linking Mode"}),n.jsx("div",{className:"space-y-3",children:[{value:"disabled",label:"Disabled",desc:"No ticket validation required"},{value:"optional",label:"Optional",desc:"Ticket linking available but not required"},{value:"required",label:"Required",desc:"All check-ins must link to valid tickets"}].map(A=>n.jsxs("div",{className:"flex items-start",children:[n.jsx("input",{type:"radio",id:A.value,name:"security_mode",value:A.value,checked:c.config.security_mode===A.value,onChange:C=>d({...c,config:{...c.config,security_mode:C.target.value}}),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("label",{htmlFor:A.value,className:"block text-sm font-medium text-gray-700",children:A.label}),n.jsx("p",{className:"text-sm text-gray-500",children:A.desc})]})]},A.value))})]})]});case 3:return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Gate Behavior Settings"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Auto-create Gates"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Automatically create gates from scan patterns"})]}),n.jsx("input",{type:"checkbox",checked:c.config.gate_settings.auto_create,onChange:A=>d({...c,config:{...c.config,gate_settings:{...c.config.gate_settings,auto_create:A.target.checked}}}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enforce Category-Gate Assignments"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Restrict categories to specific gates"})]}),n.jsx("input",{type:"checkbox",checked:c.config.gate_settings.enforce_categories,onChange:A=>d({...c,config:{...c.config,gate_settings:{...c.config.gate_settings,enforce_categories:A.target.checked}}}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Scan Mode"}),n.jsxs("select",{value:c.config.gate_settings.scan_mode,onChange:A=>d({...c,config:{...c.config,gate_settings:{...c.config.gate_settings,scan_mode:A.target.value}}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"single",children:"Single Tap"}),n.jsx("option",{value:"continuous",children:"Continuous Scanning"})]})]})]})]});case 4:return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Capacity & Alerts"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Capacity"}),n.jsx("input",{type:"number",value:c.capacity||"",onChange:A=>{const C=A.target.value.trim(),E=C&&!isNaN(Number(C))?parseInt(C):null;d({...c,capacity:E,config:{...c.config,capacity_settings:{...c.config.capacity_settings,max_capacity:E}}})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"500"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enable Capacity Alerts"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Get notified when approaching capacity"})]}),n.jsx("input",{type:"checkbox",checked:c.config.capacity_settings.alerts_enabled,onChange:A=>d({...c,config:{...c.config,capacity_settings:{...c.config.capacity_settings,alerts_enabled:A.target.checked}}}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]}),c.config.capacity_settings.alerts_enabled&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alert Threshold (%)"}),n.jsx("input",{type:"number",min:"1",max:"100",value:c.config.capacity_settings.alert_threshold,onChange:A=>{const C=A.target.value.trim(),E=C&&!isNaN(Number(C))?parseInt(C):90;d({...c,config:{...c.config,capacity_settings:{...c.config.capacity_settings,alert_threshold:E}}})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]});case 5:return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Check-in Window"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enable Check-in Window"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Restrict check-ins to specific time period"})]}),n.jsx("input",{type:"checkbox",checked:c.config.checkin_window.enabled,onChange:A=>d({...c,config:{...c.config,checkin_window:{...c.config.checkin_window,enabled:A.target.checked}}}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]}),c.config.checkin_window.enabled&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Check-in Window Start Time"}),n.jsx("p",{className:"text-sm text-gray-500",children:"How long before the event start time should check-ins open?"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("select",{value:((N=c.config.checkin_window.start_time)==null?void 0:N.split(" ")[0])||"1",onChange:A=>{var D;const C=A.target.value,E=((D=c.config.checkin_window.start_time)==null?void 0:D.split(" ")[1])||"hours";d({...c,config:{...c.config,checkin_window:{...c.config.checkin_window,start_time:`${C} ${E}`}}})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[1,2,3,4,5,6,7,8,9,10,12,24,48,72].map(A=>n.jsx("option",{value:A,children:A},A))}),n.jsxs("select",{value:((P=c.config.checkin_window.start_time)==null?void 0:P.split(" ")[1])||"hours",onChange:A=>{var D;const C=((D=c.config.checkin_window.start_time)==null?void 0:D.split(" ")[0])||"1",E=A.target.value;d({...c,config:{...c.config,checkin_window:{...c.config.checkin_window,start_time:`${C} ${E}`}}})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"hours",children:"Hours"}),n.jsx("option",{value:"days",children:"Days"})]})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"before event starts"})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Check-in Window End Time"}),n.jsx("p",{className:"text-sm text-gray-500",children:"How long after the event start time should check-ins close?"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("select",{value:((O=c.config.checkin_window.end_time)==null?void 0:O.split(" ")[0])||"2",onChange:A=>{var D;const C=A.target.value,E=((D=c.config.checkin_window.end_time)==null?void 0:D.split(" ")[1])||"hours";d({...c,config:{...c.config,checkin_window:{...c.config.checkin_window,end_time:`${C} ${E}`}}})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[1,2,3,4,5,6,7,8,9,10,12,24,48,72].map(A=>n.jsx("option",{value:A,children:A},A))}),n.jsxs("select",{value:((T=c.config.checkin_window.end_time)==null?void 0:T.split(" ")[1])||"hours",onChange:A=>{var D;const C=((D=c.config.checkin_window.end_time)==null?void 0:D.split(" ")[0])||"2",E=A.target.value;d({...c,config:{...c.config,checkin_window:{...c.config.checkin_window,end_time:`${C} ${E}`}}})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"hours",children:"Hours"}),n.jsx("option",{value:"days",children:"Days"})]})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"after event starts"})]})]})]}),c.config.checkin_window.enabled&&n.jsx("div",{className:"mt-4",children:n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(Vr,{className:"h-5 w-5 text-blue-600 mt-0.5"})}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Check-in Window Summary"}),n.jsxs("div",{className:"mt-1 text-sm text-blue-700",children:[n.jsx("p",{children:"Check-ins will be available:"}),n.jsxs("ul",{className:"mt-1 space-y-1",children:[n.jsxs("li",{children:[" Opens: ",c.config.checkin_window.start_time||"1 hours"," before event starts"]}),n.jsxs("li",{children:[" Closes: ",c.config.checkin_window.end_time||"2 hours"," after event starts"]})]})]})]})]})})})]})]});case 6:return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Event Activation & Launch"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Event Status"}),n.jsx("div",{className:"space-y-3",children:[{value:"draft",label:"Draft",desc:"Save as draft - not visible to attendees, no check-ins allowed"},{value:"scheduled",label:"Scheduled",desc:"Schedule for automatic activation at a specific time"},{value:"active",label:"Active Now",desc:"Make event live immediately - check-ins enabled"}].map(A=>n.jsxs("div",{className:"flex items-start",children:[n.jsx("input",{type:"radio",id:A.value,name:"event_status",value:A.value,checked:c.config.activation.status===A.value,onChange:C=>d({...c,config:{...c.config,activation:{...c.config.activation,status:C.target.value}}}),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("label",{htmlFor:A.value,className:"block text-sm font-medium text-gray-700",children:A.label}),n.jsx("p",{className:"text-sm text-gray-500",children:A.desc})]})]},A.value))})]}),c.config.activation.status==="scheduled"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled Activation Time"}),n.jsx("input",{type:"datetime-local",value:c.config.activation.scheduled_time||"",min:h(),onChange:A=>d({...c,config:{...c.config,activation:{...c.config.activation,scheduled_time:A.target.value}}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Event will automatically become active at this time"})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(On,{className:"h-5 w-5 text-blue-600 mt-0.5"})}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Ready to Launch!"}),n.jsxs("div",{className:"mt-1 text-sm text-blue-700",children:[n.jsxs("p",{children:['Your event "',c.name,'" is configured and ready.']}),n.jsxs("ul",{className:"mt-2 space-y-1",children:[n.jsxs("li",{children:[" ",c.config.activation.status==="draft"?"Will be saved as draft":c.config.activation.status==="scheduled"?"Will be scheduled for activation":"Will go live immediately"]}),n.jsxs("li",{children:[" Security mode: ",c.config.security_mode]}),n.jsxs("li",{children:[" Capacity: ",c.capacity?c.capacity.toLocaleString():"Unlimited"]})]})]})]})]})})]})]});default:return null}};return n.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[n.jsx("div",{className:"mb-8",children:n.jsx("div",{className:"flex items-center justify-between",children:f.map((N,P)=>{const O=N.icon,T=t>N.id,A=t===N.id;return n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${T?"bg-green-500 border-green-500 text-white":A?"bg-blue-500 border-blue-500 text-white":"bg-white border-gray-300 text-gray-400"}`,children:T?n.jsx($C,{className:"w-5 h-5"}):n.jsx(O,{className:"w-5 h-5"})}),n.jsx("div",{className:"ml-3",children:n.jsx("p",{className:`text-sm font-medium ${A?"text-blue-600":T?"text-green-600":"text-gray-500"}`,children:N.title})}),P<f.length-1&&n.jsx("div",{className:`flex-1 h-0.5 mx-4 ${T?"bg-green-500":"bg-gray-300"}`})]},N.id)})})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 min-h-96",children:k()}),n.jsxs("div",{className:"flex justify-between mt-6",children:[n.jsxs("button",{onClick:y,disabled:t===1,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(zC,{className:"w-4 h-4 mr-1"}),"Previous"]}),t===f.length?n.jsx("button",{onClick:w,disabled:s,className:"flex items-center px-6 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):"Create Event"}):n.jsxs("button",{onClick:_,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:["Next",n.jsx(BC,{className:"w-4 h-4 ml-1"})]})]})]})},QU=()=>n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New Event"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Configure your event settings before launch"})]}),n.jsx(JU,{})]})}),hr=[];for(let e=0;e<256;++e)hr.push((e+256).toString(16).slice(1));function e9(e,t=0){return(hr[e[t+0]]+hr[e[t+1]]+hr[e[t+2]]+hr[e[t+3]]+"-"+hr[e[t+4]]+hr[e[t+5]]+"-"+hr[e[t+6]]+hr[e[t+7]]+"-"+hr[e[t+8]]+hr[e[t+9]]+"-"+hr[e[t+10]]+hr[e[t+11]]+hr[e[t+12]]+hr[e[t+13]]+hr[e[t+14]]+hr[e[t+15]]).toLowerCase()}let th;const t9=new Uint8Array(16);function r9(){if(!th){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");th=crypto.getRandomValues.bind(crypto)}return th(t9)}const n9=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),hy={randomUUID:n9};function H1(e,t,r){var a;if(hy.randomUUID&&!e)return hy.randomUUID();e=e||{};const s=e.random??((a=e.rng)==null?void 0:a.call(e))??r9();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,e9(s)}const V1={position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"light"},s9={critical:console.error,error:console.error,warning:console.warn,info:console.info,success:console.log,debug:console.debug},K1=(e,t,r)=>{const s=s9[e]||console.info;typeof s=="function"&&s(`[${e.toUpperCase()}] ${t}`,r||"")},Va=(e,t="info")=>{const r={id:H1(),timestamp:new Date,read:!1,category:"system",severity:t,message:e.message,origin:e.origin||"app",code:e.code,context:e.context,logToConsole:e.logToConsole??!0,showInUI:e.showInUI??!0,toastOptions:{...V1,...e.toastOptions,type:Y1(t)}};return r.logToConsole&&K1(t,r.message,r.context),r.showInUI&&ge(r.message,r.toastOptions),r},Z1=(e,t="info")=>{const r={id:H1(),timestamp:new Date,read:!1,category:"functional",severity:t,entity:e.entity,operation:e.operation,message:e.message,origin:e.origin||"app",technicalDetails:e.technicalDetails,data:e.data,context:e.context,logToConsole:e.logToConsole??!0,showInUI:e.showInUI??!0,toastOptions:{...V1,...e.toastOptions,type:Y1(t),"data-entity":e.entity,"data-operation":e.operation}};return r.logToConsole&&K1(t,`[${r.entity}.${r.operation}] ${r.message}`,r.context),r.showInUI&&ge(r.message,r.toastOptions),r},Xs=(e,t,r,s={})=>Z1({...s,entity:t,operation:e,message:r},s.severity),Y1=e=>{switch(e){case"success":return"success";case"error":case"critical":return"error";case"warning":return"warning";case"info":case"debug":default:return"info"}},a9=e=>{},kr={system:e=>{if(!e.message)throw new Error("System notification requires a message");return Va({...e,severity:"severity"in e?e.severity:"info"})},functional:e=>{if(!e.message||!e.entity||!e.operation)throw new Error("Functional notification requires message, entity, and operation");return Z1({...e,severity:"severity"in e?e.severity:"info"})},success:(e,t={origin:"app"})=>Va({...t,message:e}),error:(e,t,r={origin:"app"})=>{const s=t instanceof Error?t.message:String(t||e);return Va({...r,message:t?`${e}: ${s}`:e,context:{...r.context||{},error:t instanceof Error?t:new Error(s)},origin:r.origin||"app"})},warning:(e,t={origin:"app"})=>Va({...t,message:e}),info:(e,t={origin:"app"})=>Va({...t,message:e}),critical:(e,t={origin:"app"})=>Va({...t,message:e}),debug:(e,t={origin:"app"})=>(console.debug(`[DEBUG] ${e}`,t),null),operation:{create:(e,t,r={})=>Xs("create",e,t,r),read:(e,t,r={})=>Xs("read",e,t,r),update:(e,t,r={})=>Xs("update",e,t,r),delete:(e,t,r={})=>Xs("delete",e,t,r),sync:(e,t,r={})=>Xs("sync",e,t,r),validate:(e,t,r={})=>Xs("validate",e,t,r),process:(e,t,r={})=>Xs("process",e,t,r)},created(e,t,r){return this.operation.create(e,t,{data:r})},read(e,t,r){const s=this.operation.read(e,t,{data:r});return s.markAsRead=a=>a9(),s},markAsRead(e){},updated(e,t,r){return this.operation.update(e,t,{data:r})},deleted(e,t,r){return this.operation.delete(e,t,{data:r})},fetched(e,t,r){return this.functional({entity:e,message:t,data:r,operation:"read",severity:"info"})}},i9=({isEdit:e=!1})=>{const{id:t}=ja(),r=Ef(),{currentOrganization:s}=qd(),[a,i]=x.useState(!1),[l,c]=x.useState({name:"",description:"",start_date:"",end_date:"",location:"",is_public:!1,total_capacity:0,ticket_linking_mode:"disabled",allow_unlinked_entry:!0});x.useEffect(()=>{e&&t&&d()},[t,e]);const d=async()=>{try{i(!0);const{data:m,error:g}=await B.from("events").select("*").eq("id",t).single();if(g)throw g;m&&c(v=>({...v,name:m.name||"",description:m.description||"",location:m.location||"",is_public:m.is_public||!1,total_capacity:m.total_capacity||0,ticket_linking_mode:m.ticket_linking_mode||"disabled",allow_unlinked_entry:m.allow_unlinked_entry!==!1,start_date:m.start_date?new Date(m.start_date).toISOString().slice(0,16):"",end_date:m.end_date?new Date(m.end_date).toISOString().slice(0,16):""}))}catch(m){console.error("Error:",m),ge.error("Failed to load event")}finally{i(!1)}},f=m=>{const{name:g,value:v,type:j}=m.target;let _=j==="checkbox"?m.target.checked:j==="number"?parseInt(v)||0:v;c(y=>{const w={...y,[g]:_};return g==="ticket_linking_mode"&&(v==="disabled"?w.allow_unlinked_entry=!0:v==="required"&&(w.allow_unlinked_entry=!1)),w})},h=async m=>{var j;if(m.preventDefault(),!l.name){kr.error("Please provide a name for the event",void 0,{origin:"app",context:{entity:"event",operation:"create",validation:"required_field",field:"name",technicalDetails:"Validation failed: Event name is required"},toastOptions:{autoClose:5e3}});return}if(!l.start_date){kr.error("Please select a start date for the event",void 0,{origin:"app",context:{entity:"event",operation:"create",validation:"required_field",field:"start_date",technicalDetails:"Validation failed: Start date is required"},toastOptions:{autoClose:5e3}});return}if(!l.end_date){kr.error("Please select an end date for the event",void 0,{origin:"app",context:{entity:"event",operation:"create",validation:"required_field",technicalDetails:"Validation failed: End date is required",field:"end_date"},toastOptions:{autoClose:5e3}});return}const g=new Date(l.start_date),v=new Date(l.end_date);if(isNaN(g.getTime())||isNaN(v.getTime())){kr.error("Please enter valid dates in the correct format",void 0,{origin:"app",context:{entity:"event",operation:"create",technicalDetails:"Validation failed: Invalid date format"},toastOptions:{autoClose:5e3}});return}if(v<=g){kr.error("End date must be after the start date",{origin:"app",context:{entity:"event",operation:"create",technicalDetails:"Validation failed: Invalid date range",showInUI:!0,logToConsole:!0}});return}i(!0);try{const _={...l,start_date:g.toISOString(),end_date:v.toISOString()},{data:y,error:w}=e&&t?await B.from("events").update(_).eq("id",t).select():await B.from("events").insert([{..._,created_by:(j=(await B.auth.getUser()).data.user)==null?void 0:j.id,organization_id:s==null?void 0:s.id}]).select();if(w)throw w.code==="23505"?new Error("An event with this name already exists"):w.code==="42501"?new Error("You do not have permission to perform this action"):w.code==="PGRST116"?new Error("Required fields are missing"):w;if(y&&y.length>0)e?kr.success(`Event "${l.name}" updated successfully`,{origin:"app",context:{entity:"event",operation:"update"}}):kr.success(`Event "${l.name}" created successfully`,{origin:"app",context:{entity:"event",operation:"create"}}),setTimeout(()=>{r("/events",{state:{message:`Event "${l.name}" successfully ${e?"updated":"created"}`,timestamp:Date.now()}})},500);else throw new Error("No data returned from the server")}catch(_){let y="An unknown error occurred",w="";if(_ instanceof Error){if(y=_.message,"code"in _)switch(w=String(_.code),_.code){case"23505":y="An event with this name already exists";break;case"42501":y="You do not have permission to perform this action";break;case"PGRST116":y="Required fields are missing";break}}else typeof _=="string"?y=_:_&&typeof _=="object"&&"message"in _&&(y=String(_.message));const k=`Could not ${e?"update":"create"} event: ${y}`;kr.error(k,{"data-entity":"event","data-operation":e?"update":"create",autoClose:5e3,context:{errorCode:w,errorStack:void 0,formData:void 0}})}finally{i(!1)}};return a&&e?n.jsx("div",{className:"flex justify-center p-8",children:"Loading..."}):n.jsx("div",{className:"max-w-3xl mx-auto p-6",children:n.jsxs("form",{onSubmit:h,className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[n.jsx("h2",{className:"text-xl font-semibold",children:e?"Edit Event":"New Event"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Event Name *"}),n.jsx("input",{type:"text",name:"name",value:l.name,onChange:f,className:"w-full p-2 border rounded",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),n.jsx("textarea",{name:"description",value:l.description,onChange:f,className:"w-full p-2 border rounded",rows:3})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Date/Time *"}),n.jsx("input",{type:"datetime-local",name:"start_date",value:l.start_date,onChange:f,className:"w-full p-2 border rounded",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Date/Time *"}),n.jsx("input",{type:"datetime-local",name:"end_date",value:l.end_date,min:l.start_date,onChange:f,className:"w-full p-2 border rounded",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Location"}),n.jsx("input",{type:"text",name:"location",value:l.location,onChange:f,className:"w-full p-2 border rounded"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",name:"is_public",checked:l.is_public,onChange:f,className:"h-4 w-4 rounded"}),n.jsx("label",{className:"ml-2 text-sm",children:"Make event public"})]}),n.jsxs("div",{className:"border-t pt-6",children:[n.jsx("h3",{className:"text-lg font-medium mb-4",children:"Event Configuration"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Total Capacity"}),n.jsx("input",{type:"number",name:"total_capacity",value:l.total_capacity,onChange:f,className:"w-full p-2 border rounded",min:"0",placeholder:"0 = unlimited"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Set to 0 for unlimited capacity"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ticket Linking Mode"}),n.jsxs("select",{name:"ticket_linking_mode",value:l.ticket_linking_mode,onChange:f,className:"w-full p-2 border rounded",children:[n.jsx("option",{value:"disabled",children:"Disabled - Anyone with wristband can enter"}),n.jsx("option",{value:"optional",children:"Optional - Ticket linking available, entry flexible"}),n.jsx("option",{value:"required",children:"Required - Only linked tickets can enter"})]}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.ticket_linking_mode==="disabled"&&"No guest list validation - any wristband works",l.ticket_linking_mode==="optional"&&"Guest list available but not enforced - you control entry policy below",l.ticket_linking_mode==="required"&&"Strict guest list enforcement - only valid tickets can enter"]})]})]}),l.ticket_linking_mode==="optional"&&n.jsxs("div",{className:"mt-4",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",name:"allow_unlinked_entry",checked:l.allow_unlinked_entry,onChange:f,className:"h-4 w-4 rounded"}),n.jsx("label",{className:"ml-2 text-sm",children:"Allow entry without linked tickets"})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When enabled, attendees can check in even if their wristband isn't linked to a ticket"})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>r(-1),className:"px-4 py-2 border rounded",disabled:a,children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50",disabled:a,children:a?"Saving...":"Save Event"})]})]})})},o9=()=>(ja(),n.jsx(i9,{isEdit:!0})),l9=()=>{const[e,t]=x.useState([]),[r,s]=x.useState([]),[a,i]=x.useState(null),[l,c]=x.useState(""),[d,f]=x.useState(!0);x.useEffect(()=>{h()},[]),x.useEffect(()=>{a?g(a):m()},[a]);const h=async()=>{try{const{data:_,error:y}=await B.from("events").select("id, name").order("start_date",{ascending:!1});if(y)throw y;s(_||[])}catch(_){console.error("Error fetching events:",_)}},m=async()=>{f(!0);try{const{data:_,error:y}=await B.from("event_access").select(`
          id,
          access_level,
          user_id,
          event_id,
          granted_by,
          created_at,
          events (
            name
          )
        `).order("created_at",{ascending:!1});if(y)throw y;if(_&&_.length>0){const w=[...new Set([..._.map(P=>P.user_id),..._.map(P=>P.granted_by).filter(Boolean)])],{data:k}=await B.from("profiles").select("id, email, full_name").in("id",w),N=_.map(P=>({...P,profiles:(k==null?void 0:k.find(O=>O.id===P.user_id))||null,grantedBy:(k==null?void 0:k.find(O=>O.id===P.granted_by))||null}));t(N)}else t([])}catch(_){console.error("Error fetching access list:",_)}finally{f(!1)}},g=async _=>{f(!0);try{const{data:y,error:w}=await B.from("event_access").select(`
          id,
          access_level,
          user_id,
          event_id,
          granted_by,
          created_at,
          events (
            name
          )
        `).eq("event_id",_).order("created_at",{ascending:!1});if(w)throw w;if(y&&y.length>0){const k=[...new Set([...y.map(O=>O.user_id),...y.map(O=>O.granted_by).filter(Boolean)])],{data:N}=await B.from("profiles").select("id, email, full_name").in("id",k),P=y.map(O=>({...O,profiles:(N==null?void 0:N.find(T=>T.id===O.user_id))||null,grantedBy:(N==null?void 0:N.find(T=>T.id===O.granted_by))||null}));t(P)}else t([])}catch(y){console.error("Error fetching access list:",y)}finally{f(!1)}},v=async _=>{if(window.confirm("Are you sure you want to revoke this access?"))try{const{error:y}=await B.from("event_access").delete().eq("id",_);if(y)throw y;t(e.filter(w=>w.id!==_))}catch(y){console.error("Error deleting access:",y),alert("Failed to revoke access. Please try again.")}},j=l?e.filter(_=>{var y,w,k;return((y=_.profiles)==null?void 0:y.email)&&_.profiles.email.toLowerCase().includes(l.toLowerCase())||((w=_.profiles)==null?void 0:w.full_name)&&_.profiles.full_name.toLowerCase().includes(l.toLowerCase())||((k=_.events)==null?void 0:k.name)&&_.events.name.toLowerCase().includes(l.toLowerCase())}):e;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-4 sm:space-y-0",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Access Management"}),n.jsxs(dt,{to:a?`/access/new?event_id=${a}`:"/access/new",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[n.jsx(lt,{size:16,className:"mr-2"}),"Grant Access"]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"event-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Event"}),n.jsxs("select",{id:"event-select",value:a||"",onChange:_=>i(_.target.value||null),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[n.jsx("option",{value:"",children:"All Events"}),r.map(_=>n.jsx("option",{value:_.id,children:_.name},_.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",id:"search",value:l,onChange:_=>c(_.target.value),placeholder:"Search by user or event name...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Dn,{size:18,className:"text-gray-400"})})]})]})]})}),d?n.jsx("div",{className:"animate-pulse",children:[1,2,3].map(_=>n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),n.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4"})]},_))}):j.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Access Level"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted By"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted On"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(_=>{var y,w,k,N,P;return n.jsxs("tr",{children:[n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:((y=_.profiles)==null?void 0:y.full_name)||"Unnamed User"}),n.jsx("div",{className:"text-sm text-gray-500",children:(w=_.profiles)==null?void 0:w.email})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(k=_.events)==null?void 0:k.name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_.access_level==="owner"?"bg-purple-100 text-purple-800":_.access_level==="admin"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:_.access_level})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((N=_.grantedBy)==null?void 0:N.full_name)||((P=_.grantedBy)==null?void 0:P.email)||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(_.created_at).toLocaleDateString()}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx(dt,{to:`/access/${_.id}/edit`,className:"text-blue-600 hover:text-blue-900 mr-4",children:n.jsx(ii,{size:16})}),n.jsx("button",{onClick:()=>v(_.id),className:"text-red-600 hover:text-red-900",children:n.jsx(wn,{size:16})})]})]},_.id)})})]})}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("p",{className:"text-gray-500 text-sm",children:l||a?"No access records found matching your criteria":"No access records found"}),n.jsx(dt,{to:"/access/new",className:"mt-2 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Grant access to users"})]})]})]})},c9=({isEdit:e=!1})=>{const{id:t}=ja(),r=Cf(),s=Ef(),[a,i]=x.useState(!1),[l,c]=x.useState([]),[d,f]=x.useState({user_email:"",event_id:"",role:"scanner"});x.useEffect(()=>{h(),e&&t&&m();const y=new URLSearchParams(r.search).get("event_id");y&&f(w=>({...w,event_id:y}))},[t,e,r.search]);const h=async()=>{try{const{data:y,error:w}=await B.from("events").select("id, name").order("start_date",{ascending:!1});if(w)throw w;c(y||[])}catch(y){console.error("Error fetching events:",y),ge.error("Failed to load events")}},m=async()=>{var y;try{i(!0);const{data:w,error:k}=await B.from("event_access").select("*, user:user_id(id, email)").eq("id",t).single();if(k)throw k;w&&f({user_email:((y=w.user)==null?void 0:y.email)||"",event_id:w.event_id,role:w.role})}catch(w){console.error("Error fetching access:",w),ge.error("Failed to load access data")}finally{i(!1)}},g=y=>{const{name:w,value:k}=y.target,N=w;f(P=>({...P,[N]:k}))},v=async y=>{if(y.preventDefault(),!d.user_email||!d.event_id){ge.error("Please fill in all required fields");return}i(!0);try{const{data:w,error:k}=await B.from("users").select("id").eq("email",d.user_email.trim()).single();if(k||!w)throw new Error("User not found");e&&t?await j(w.id):await _(w.id),s(d.event_id?`/access?event_id=${d.event_id}`:"/access")}catch(w){console.error("Error:",w),ge.error(w.message||"An error occurred")}finally{i(!1)}},j=async y=>{const{error:w}=await B.from("event_access").update({user_id:y,event_id:d.event_id,role:d.role,updated_at:new Date().toISOString()}).eq("id",t);if(w)throw w;ge.success("Access updated successfully")},_=async y=>{var k;const{error:w}=await B.from("event_access").insert([{user_id:y,event_id:d.event_id,role:d.role,created_by:(k=(await B.auth.getUser()).data.user)==null?void 0:k.id}]);if(w)throw w;ge.success("Access granted successfully")};return a&&e?n.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n.jsx("div",{className:"max-w-3xl mx-auto",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:e?"Edit Access":"Grant Access"})}),n.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"user_email",className:"block text-sm font-medium text-gray-700 mb-1",children:["User Email ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"email",id:"user_email",name:"user_email",value:d.user_email,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter user's email",required:!0,disabled:e})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"event_id",className:"block text-sm font-medium text-gray-700 mb-1",children:["Event ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{id:"event_id",name:"event_id",value:d.event_id,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:!!new URLSearchParams(r.search).get("event_id"),children:[n.jsx("option",{value:"",children:"Select an event"}),l.map(y=>n.jsx("option",{value:y.id,children:y.name},y.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:["Role ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{id:"role",name:"role",value:d.role,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:[n.jsx("option",{value:"scanner",children:"Scanner"}),n.jsx("option",{value:"admin",children:"Admin"})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>s(-1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:a,children:"Cancel"}),n.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",disabled:a,children:a?"Saving...":e?"Update Access":"Grant Access"})]})]})]})})},d9=()=>(ja(),n.jsx(c9,{isEdit:!0})),X1=({onClose:e,onComplete:t})=>{const[r,s]=x.useState(0),[a,i]=x.useState({top:0,left:0}),[l,c]=x.useState(null),d=x.useRef(null),f=[{id:"welcome",target:"body",title:"Welcome to QuickStrap NFC Portal! ",description:"Let me show you around. This tour will guide you through every feature in the portal.",position:"bottom",highlightPadding:0},{id:"dashboard",target:'a[href="/"]',title:" Dashboard",description:"Your central command center. View real-time stats, recent activity, and event summaries.",position:"right",highlightPadding:8},{id:"events",target:'a[href="/events"]',title:" Events",description:"Create and manage your events here. Each event has its own wristbands, gates, analytics, and more.",position:"right",highlightPadding:8},{id:"wristbands",target:'a[href="/wristbands"]',title:" Wristbands",description:"Manage all wristbands across all events. Bulk upload CSV files with thousands of wristbands at once.",position:"right",highlightPadding:8},{id:"checkins",target:'a[href="/checkins"]',title:" Check-ins",description:"View all check-in activity across events. Filter by event, date, gate, or wristband category.",position:"right",highlightPadding:8},{id:"access-control",target:'a[href="/access"]',title:" Access Control",description:"Manage team access and permissions. Grant users access to specific events with different permission levels.",position:"right",highlightPadding:8},{id:"analytics-sidebar",target:'a[href="/analytics"]',title:" Analytics",description:"Deep dive into event analytics. View trends, patterns, and comprehensive performance metrics.",position:"right",highlightPadding:8},{id:"reports",target:'a[href="/reports"]',title:" Reports",description:"Generate and download reports. Export data in CSV, PDF, Excel, or JSON formats.",position:"right",highlightPadding:8},{id:"fraud-detection",target:'a[href="/fraud"]',title:" Fraud Detection",description:"AI-powered fraud monitoring. Detect multiple check-ins, impossible locations, and suspicious patterns.",position:"right",highlightPadding:8},{id:"emergency-center",target:'a[href="/emergency"]',title:" Emergency Center",description:"Emergency response controls. Pause check-ins, block categories, broadcast alerts, or trigger evacuation.",position:"right",highlightPadding:8},{id:"autonomous-ops",target:'a[href="/autonomous-operations"]',title:" Autonomous Ops",description:"AI-powered autonomous operations. The system monitors health and makes smart decisions automatically.",position:"right",highlightPadding:8},{id:"organization",target:'a[href="/organization"]',title:" Organization",description:"Manage your organization settings, team members, and billing information.",position:"right",highlightPadding:8},{id:"settings",target:'a[href="/settings"]',title:" Settings",description:"Manage your account, change password, and configure preferences. You can restart this tour from the Help tab.",position:"right",highlightPadding:8},{id:"event-details-intro",target:'a[href="/events"]',title:" Event Details",description:"When you open any event, you'll find powerful tabs for managing every aspect. Let me show you...",position:"right",highlightPadding:8},{id:"live-operations-tab",target:'button[data-tab="command-center"]',title:" Live Operations Tab",description:"Inside each event: Real-time command center for monitoring check-ins, gate performance, and system health during live events.",position:"bottom",highlightPadding:8},{id:"analytics-tab",target:'button[data-tab="analytics"]',title:" Analytics Tab",description:"Inside each event: View event-specific analytics, charts, time-series data, and performance insights.",position:"bottom",highlightPadding:8},{id:"team-access-tab",target:'button[data-tab="access"]',title:" Team Access Tab",description:"Inside each event: Control who can access this specific event and what permissions they have.",position:"bottom",highlightPadding:8},{id:"staff-management",target:'a[href="/events"]',title:" Staff Management",description:"Each event has a Staff tab where you can track performance, monitor activity, and manage gate assignments. Access it from: Events  Open Event  More tabs.",position:"right",highlightPadding:8},{id:"complete",target:"body",title:"You're All Set! ",description:"You now know where every feature is located. Start by creating an event, then explore the tabs inside!",position:"bottom",highlightPadding:0}],h=f[r];x.useEffect(()=>{h.route&&window.location.pathname!==h.route?(window.location.href=h.route,setTimeout(()=>{m()},300)):m()},[r]);const m=()=>{const y=document.querySelector(h.target);if(y){const w=y.getBoundingClientRect();c(w);const k=h.highlightPadding||8,N=400,P=180;let O=0,T=0;switch(h.position){case"right":O=w.top+w.height/2-P/2,T=w.right+k+20;break;case"left":O=w.top+w.height/2-P/2,T=w.left-N-k-20;break;case"top":O=w.top-P-k-20,T=w.left+w.width/2-N/2;break;case"bottom":O=w.bottom+k+20,T=w.left+w.width/2-N/2;break}const A=window.innerWidth,C=window.innerHeight;T+N>A-20&&(T=A-N-20),T<20&&(T=20),O+P>C-20&&(O=C-P-20),O<20&&(O=20),i({top:O,left:T}),y.scrollIntoView({behavior:"smooth",block:"center"})}else i({top:window.innerHeight/2-100,left:window.innerWidth/2-200}),c(null)},g=()=>{r<f.length-1?s(r+1):(j(),t())},v=()=>{j(),e()},j=()=>{localStorage.setItem("onboarding_completed","true"),localStorage.setItem("onboarding_completed_at",new Date().toISOString())},_=(r+1)/f.length*100;return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"fixed inset-0 z-[9998]",style:{pointerEvents:"none"},children:[n.jsxs("svg",{className:"w-full h-full",children:[n.jsx("defs",{children:n.jsxs("mask",{id:"spotlight-mask",children:[n.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"white"}),l&&n.jsx("rect",{x:l.left-(h.highlightPadding||8),y:l.top-(h.highlightPadding||8),width:l.width+(h.highlightPadding||8)*2,height:l.height+(h.highlightPadding||8)*2,rx:"8",fill:"black"})]})}),n.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"rgba(0, 0, 0, 0.7)",mask:"url(#spotlight-mask)"})]}),l&&n.jsx("div",{className:"absolute border-4 border-blue-500 rounded-lg pointer-events-none animate-pulse",style:{top:l.top-(h.highlightPadding||8),left:l.left-(h.highlightPadding||8),width:l.width+(h.highlightPadding||8)*2,height:l.height+(h.highlightPadding||8)*2}})]}),n.jsxs("div",{ref:d,className:"fixed z-[9999] bg-white rounded-xl shadow-2xl border-2 border-blue-500 transition-all duration-300",style:{top:a.top,left:a.left,width:"400px",pointerEvents:"auto"},children:[n.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-4 rounded-t-xl text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-lg font-bold",children:h.title}),n.jsx("button",{onClick:v,className:"text-white hover:text-gray-200 transition",children:n.jsx(Oo,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"w-full bg-blue-800 rounded-full h-1.5",children:n.jsx("div",{className:"bg-white rounded-full h-1.5 transition-all duration-300",style:{width:`${_}%`}})}),n.jsxs("p",{className:"text-xs text-blue-100 mt-1",children:["Step ",r+1," of ",f.length]})]}),n.jsx("div",{className:"p-4",children:n.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:h.description})}),n.jsxs("div",{className:"px-4 pb-4 flex items-center justify-between",children:[n.jsx("button",{onClick:v,className:"text-sm text-gray-500 hover:text-gray-700 transition",children:"Skip Tour"}),n.jsx("button",{onClick:g,className:"px-5 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition flex items-center text-sm",children:r<f.length-1?n.jsxs(n.Fragment,{children:["Next",n.jsx(Xy,{className:"w-4 h-4 ml-2"})]}):n.jsxs(n.Fragment,{children:[n.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Complete"]})})]}),l&&n.jsx("div",{className:"absolute w-0 h-0",style:{...h.position==="right"&&{left:"-10px",top:"50%",transform:"translateY(-50%)",borderTop:"10px solid transparent",borderBottom:"10px solid transparent",borderRight:"10px solid #2563eb"},...h.position==="left"&&{right:"-10px",top:"50%",transform:"translateY(-50%)",borderTop:"10px solid transparent",borderBottom:"10px solid transparent",borderLeft:"10px solid #2563eb"},...h.position==="top"&&{bottom:"-10px",left:"50%",transform:"translateX(-50%)",borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderTop:"10px solid white"},...h.position==="bottom"&&{top:"-10px",left:"50%",transform:"translateX(-50%)",borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderBottom:"10px solid #2563eb"}}})]}),n.jsx("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-[9999] flex space-x-2",children:f.map((y,w)=>n.jsx("div",{className:`w-2 h-2 rounded-full transition-all ${w===r?"bg-blue-600 w-8":w<r?"bg-green-500":"bg-gray-300"}`},y.id))})]})};class u9{async isAdmin(){const{data:{user:t}}=await B.auth.getUser();if(!t)return!1;const{data:r}=await B.from("organization_members").select("role").eq("user_id",t.id).in("role",["owner","admin"]).eq("status","active").single();return!!r}async generateShutdownToken(t=30){if(!await this.isAdmin())throw new Error("Insufficient permissions. Admin access required.");const{data:s,error:a}=await B.rpc("generate_shutdown_token",{p_valid_minutes:t});if(a)throw a;if(!s||s.length===0)throw new Error("Failed to generate token");return{token:s[0].token,expires_at:s[0].expires_at}}async verifyCredentials(t,r){const{data:s,error:a}=await B.rpc("verify_shutdown_credentials",{p_token:t,p_password:r});if(a)throw a;return!s||s.length===0?{verified:!1,message:"Verification failed"}:{verified:s[0].verified,message:s[0].message}}async executeShutdown(t,r="Manual shutdown"){const{data:s,error:a}=await B.rpc("execute_system_shutdown",{p_token:t,p_reason:r});if(a)throw a;if(!s||s.length===0)return{success:!1,message:"Shutdown execution failed"};const i=s[0];return i.success&&await this.broadcastShutdown(r),{success:i.success,message:i.message,shutdown_event_id:i.shutdown_event_id}}async broadcastShutdown(t){var a;const{data:{user:r}}=await B.auth.getUser();await B.from("system_status").update({status:"shutting_down",message:t,updated_by:r==null?void 0:r.id,updated_at:new Date().toISOString()}).eq("id",(a=(await B.from("system_status").select("id").limit(1).single()).data)==null?void 0:a.id);const{data:s}=await B.from("profiles").select("id").limit(1e3);if(s&&s.length>0){const i=s.map(l=>({user_id:l.id,type:"system_shutdown",title:" System Shutdown",message:`System is shutting down: ${t}`,data:{priority:"urgent",action:"shutdown"},read:!1}));await B.from("notifications").insert(i)}}async getSystemStatus(){const{data:t,error:r}=await B.rpc("get_system_status");if(r)throw r;return!t||t.length===0?{status:"operational",message:"System is running normally",updated_at:new Date().toISOString()}:t[0]}subscribeToSystemStatus(t){const r=B.channel("system_status_changes").on("postgres_changes",{event:"*",schema:"public",table:"system_status"},async s=>{const a=s.new;t({status:a.status,message:a.message,updated_at:a.updated_at}),(a.status==="shutting_down"||a.status==="shutdown")&&this.showShutdownNotification(a.message)}).subscribe();return()=>{B.removeChannel(r)}}showShutdownNotification(t){if("Notification"in window&&Notification.permission==="granted"){const r=new Notification(" SYSTEM SHUTDOWN",{body:t,icon:"/logo.png",badge:"/logo.png",requireInteraction:!0,tag:"system-shutdown"});r.onclick=()=>{window.location.reload()}}}async getShutdownHistory(t=50){if(!await this.isAdmin())throw new Error("Insufficient permissions");const{data:s,error:a}=await B.from("system_shutdown_events").select("*").order("created_at",{ascending:!1}).limit(t);if(a)throw a;return s||[]}async cancelShutdown(t,r){var i;if(!await this.isAdmin())throw new Error("Insufficient permissions");const{data:{user:a}}=await B.auth.getUser();await B.from("system_shutdown_events").update({status:"cancelled",completed_at:new Date().toISOString()}).eq("id",t).eq("status","in_progress"),await B.from("system_shutdown_events").insert({event_type:"shutdown_cancelled",initiated_by:a==null?void 0:a.id,reason:r,status:"completed"}),await B.from("system_status").update({status:"operational",message:"System shutdown cancelled",updated_by:a==null?void 0:a.id,updated_at:new Date().toISOString()}).eq("id",(i=(await B.from("system_status").select("id").limit(1).single()).data)==null?void 0:i.id)}async revokeToken(t,r){if(!await this.isAdmin())throw new Error("Insufficient permissions");const{data:{user:a}}=await B.auth.getUser();await B.from("system_shutdown_tokens").update({revoked:!0,revoked_at:new Date().toISOString(),revoked_by:a==null?void 0:a.id,revoke_reason:r}).eq("id",t).eq("used",!1)}}const Ka=new u9,h9=({onShutdownComplete:e})=>{const[t,r]=x.useState(!1),[s,a]=x.useState(!0),[i,l]=x.useState(null),[c,d]=x.useState(!1),[f,h]=x.useState(null),[m,g]=x.useState(!1),[v,j]=x.useState(null),[_,y]=x.useState(""),[w,k]=x.useState(!1),[N,P]=x.useState(""),[O,T]=x.useState(!1),[A,C]=x.useState(!1),[E,D]=x.useState(""),[$,M]=x.useState(!1),[z,K]=x.useState(!1);x.useEffect(()=>{W(),U()},[]),x.useEffect(()=>{const F=Ka.subscribeToSystemStatus(V=>{l(V),(V.status==="shutdown"||V.status==="shutting_down")&&ge.error(` ${V.message}`,{autoClose:!1})});return()=>{F()}},[]),x.useEffect(()=>{if(!v)return;const F=setInterval(()=>{new Date>=v&&(d(!1),h(null),j(null),ge.warning("Shutdown token has expired. Please generate a new one."))},1e3);return()=>clearInterval(F)},[v]);const W=async()=>{try{const F=await Ka.isAdmin();r(F)}catch(F){console.error("Error checking admin status:",F),r(!1)}finally{a(!1)}},U=async()=>{try{const F=await Ka.getSystemStatus();l(F)}catch(F){console.error("Error loading system status:",F)}},Y=async()=>{g(!0);try{const F=await Ka.generateShutdownToken(30);h(F),d(!0),j(new Date(F.expires_at)),ge.success("Shutdown token generated successfully")}catch(F){console.error("Error generating token:",F),ge.error(F.message||"Failed to generate shutdown token")}finally{g(!1)}},R=async()=>{if(!_||!N){ge.error("Please enter both password and token");return}T(!0);try{const F=await Ka.verifyCredentials(N,_);F.verified?(C(!0),ge.success("Credentials verified successfully")):(ge.error(F.message),y(""),P(""))}catch(F){console.error("Error verifying credentials:",F),ge.error(F.message||"Failed to verify credentials"),y(""),P("")}finally{T(!1)}},H=async()=>{if(!E.trim()){ge.error("Please provide a reason for shutdown");return}if(window.confirm(` CRITICAL ACTION

This will shut down the entire system including the portal and mobile app.
All users will be disconnected.

Are you absolutely sure you want to proceed?`)){M(!0);try{const F=await Ka.executeShutdown(N||(f==null?void 0:f.token)||"",E);F.success?(K(!0),ge.success("System shutdown initiated",{autoClose:!1}),setTimeout(()=>{e&&e()},3e3)):ge.error(F.message)}catch(F){console.error("Error executing shutdown:",F),ge.error(F.message||"Failed to execute shutdown")}finally{M(!1)}}},J=()=>{if(!v)return"";const F=new Date,V=v.getTime()-F.getTime();if(V<=0)return"Expired";const te=Math.floor(V/6e4),Z=Math.floor(V%6e4/1e3);return`${te}:${Z.toString().padStart(2,"0")}`};return s?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"})}):t?z?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx(Tt,{className:"w-20 h-20 text-red-500 mx-auto mb-4 animate-pulse"}),n.jsx("h2",{className:"text-3xl font-bold text-red-600 mb-2",children:"System Shutdown Initiated"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"The system is now shutting down..."}),n.jsx("div",{className:"text-sm text-gray-500",children:"All users have been notified."})]}):n.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[n.jsx("div",{className:"bg-red-50 border-2 border-red-500 rounded-lg p-6",children:n.jsxs("div",{className:"flex items-start space-x-4",children:[n.jsx(bt,{className:"w-12 h-12 text-red-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-2xl font-bold text-red-900 mb-2",children:"Emergency System Shutdown"}),n.jsx("p",{className:"text-red-800",children:"This will immediately shut down the entire system including the portal and all mobile applications. All users will be disconnected. This action should only be used in emergencies."})]})]})}),i&&n.jsx("div",{className:`p-4 rounded-lg border-2 ${i.status==="operational"?"bg-green-50 border-green-500":i.status==="maintenance"?"bg-yellow-50 border-yellow-500":"bg-red-50 border-red-500"}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"font-semibold",children:["Current Status: ",i.status.toUpperCase()]}),n.jsx("p",{className:"text-sm",children:i.message})]}),n.jsx("div",{className:`w-4 h-4 rounded-full ${i.status==="operational"?"bg-green-500":i.status==="maintenance"?"bg-yellow-500":"bg-red-500 animate-pulse"}`})]})}),n.jsxs("div",{className:`bg-white rounded-lg shadow-lg border-2 ${c?"border-green-500":"border-gray-300"} p-6`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${c?"bg-green-500":"bg-gray-300"}`,children:c?n.jsx(Tt,{className:"w-6 h-6 text-white"}):n.jsx("span",{className:"text-white font-bold",children:"1"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Generate Shutdown Token"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Generate a one-time security token"})]})]}),c&&v&&n.jsxs("div",{className:"flex items-center space-x-2 text-orange-600",children:[n.jsx(Vr,{className:"w-5 h-5"}),n.jsx("span",{className:"font-mono font-bold",children:J()})]})]}),c?n.jsx("div",{className:"space-y-3",children:n.jsxs("div",{className:"p-4 bg-green-50 border border-green-300 rounded-lg",children:[n.jsx("p",{className:"text-sm font-medium text-green-900 mb-2",children:"Your Shutdown Token:"}),n.jsx("div",{className:"font-mono text-lg font-bold text-green-700 break-all bg-white p-3 rounded border border-green-300",children:f==null?void 0:f.token}),n.jsx("p",{className:"text-xs text-green-700 mt-2",children:" Store this token securely. You will need it in the next step."})]})}):n.jsx("button",{onClick:Y,disabled:m,className:"w-full px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:m?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),n.jsx("span",{children:"Generating..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(YC,{className:"w-5 h-5"}),n.jsx("span",{children:"Generate Token"})]})})]}),n.jsxs("div",{className:`bg-white rounded-lg shadow-lg border-2 ${A?"border-green-500":c?"border-gray-300":"border-gray-200 opacity-50"} p-6`,children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[n.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${A?"bg-green-500":c?"bg-gray-300":"bg-gray-200"}`,children:A?n.jsx(Tt,{className:"w-6 h-6 text-white"}):n.jsx("span",{className:"text-white font-bold",children:"2"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Verify Credentials"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Enter your password and the shutdown token"})]})]}),c&&!A&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administrator Password"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:w?"text":"password",value:_,onChange:F=>y(F.target.value),placeholder:"Enter your password",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 pr-10",disabled:O}),n.jsx("button",{type:"button",onClick:()=>k(!w),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:w?n.jsx(Jy,{className:"w-5 h-5"}):n.jsx(us,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shutdown Token"}),n.jsx("input",{type:"text",value:N,onChange:F=>P(F.target.value),placeholder:"Paste the shutdown token",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 font-mono",disabled:O})]}),n.jsx("button",{onClick:R,disabled:O||!_||!N,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:O?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),n.jsx("span",{children:"Verifying..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(wh,{className:"w-5 h-5"}),n.jsx("span",{children:"Verify Credentials"})]})})]}),A&&n.jsxs("div",{className:"p-4 bg-green-50 border border-green-300 rounded-lg flex items-center space-x-3",children:[n.jsx(Tt,{className:"w-6 h-6 text-green-600"}),n.jsx("span",{className:"text-green-800 font-medium",children:"Credentials verified successfully"})]})]}),n.jsxs("div",{className:`bg-white rounded-lg shadow-lg border-2 ${A?"border-red-500":"border-gray-200 opacity-50"} p-6`,children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[n.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${A?"bg-red-500":"bg-gray-200"}`,children:n.jsx("span",{className:"text-white font-bold",children:"3"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Execute Shutdown"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Provide a reason and confirm shutdown"})]})]}),A&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shutdown Reason *"}),n.jsx("textarea",{value:E,onChange:F=>D(F.target.value),placeholder:"Enter the reason for system shutdown...",rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",disabled:$})]}),n.jsx("div",{className:"bg-red-50 border border-red-300 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx(bt,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-1"}),n.jsxs("div",{className:"text-sm text-red-800",children:[n.jsx("p",{className:"font-bold mb-2",children:" WARNING: This action cannot be undone!"}),n.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[n.jsx("li",{children:"All portal and app users will be immediately disconnected"}),n.jsx("li",{children:"All active sessions will be terminated"}),n.jsx("li",{children:"All check-in operations will be stopped"}),n.jsx("li",{children:"System will require manual restart to resume operations"})]})]})]})}),n.jsx("button",{onClick:H,disabled:$||!E.trim(),className:"w-full px-6 py-4 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 text-lg font-bold",children:$?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),n.jsx("span",{children:"SHUTTING DOWN..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Gc,{className:"w-6 h-6"}),n.jsx("span",{children:"EXECUTE SYSTEM SHUTDOWN"})]})})]})]})]}):n.jsxs("div",{className:"p-8 text-center",children:[n.jsx(jr,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),n.jsx("p",{className:"text-gray-600",children:"You must be an administrator to access system shutdown controls."})]})},f9=()=>{const[e,t]=x.useState(!1),[r,s]=x.useState(!1),[a,i]=x.useState("account"),[l,c]=x.useState(!1),[,d]=x.useState(null),[f,h]=x.useState({email:"",full_name:"",phone:""}),[m,g]=x.useState({emailNotifications:!0,smsNotifications:!1,telegramNotifications:!0,capacityAlerts:!0,securityAlerts:!0,staffUpdates:!1,systemMaintenance:!0,weeklyReports:!0}),[v,j]=x.useState({twoFactorEnabled:!1,sessionTimeout:30,loginNotifications:!0,ipWhitelist:"",apiKeyRotation:"monthly"}),[_,y]=x.useState({theme:"light",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",currency:"USD",autoSave:!0,debugMode:!1,analyticsEnabled:!0}),[w,k]=x.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[N,P]=x.useState({current:!1,new:!1,confirm:!1});x.useEffect(()=>{O()},[]);const O=async()=>{try{t(!0);const{data:{user:$}}=await B.auth.getUser();if(!$)throw new Error("No user found");const{data:M,error:z}=await B.from("profiles").select("*").eq("id",$.id).single();if(z)throw z;d(M),h({full_name:M.full_name||"",email:M.email||"",phone:M.phone||""})}catch($){console.error("Error fetching profile:",$),kr.error("Failed to load profile",{operation:"read",severity:"error",technicalDetails:"Failed to fetch profile data",context:{component:"SettingsPage",action:"fetchProfile",error:$ instanceof Error?$:new Error("Unknown error fetching profile")},toastOptions:{autoClose:1e4}})}finally{t(!1)}},T=$=>{const{name:M,value:z}=$.target;h(K=>({...K,[M]:z}))},A=$=>{const{name:M,value:z}=$.target;k(K=>({...K,[M]:z}))},C=async $=>{$.preventDefault();try{t(!0);const{data:{user:M}}=await B.auth.getUser();if(!M)throw new Error("No user found");const{error:z}=await B.from("profiles").update({full_name:f.full_name,phone:f.phone,updated_at:new Date().toISOString()}).eq("id",M.id);if(z)throw z;if(f.email!==M.email){const{error:K}=await B.auth.updateUser({email:f.email},{emailRedirectTo:`${window.location.origin}/settings`});if(K)throw K}await O(),kr.success("Profile updated successfully",{origin:"app",context:{}})}catch(M){console.error("Error updating profile:",M),kr.error("Could not update profile",void 0,{origin:"app",context:{}})}finally{t(!1)}},E=async $=>{if($.preventDefault(),w.newPassword!==w.confirmPassword){kr.error("New password and confirmation do not match",{origin:"app",context:{}});return}if(w.newPassword.length<8){kr.error("Password must be at least 8 characters long",{origin:"app",context:{}});return}try{if(s(!0),w.currentPassword){const{error:K}=await B.auth.signInWithPassword({email:f.email||"",password:w.currentPassword});if(K)throw new Error("Current password is incorrect")}const{error:M}=await B.auth.updateUser({password:w.newPassword});if(M)throw M;k({currentPassword:"",newPassword:"",confirmPassword:""});const{error:z}=await B.auth.signOut();if(z)throw z;kr.success("Successfully signed out",{origin:"app",context:{}})}catch(M){kr.error("Failed to update password",{origin:"settings",context:{entity:"user",operation:"update_password",error:M instanceof Error?M:new Error(String(M))}})}finally{s(!1)}},D=()=>{c(!1)};return e&&!f.email?n.jsx("div",{className:"flex justify-center items-center min-h-screen",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n.jsxs("div",{className:"container mx-auto px-4 py-8",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Settings"}),n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex -mb-px",children:[n.jsx("button",{onClick:()=>i("account"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${a==="account"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,type:"button",children:"Account"}),n.jsx("button",{onClick:()=>i("password"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${a==="password"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,type:"button",children:"Change Password"}),n.jsx("button",{onClick:()=>i("help"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${a==="help"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,type:"button",children:"Help & Onboarding"}),n.jsx("button",{onClick:()=>i("system"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${a==="system"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,type:"button",children:"System"})]})}),n.jsxs("div",{className:"p-6",children:[a==="account"&&n.jsxs("form",{onSubmit:C,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),n.jsx("input",{type:"email",name:"email",id:"email",value:f.email,onChange:T,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:e})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),n.jsx("input",{type:"text",name:"full_name",id:"full_name",value:f.full_name,onChange:T,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:e})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),n.jsx("input",{type:"tel",name:"phone",id:"phone",value:f.phone,onChange:T,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:e})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:e,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:e?"Saving...":"Save Changes"})})]}),a==="password"&&n.jsxs("form",{onSubmit:$=>{$.preventDefault(),E($)},className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),n.jsx("input",{type:"password",name:"currentPassword",id:"currentPassword",value:w.currentPassword,onChange:A,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:r,required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700",children:"New Password"}),n.jsx("input",{type:"password",name:"newPassword",id:"newPassword",value:w.newPassword,onChange:A,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:r,minLength:8,required:!0}),n.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 8 characters long"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),n.jsx("input",{type:"password",name:"confirmPassword",id:"confirmPassword",value:w.confirmPassword,onChange:A,className:`mt-1 block w-full rounded-md shadow-sm sm:text-sm ${w.newPassword&&w.confirmPassword&&w.newPassword!==w.confirmPassword?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,disabled:r,required:!0}),w.newPassword&&w.confirmPassword&&w.newPassword!==w.confirmPassword&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Passwords do not match"})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:r||!w.currentPassword||!w.newPassword||!w.confirmPassword||w.newPassword!==w.confirmPassword,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Updating...":"Update Password"})})]}),a==="help"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 border border-blue-200",children:[n.jsxs("div",{className:"flex items-center mb-4",children:[n.jsx(ix,{className:"w-8 h-8 text-blue-600 mr-3"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Getting Started Guide"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Learn how to use all portal features"})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:" Interactive Onboarding Wizard"}),n.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Take a guided tour through the portal's key features. Perfect for new users or as a refresher."}),n.jsxs("button",{onClick:()=>c(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",children:[n.jsx(ix,{className:"w-4 h-4 mr-2"}),"Start Onboarding Wizard"]})]}),n.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:" Quick Reference Guide"}),n.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Access the complete feature documentation with step-by-step instructions."}),n.jsx("a",{href:"/FEATURE_ACCESS_GUIDE.md",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 border border-purple-600 text-purple-600 rounded-md hover:bg-purple-50 transition",children:"View Documentation"})]}),n.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:" Quick Tips"}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-green-600 mr-2",children:""}),n.jsxs("span",{children:["Go to ",n.jsx("strong",{children:"Events"}),"  Open any event to see 10 feature tabs"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-green-600 mr-2",children:""}),n.jsxs("span",{children:["Use ",n.jsx("strong",{children:"Command Center"})," tab during live events for real-time monitoring"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-green-600 mr-2",children:""}),n.jsxs("span",{children:["Bulk upload wristbands via CSV in the ",n.jsx("strong",{children:"Wristbands"})," tab"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-green-600 mr-2",children:""}),n.jsxs("span",{children:["Monitor fraud detection in real-time with the ",n.jsx("strong",{children:"Fraud Detection"})," tab"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-green-600 mr-2",children:""}),n.jsxs("span",{children:["Generate reports in multiple formats using the ",n.jsx("strong",{children:"Export"})," tab"]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg p-4 border border-yellow-200",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:" Pro Tips"}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-yellow-600 mr-2",children:""}),n.jsxs("span",{children:["Run pre-event tests in the ",n.jsx("strong",{children:"Testing"})," tab before going live"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-yellow-600 mr-2",children:""}),n.jsx("span",{children:"Set up automated reports to be emailed daily/weekly"})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-yellow-600 mr-2",children:""}),n.jsxs("span",{children:["Use ",n.jsx("strong",{children:"Emergency Controls"})," for quick response during incidents"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-yellow-600 mr-2",children:""}),n.jsxs("span",{children:["Check ",n.jsx("strong",{children:"Autonomous Operations"})," in sidebar for AI-powered features"]})]})]})]})]})]})}),a==="system"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 rounded-lg p-6 border border-red-200",children:[n.jsxs("div",{className:"flex items-center mb-4",children:[n.jsx(Gc,{className:"w-8 h-8 text-red-600 mr-3"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"System Management"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Critical system operations (Admin only)"})]})]}),n.jsx("div",{className:"bg-white rounded-lg p-4 border border-red-300 mb-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(bt,{className:"w-5 h-5 text-red-600 mr-3 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-red-900 mb-1",children:"Critical System Controls"}),n.jsx("p",{className:"text-sm text-gray-700",children:"The controls below can affect the entire system and all connected users. Only administrators with proper authorization should access these features."})]})]})}),n.jsx(h9,{})]})})]})]}),l&&n.jsx(X1,{onClose:D,onComplete:D})]})},m9=()=>n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Notification Test Page"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border-2 border-dashed border-gray-300",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-gray-400 text-lg mb-2",children:""}),n.jsx("h3",{className:"text-gray-600 font-medium",children:"Notification Testing"}),n.jsx("p",{className:"text-gray-500 text-sm",children:"Component temporarily disabled"}),n.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Bootstrap dependencies removed"})]})})]})});class p9{async getEventStaff(t){const{data:r,error:s}=await B.from("event_access").select(`
        *,
        profiles:user_id (
          id,
          email,
          full_name,
          avatar_url
        )
      `).eq("event_id",t).eq("is_active",!0).order("assigned_at",{ascending:!1});if(s)throw s;return r||[]}async assignStaffToEvent(t,r,s){var l,c;const{data:a}=await B.auth.getUser(),{error:i}=await B.from("event_access").insert({event_id:t,user_id:r,access_level:s,assigned_by:(l=a.user)==null?void 0:l.id});if(i)throw i;await this.logStaffAction(t,r,"staff_assigned",{access_level:s,assigned_by:(c=a.user)==null?void 0:c.id})}async removeStaffFromEvent(t){const{data:r}=await B.from("event_access").select("event_id, user_id").eq("id",t).single(),{error:s}=await B.from("event_access").update({is_active:!1}).eq("id",t);if(s)throw s;r&&await this.logStaffAction(r.event_id,r.user_id,"staff_removed",{access_id:t})}async updateStaffAccessLevel(t,r){const{data:s}=await B.from("event_access").select("event_id, user_id, access_level").eq("id",t).single(),{error:a}=await B.from("event_access").update({access_level:r}).eq("id",t);if(a)throw a;s&&await this.logStaffAction(s.event_id,s.user_id,"access_level_changed",{old_level:s.access_level,new_level:r})}async inviteStaffMember(t,r,s,a){try{const{data:i}=await B.auth.admin.listUsers(),l=i.users.find(f=>f.email===t);if(l)return await this.assignStaffToEvent(r,l.id,a),{success:!0,user:l};const{data:c,error:d}=await B.auth.admin.inviteUserByEmail(t,{data:{invited_for_event:r,invited_for_event_name:s,default_access_level:a,role:"staff"}});if(d)throw d;return c.user&&await this.assignStaffToEvent(r,c.user.id,a),{success:!0,user:c.user}}catch(i){return{success:!1,error:i.message}}}async getStaffActivity(t){const{data:r,error:s}=await B.from("checkin_logs").select(`
        staff_id,
        created_at,
        location
      `).eq("event_id",t).not("staff_id","is",null);if(s)throw s;const a=new Map;r==null||r.forEach(l=>{const c=l.staff_id;a.has(c)||a.set(c,{user_id:c,event_id:t,last_activity:l.created_at,total_scans:0,current_gate:l.location,is_online:!1});const d=a.get(c);d.total_scans++,new Date(l.created_at)>new Date(d.last_activity)&&(d.last_activity=l.created_at,d.current_gate=l.location)});const i=new Date(Date.now()-5*60*1e3);return a.forEach(l=>{l.is_online=new Date(l.last_activity)>i}),Array.from(a.values())}async checkEventAccess(t,r){const{data:s,error:a}=await B.from("event_access").select("access_level").eq("user_id",t).eq("event_id",r).eq("is_active",!0).single();return a||!s?{hasAccess:!1}:{hasAccess:!0,accessLevel:s.access_level}}async getUserEvents(t){const{data:r,error:s}=await B.from("event_access").select(`
        access_level,
        events (
          id,
          name,
          description,
          location,
          start_date,
          end_date,
          config
        )
      `).eq("user_id",t).eq("is_active",!0);if(s)throw s;return r||[]}async sendMessageToStaff(t,r,s,a="normal"){var l;const{data:i}=await B.auth.getUser();for(const c of r)await this.logStaffAction(t,c,"message_sent",{message:s,priority:a,sent_by:(l=i.user)==null?void 0:l.id})}async logStaffAction(t,r,s,a){var l;const{data:i}=await B.auth.getUser();await B.from("audit_log").insert({event_id:t,user_id:(l=i.user)==null?void 0:l.id,action:s,table_name:"event_access",record_id:r,new_values:a})}subscribeToStaffChanges(t,r){return B.channel(`staff_changes_${t}`).on("postgres_changes",{event:"*",schema:"public",table:"event_access",filter:`event_id=eq.${t}`},r).subscribe()}async getStaffOnlineStatus(t){const r=await this.getStaffActivity(t),s={};return r.forEach(a=>{s[a.user_id]=a.is_online}),s}}const g9=new p9;class x9{constructor(){nr(this,"subscriptions",new Map)}async sendBroadcast(t,r,s={}){const{data:{user:a}}=await B.auth.getUser();if(!a)throw new Error("Not authenticated");const i=new Date().toISOString(),l=s.expiresInMinutes?new Date(Date.now()+s.expiresInMinutes*60*1e3).toISOString():void 0,{data:c,error:d}=await B.from("staff_messages").insert({event_id:t,sender_id:a.id,message:r,message_type:s.type||"broadcast",priority:s.priority||"normal",sent_at:i,expires_at:l}).select().single();if(d)throw d;const{data:f}=await B.from("checkin_logs").select("staff_id").eq("event_id",t).not("staff_id","is",null).order("timestamp",{ascending:!1}).limit(100),h=[...new Set(f==null?void 0:f.map(m=>m.staff_id).filter(Boolean))];if(h.length>0){const m=h.map(g=>({user_id:g,type:"broadcast_message",title:this.getNotificationTitle(s.type||"broadcast"),message:r,data:{broadcast_id:c.id,event_id:t,priority:s.priority||"normal",sender_id:a.id},read:!1}));await B.from("notifications").insert(m)}return c}subscribeToBroadcasts(t,r){const s=B.channel(`broadcasts:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"staff_messages",filter:`event_id=eq.${t}`},a=>{const i=a.new;i.expires_at&&new Date(i.expires_at)<new Date||(r(i),this.showBrowserNotification(i))}).subscribe();return this.subscriptions.set(t,s),()=>{B.removeChannel(s),this.subscriptions.delete(t)}}subscribeToNotifications(t,r){const s=B.channel(`notifications:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${t}`},a=>{var l,c;const i=a.new;r(i),(((l=i.data)==null?void 0:l.priority)==="high"||((c=i.data)==null?void 0:c.priority)==="urgent")&&this.showBrowserNotification({message:i.message,message_type:"alert",priority:i.data.priority})}).subscribe();return()=>{B.removeChannel(s)}}async markBroadcastAsRead(t,r){const{error:s}=await B.from("notifications").update({read:!0,read_at:new Date().toISOString()}).eq("data->>broadcast_id",t).eq("user_id",r);if(s)throw s}async getBroadcastHistory(t,r=50){const{data:s,error:a}=await B.from("staff_messages").select("*").eq("event_id",t).order("sent_at",{ascending:!1}).limit(r);if(a)throw a;return s}showBrowserNotification(t){if("Notification"in window)if(Notification.permission==="granted"){const r=new Notification(this.getNotificationTitle(t.message_type),{body:t.message,icon:"/logo.png",badge:"/logo.png",tag:t.id,requireInteraction:t.priority==="urgent",data:{messageId:t.id}});r.onclick=()=>{window.focus(),r.close()}}else Notification.permission!=="denied"&&Notification.requestPermission()}getNotificationTitle(t){switch(t){case"emergency":return" Emergency Alert";case"alert":return" Important Alert";case"broadcast":default:return" Broadcast Message"}}async requestNotificationPermission(){return"Notification"in window?Notification.permission==="default"?await Notification.requestPermission():Notification.permission:"denied"}cleanup(){this.subscriptions.forEach(t=>{B.removeChannel(t)}),this.subscriptions.clear()}}const v9=new x9,y9=()=>{const{eventId:e}=ja(),t=Ef(),[r,s]=x.useState(null),[a,i]=x.useState([]),[l,c]=x.useState(!0),[d,f]=x.useState("assignments"),[h,m]=x.useState(!1),[g,v]=x.useState(""),[j,_]=x.useState(!1);x.useEffect(()=>{e&&(y(),w())},[e]);const y=async()=>{if(e)try{const{data:N,error:P}=await B.from("events").select("*").eq("id",e).single();if(P)throw P;s(N)}catch(N){console.error("Error fetching event:",N),t("/events")}finally{c(!1)}},w=async()=>{if(e)try{const N=await g9.getStaffActivity(e);i(N)}catch(N){console.error("Error fetching staff activity:",N)}},k=async()=>{if(!g.trim()){ge.error("Please enter a message");return}if(!e){ge.error("No event selected");return}_(!0);try{await v9.sendBroadcast(e,g,{type:"broadcast",priority:"normal"}),ge.success(`Broadcast message sent to ${a.length} staff members`),v(""),m(!1)}catch(N){console.error("Error sending broadcast:",N),ge.error("Failed to send broadcast message")}finally{_(!1)}};return l?n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r?n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("div",{className:"flex items-center space-x-4 mb-4",children:n.jsxs("button",{onClick:()=>t(`/events/${e}`),className:"flex items-center text-gray-600 hover:text-gray-900",children:[n.jsx(Mf,{className:"w-4 h-4 mr-1"}),"Back to Event"]})}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r.name}),n.jsx("p",{className:"text-gray-600",children:"Staff Management & Activity"})]}),n.jsx("div",{className:"flex items-center space-x-3",children:n.jsxs("div",{className:"text-right text-sm text-gray-600",children:[n.jsx("p",{children:new Date(r.start_date).toLocaleDateString()}),n.jsx("p",{children:r.location})]})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(lt,{className:"w-8 h-8 text-blue-600"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Staff"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.length})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(qt,{className:"w-8 h-8 text-green-600"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Online Now"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.filter(N=>N.is_online).length})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(jr,{className:"w-8 h-8 text-purple-600"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Scans"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.reduce((N,P)=>N+P.total_scans,0)})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Fl,{className:"w-8 h-8 text-orange-600"}),n.jsxs("div",{className:"ml-3",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Scans/Staff"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.length>0?Math.round(a.reduce((N,P)=>N+P.total_scans,0)/a.length):0})]})]})})]}),n.jsx("div",{className:"border-b border-gray-200 mb-6",children:n.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"assignments",label:"Staff Assignments",icon:lt},{id:"activity",label:"Activity Monitor",icon:qt},{id:"messages",label:"Messages",icon:Fl}].map(N=>{const P=N.icon;return n.jsxs("button",{onClick:()=>f(N.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm ${d===N.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(P,{className:"w-4 h-4 mr-2"}),N.label]},N.id)})})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[d==="assignments"&&n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(lt,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),n.jsx("p",{children:"Staff assignment management coming soon"}),n.jsx("p",{className:"text-sm",children:"Assign staff to gates and manage permissions"})]}),d==="activity"&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Staff Activity Monitor"}),n.jsx("button",{onClick:w,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Refresh"})]}),a.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(qt,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),n.jsx("p",{children:"No staff activity recorded yet"})]}):n.jsx("div",{className:"space-y-3",children:a.map(N=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${N.is_online?"bg-green-500":"bg-gray-400"}`}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Staff Member"}),n.jsxs("p",{className:"text-xs text-gray-500",children:["Last active: ",new Date(N.last_activity).toLocaleString()]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[N.total_scans," scans"]}),N.current_gate&&n.jsxs("p",{className:"text-xs text-gray-500",children:["At: ",N.current_gate]})]})]},N.user_id))})]}),d==="messages"&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Staff Messages"}),n.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[n.jsx(Kl,{className:"w-4 h-4 mr-2"}),"Send Broadcast"]})]}),n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Fl,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),n.jsxs("p",{children:["Broadcast messages to ",a.length," staff members"]}),n.jsx("p",{className:"text-sm",children:'Click "Send Broadcast" to compose and send a message to all staff'})]})]})]})]}),h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Send Broadcast Message"}),n.jsx("button",{onClick:()=>{m(!1),v("")},className:"text-gray-400 hover:text-gray-600",children:n.jsx(Oo,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["This message will be sent to ",a.length," staff members"]}),n.jsx("textarea",{value:g,onChange:N=>v(N.target.value),placeholder:"Enter your message here...",className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:j})]}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx("button",{onClick:()=>{m(!1),v("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",disabled:j,children:"Cancel"}),n.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center disabled:opacity-50 disabled:cursor-not-allowed",disabled:j||!g.trim(),children:j?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Kl,{className:"w-4 h-4 mr-2"}),"Send Message"]})})]})]})})]}):n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Event Not Found"}),n.jsx("p",{className:"text-gray-600 mt-2",children:"The event you're looking for doesn't exist."}),n.jsx("button",{onClick:()=>t("/events"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Back to Events"})]})})},on=x.forwardRef(({className:e,type:t,...r},s)=>n.jsx("input",{type:t,className:ji("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));on.displayName="Input";const b9=ob("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Pn({className:e,variant:t,...r}){return n.jsx("div",{className:ji(b9({variant:t}),e),...r})}class w9{constructor(){nr(this,"webhookEndpoints",new Map);nr(this,"notificationConfig",{})}async initialize(){try{const{data:t}=await B.from("system_settings").select("*").eq("category","webhooks").single();t!=null&&t.settings&&(this.notificationConfig=t.settings,this.webhookEndpoints=new Map(Object.entries(t.settings.endpoints||{})))}catch(t){console.warn("Failed to load webhook configuration:",t)}}registerWebhook(t,r){this.webhookEndpoints.set(t,r),this.saveConfiguration()}unregisterWebhook(t){this.webhookEndpoints.delete(t),this.saveConfiguration()}async sendWebhook(t){const r=Array.from(this.webhookEndpoints.entries()).map(async([a,i])=>{try{const l=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json","User-Agent":"QuickStrap-Portal/1.0"},body:JSON.stringify({...t,source:"quickstrap-portal",webhook_name:a})});if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);return{name:a,success:!0,response:await l.text()}}catch(l){return console.error(`Webhook ${a} failed:`,l),{name:a,success:!1,error:l instanceof Error?l.message:"Unknown error"}}});return(await Promise.allSettled(r)).map((a,i)=>{var l;return a.status==="fulfilled"?a.value:{name:Array.from(this.webhookEndpoints.keys())[i],success:!1,error:((l=a.reason)==null?void 0:l.message)||"Unknown error"}})}async triggerNotification(t,r,s){const a={event:t,data:r,timestamp:new Date().toISOString(),eventId:s,metadata:{portal_version:"1.0",environment:"production"}},i=await this.sendWebhook(a);return await this.logNotification(a,i),i}async notifyCheckin(t){return this.triggerNotification("checkin.created",{wristband_id:t.wristband_id,gate_name:t.gate_name,event_id:t.event_id,timestamp:t.timestamp,staff_member:t.staff_member},t.event_id)}async notifyCapacityAlert(t){return this.triggerNotification("capacity.alert",{event_id:t.event_id,event_name:t.event_name,current_count:t.current_count,capacity_limit:t.capacity_limit,percentage:Math.round(t.current_count/t.capacity_limit*100),alert_level:t.current_count>=t.capacity_limit?"critical":"warning"},t.event_id)}async notifySecurityAlert(t){return this.triggerNotification("security.alert",{alert_type:t.type,wristband_id:t.wristband_id,event_id:t.event_id,description:t.description,severity:t.severity||"medium",staff_member:t.staff_member},t.event_id)}async notifyStaffStatus(t){return this.triggerNotification("staff.status",{staff_id:t.staff_id,staff_name:t.staff_name,status:t.status,event_id:t.event_id,location:t.location},t.event_id)}async notifyGateRequest(t){return this.triggerNotification("gate.approval_request",{gate_name:t.gate_name,event_id:t.event_id,created_by:t.created_by,location:t.location,auto_discovered:t.auto_discovered,request_id:t.id},t.event_id)}async notifySystemHealth(t){return this.triggerNotification("system.health",{status:t.status,metrics:t.metrics,alerts:t.alerts,timestamp:new Date().toISOString()})}async updateNotificationConfig(t){this.notificationConfig={...this.notificationConfig,...t},await this.saveConfiguration()}getConfiguration(){return{webhooks:Object.fromEntries(this.webhookEndpoints),notifications:this.notificationConfig}}async saveConfiguration(){try{const t={endpoints:Object.fromEntries(this.webhookEndpoints),notifications:this.notificationConfig};await B.from("system_settings").upsert({category:"webhooks",settings:t,updated_at:new Date().toISOString()})}catch(t){console.error("Failed to save webhook configuration:",t instanceof Error?t.message:t)}}async logNotification(t,r){try{await B.from("audit_log").insert({action:"notification_sent",details:{event:t.event,webhook_results:r,payload_size:JSON.stringify(t).length},timestamp:new Date().toISOString()})}catch(s){console.error("Failed to log notification:",s)}}async testWebhook(t,r){const s=r||this.webhookEndpoints.get(t);if(!s)throw new Error(`Webhook ${t} not found`);const a={event:"test.webhook",data:{message:"This is a test webhook from QuickStrap Portal",timestamp:new Date().toISOString()},timestamp:new Date().toISOString(),metadata:{test:!0,webhook_name:t}};try{const i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","User-Agent":"QuickStrap-Portal/1.0"},body:JSON.stringify(a)});return{success:i.ok,status:i.status,statusText:i.statusText,response:await i.text()}}catch(i){return{success:!1,error:i instanceof Error?i.message:"Unknown error"}}}}const Kn=new w9;class _9{constructor(){nr(this,"config",{botToken:"",chatId:"",enabled:!1});nr(this,"authenticatedUsers",new Map);nr(this,"loginAttempts",new Map);nr(this,"validCredentials",{});nr(this,"sessionTimeout",36e5)}async initialize(){try{const t="",r="";this.config={botToken:t,chatId:r,enabled:!!(t&&r)},(!t||!r)&&console.warn("Telegram service disabled: Missing VITE_TELEGRAM_BOT_TOKEN or VITE_TELEGRAM_CHAT_ID environment variables")}catch(t){console.error("Failed to initialize Telegram service:",t)}}async updateConfig(t){this.config={...this.config,...t};const{secureStorage:r}=await as(async()=>{const{secureStorage:s}=await import("./secureStorage-BLm_y47z.js");return{secureStorage:s}},[]);r.setItem("telegram_config",this.config,{encrypt:!0,expiry:24*60*60*1e3})}getConfig(){return{...this.config}}async sendMessage(t){if(!this.config.enabled)return{success:!1,error:"Telegram not configured"};if(!this.config.botToken||!this.config.chatId)return{success:!1,error:"Missing bot token or chat ID"};try{const r=`https://api.telegram.org/bot${this.config.botToken}/sendMessage`,s={chat_id:this.config.chatId,text:t.text,parse_mode:t.parse_mode||"Markdown",disable_notification:t.disable_notification||!1},a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),i=await a.json();return a.ok&&i.ok?{success:!0,messageId:i.result.message_id}:{success:!1,error:i.description||"Failed to send message"}}catch(r){return console.error("Telegram send error:",r),{success:!1,error:r instanceof Error?r.message:"Network error"}}}async sendCheckinNotification(t){const r={text:` *New Check-in*

 Wristband: \`${t.wristband_id}\`
 Gate: ${t.gate_name}
 Event: ${t.event_name}
 Time: ${new Date(t.timestamp).toLocaleString()}
 Staff: ${t.staff_member}
${t.category?` Category: ${t.category}`:""}
${t.status?` Status: ${t.status}`:""}`,parse_mode:"Markdown"};return this.sendMessage(r)}async sendCapacityAlert(t){const s={text:`${t.alert_level==="critical"?"":""} *Capacity Alert*

 Event: ${t.event_name}
 Attendance: ${t.current_count}/${t.capacity_limit} (${t.percentage}%)
 Level: ${t.alert_level.toUpperCase()}

${t.percentage>=100?" **CAPACITY REACHED**":t.percentage>=90?" **NEAR CAPACITY**":" **MONITORING**"}`,parse_mode:"Markdown"};return this.sendMessage(s)}async sendSecurityAlert(t){const s={text:`${t.severity==="critical"?"":t.severity==="high"?"":""} *Security Alert*

 Type: ${t.alert_type}
 Wristband: \`${t.wristband_id}\`
 ${t.description}
 Severity: ${t.severity.toUpperCase()}
 Event: ${t.event_name}
 Reported by: ${t.staff_member}

${t.severity==="critical"?" **IMMEDIATE ATTENTION REQUIRED**":""}`,parse_mode:"Markdown"};return this.sendMessage(s)}async sendStaffStatusUpdate(t){const s={text:` *Staff Update*

${{online:"",offline:"",break:"",busy:""}[t.status]||""} ${t.staff_name} is now **${t.status.toUpperCase()}**
 Event: ${t.event_name}
${t.location?` Location: ${t.location}`:""}
 Time: ${new Date().toLocaleString()}`,parse_mode:"Markdown"};return this.sendMessage(s)}async sendGateApprovalRequest(t){const r={text:` *Gate Approval Request*

 Gate Name: ${t.gate_name}
 Event: ${t.event_name}
 Created by: ${t.created_by}
${t.location?` Location: ${t.location}`:""}
 Auto-discovered: ${t.auto_discovered?"Yes":"No"}

 *Awaiting approval in portal*`,parse_mode:"Markdown"};return this.sendMessage(r)}async sendSystemHealthAlert(t){const s={text:` *System Health Update*

${t.status==="healthy"?"":t.status==="warning"?"":""} Status: **${t.status.toUpperCase()}**
 Metrics: ${JSON.stringify(t.metrics,null,2)}
${t.alerts.length>0?` Alerts:
${t.alerts.map(a=>` ${a}`).join(`
`)}`:" No active alerts"}
 Time: ${new Date().toLocaleString()}`,parse_mode:"Markdown"};return this.sendMessage(s)}async testConnection(){if(!this.config.botToken)return{success:!1,error:"No bot token configured"};try{const t=`https://api.telegram.org/bot${this.config.botToken}/getMe`,r=await fetch(t),s=await r.json();return r.ok&&s.ok?(this.config.chatId&&await this.sendMessage({text:` *Test Message*

Your QuickStrap Portal is connected to Telegram! `,parse_mode:"Markdown"}),{success:!0,botInfo:s.result}):{success:!1,error:s.description||"Failed to get bot info"}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Network error"}}}async getChatUpdates(){if(!this.config.botToken)return{success:!1,error:"No bot token configured"};try{const t=`https://api.telegram.org/bot${this.config.botToken}/getUpdates`,r=await fetch(t),s=await r.json();return r.ok&&s.ok?{success:!0,updates:s.result}:{success:!1,error:s.description||"Failed to get updates"}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Network error"}}}isAuthenticated(t){const r=this.authenticatedUsers.get(t);return r?Date.now()>r.sessionExpiry?(this.authenticatedUsers.delete(t),!1):!0:!1}async sendMessageToChat(t,r){if(!this.config.botToken)throw new Error("Bot token not configured");const s=`https://api.telegram.org/bot${this.config.botToken}/sendMessage`,a={chat_id:t,text:r.text,parse_mode:r.parse_mode||"Markdown",disable_notification:r.disable_notification||!1,reply_markup:r.reply_markup};return(await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json()}async handleStartCommand(t,r,s){const i=this.isAuthenticated(r)?` Welcome back, ${s||"User"}!

You're logged in. Available commands:

 *Information Commands:*
/info - System information
/stats - Event statistics
/capacity - Venue capacity status
/gates - Active gates list
/alerts - Recent alerts

 *Other Commands:*
/help - Show help
/logout - Logout`:` Welcome to QuickStrap NFC Portal!

 *Authentication Required*

Please login to access system information and commands.

Use /login to authenticate.`;await this.sendMessageToChat(t,{text:i,parse_mode:"Markdown"})}async handleLoginCommand(t,r){if(this.isAuthenticated(r)){await this.sendMessageToChat(t,{text:` You are already logged in!

Use /logout to logout first.`,parse_mode:"Markdown"});return}this.loginAttempts.set(r,{attempts:0,lastAttempt:Date.now()}),await this.sendMessageToChat(t,{text:` *Login Process*

Please send your credentials in this format:
\`username:password\`

Example: \`admin:admin123\`

Use /cancel to abort login.`,parse_mode:"Markdown"})}async handleLogoutCommand(t,r,s){if(!this.isAuthenticated(r)){await this.sendMessageToChat(t,{text:" You are not logged in.",parse_mode:"Markdown"});return}this.authenticatedUsers.delete(r),await this.sendMessageToChat(t,{text:` Logged out successfully!

Use /login to login again.`,parse_mode:"Markdown"})}async handleHelpCommand(t,r){const a=this.isAuthenticated(r)?` *Available Commands*

 *Information Commands:*
/info - System information
/stats - Event statistics
/capacity - Venue capacity status
/gates - Active gates list
/alerts - Recent security alerts

 *Account Commands:*
/help - Show this help
/logout - Logout from bot

All information commands require authentication.`:` *Help*

 *Authentication Required*

Please /login first to access commands.

*After login you'll have access to:*
 System information
 Event statistics
 Capacity monitoring
 Gate management
 Security alerts`;await this.sendMessageToChat(t,{text:a,parse_mode:"Markdown"})}async handleCredentialSubmission(t,r,s){const a=this.loginAttempts.get(r);if(!a){await this.sendMessageToChat(t,{text:" No active login session. Use /login to start.",parse_mode:"Markdown"});return}const i=s.split(":");if(i.length!==2){await this.sendMessageToChat(t,{text:" Invalid format. Use: `username:password`\n\nExample: `admin:admin123`",parse_mode:"Markdown"});return}const[l,c]=i.map(d=>d.trim());try{const{supabase:d}=await as(async()=>{const{supabase:g}=await Promise.resolve().then(()=>QE);return{supabase:g}},void 0),{data:f,error:h}=await d.auth.signInWithPassword({email:l,password:c});if(h||!f.user){a.attempts++,a.lastAttempt=Date.now(),a.attempts>=3?(this.loginAttempts.delete(r),await this.sendMessageToChat(t,{text:` *Login Failed*

Too many failed attempts. Please try /login again later.`,parse_mode:"Markdown"})):await this.sendMessageToChat(t,{text:` *Invalid Credentials*

Attempt ${a.attempts}/3

Please try again or use /cancel to abort.`,parse_mode:"Markdown"});return}const m={userId:r,username:f.user.email||l,authenticatedAt:Date.now(),sessionExpiry:Date.now()+this.sessionTimeout};this.authenticatedUsers.set(r,m),this.loginAttempts.delete(r),await this.sendMessageToChat(t,{text:` *Login Successful!*

Welcome, ${f.user.email}!

 *Available Commands:*
/info - System information
/stats - Event statistics
/capacity - Venue capacity
/gates - Active gates
/alerts - Security alerts

 Use /help anytime for command list`,parse_mode:"Markdown"}),await d.auth.signOut()}catch(d){console.error("Telegram auth error:",d),await this.sendMessageToChat(t,{text:` *Authentication Error*

System temporarily unavailable. Please try again later.`,parse_mode:"Markdown"})}}async handleProtectedCommand(t,r,s){if(!this.isAuthenticated(r)){await this.sendMessageToChat(t,{text:` *Authentication Required*

Please /login first to use this command.`,parse_mode:"Markdown"});return}switch(s){case"/info":await this.handleInfoCommand(t,r);break;case"/stats":await this.handleStatsCommand(t,r);break;case"/capacity":await this.handleCapacityCommand(t,r);break;case"/gates":await this.handleGatesCommand(t,r);break;case"/alerts":await this.handleAlertsCommand(t,r);break;default:await this.sendMessageToChat(t,{text:" Unknown command. Use /help to see available commands.",parse_mode:"Markdown"})}}async handleInfoCommand(t,r){const s=this.authenticatedUsers.get(r),a=s?Math.floor((s.sessionExpiry-Date.now())/6e4):0,i=` *System Information*

 Status: Online
 Version: 1.0.0
 Active Users: ${this.authenticatedUsers.size}
 Database: Connected
 Last Update: ${new Date().toLocaleString()}
 Session Expires: ${a} minutes`;await this.sendMessageToChat(t,{text:i,parse_mode:"Markdown"})}async handleStatsCommand(t,r){await this.sendMessageToChat(t,{text:` *Event Statistics*

 Total Check-ins: 1,234
 Active Gates: 8
 Unique Visitors: 987
 Peak Hour: 8:00 PM (245 check-ins)
 Avg Response: 120ms
 Success Rate: 98.7%`,parse_mode:"Markdown"})}async handleCapacityCommand(t,r){await this.sendMessageToChat(t,{text:` *Venue Capacity Status*

 Main Event:
  Current: 850 / 1000
  Capacity: 85%
  Status:  Near Capacity

 VIP Area:
  Current: 45 / 50
  Capacity: 90%
  Status:  Near Capacity

 General Admission:
  Current: 650 / 800
  Capacity: 81%
  Status:  Good`,parse_mode:"Markdown"})}async handleGatesCommand(t,r){await this.sendMessageToChat(t,{text:` *Active Gates*

 Gate A - Main Entrance
  Status: Active
  Check-ins: 342

 Gate B - VIP Entrance
  Status: Active
  Check-ins: 89

 Gate C - Side Entrance
  Status: Active
  Check-ins: 156

 Gate D - Emergency Exit
  Status: Standby
  Check-ins: 0`,parse_mode:"Markdown"})}async handleAlertsCommand(t,r){await this.sendMessageToChat(t,{text:` *Recent Security Alerts*

 *Low Priority*
 Duplicate scan attempt - Gate A (5 min ago)
 Gate auto-discovery - Gate E (12 min ago)

 *Medium Priority*
 Capacity 85% reached - Main Event (3 min ago)

 No critical alerts`,parse_mode:"Markdown"})}async handleWebhook(t){try{const r=t.message;if(!r||!r.text)return{success:!0};const s=r.chat.id,a=r.from.id,i=r.text.trim(),l=r.from.username||r.from.first_name;if(i.startsWith("/")){const c=i.split(" ")[0].toLowerCase();switch(c){case"/start":await this.handleStartCommand(s,a,l);break;case"/login":await this.handleLoginCommand(s,a);break;case"/logout":await this.handleLogoutCommand(s,a,l);break;case"/help":await this.handleHelpCommand(s,a);break;case"/cancel":this.loginAttempts.delete(a),await this.sendMessageToChat(s,{text:" Login cancelled.",parse_mode:"Markdown"});break;case"/info":case"/stats":case"/capacity":case"/gates":case"/alerts":await this.handleProtectedCommand(s,a,c);break;default:await this.sendMessageToChat(s,{text:" Unknown command. Use /help for available commands.",parse_mode:"Markdown"})}}else this.loginAttempts.get(a)?await this.handleCredentialSubmission(s,a,i):await this.sendMessageToChat(s,{text:" Please use /help to see available commands.",parse_mode:"Markdown"});return{success:!0}}catch(r){return console.error("Webhook handler error:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}async setWebhook(t){if(!this.config.botToken)return{success:!1,error:"Bot token not configured"};try{const r=`https://api.telegram.org/bot${this.config.botToken}/setWebhook`,s=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t})}),a=await s.json();return s.ok&&a.ok?{success:!0}:{success:!1,error:a.description||"Failed to set webhook"}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Network error"}}}async getWebhookInfo(){if(!this.config.botToken)return{success:!1,error:"Bot token not configured"};try{const t=`https://api.telegram.org/bot${this.config.botToken}/getWebhookInfo`,r=await fetch(t),s=await r.json();return r.ok&&s.ok?{success:!0,info:s.result}:{success:!1,error:s.description||"Failed to get webhook info"}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Network error"}}}}const Mr=new _9;class j9{constructor(){nr(this,"templates",new Map);nr(this,"rules",new Map);nr(this,"isInitialized",!1)}async initialize(){if(!this.isInitialized)try{await Promise.all([this.loadTemplates(),this.loadRules(),Kn.initialize(),Mr.initialize()]),this.templates.size===0&&await this.createDefaultTemplates(),this.rules.size===0&&await this.createDefaultRules(),this.isInitialized=!0}catch(t){console.error("Failed to initialize notification service:",t)}}async loadTemplates(){try{const{data:t}=await B.from("notification_templates").select("*").eq("enabled",!0);t&&t.forEach(r=>{this.templates.set(r.event,r)})}catch(t){console.warn("Failed to load notification templates:",t)}}async loadRules(){try{const{data:t}=await B.from("notification_rules").select("*").eq("enabled",!0);t&&t.forEach(r=>{this.rules.set(r.event,r)})}catch(t){console.warn("Failed to load notification rules:",t)}}async createDefaultTemplates(){const t=[{name:"Check-in Alert",event:"checkin.created",template:` New check-in at {{gate_name}}
 Wristband: {{wristband_id}}
 Event: {{event_name}}
 {{timestamp}}`,channels:["telegram","slack"],enabled:!0},{name:"Capacity Warning",event:"capacity.alert",template:` Capacity Alert: {{event_name}}
 {{current_count}}/{{capacity_limit}} ({{percentage}}%)
 Status: {{alert_level}}`,channels:["telegram","slack","email"],enabled:!0},{name:"Security Alert",event:"security.alert",template:` Security Alert: {{alert_type}}
 Wristband: {{wristband_id}}
 {{description}}
 Severity: {{severity}}`,channels:["telegram","slack","email"],enabled:!0},{name:"Staff Status Update",event:"staff.status",template:` Staff Update: {{staff_name}}
 Status: {{status}}
 Event: {{event_name}}
 Location: {{location}}`,channels:["telegram"],enabled:!0},{name:"Gate Approval Request",event:"gate.approval_request",template:` New Gate Request
 Name: {{gate_name}}
 Created by: {{created_by}}
 Location: {{location}}
 Auto-discovered: {{auto_discovered}}`,channels:["telegram","slack"],enabled:!0},{name:"System Health Alert",event:"system.health",template:` System Health: {{status}}
 Metrics: {{metrics}}
 Alerts: {{alerts}}`,channels:["telegram","email"],enabled:!0}];try{for(const r of t){const{data:s}=await B.from("notification_templates").insert(r).select().single();s&&this.templates.set(s.event,s)}}catch(r){console.error("Failed to create default templates:",r)}}async createDefaultRules(){const t=[{name:"High-frequency check-ins",event:"checkin.created",conditions:{min_interval:60},actions:["webhook","telegram"],enabled:!0,priority:"medium"},{name:"Capacity threshold alerts",event:"capacity.alert",conditions:{threshold:80},actions:["webhook","telegram","email"],enabled:!0,priority:"high"},{name:"Critical security alerts",event:"security.alert",conditions:{severity:["high","critical"]},actions:["webhook","telegram","slack","email"],enabled:!0,priority:"critical"},{name:"Staff offline alerts",event:"staff.status",conditions:{status:"offline",duration:300},actions:["webhook","telegram"],enabled:!0,priority:"medium"}];try{for(const r of t){const{data:s}=await B.from("notification_rules").insert(r).select().single();s&&this.rules.set(s.event,s)}}catch(r){console.error("Failed to create default rules:",r)}}async sendNotification(t,r,s){await this.initialize();try{const a=this.rules.get(t);if(!a||!a.enabled)return{success:!1,reason:"No active rule"};if(!this.evaluateConditions(a.conditions,r))return{success:!1,reason:"Conditions not met"};const i=this.templates.get(t);if(!i||!i.enabled)return{success:!1,reason:"No active template"};const l=this.formatMessage(i.template,r),c=await Kn.triggerNotification(t,{...r,formatted_message:l,template_id:i.id,rule_id:a.id,priority:a.priority,channels:i.channels},s);let d=null;if(i.channels.includes("telegram"))try{d=await this.sendToTelegram(t,r)}catch(f){console.warn("Failed to send Telegram notification:",f)}return await this.logNotification(t,r,l,c),{success:!0,message:l,webhookResults:c,priority:a.priority}}catch(a){return console.error(`Failed to send notification for event ${t}:`,a),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}evaluateConditions(t,r){for(const[s,a]of Object.entries(t))switch(s){case"threshold":if(r.percentage&&r.percentage<a)return!1;break;case"severity":if(Array.isArray(a)&&!a.includes(r.severity))return!1;break;case"status":if(r.status!==a)return!1;break;case"min_interval":break;default:if(r[s]!==a)return!1}return!0}formatMessage(t,r){let s=t;for(const[a,i]of Object.entries(r)){const l=`{{${a}}}`;s=s.replace(new RegExp(l,"g"),String(i))}if(r.timestamp){const a=new Date(r.timestamp);s=s.replace("{{timestamp}}",a.toLocaleString())}return s}async logNotification(t,r,s,a){try{await B.from("audit_log").insert({action:"notification_processed",details:{event:t,message:s,data_keys:Object.keys(r),webhook_count:a.length,success_count:a.filter(i=>i.success).length},timestamp:new Date().toISOString()})}catch(i){console.error("Failed to log notification:",i)}}async sendToTelegram(t,r){switch(t){case"checkin.created":return Mr.sendCheckinNotification(r);case"capacity.alert":return Mr.sendCapacityAlert(r);case"security.alert":return Mr.sendSecurityAlert(r);case"staff.status":return Mr.sendStaffStatusUpdate(r);case"gate.approval_request":return Mr.sendGateApprovalRequest(r);case"system.health":return Mr.sendSystemHealthAlert(r);default:return Mr.sendMessage({text:` *${t}*

${JSON.stringify(r,null,2)}`,parse_mode:"Markdown"})}}async notifyCheckin(t){return this.sendNotification("checkin.created",t,t.event_id)}async notifyCapacityAlert(t){return this.sendNotification("capacity.alert",t,t.event_id)}async notifySecurityAlert(t){return this.sendNotification("security.alert",t,t.event_id)}async notifyStaffStatus(t){return this.sendNotification("staff.status",t,t.event_id)}async notifyGateRequest(t){return this.sendNotification("gate.approval_request",t,t.event_id)}async notifySystemHealth(t){return this.sendNotification("system.health",t)}async createTemplate(t){const{data:r}=await B.from("notification_templates").insert(t).select().single();return r&&this.templates.set(r.event,r),r}async updateTemplate(t,r){const{data:s}=await B.from("notification_templates").update(r).eq("id",t).select().single();return s&&this.templates.set(s.event,s),s}async createRule(t){const{data:r}=await B.from("notification_rules").insert(t).select().single();return r&&this.rules.set(r.event,r),r}async updateRule(t,r){const{data:s}=await B.from("notification_rules").update(r).eq("id",t).select().single();return s&&this.rules.set(s.event,s),s}getConfiguration(){return{templates:Array.from(this.templates.values()),rules:Array.from(this.rules.values()),webhooks:Kn.getConfiguration()}}}const N9=new j9;function k9(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}Array(12).fill(0);let Sf=1;class S9{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:s,...a}=t,i=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:Sf++,l=this.toasts.find(d=>d.id===i),c=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),l?this.toasts=this.toasts.map(d=>d.id===i?(this.publish({...d,...t,id:i,title:s}),{...d,...t,id:i,dismissible:c,title:s}):d):this.addToast({title:s,...a,dismissible:c,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(s=>s({id:r.id,dismiss:!0}))}),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let s;r.loading!==void 0&&(s=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const a=Promise.resolve(t instanceof Function?t():t);let i=s!==void 0,l;const c=a.then(async f=>{if(l=["resolve",f],at.isValidElement(f))i=!1,this.create({id:s,type:"default",message:f});else if(C9(f)&&!f.ok){i=!1;const m=typeof r.error=="function"?await r.error(`HTTP error! status: ${f.status}`):r.error,g=typeof r.description=="function"?await r.description(`HTTP error! status: ${f.status}`):r.description,j=typeof m=="object"&&!at.isValidElement(m)?m:{message:m};this.create({id:s,type:"error",description:g,...j})}else if(f instanceof Error){i=!1;const m=typeof r.error=="function"?await r.error(f):r.error,g=typeof r.description=="function"?await r.description(f):r.description,j=typeof m=="object"&&!at.isValidElement(m)?m:{message:m};this.create({id:s,type:"error",description:g,...j})}else if(r.success!==void 0){i=!1;const m=typeof r.success=="function"?await r.success(f):r.success,g=typeof r.description=="function"?await r.description(f):r.description,j=typeof m=="object"&&!at.isValidElement(m)?m:{message:m};this.create({id:s,type:"success",description:g,...j})}}).catch(async f=>{if(l=["reject",f],r.error!==void 0){i=!1;const h=typeof r.error=="function"?await r.error(f):r.error,m=typeof r.description=="function"?await r.description(f):r.description,v=typeof h=="object"&&!at.isValidElement(h)?h:{message:h};this.create({id:s,type:"error",description:m,...v})}}).finally(()=>{i&&(this.dismiss(s),s=void 0),r.finally==null||r.finally.call(r)}),d=()=>new Promise((f,h)=>c.then(()=>l[0]==="reject"?h(l[1]):f(l[1])).catch(h));return typeof s!="string"&&typeof s!="number"?{unwrap:d}:Object.assign(s,{unwrap:d})},this.custom=(t,r)=>{const s=(r==null?void 0:r.id)||Sf++;return this.create({jsx:t(s),id:s,...r}),s},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const sn=new S9,E9=(e,t)=>{const r=(t==null?void 0:t.id)||Sf++;return sn.addToast({title:e,...t,id:r}),r},C9=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",P9=E9,A9=()=>sn.toasts,T9=()=>sn.getActiveToasts(),Ye=Object.assign(P9,{success:sn.success,info:sn.info,warning:sn.warning,error:sn.error,custom:sn.custom,message:sn.message,promise:sn.promise,dismiss:sn.dismiss,loading:sn.loading},{getHistory:A9,getToasts:T9});k9("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");const O9=()=>{const[e,t]=x.useState({botToken:"8365810167:AAG-hEm4AV-vUNWWxVsGl3u901lU--kxU18",chatId:"",enabled:!1}),[r,s]=x.useState(!1),[a,i]=x.useState(null),[l,c]=x.useState(!1),[d,f]=x.useState([]);x.useEffect(()=>{h()},[]);const h=async()=>{try{await Mr.initialize();const k=Mr.getConfig();t(k)}catch(k){console.error("Failed to load Telegram config:",k)}},m=async()=>{try{Mr.updateConfig(e),Ye.success("Telegram configuration saved")}catch(k){console.error("Failed to save config:",k),Ye.error("Failed to save configuration")}},g=async()=>{s(!0);try{const k=await Mr.testConnection();i(k),k.success?Ye.success("Telegram connection successful!"):Ye.error(`Connection failed: ${k.error}`)}catch(k){console.error("Test failed:",k),Ye.error("Test failed")}finally{s(!1)}},v=async()=>{s(!0);try{const k=await Mr.getChatUpdates();k.success&&k.updates?(f(k.updates),k.updates.length===0?Ye.info("No messages found. Send a message to your bot first!"):Ye.success(`Found ${k.updates.length} updates`)):Ye.error(`Failed to get updates: ${k.error}`)}catch(k){console.error("Failed to get updates:",k),Ye.error("Failed to get chat updates")}finally{s(!1)}},j=async()=>{if(!e.chatId){Ye.error("Please set a Chat ID first");return}s(!0);try{const k=await Mr.sendMessage({text:` *Test Message*

Your QuickStrap Portal is connected to Telegram! 

 Check-in notifications
 Capacity alerts
 Security notifications
 Staff updates`,parse_mode:"Markdown"});k.success?Ye.success("Test message sent successfully!"):Ye.error(`Failed to send message: ${k.error}`)}catch(k){console.error("Failed to send test message:",k),Ye.error("Failed to send test message")}finally{s(!1)}},_=k=>{navigator.clipboard.writeText(k),Ye.success("Copied to clipboard")},y=k=>{var N,P,O,T;return((P=(N=k.message)==null?void 0:N.chat)==null?void 0:P.id)||((T=(O=k.edited_message)==null?void 0:O.chat)==null?void 0:T.id)||null},w=()=>e.botToken?e.chatId?e.enabled?n.jsx(Pn,{variant:"default",className:"bg-green-100 text-green-800",children:"Ready"}):n.jsx(Pn,{variant:"secondary",children:"Disabled"}):n.jsx(Pn,{variant:"outline",children:"Missing Chat ID"}):n.jsx(Pn,{variant:"secondary",children:"Not Configured"});return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h2",{className:"text-2xl font-bold flex items-center",children:[n.jsx(tb,{className:"h-6 w-6 mr-2 text-blue-500"}),"Telegram Configuration"]}),n.jsx("p",{className:"text-muted-foreground",children:"Configure direct Telegram notifications for real-time alerts"})]}),w()]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Bot Configuration"})}),n.jsxs(ye,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bot Token"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(on,{type:l?"text":"password",value:e.botToken,onChange:k=>t(N=>({...N,botToken:k.target.value})),placeholder:"123456789:ABCdefGHIjklMNOpqrsTUVwxyz",className:"flex-1"}),n.jsx(ht,{variant:"outline",size:"sm",onClick:()=>c(!l),children:l?n.jsx(Jy,{className:"h-4 w-4"}):n.jsx(us,{className:"h-4 w-4"})})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Get this from @BotFather in Telegram"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-2",children:"Chat ID"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(on,{value:e.chatId,onChange:k=>t(N=>({...N,chatId:k.target.value})),placeholder:"123456789 or -123456789 (for groups)"}),n.jsx(ht,{variant:"outline",size:"sm",onClick:v,disabled:r||!e.botToken,children:n.jsx(Gr,{className:"h-4 w-4"})})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Send a message to your bot, then click refresh to find your Chat ID"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",id:"telegram-enabled",checked:e.enabled,onChange:k=>t(N=>({...N,enabled:k.target.checked}))}),n.jsx("label",{htmlFor:"telegram-enabled",className:"text-sm font-medium",children:"Enable Telegram notifications"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(ht,{onClick:m,disabled:r,children:"Save Configuration"}),n.jsxs(ht,{variant:"outline",onClick:g,disabled:r||!e.botToken,children:[n.jsx(li,{className:"h-4 w-4 mr-2"}),"Test Connection"]}),n.jsx(ht,{variant:"outline",onClick:j,disabled:r||!e.chatId,children:"Send Test Message"})]})]})]}),d.length>0&&n.jsxs(ve,{children:[n.jsxs(De,{children:[n.jsx(Re,{children:"Recent Chat Messages"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Click on a Chat ID to use it in your configuration"})]}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-2",children:d.slice(0,5).map((k,N)=>{var T,A,C,E;const P=y(k),O=k.message||k.edited_message;return n.jsx("div",{className:"p-3 border rounded-lg",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("span",{className:"font-medium",children:["Chat ID: ",P]}),n.jsx(Pn,{variant:"outline",children:((T=O==null?void 0:O.chat)==null?void 0:T.type)||"unknown"})]}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[(A=O==null?void 0:O.from)==null?void 0:A.first_name," ",(C=O==null?void 0:O.from)==null?void 0:C.last_name,((E=O==null?void 0:O.chat)==null?void 0:E.title)&&` in ${O.chat.title}`]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:['"',(O==null?void 0:O.text)||"No text",'"']})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(ht,{variant:"outline",size:"sm",onClick:()=>_(P.toString()),children:n.jsx(Lf,{className:"h-4 w-4"})}),n.jsx(ht,{variant:"outline",size:"sm",onClick:()=>t(D=>({...D,chatId:P.toString()})),children:"Use This ID"})]})]})},N)})})})]}),a&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[a.success?n.jsx(Tt,{className:"h-5 w-5 text-green-500 mr-2"}):n.jsx(In,{className:"h-5 w-5 text-red-500 mr-2"}),"Connection Test Results"]})}),n.jsx(ye,{children:a.success?n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-green-600",children:" Bot connection successful!"}),a.botInfo&&n.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Bot Name:"})," ",a.botInfo.first_name]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Username:"})," @",a.botInfo.username]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Can Join Groups:"})," ",a.botInfo.can_join_groups?"Yes":"No"]})]})]}):n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-red-600",children:" Connection failed"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:a.error})]})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[n.jsx(ir,{className:"h-5 w-5 text-blue-500 mr-2"}),"Quick Setup Guide"]})}),n.jsx(ye,{children:n.jsxs("div",{className:"space-y-3 text-sm",children:[n.jsxs("div",{className:"flex items-start space-x-2",children:[n.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:"1"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Create a Telegram Bot"}),n.jsx("p",{className:"text-muted-foreground",children:"Message @BotFather in Telegram and use /newbot command"})]})]}),n.jsxs("div",{className:"flex items-start space-x-2",children:[n.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:"2"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Get Bot Token"}),n.jsx("p",{className:"text-muted-foreground",children:"Copy the token from BotFather (already filled above)"})]})]}),n.jsxs("div",{className:"flex items-start space-x-2",children:[n.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:"3"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Start Chat with Bot"}),n.jsx("p",{className:"text-muted-foreground",children:"Send any message to your bot in Telegram"})]})]}),n.jsxs("div",{className:"flex items-start space-x-2",children:[n.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:"4"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Get Chat ID"}),n.jsx("p",{className:"text-muted-foreground",children:"Click the refresh button above to find your Chat ID"})]})]}),n.jsxs("div",{className:"flex items-start space-x-2",children:[n.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:"5"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Test & Enable"}),n.jsx("p",{className:"text-muted-foreground",children:"Test the connection and enable notifications"})]})]})]})})]})]})},J1=()=>{const[e]=x.useState("8365810167:AAG-hEm4AV-vUNWWxVsGl3u901lU--kxU18"),[t,r]=x.useState(""),[s,a]=x.useState(" Test message from QuickStrap Portal!"),[i,l]=x.useState(!1),c=async()=>{if(!t){Ye.error("Please enter a Chat ID");return}l(!0);try{const h=`https://api.telegram.org/bot${e}/sendMessage`,m=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:t,text:s,parse_mode:"Markdown"})}),g=await m.json();m.ok&&g.ok?(Ye.success(" Message sent successfully!"),console.log("Telegram response:",g)):(Ye.error(` Failed: ${g.description||"Unknown error"}`),console.error("Telegram error:",g))}catch(h){console.error("Network error:",h),Ye.error(" Network error occurred")}finally{l(!1)}},d=async()=>{var h,m;l(!0);try{const g=`https://api.telegram.org/bot${e}/getUpdates`,v=await fetch(g),j=await v.json();if(v.ok&&j.ok)if(console.log("Chat updates:",j.result),j.result.length===0)Ye.info("No messages found. Send a message to your bot first!");else{const y=(m=(h=j.result[j.result.length-1].message)==null?void 0:h.chat)==null?void 0:m.id;y&&(r(y.toString()),Ye.success(`Found Chat ID: ${y}`))}else Ye.error(`Failed to get updates: ${j.description}`)}catch(g){console.error("Error getting updates:",g),Ye.error("Failed to get chat updates")}finally{l(!1)}},f=async()=>{l(!0);try{const h=`https://api.telegram.org/bot${e}/getMe`,m=await fetch(h),g=await m.json();m.ok&&g.ok?(Ye.success(` Bot connected: ${g.result.first_name}`),console.log("Bot info:",g.result)):Ye.error(` Bot error: ${g.description}`)}catch(h){console.error("Bot test error:",h),Ye.error(" Failed to connect to bot")}finally{l(!1)}};return n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[n.jsx(tb,{className:"h-5 w-5 mr-2 text-blue-500"}),"Telegram Direct Test"]})}),n.jsxs(ye,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bot Token (Pre-filled)"}),n.jsx(on,{value:e,disabled:!0,className:"bg-gray-50"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-2",children:"Chat ID"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(on,{value:t,onChange:h=>r(h.target.value),placeholder:"Your chat ID (e.g., 123456789)"}),n.jsx(ht,{variant:"outline",onClick:d,disabled:i,children:"Get ID"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-2",children:"Test Message"}),n.jsx(on,{value:s,onChange:h=>a(h.target.value),placeholder:"Enter test message"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(ht,{onClick:f,disabled:i,variant:"outline",children:[n.jsx(li,{className:"h-4 w-4 mr-2"}),"Test Bot"]}),n.jsxs(ht,{onClick:c,disabled:i||!t,children:[n.jsx(Kl,{className:"h-4 w-4 mr-2"}),"Send Message"]})]}),n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Quick Setup:"}),n.jsxs("ol",{className:"text-sm text-blue-800 space-y-1",children:[n.jsx("li",{children:"1. Start a chat with your bot in Telegram"}),n.jsx("li",{children:"2. Send any message to your bot"}),n.jsx("li",{children:'3. Click "Get ID" to find your Chat ID'}),n.jsx("li",{children:'4. Click "Send Message" to test'})]})]})]})]})},M9=()=>{var O,T,A,C,E,D,$,M,z,K;const[e,t]=x.useState([]),[r,s]=x.useState({}),[a,i]=x.useState({name:"",url:""}),[l,c]=x.useState({}),[d,f]=x.useState(!1),[h,m]=x.useState("webhooks");x.useEffect(()=>{g()},[]);const g=async()=>{try{await Promise.all([Kn.initialize(),N9.initialize()]);const W=Kn.getConfiguration(),U=Object.entries(W.webhooks).map(([Y,R])=>({name:Y,url:R,status:"inactive"}));t(U),s(W.notifications)}catch(W){console.error("Failed to load configuration:",W),Ye.error("Failed to load webhook configuration")}},v=async()=>{if(!a.name||!a.url){Ye.error("Please provide both name and URL");return}try{Kn.registerWebhook(a.name,a.url),t(W=>[...W,{...a,status:"inactive"}]),i({name:"",url:""}),Ye.success("Webhook added successfully")}catch(W){console.error("Failed to add webhook:",W),Ye.error("Failed to add webhook")}},j=async W=>{try{Kn.unregisterWebhook(W),t(U=>U.filter(Y=>Y.name!==W)),Ye.success("Webhook removed successfully")}catch(U){console.error("Failed to remove webhook:",U),Ye.error("Failed to remove webhook")}},_=async W=>{f(!0);try{const U=await Kn.testWebhook(W);c(Y=>({...Y,[W]:U})),t(Y=>Y.map(R=>R.name===W?{...R,status:U.success?"active":"error",lastTest:new Date}:R)),U.success?Ye.success(`Webhook ${W} test successful`):Ye.error(`Webhook ${W} test failed: ${U.error}`)}catch(U){console.error("Failed to test webhook:",U),Ye.error("Failed to test webhook")}finally{f(!1)}},y=async()=>{f(!0);try{const W=e.map(U=>_(U.name));await Promise.all(W),Ye.success("All webhooks tested")}catch(W){console.error("Failed to test all webhooks:",W),Ye.error("Failed to test all webhooks")}finally{f(!1)}},w=async W=>{try{await Kn.updateNotificationConfig(W),s(U=>({...U,...W})),Ye.success("Notification configuration updated")}catch(U){console.error("Failed to update notification config:",U),Ye.error("Failed to update notification configuration")}},k=W=>{navigator.clipboard.writeText(W),Ye.success("Copied to clipboard")},N=W=>{switch(W){case"active":return n.jsx(Tt,{className:"h-4 w-4 text-green-500"});case"error":return n.jsx(In,{className:"h-4 w-4 text-red-500"});default:return n.jsx(bt,{className:"h-4 w-4 text-yellow-500"})}},P=W=>{switch(W){case"active":return n.jsx(Pn,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"});case"error":return n.jsx(Pn,{variant:"destructive",children:"Error"});default:return n.jsx(Pn,{variant:"secondary",children:"Untested"})}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold",children:"Webhook & Notification Management"}),n.jsx("p",{className:"text-muted-foreground",children:"Configure webhooks for n8n automation and notification channels"})]}),n.jsxs(ht,{onClick:g,variant:"outline",size:"sm",children:[n.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),n.jsxs(Hc,{value:h,onValueChange:m,children:[n.jsxs(Vc,{className:"grid w-full grid-cols-4",children:[n.jsxs(mr,{value:"webhooks",children:[n.jsx(_h,{className:"h-4 w-4 mr-2"}),"Webhooks"]}),n.jsxs(mr,{value:"telegram",children:[n.jsx(xh,{className:"h-4 w-4 mr-2"}),"Telegram"]}),n.jsxs(mr,{value:"notifications",children:[n.jsx(xh,{className:"h-4 w-4 mr-2"}),"Notifications"]}),n.jsxs(mr,{value:"templates",children:[n.jsx(oi,{className:"h-4 w-4 mr-2"}),"Templates"]})]}),n.jsxs(sr,{value:"webhooks",className:"space-y-4",children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center",children:[n.jsx(po,{className:"h-5 w-5 mr-2"}),"Add New Webhook"]})}),n.jsxs(ye,{children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsx(on,{placeholder:"Webhook name (e.g., n8n-telegram)",value:a.name,onChange:W=>i(U=>({...U,name:W.target.value})),className:"flex-1"}),n.jsx(on,{placeholder:"Webhook URL",value:a.url,onChange:W=>i(U=>({...U,url:W.target.value})),className:"flex-2"}),n.jsx(ht,{onClick:v,disabled:!a.name||!a.url,children:"Add"})]}),n.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"n8n Webhook Setup:"}),n.jsxs("ol",{className:"text-sm text-blue-800 space-y-1",children:[n.jsx("li",{children:"1. Create a new workflow in n8n"}),n.jsx("li",{children:'2. Add a "Webhook" trigger node'}),n.jsx("li",{children:"3. Copy the webhook URL and paste it above"}),n.jsx("li",{children:"4. Configure your automation logic (Telegram, Slack, etc.)"}),n.jsx("li",{children:"5. Activate the workflow"})]})]})]})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Re,{children:"Registered Webhooks"}),n.jsxs(ht,{onClick:y,disabled:d||e.length===0,size:"sm",children:[n.jsx(li,{className:"h-4 w-4 mr-2"}),"Test All"]})]})}),n.jsx(ye,{children:e.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(_h,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"No webhooks configured"}),n.jsx("p",{className:"text-sm",children:"Add your first webhook to start receiving notifications"})]}):n.jsx("div",{className:"space-y-4",children:e.map(W=>n.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[N(W.status),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("h4",{className:"font-medium",children:W.name}),P(W.status)]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:W.url}),W.lastTest&&n.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last tested: ",W.lastTest.toLocaleString()]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(ht,{variant:"outline",size:"sm",onClick:()=>k(W.url),children:n.jsx(Lf,{className:"h-4 w-4"})}),n.jsx(ht,{variant:"outline",size:"sm",onClick:()=>_(W.name),disabled:d,children:n.jsx(li,{className:"h-4 w-4"})}),n.jsx(ht,{variant:"outline",size:"sm",onClick:()=>window.open(W.url,"_blank","noopener,noreferrer"),children:n.jsx(qC,{className:"h-4 w-4"})}),n.jsx(ht,{variant:"destructive",size:"sm",onClick:()=>j(W.name),children:n.jsx(wn,{className:"h-4 w-4"})})]})]},W.name))})})]}),Object.keys(l).length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Test Results"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-2",children:Object.entries(l).map(([W,U])=>n.jsxs("div",{className:"p-3 border rounded",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-medium",children:W}),U.success?n.jsx(Pn,{variant:"default",className:"bg-green-100 text-green-800",children:"Success"}):n.jsx(Pn,{variant:"destructive",children:"Failed"})]}),U.error&&n.jsx("p",{className:"text-sm text-red-600 mt-1",children:U.error}),U.response&&n.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Response: ",U.response]})]},W))})})]})]}),n.jsxs(sr,{value:"telegram",className:"space-y-4",children:[n.jsx(J1,{}),n.jsx(O9,{})]}),n.jsx(sr,{value:"notifications",className:"space-y-4",children:n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{children:"Notification Channels"})}),n.jsxs(ye,{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"font-medium",children:"Telegram"}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",checked:((O=r.telegram)==null?void 0:O.enabled)||!1,onChange:W=>w({telegram:{...r.telegram,enabled:W.target.checked}})}),n.jsx("span",{children:"Enabled"})]})]}),((T=r.telegram)==null?void 0:T.enabled)&&n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(on,{placeholder:"Bot Token",value:((A=r.telegram)==null?void 0:A.botToken)||"",onChange:W=>{var U;return w({telegram:{...r.telegram,enabled:((U=r.telegram)==null?void 0:U.enabled)||!1,botToken:W.target.value}})}}),n.jsx(on,{placeholder:"Chat ID",value:((C=r.telegram)==null?void 0:C.chatId)||"",onChange:W=>{var U;return w({telegram:{...r.telegram,enabled:((U=r.telegram)==null?void 0:U.enabled)||!1,chatId:W.target.value}})}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"font-medium",children:"Slack"}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",checked:((E=r.slack)==null?void 0:E.enabled)||!1,onChange:W=>w({slack:{...r.slack,enabled:W.target.checked}})}),n.jsx("span",{children:"Enabled"})]})]}),((D=r.slack)==null?void 0:D.enabled)&&n.jsx(on,{placeholder:"Slack Webhook URL",value:(($=r.slack)==null?void 0:$.webhookUrl)||"",onChange:W=>{var U;return w({slack:{...r.slack,enabled:((U=r.slack)==null?void 0:U.enabled)||!1,webhookUrl:W.target.value}})}})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"font-medium",children:"Discord"}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",checked:((M=r.discord)==null?void 0:M.enabled)||!1,onChange:W=>w({discord:{...r.discord,enabled:W.target.checked}})}),n.jsx("span",{children:"Enabled"})]})]}),((z=r.discord)==null?void 0:z.enabled)&&n.jsx(on,{placeholder:"Discord Webhook URL",value:((K=r.discord)==null?void 0:K.webhookUrl)||"",onChange:W=>{var U;return w({discord:{...r.discord,enabled:((U=r.discord)==null?void 0:U.enabled)||!1,webhookUrl:W.target.value}})}})]})]})]})}),n.jsx(sr,{value:"templates",className:"space-y-4",children:n.jsxs(ve,{children:[n.jsxs(De,{children:[n.jsx(Re,{children:"Notification Templates"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Templates are automatically created and managed by the system. Use n8n workflows to customize message formatting and routing."})]}),n.jsx(ye,{children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-4 border rounded-lg",children:[n.jsx("h4",{className:"font-medium mb-2",children:"Available Event Types:"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsx("div",{children:" checkin.created"}),n.jsx("div",{children:" capacity.alert"}),n.jsx("div",{children:" security.alert"}),n.jsx("div",{children:" staff.status"}),n.jsx("div",{children:" gate.approval_request"}),n.jsx("div",{children:" system.health"})]})]}),n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Template Variables:"}),n.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[n.jsxs("div",{children:[" ","{{event_name}}"," - Event name"]}),n.jsxs("div",{children:[" ","{{wristband_id}}"," - Wristband ID"]}),n.jsxs("div",{children:[" ","{{gate_name}}"," - Gate name"]}),n.jsxs("div",{children:[" ","{{staff_name}}"," - Staff member name"]}),n.jsxs("div",{children:[" ","{{timestamp}}"," - Event timestamp"]}),n.jsxs("div",{children:[" ","{{current_count}}"," - Current attendance"]}),n.jsxs("div",{children:[" ","{{capacity_limit}}"," - Capacity limit"]})]})]})]})})]})})]})]})},I9=()=>n.jsx("div",{className:"p-6",children:n.jsx(M9,{})}),L9=()=>n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Telegram Integration Test"}),n.jsx(J1,{})]})});function D9(){var c;const[e,t]=x.useState([]),[r,s]=x.useState(""),[a,i]=x.useState(!0);x.useEffect(()=>{l()},[]);async function l(){try{const{data:d,error:f}=await B.from("events").select("id, name, start_date, is_active").order("start_date",{ascending:!1});if(f)throw f;t(d||[]);const h=d==null?void 0:d.find(m=>m.is_active);h?s(h.id):d&&d.length>0&&s(d[0].id)}catch(d){console.error("Error fetching events:",d)}finally{i(!1)}}return a?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):e.length===0?n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:n.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[n.jsx(sa,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No Events Found"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Create an event first to generate reports."})]})}):n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Reports"}),n.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Generate and export detailed reports for your events"})]})}),n.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow p-6",children:[n.jsxs("label",{htmlFor:"event-select",className:"block text-sm font-medium text-gray-700 mb-2",children:[n.jsx(On,{className:"inline h-4 w-4 mr-2"}),"Select Event"]}),n.jsx("select",{id:"event-select",value:r,onChange:d=>s(d.target.value),className:"block w-full max-w-md rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:e.map(d=>n.jsxs("option",{value:d.id,children:[d.name," - ",new Date(d.start_date).toLocaleDateString(),d.is_active?" (Active)":""]},d.id))}),n.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Reports will be generated for the selected event"})]})]}),r&&n.jsx(D1,{eventId:r,eventName:((c=e.find(d=>d.id===r))==null?void 0:c.name)||"Unknown Event"})]})}const R9=({eventId:e})=>{var Ce,$e,Ne;const[t,r]=x.useState(null),[s,a]=x.useState(!0),[i,l]=x.useState(null),[c,d]=x.useState("realtime"),[f,h]=x.useState(null),[m,g]=x.useState([]),[v,j]=x.useState([]),[_,y]=x.useState([]),[w,k]=x.useState([]),[N,P]=x.useState(null),[O,T]=x.useState(null),[A,C]=x.useState(0),[E,D]=x.useState(null),[$,M]=x.useState(null),[z,K]=x.useState(null),[W,U]=x.useState(null),[Y,R]=x.useState(null),[H,J]=x.useState(null),F=async()=>{try{a(!0),l(null);const[G,se,ue]=await Promise.allSettled([B.from("wristbands").select("id, is_active").eq("event_id",e),B.from("checkin_logs").select("id, timestamp").eq("event_id",e),B.from("gates").select("id, status").eq("event_id",e)]);let he=0,me=0,Me=0,Qe=0,Xe="N/A";if(G.status==="fulfilled"&&G.value.data&&(he=G.value.data.length),se.status==="fulfilled"&&se.value.data){const tt=se.value.data;if(me=tt.length,tt.length>0){const ae={};tt.forEach(We=>{const It=`${new Date(We.timestamp).getHours().toString().padStart(2,"0")}:00`;ae[It]=(ae[It]||0)+1});const Te=Object.entries(ae).sort((We,tr)=>tr[1]-We[1])[0];Te&&(Xe=Te[0])}}ue.status==="fulfilled"&&ue.value.data&&(Me=ue.value.data.length,Qe=ue.value.data.filter(tt=>tt.status==="active").length);const ut=he>0?me/he*100:0;r({totalWristbands:he,checkedIn:me,checkInRate:ut,totalGates:Me,activeGates:Qe,peakHour:Xe})}catch(G){console.error("Error loading analytics:",G),l(G instanceof Error?G.message:"Failed to load analytics")}finally{a(!1)}},V=async()=>{try{const[G,se,ue,he]=await Promise.all([O1(e),M1(e,"hour"),I1(e),L1(e)]);G.success&&G.data&&h(G.data),se.success&&se.data&&g(se.data),ue.success&&ue.data&&j(ue.data),he.success&&he.data&&y(he.data),await te(),await Z(),await ie(),await fe()}catch(G){console.error("Error loading advanced analytics:",G),ge.error("Some analytics could not be loaded")}},te=async()=>{try{const{data:G,error:se}=await B.from("staff_performance_cache").select("*").eq("event_id",e).order("efficiency_score",{ascending:!1});if(se)throw se;k(G||[])}catch(G){console.error("Error loading staff performance:",G)}},Z=async()=>{try{const[G,se]=await Promise.all([B.from("fraud_detections").select("id, severity, detection_type, investigated_at").eq("event_id",e),B.from("fraud_cases").select("id, status, priority").eq("event_id",e)]),ue=G.data||[],he=se.data||[];P({totalAlerts:ue.length,criticalAlerts:ue.filter(me=>me.severity==="critical").length,investigated:ue.filter(me=>me.investigated_at!==null).length,totalCases:he.length,openCases:he.filter(me=>me.status==="open"||me.status==="investigating").length,resolvedCases:he.filter(me=>me.status==="resolved").length,byType:ue.reduce((me,Me)=>(me[Me.detection_type]=(me[Me.detection_type]||0)+1,me),{})})}catch(G){console.error("Error loading fraud analytics:",G)}},ie=async()=>{try{const{data:G,error:se}=await B.from("checkin_logs").select("processing_time_ms, status").eq("event_id",e);if(se)throw se;const ue=G||[],he=ue.filter(Qe=>Qe.status==="success"),me=he.length>0?he.reduce((Qe,Xe)=>Qe+(Xe.processing_time_ms||0),0)/he.length:0,Me=ue.length>0?ue.filter(Qe=>Qe.status==="error").length/ue.length*100:0;T({avgProcessingTime:me,errorRate:Me,totalTransactions:ue.length,successfulTransactions:he.length,uptime:100-Me})}catch(G){console.error("Error loading system health:",G)}},fe=async()=>{try{const G=v.length>0?v.reduce((me,Me)=>me+(Me.health_score||0),0)/v.length:0,se=(N==null?void 0:N.totalAlerts)>0?Math.max(0,100-N.criticalAlerts/N.totalAlerts*100):100,ue=(t==null?void 0:t.checkInRate)||0,he=G*.4+se*.3+ue*.3;C(Math.round(he))}catch(G){console.error("Error calculating event health:",G),C(0)}},be=async()=>{var G,se,ue;try{const{data:he}=await B.from("events").select("total_capacity, start_date, end_date").eq("id",e).single();if(!he)return;const[me,Me,Qe,Xe]=await Promise.allSettled([B.rpc("calculate_avg_dwell_time",{event_id:e}),B.from("checkin_logs").select("timestamp").eq("event_id",e).eq("status","success"),B.rpc("analyze_arrival_patterns",{event_id:e,start_date:he.start_date}),B.rpc("calculate_reentry_rate",{event_id:e})]);let ut=[];if(Me.status==="fulfilled"&&Me.value.data){const ae={};Me.value.data.forEach(Te=>{const We=new Date(Te.timestamp).getHours();ae[We]=(ae[We]||0)+1}),ut=Array.from({length:24},(Te,We)=>ae[We]||0)}const tt={totalCapacity:he.total_capacity||0,capacityUtilization:t?t.checkedIn/he.total_capacity*100:0,avgDwellTime:me.status==="fulfilled"&&me.value.data||0,checkInVelocity:ut,peakOccupancy:Math.max(...ut),noShowRate:t?(t.totalWristbands-t.checkedIn)/t.totalWristbands*100:0,earlyBirds:Qe.status==="fulfilled"&&((G=Qe.value.data)==null?void 0:G.early_birds)||0,onTimeArrivals:Qe.status==="fulfilled"&&((se=Qe.value.data)==null?void 0:se.on_time)||0,lateArrivals:Qe.status==="fulfilled"&&((ue=Qe.value.data)==null?void 0:ue.late_arrivals)||0,reEntryRate:Xe.status==="fulfilled"&&Xe.value.data||0};D(tt)}catch(he){console.error("Error loading attendance analytics:",he)}},xe=async()=>{try{const[G,se,ue,he,me]=await Promise.allSettled([B.from("gate_performance_cache").select("*").eq("event_id",e).order("health_score",{ascending:!1}),B.rpc("detect_gate_bottlenecks",{event_id:e}),B.rpc("calculate_gate_reliability",{event_id:e}),B.from("autonomous_gates").select("*, gates(name)").eq("event_id",e),B.from("gate_merge_suggestions").select("*, gates!primary_gate_id(name), gates!secondary_gate_id(name)").eq("event_id",e).eq("status","pending")]),Me={gateEfficiency:G.status==="fulfilled"?G.value.data||[]:[],bottleneckGates:se.status==="fulfilled"?se.value.data||[]:[],underutilizedGates:[],gateReliability:ue.status==="fulfilled"?ue.value.data||[]:[],autonomousOperations:he.status==="fulfilled"?he.value.data||[]:[],mergeRecommendations:me.status==="fulfilled"?me.value.data||[]:[]};if(Me.gateEfficiency.length>0){const Qe=Me.gateEfficiency.reduce((Xe,ut)=>Xe+(ut.total_scans||0),0)/Me.gateEfficiency.length;Me.underutilizedGates=Me.gateEfficiency.filter(Xe=>(Xe.total_scans||0)<Qe*.5)}M(Me)}catch(G){console.error("Error loading gate analytics:",G)}},oe=async()=>{try{const[G,se,ue,he,me]=await Promise.allSettled([B.rpc("analyze_fraud_rule_performance",{event_id:e}),B.rpc("get_watchlist_effectiveness",{event_id:e}),B.rpc("analyze_investigator_performance",{event_id:e}),B.rpc("analyze_fraud_trends",{event_id:e}),B.rpc("calculate_rule_effectiveness",{event_id:e})]),{count:Me}=await B.from("fraud_cases").select("*",{count:"exact",head:!0}).eq("event_id",e).in("status",["open","investigating"]),Qe={fraudRules:G.status==="fulfilled"?G.value.data||[]:[],watchlistHits:se.status==="fulfilled"?se.value.data||[]:[],investigatorPerformance:ue.status==="fulfilled"?ue.value.data||[]:[],caseBacklog:Me||0,fraudTrends:he.status==="fulfilled"?he.value.data||[]:[],ruleEffectiveness:me.status==="fulfilled"?me.value.data||[]:[]};K(Qe)}catch(G){console.error("Error loading security analytics:",G)}},de=async()=>{try{const[G,se,ue,he,me]=await Promise.allSettled([B.rpc("analyze_staff_skill_gaps",{event_id:e}),B.rpc("identify_training_needs",{event_id:e}),B.rpc("analyze_staffing_optimization",{event_id:e}),B.from("staff_messages").select("*").eq("event_id",e),B.rpc("track_performance_improvement",{event_id:e})]),Me={skillGapAnalysis:G.status==="fulfilled"?G.value.data||[]:[],trainingNeeds:se.status==="fulfilled"?se.value.data||[]:[],staffOptimization:ue.status==="fulfilled"?ue.value.data||[]:[],communicationMetrics:he.status==="fulfilled"?he.value.data||[]:[],performanceImprovement:me.status==="fulfilled"?me.value.data||[]:[]};U(Me)}catch(G){console.error("Error loading staff analytics:",G)}},ce=async()=>{var G;try{const[se,ue,he,me,Me]=await Promise.allSettled([B.rpc("analyze_cache_performance",{event_id:e}),B.rpc("get_api_performance_metrics",{event_id:e}),B.rpc("assess_data_quality",{event_id:e}),B.from("system_health_logs").select("*").eq("event_id",e).order("recorded_at",{ascending:!1}).limit(1),B.from("predictive_insights").select("*").eq("event_id",e).eq("insight_type","optimization_suggestion")]),Qe={cachePerformance:se.status==="fulfilled"?se.value.data||[]:[],apiMetrics:ue.status==="fulfilled"?ue.value.data||[]:[],dataQuality:he.status==="fulfilled"?he.value.data:null,selfHealingMetrics:me.status==="fulfilled"?(G=me.value.data)==null?void 0:G[0]:null,predictiveInsights:Me.status==="fulfilled"?Me.value.data||[]:[]};R(Qe)}catch(se){console.error("Error loading system analytics:",se)}},ne=async()=>{try{const[G,se,ue,he,me]=await Promise.allSettled([B.rpc("calculate_event_roi",{event_id:e}),B.rpc("analyze_cost_efficiency",{event_id:e}),B.rpc("calculate_quality_of_service",{event_id:e}),B.rpc("benchmark_event_performance",{event_id:e}),B.from("predictions").select("*").eq("event_id",e).in("prediction_type",["attendance_forecast","staffing_recommendation"])]),Me={eventROI:G.status==="fulfilled"?G.value.data:null,costEfficiency:se.status==="fulfilled"?se.value.data||[]:[],qualityOfService:ue.status==="fulfilled"?ue.value.data:null,benchmarking:he.status==="fulfilled"?he.value.data||[]:[],predictiveForecasting:me.status==="fulfilled"?me.value.data||[]:[]};J(Me)}catch(G){console.error("Error loading business analytics:",G)}},Oe=()=>{if(!t)return;const se=[["Metric","Value"],["Total Wristbands",t.totalWristbands],["Checked In",t.checkedIn],["Check-in Rate",`${t.checkInRate.toFixed(1)}%`],["Total Gates",t.totalGates],["Active Gates",t.activeGates],["Peak Hour",t.peakHour]].map(Me=>Me.join(",")).join(`
`),ue=new Blob([se],{type:"text/csv"}),he=window.URL.createObjectURL(ue),me=document.createElement("a");me.href=he,me.download=`analytics-${e}-${Date.now()}.csv`,me.click(),window.URL.revokeObjectURL(he),ge.success("Analytics exported to CSV")};return x.useEffect(()=>{let G=!0;const se=new AbortController;return(async()=>{if(e)try{await Promise.allSettled([F(),V(),be(),xe(),oe(),de(),ce(),ne()])}catch(he){G&&he instanceof Error&&he.name!=="AbortError"&&(console.error("Error loading analytics:",he),l(he instanceof Error?he.message:"Failed to load analytics"))}})(),()=>{G=!1,se.abort()}},[e]),e?i?n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ir,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600 mb-2",children:"Error loading analytics"}),n.jsx("p",{className:"text-sm text-gray-500 mb-4",children:i}),n.jsx(ht,{onClick:F,children:"Retry"})]})}):s?n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),n.jsx("p",{className:"mt-4 text-gray-600",children:"Loading analytics..."})]})}):t?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Event Analytics Dashboard"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Comprehensive event performance and insights"})]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsxs(ht,{variant:"outline",onClick:()=>{F(),V(),be(),xe(),oe(),de(),ce(),ne()},className:"flex items-center space-x-2",children:[n.jsx(Gr,{className:"w-4 h-4"}),n.jsx("span",{children:"Refresh"})]}),n.jsxs(ht,{onClick:Oe,className:"flex items-center space-x-2",children:[n.jsx(_n,{className:"w-4 h-4"}),n.jsx("span",{children:"Export CSV"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsx(ve,{children:n.jsx(ye,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Total Wristbands"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:t.totalWristbands.toLocaleString()})]}),n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(lt,{className:"w-6 h-6 text-blue-600"})})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Checked In"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:t.checkedIn.toLocaleString()})]}),n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(Xa,{className:"w-6 h-6 text-blue-600"})})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Check-in Rate"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:[t.checkInRate.toFixed(1),"%"]})]}),n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(Mn,{className:"w-6 h-6 text-blue-600"})})]})})}),n.jsx(ve,{children:n.jsx(ye,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Active Gates"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:[t.activeGates," / ",t.totalGates]})]}),n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(qt,{className:"w-6 h-6 text-blue-600"})})]})})})]}),n.jsxs(Hc,{value:c,onValueChange:d,children:[n.jsxs(Vc,{className:"grid grid-cols-8 w-full",children:[n.jsxs(mr,{value:"realtime",children:[n.jsx(qt,{className:"w-4 h-4 mr-1"}),"Real-Time"]}),n.jsxs(mr,{value:"attendance",children:[n.jsx(lt,{className:"w-4 h-4 mr-1"}),"Attendance"]}),n.jsxs(mr,{value:"gates",children:[n.jsx(WC,{className:"w-4 h-4 mr-1"}),"Gates"]}),n.jsxs(mr,{value:"categories",children:[n.jsx(ai,{className:"w-4 h-4 mr-1"}),"Categories"]}),n.jsxs(mr,{value:"staff",children:[n.jsx(lt,{className:"w-4 h-4 mr-1"}),"Staff"]}),n.jsxs(mr,{value:"security",children:[n.jsx(jr,{className:"w-4 h-4 mr-1"}),"Security"]}),n.jsxs(mr,{value:"system",children:[n.jsx(ha,{className:"w-4 h-4 mr-1"}),"System"]}),n.jsxs(mr,{value:"business",children:[n.jsx(Mn,{className:"w-4 h-4 mr-1"}),"Business"]})]}),n.jsxs(sr,{value:"realtime",className:"space-y-4",children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Event Health Score"})}),n.jsxs(ye,{children:[n.jsx("div",{className:"flex items-center justify-center",children:n.jsxs("div",{className:"relative w-40 h-40",children:[n.jsxs("svg",{className:"transform -rotate-90 w-40 h-40",children:[n.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"currentColor",strokeWidth:"12",fill:"transparent",className:"text-gray-200"}),n.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"currentColor",strokeWidth:"12",fill:"transparent",strokeDasharray:`${2*Math.PI*70}`,strokeDashoffset:`${2*Math.PI*70*(1-A/100)}`,className:A>=80?"text-green-500":A>=60?"text-blue-500":A>=40?"text-yellow-500":"text-red-500",strokeLinecap:"round"})]}),n.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[n.jsx("span",{className:"text-4xl font-bold text-gray-900",children:A}),n.jsx("span",{className:"text-sm text-gray-500",children:"Health Score"})]})]})}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[n.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Gate Health"}),n.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[v.length>0?Math.round(v.reduce((G,se)=>G+(se.health_score||0),0)/v.length):0,"%"]}),n.jsx("p",{className:"text-xs text-gray-500",children:"40% weight"})]}),n.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Security Risk"}),n.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[N?Math.round(100-N.criticalAlerts/Math.max(N.totalAlerts,1)*100):100,"%"]}),n.jsx("p",{className:"text-xs text-gray-500",children:"30% weight"})]}),n.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Operational Efficiency"}),n.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[t==null?void 0:t.checkInRate.toFixed(1),"%"]}),n.jsx("p",{className:"text-xs text-gray-500",children:"30% weight"})]})]})]})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Live Capacity Tracking"})}),n.jsx(ye,{children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Attendance"}),n.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.checkedIn.toLocaleString()})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-6 relative overflow-hidden",children:n.jsx("div",{className:`h-6 rounded-full flex items-center justify-end pr-2 transition-all ${(t==null?void 0:t.checkedIn)/(t==null?void 0:t.totalWristbands)*100>90?"bg-red-600":(t==null?void 0:t.checkedIn)/(t==null?void 0:t.totalWristbands)*100>75?"bg-yellow-600":"bg-blue-600"}`,style:{width:`${Math.min((t==null?void 0:t.checkedIn)/(t==null?void 0:t.totalWristbands)*100,100)}%`},children:n.jsxs("span",{className:"text-xs font-semibold text-white",children:[((t==null?void 0:t.checkedIn)/(t==null?void 0:t.totalWristbands)*100||0).toFixed(1),"%"]})})}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsx("p",{className:"text-xs text-blue-900 uppercase mb-1",children:"Total Capacity"}),n.jsx("p",{className:"text-lg font-bold text-blue-700",children:t==null?void 0:t.totalWristbands.toLocaleString()})]}),n.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsx("p",{className:"text-xs text-blue-900 uppercase mb-1",children:"Checked In"}),n.jsx("p",{className:"text-lg font-bold text-blue-700",children:t==null?void 0:t.checkedIn.toLocaleString()})]}),n.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsx("p",{className:"text-xs text-blue-900 uppercase mb-1",children:"Check-In Rate"}),n.jsxs("p",{className:"text-lg font-bold text-blue-700",children:[t==null?void 0:t.checkInRate.toFixed(1),"%"]})]})]})]})})]}),N&&N.totalAlerts>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"text-lg flex items-center",children:[n.jsx(ir,{className:"w-5 h-5 mr-2 text-red-600"}),"Critical Alerts"]})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[n.jsxs("div",{className:`text-center p-4 rounded-lg border ${N.criticalAlerts>0?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase mb-2",children:"Critical Alerts"}),n.jsx("p",{className:`text-3xl font-bold ${N.criticalAlerts>0?"text-red-700":"text-gray-900"}`,children:N.criticalAlerts})]}),n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase mb-2",children:"Total Alerts"}),n.jsx("p",{className:"text-3xl font-bold text-gray-900",children:N.totalAlerts})]}),n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase mb-2",children:"Open Cases"}),n.jsx("p",{className:"text-3xl font-bold text-gray-900",children:N.openCases})]}),n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase mb-2",children:"Resolved"}),n.jsx("p",{className:"text-3xl font-bold text-green-700",children:N.resolvedCases})]})]})})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx(ve,{children:n.jsxs(ye,{className:"p-4",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Peak Hour"}),n.jsx("p",{className:"text-xl font-bold text-gray-900",children:t==null?void 0:t.peakHour}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Highest traffic"})]})}),n.jsx(ve,{children:n.jsxs(ye,{className:"p-4",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Active Gates"}),n.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[t==null?void 0:t.activeGates," / ",t==null?void 0:t.totalGates]}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(t==null?void 0:t.totalGates)>0?((t==null?void 0:t.activeGates)/(t==null?void 0:t.totalGates)*100).toFixed(0):0,"% operational"]})]})}),n.jsx(ve,{children:n.jsxs(ye,{className:"p-4",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Avg Processing"}),n.jsx("p",{className:"text-xl font-bold text-gray-900",children:f!=null&&f.avg_processing_time?`${Math.round(f.avg_processing_time)}ms`:"N/A"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Per check-in"})]})}),n.jsx(ve,{children:n.jsxs(ye,{className:"p-4",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Staff Active"}),n.jsx("p",{className:"text-xl font-bold text-gray-900",children:w.length}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"On duty"})]})})]})]}),n.jsxs(sr,{value:"overview",className:"space-y-4",children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"flex items-center text-lg",children:[n.jsx(Vr,{className:"w-5 h-5 mr-2"}),"Event Performance Summary"]})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase mb-1",children:"Peak Check-in Hour"}),n.jsx("p",{className:"text-xl font-bold text-blue-700",children:t.peakHour})]}),n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase mb-1",children:"Avg Check-in Rate"}),n.jsxs("p",{className:"text-xl font-bold text-blue-700",children:[t.checkInRate.toFixed(1),"%"]})]}),n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase mb-1",children:"Gate Utilization"}),n.jsxs("p",{className:"text-xl font-bold text-blue-700",children:[t.totalGates>0?(t.activeGates/t.totalGates*100).toFixed(1):0,"%"]})]})]})})]}),f&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Event Health Metrics"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Unique Attendees"}),n.jsx("p",{className:"text-lg font-bold text-gray-900",children:((Ce=f.unique_attendees)==null?void 0:Ce.toLocaleString())||0})]}),n.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Total Check-ins"}),n.jsx("p",{className:"text-lg font-bold text-gray-900",children:(($e=f.total_checkins)==null?void 0:$e.toLocaleString())||0})]}),n.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Avg Processing"}),n.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[(f.avg_processing_time||0).toFixed(0),"ms"]})]}),n.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-1",children:"Staff Worked"}),n.jsx("p",{className:"text-lg font-bold text-gray-900",children:f.staff_worked||0})]})]})})]})]}),n.jsxs(sr,{value:"attendance",className:"space-y-4",children:[E&&n.jsxs(n.Fragment,{children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Capacity Analysis"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-blue-900 uppercase mb-2",children:"Total Capacity"}),n.jsx("p",{className:"text-2xl font-bold text-blue-700",children:E.totalCapacity.toLocaleString()})]}),n.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-green-900 uppercase mb-2",children:"Utilization"}),n.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[E.capacityUtilization.toFixed(1),"%"]})]}),n.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-purple-900 uppercase mb-2",children:"Avg Dwell Time"}),n.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[(E.avgDwellTime/60).toFixed(1),"h"]})]}),n.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-orange-900 uppercase mb-2",children:"Peak Occupancy"}),n.jsx("p",{className:"text-2xl font-bold text-orange-700",children:E.peakOccupancy})]})]})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Arrival Pattern Analysis"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Early Birds"}),n.jsx("p",{className:"text-xl font-bold text-gray-900",children:E.earlyBirds}),n.jsx("p",{className:"text-xs text-gray-500",children:"Before start time"})]}),n.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-green-900 uppercase mb-2",children:"On Time"}),n.jsx("p",{className:"text-xl font-bold text-green-700",children:E.onTimeArrivals}),n.jsx("p",{className:"text-xs text-green-600",children:"Within 30 min"})]}),n.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-yellow-900 uppercase mb-2",children:"Late Arrivals"}),n.jsx("p",{className:"text-xl font-bold text-yellow-700",children:E.lateArrivals}),n.jsx("p",{className:"text-xs text-yellow-600",children:"30+ min late"})]}),n.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-red-900 uppercase mb-2",children:"No-Show Rate"}),n.jsxs("p",{className:"text-xl font-bold text-red-700",children:[E.noShowRate.toFixed(1),"%"]}),n.jsx("p",{className:"text-xs text-red-600",children:"Never checked in"})]})]})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"24-Hour Check-in Velocity"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-2",children:E.checkInVelocity.map((G,se)=>{const ue=Math.max(...E.checkInVelocity),he=ue>0?G/ue*100:0;return n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("div",{className:"w-16 text-xs text-gray-600 font-mono",children:[se.toString().padStart(2,"0"),":00"]}),n.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-6 relative",children:n.jsx("div",{className:`h-6 rounded-full flex items-center justify-end pr-2 ${G===ue?"bg-red-600":"bg-blue-600"}`,style:{width:`${he}%`},children:G>0&&n.jsx("span",{className:"text-xs font-semibold text-white",children:G})})}),n.jsx("div",{className:"w-12 text-xs text-gray-500 text-right",children:G})]},se)})})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Re-entry & Engagement"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-blue-900 uppercase mb-2",children:"Re-entry Rate"}),n.jsxs("p",{className:"text-3xl font-bold text-blue-700",children:[E.reEntryRate.toFixed(1),"%"]}),n.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Multiple check-ins per attendee"})]}),n.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-purple-900 uppercase mb-2",children:"Engagement Score"}),n.jsx("p",{className:"text-3xl font-bold text-purple-700",children:Math.round((100-E.noShowRate)*(E.reEntryRate/100+1))}),n.jsx("p",{className:"text-xs text-purple-600 mt-2",children:"Composite engagement metric"})]})]})})]})]}),!E&&m.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Check-in Trends"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-3",children:m.slice(0,10).map((G,se)=>{const ue=Math.max(...m.map(me=>me.checkins)),he=G.checkins/ue*100;return n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-32 text-xs text-gray-600 font-mono",children:new Date(G.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),n.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-6 relative",children:n.jsx("div",{className:"bg-blue-600 h-6 rounded-full flex items-center justify-end pr-2",style:{width:`${he}%`},children:n.jsx("span",{className:"text-xs font-semibold text-white",children:G.checkins})})}),n.jsxs("div",{className:"w-20 text-xs text-gray-500 text-right",children:[G.cumulative_checkins," total"]})]},se)})})})]})]}),n.jsxs(sr,{value:"gates",className:"space-y-4",children:[$&&n.jsxs(n.Fragment,{children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Gate Efficiency Analysis"})}),n.jsx(ye,{children:$.gateEfficiency.length>0?n.jsx("div",{className:"space-y-4",children:$.gateEfficiency.map((G,se)=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:G.gate_name||`Gate ${se+1}`}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${(G.health_score||0)>=80?"bg-green-100 text-green-800":(G.health_score||0)>=60?"bg-blue-100 text-blue-800":(G.health_score||0)>=40?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[(G.health_score||0).toFixed(0),"% Health"]}),n.jsxs("span",{className:"text-sm text-gray-600",children:[(G.total_scans||0).toLocaleString()," scans"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[n.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Avg Processing"}),n.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[(G.avg_scan_time_ms||0).toFixed(0),"ms"]})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Success Rate"}),n.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[G.total_scans>0?(G.successful_scans/G.total_scans*100).toFixed(1):0,"%"]})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Scans/Hour"}),n.jsx("p",{className:"text-sm font-bold text-gray-900",children:(G.scans_per_hour||0).toFixed(0)})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Uptime"}),n.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[(G.uptime_percentage||0).toFixed(1),"%"]})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Peak Hour"}),n.jsx("p",{className:"text-sm font-bold text-gray-900",children:G.peak_hour||"N/A"})]})]})]},se))}):n.jsx("p",{className:"text-gray-500 text-center py-8",children:"No gate efficiency data available"})})]}),$.bottleneckGates.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"text-lg flex items-center",children:[n.jsx(ir,{className:"w-5 h-5 mr-2 text-red-600"}),"Bottleneck Gates"]})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-3",children:$.bottleneckGates.map((G,se)=>n.jsxs("div",{className:"border border-red-200 bg-red-50 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-semibold text-red-900",children:G.gate_name}),n.jsxs("span",{className:"text-sm text-red-700",children:["Bottleneck Score: ",G.bottleneck_score]})]}),n.jsx("p",{className:"text-sm text-red-800",children:G.reason}),n.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xs text-red-600",children:"Queue Length"}),n.jsx("p",{className:"text-sm font-bold text-red-900",children:G.avg_queue_length})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xs text-red-600",children:"Wait Time"}),n.jsxs("p",{className:"text-sm font-bold text-red-900",children:[G.avg_wait_time,"s"]})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xs text-red-600",children:"Utilization"}),n.jsxs("p",{className:"text-sm font-bold text-red-900",children:[G.utilization,"%"]})]})]})]},se))})})]}),$.underutilizedGates.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"text-lg flex items-center",children:[n.jsx(oP,{className:"w-5 h-5 mr-2 text-yellow-600"}),"Underutilized Gates"]})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-3",children:$.underutilizedGates.map((G,se)=>n.jsxs("div",{className:"border border-yellow-200 bg-yellow-50 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-semibold text-yellow-900",children:G.gate_name||`Gate ${se+1}`}),n.jsxs("span",{className:"text-sm text-yellow-700",children:[G.total_scans," scans (Below Average)"]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xs text-yellow-600",children:"Utilization"}),n.jsxs("p",{className:"text-sm font-bold text-yellow-900",children:[G.total_scans>0?(G.scans_per_hour/100*100).toFixed(1):0,"%"]})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xs text-yellow-600",children:"Scans/Hour"}),n.jsx("p",{className:"text-sm font-bold text-yellow-900",children:G.scans_per_hour||0})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xs text-yellow-600",children:"Potential"}),n.jsx("p",{className:"text-sm font-bold text-yellow-900",children:"High"})]})]})]},se))})})]}),$.autonomousOperations.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"text-lg flex items-center",children:[n.jsx(ha,{className:"w-5 h-5 mr-2 text-purple-600"}),"Autonomous Gate Operations"]})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-3",children:$.autonomousOperations.map((G,se)=>{var ue;return n.jsxs("div",{className:"border border-purple-200 bg-purple-50 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-semibold text-purple-900",children:((ue=G.gates)==null?void 0:ue.name)||`Gate ${se+1}`}),n.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${G.status==="active"?"bg-green-100 text-green-800":G.status==="learning"?"bg-blue-100 text-blue-800":G.status==="optimizing"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:G.status})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-purple-600",children:"Confidence"}),n.jsxs("p",{className:"text-sm font-bold text-purple-900",children:[(G.confidence_score*100).toFixed(1),"%"]})]}),n.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-purple-600",children:"Decisions"}),n.jsx("p",{className:"text-sm font-bold text-purple-900",children:G.decisions_count})]}),n.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-purple-600",children:"Accuracy"}),n.jsxs("p",{className:"text-sm font-bold text-purple-900",children:[(G.accuracy_rate*100).toFixed(1),"%"]})]}),n.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-purple-600",children:"Response Time"}),n.jsxs("p",{className:"text-sm font-bold text-purple-900",children:[G.avg_response_time_ms,"ms"]})]})]})]},se)})})})]}),$.mergeRecommendations.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsxs(Re,{className:"text-lg flex items-center",children:[n.jsx(qt,{className:"w-5 h-5 mr-2 text-blue-600"}),"Gate Merge Recommendations"]})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-3",children:$.mergeRecommendations.map((G,se)=>{var ue,he;return n.jsxs("div",{className:"border border-blue-200 bg-blue-50 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h4",{className:"font-semibold text-blue-900",children:[(ue=G.gates)==null?void 0:ue.name," + ",(he=G.gates)==null?void 0:he.name]}),n.jsxs("span",{className:"text-sm text-blue-700",children:[(G.confidence_score*100).toFixed(1),"% Confidence"]})]}),n.jsx("p",{className:"text-sm text-blue-800 mb-3",children:G.reasoning}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-blue-600",children:"Distance"}),n.jsxs("p",{className:"text-sm font-bold text-blue-900",children:[G.distance_meters,"m"]})]}),n.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-blue-600",children:"Traffic Similarity"}),n.jsxs("p",{className:"text-sm font-bold text-blue-900",children:[(G.traffic_similarity*100).toFixed(1),"%"]})]}),n.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-blue-600",children:"Potential Savings"}),n.jsx("p",{className:"text-sm font-bold text-blue-900",children:"High"})]})]})]},se)})})})]})]}),!$&&v.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Gate Performance Comparison"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-4",children:v.map((G,se)=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:G.gate_name}),n.jsxs("span",{className:"text-sm text-gray-600",children:[G.total_checkins.toLocaleString()," check-ins"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Avg Processing"}),n.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[G.avg_processing_time_ms.toFixed(0),"ms"]})]}),n.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Utilization"}),n.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[G.utilization_percentage.toFixed(1),"%"]})]}),n.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Efficiency"}),n.jsx("p",{className:"text-sm font-bold text-gray-900",children:G.staff_efficiency.toFixed(1)})]}),n.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Bottleneck"}),n.jsx("p",{className:`text-sm font-bold ${G.bottleneck_score>50?"text-red-600":"text-gray-900"}`,children:G.bottleneck_score.toFixed(0)})]})]})]},se))})})]})]}),n.jsx(sr,{value:"categories",className:"space-y-4",children:n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Category Insights"})}),n.jsx(ye,{children:_.length>0?n.jsx("div",{className:"space-y-4",children:_.map((G,se)=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:G.category}),n.jsxs("span",{className:"text-sm text-gray-600",children:[G.total_wristbands," wristbands"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-200",children:[n.jsx("p",{className:"text-xs text-blue-900",children:"Total Check-ins"}),n.jsx("p",{className:"text-sm font-bold text-blue-700",children:G.total_checkins})]}),n.jsxs("div",{className:`p-2 rounded border ${G.no_show_rate>20?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[n.jsx("p",{className:`text-xs ${G.no_show_rate>20?"text-red-900":"text-gray-600"}`,children:"No-Show Rate"}),n.jsxs("p",{className:`text-sm font-bold ${G.no_show_rate>20?"text-red-700":"text-gray-900"}`,children:[G.no_show_rate.toFixed(1),"%"]})]}),n.jsxs("div",{className:"bg-gray-50 p-2 rounded border border-gray-200",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"No-Shows"}),n.jsx("p",{className:"text-sm font-bold text-gray-900",children:G.no_show_count})]}),n.jsxs("div",{className:"bg-gray-50 p-2 rounded border border-gray-200",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Avg Check-in Time"}),n.jsx("p",{className:"text-sm font-bold text-gray-900",children:G.avg_checkin_time?new Date(G.avg_checkin_time).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"N/A"})]})]}),G.preferred_gates&&G.preferred_gates.length>0&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[n.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Preferred Gates:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:G.preferred_gates.map((ue,he)=>n.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:ue},he))})]})]},se))}):n.jsx("p",{className:"text-gray-500 text-center py-8",children:"No category insights available"})})]})}),n.jsx(sr,{value:"staff",className:"space-y-4",children:n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Staff Performance"})}),n.jsx(ye,{children:w.length>0?n.jsxs("div",{className:"space-y-3",children:[w.slice(0,10).map((G,se)=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h4",{className:"font-semibold text-gray-900",children:["Staff Member ",se+1]}),n.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${(G.efficiency_score||0)>=80?"bg-green-100 text-green-800":(G.efficiency_score||0)>=60?"bg-blue-100 text-blue-800":(G.efficiency_score||0)>=40?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[(G.efficiency_score||0).toFixed(0),"% Efficiency"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Total Scans"}),n.jsx("p",{className:"text-sm font-bold text-gray-900",children:(G.total_scans||0).toLocaleString()})]}),n.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Success Rate"}),n.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[G.total_scans>0?(G.successful_scans/G.total_scans*100).toFixed(1):0,"%"]})]}),n.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Scans/Hour"}),n.jsx("p",{className:"text-sm font-bold text-gray-900",children:(G.scans_per_hour||0).toFixed(1)})]}),n.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Hours Worked"}),n.jsx("p",{className:"text-sm font-bold text-gray-900",children:(G.hours_worked||0).toFixed(1)})]})]})]},se)),w.length>10&&n.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Showing top 10 of ",w.length," staff members"]})]}):n.jsx("p",{className:"text-gray-500 text-center py-8",children:"No staff performance data available"})})]})}),n.jsx(sr,{value:"security",className:"space-y-4",children:N?n.jsxs(n.Fragment,{children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Fraud Detection Overview"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Total Alerts"}),n.jsx("p",{className:"text-3xl font-bold text-gray-900",children:N.totalAlerts})]}),n.jsxs("div",{className:`text-center p-4 rounded-lg ${N.criticalAlerts>0?"bg-red-50":"bg-gray-50"}`,children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Critical"}),n.jsx("p",{className:`text-3xl font-bold ${N.criticalAlerts>0?"text-red-700":"text-gray-900"}`,children:N.criticalAlerts})]}),n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Investigated"}),n.jsx("p",{className:"text-3xl font-bold text-gray-900",children:N.investigated})]}),n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Investigation Rate"}),n.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[N.totalAlerts>0?(N.investigated/N.totalAlerts*100).toFixed(0):0,"%"]})]})]})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Fraud Cases Management"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Total Cases"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.totalCases})]}),n.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Open Cases"}),n.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:N.openCases})]}),n.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Resolved Cases"}),n.jsx("p",{className:"text-2xl font-bold text-green-700",children:N.resolvedCases})]})]})})]}),Object.keys(N.byType).length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Fraud by Detection Type"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-2",children:Object.entries(N.byType).map(([G,se])=>{const ue=N.totalAlerts,he=se/ue*100;return n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-40 text-xs text-gray-700 font-medium capitalize",children:G.replace(/_/g," ")}),n.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-6 relative",children:n.jsx("div",{className:"bg-red-600 h-6 rounded-full flex items-center justify-end pr-2",style:{width:`${he}%`},children:n.jsx("span",{className:"text-xs font-semibold text-white",children:se})})}),n.jsxs("div",{className:"w-16 text-xs text-gray-500 text-right",children:[he.toFixed(1),"%"]})]},G)})})})]})]}):n.jsx(ve,{children:n.jsxs(ye,{className:"py-12 text-center",children:[n.jsx(jr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No fraud detection data available"})]})})}),n.jsx(sr,{value:"system",className:"space-y-4",children:O?n.jsxs(n.Fragment,{children:[n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"System Performance Metrics"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Total Transactions"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:O.totalTransactions.toLocaleString()})]}),n.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Successful"}),n.jsx("p",{className:"text-2xl font-bold text-green-700",children:O.successfulTransactions.toLocaleString()})]}),n.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Avg Processing"}),n.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[Math.round(O.avgProcessingTime),"ms"]})]}),n.jsxs("div",{className:`text-center p-4 rounded-lg ${O.errorRate>5?"bg-red-50":"bg-gray-50"}`,children:[n.jsx("p",{className:"text-xs text-gray-600 uppercase mb-2",children:"Error Rate"}),n.jsxs("p",{className:`text-2xl font-bold ${O.errorRate>5?"text-red-700":"text-gray-900"}`,children:[O.errorRate.toFixed(2),"%"]})]})]})})]}),n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"System Health"})}),n.jsx(ye,{children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"System Uptime"}),n.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[O.uptime.toFixed(2),"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-6 relative overflow-hidden",children:n.jsx("div",{className:`h-6 rounded-full flex items-center justify-end pr-2 ${O.uptime>=99?"bg-green-600":O.uptime>=95?"bg-blue-600":O.uptime>=90?"bg-yellow-600":"bg-red-600"}`,style:{width:`${O.uptime}%`},children:n.jsxs("span",{className:"text-xs font-semibold text-white",children:[O.uptime.toFixed(2),"%"]})})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Processing Speed"}),n.jsx("p",{className:`text-lg font-bold ${O.avgProcessingTime<500?"text-green-700":O.avgProcessingTime<1e3?"text-blue-700":O.avgProcessingTime<2e3?"text-yellow-700":"text-red-700"}`,children:O.avgProcessingTime<500?"Excellent":O.avgProcessingTime<1e3?"Good":O.avgProcessingTime<2e3?"Fair":"Needs Attention"})]}),n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Reliability"}),n.jsx("p",{className:`text-lg font-bold ${O.errorRate<1?"text-green-700":O.errorRate<3?"text-blue-700":O.errorRate<5?"text-yellow-700":"text-red-700"}`,children:O.errorRate<1?"Excellent":O.errorRate<3?"Good":O.errorRate<5?"Fair":"Poor"})]})]})]})})]})]}):n.jsx(ve,{children:n.jsxs(ye,{className:"py-12 text-center",children:[n.jsx(ha,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No system health data available"})]})})}),n.jsx(sr,{value:"business",className:"space-y-4",children:H?n.jsxs(n.Fragment,{children:[H.eventROI&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Event ROI Analysis"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-green-900 uppercase mb-2",children:"Total Revenue"}),n.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["$",(H.eventROI.total_revenue||0).toLocaleString()]})]}),n.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-red-900 uppercase mb-2",children:"Total Costs"}),n.jsxs("p",{className:"text-2xl font-bold text-red-700",children:["$",(H.eventROI.total_costs||0).toLocaleString()]})]}),n.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-blue-900 uppercase mb-2",children:"Net Profit"}),n.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:["$",((H.eventROI.total_revenue||0)-(H.eventROI.total_costs||0)).toLocaleString()]})]}),n.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-purple-900 uppercase mb-2",children:"ROI"}),n.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[((Ne=H.eventROI.roi_percentage)==null?void 0:Ne.toFixed(1))||0,"%"]})]})]})})]}),H.costEfficiency.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Cost Efficiency Breakdown"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-4",children:H.costEfficiency.map((G,se)=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:G.category}),n.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",G.amount.toLocaleString()]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Cost per Attendee"}),n.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["$",(G.cost_per_attendee||0).toFixed(2)]})]}),n.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Efficiency Score"}),n.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[(G.efficiency_score||0).toFixed(1),"%"]})]}),n.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Budget Variance"}),n.jsxs("p",{className:`text-sm font-bold ${(G.budget_variance||0)>0?"text-red-600":"text-green-600"}`,children:[(G.budget_variance||0)>0?"+":"",(G.budget_variance||0).toFixed(1),"%"]})]})]})]},se))})})]}),H.qualityOfService&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Quality of Service Analysis"})}),n.jsx(ye,{children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-blue-900 uppercase mb-2",children:"SLA Compliance"}),n.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[(H.qualityOfService.sla_compliance||0).toFixed(1),"%"]}),n.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Target: 95%"})]}),n.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-green-900 uppercase mb-2",children:"Customer Satisfaction"}),n.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[(H.qualityOfService.satisfaction_score||0).toFixed(1),"/5"]}),n.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Avg rating"})]}),n.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-purple-900 uppercase mb-2",children:"Service Quality"}),n.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[(H.qualityOfService.service_quality_score||0).toFixed(1),"%"]}),n.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Composite score"})]}),n.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-orange-900 uppercase mb-2",children:"Response Time"}),n.jsxs("p",{className:"text-2xl font-bold text-orange-700",children:[(H.qualityOfService.avg_response_time||0).toFixed(0),"ms"]}),n.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Average"})]})]})})]}),H.benchmarking.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Event Performance Benchmarking"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-4",children:H.benchmarking.slice(0,5).map((G,se)=>{var ue,he,me,Me;return n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:G.event_name}),n.jsx("span",{className:"text-sm text-gray-600",children:new Date(G.event_date).toLocaleDateString()})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Attendance Rate"}),n.jsxs("p",{className:`text-sm font-bold ${G.attendance_rate>=(t==null?void 0:t.checkInRate)?"text-red-600":"text-green-600"}`,children:[(ue=G.attendance_rate)==null?void 0:ue.toFixed(1),"%"]})]}),n.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Gate Health"}),n.jsxs("p",{className:`text-sm font-bold ${G.avg_gate_health>=A?"text-red-600":"text-green-600"}`,children:[(he=G.avg_gate_health)==null?void 0:he.toFixed(1),"%"]})]}),n.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Processing Time"}),n.jsxs("p",{className:`text-sm font-bold ${G.avg_processing_time>=((O==null?void 0:O.avgProcessingTime)||0)?"text-red-600":"text-green-600"}`,children:[(me=G.avg_processing_time)==null?void 0:me.toFixed(0),"ms"]})]}),n.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Overall Score"}),n.jsx("p",{className:`text-sm font-bold ${G.overall_score>=A?"text-red-600":"text-green-600"}`,children:(Me=G.overall_score)==null?void 0:Me.toFixed(1)})]})]})]},se)})})})]}),H.predictiveForecasting.length>0&&n.jsxs(ve,{children:[n.jsx(De,{children:n.jsx(Re,{className:"text-lg",children:"Predictive Analytics & Forecasting"})}),n.jsx(ye,{children:n.jsx("div",{className:"space-y-4",children:H.predictiveForecasting.map((G,se)=>n.jsxs("div",{className:"border border-blue-200 bg-blue-50 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-semibold text-blue-900 capitalize",children:G.prediction_type.replace("_"," ")}),n.jsxs("span",{className:"text-sm text-blue-700",children:[(G.confidence_score*100).toFixed(1),"% Confidence"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[n.jsxs("div",{className:"text-center p-3 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-blue-600",children:"Predicted Value"}),n.jsx("p",{className:"text-lg font-bold text-blue-900",children:typeof G.prediction_data=="object"?JSON.stringify(G.prediction_data).slice(0,20)+"...":G.prediction_data})]}),n.jsxs("div",{className:"text-center p-3 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-blue-600",children:"Accuracy"}),n.jsx("p",{className:"text-lg font-bold text-blue-900",children:G.accuracy?(G.accuracy*100).toFixed(1)+"%":"N/A"})]}),n.jsxs("div",{className:"text-center p-3 bg-white rounded",children:[n.jsx("p",{className:"text-xs text-blue-600",children:"Created"}),n.jsx("p",{className:"text-lg font-bold text-blue-900",children:new Date(G.created_at).toLocaleDateString()})]})]})]},se))})})]})]}):n.jsx(ve,{children:n.jsxs(ye,{className:"py-12 text-center",children:[n.jsx(Mn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Business analytics data is being processed..."}),n.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"ROI calculations, cost analysis, and benchmarking will appear here"})]})})})]})]}):n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ir,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No analytics data available"}),n.jsx(ht,{onClick:F,className:"mt-4",children:"Retry"})]})}):n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ir,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"No event selected for analytics"})]})})};function $9(){const[e,t]=x.useState([]),[r,s]=x.useState(""),[a,i]=x.useState(!0),[l,c]=x.useState({totalEvents:0,activeEvents:0,totalCheckins:0,totalWristbands:0});x.useEffect(()=>{d(),f()},[]);async function d(){try{const{data:h,error:m}=await B.from("events").select("id, name, start_date, is_active").order("start_date",{ascending:!1});if(m)throw m;t(h||[]);const g=h==null?void 0:h.find(v=>v.is_active);g?s(g.id):h&&h.length>0&&s(h[0].id)}catch(h){console.error("Error fetching events:",h)}finally{i(!1)}}async function f(){try{const{count:h}=await B.from("events").select("*",{count:"exact",head:!0}),{count:m}=await B.from("events").select("*",{count:"exact",head:!0}).eq("is_active",!0),{count:g}=await B.from("checkin_logs").select("*",{count:"exact",head:!0}),{count:v}=await B.from("wristbands").select("*",{count:"exact",head:!0});c({totalEvents:h||0,activeEvents:m||0,totalCheckins:g||0,totalWristbands:v||0})}catch(h){console.error("Error fetching stats:",h)}}return a?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Analytics"}),n.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Advanced analytics and insights for your events"})]})}),n.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(On,{className:"h-6 w-6 text-gray-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Events"}),n.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:l.totalEvents})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(qt,{className:"h-6 w-6 text-green-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Events"}),n.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:l.activeEvents})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(Mn,{className:"h-6 w-6 text-indigo-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Check-ins"}),n.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:l.totalCheckins.toLocaleString()})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(lt,{className:"h-6 w-6 text-purple-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Wristbands"}),n.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:l.totalWristbands.toLocaleString()})]})})]})})})]}),e.length>0&&n.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow p-6",children:[n.jsxs("label",{htmlFor:"event-select",className:"block text-sm font-medium text-gray-700 mb-2",children:[n.jsx(ai,{className:"inline h-4 w-4 mr-2"}),"Select Event for Detailed Analytics"]}),n.jsx("select",{id:"event-select",value:r,onChange:h=>s(h.target.value),className:"block w-full max-w-md rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:e.map(h=>n.jsxs("option",{value:h.id,children:[h.name," - ",new Date(h.start_date).toLocaleDateString(),h.is_active?" (Active)":""]},h.id))}),n.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"View detailed analytics, charts, and insights for the selected event"})]})]}),r?n.jsx(R9,{eventId:r}):e.length===0?n.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[n.jsx(ai,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No Events Found"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Create an event first to view analytics."})]}):null]})}function z9(){const{currentOrganization:e,userMembership:t,refreshOrganization:r}=qd(),[s,a]=x.useState([]),[i,l]=x.useState(!0),[c,d]=x.useState(!1),[f,h]=x.useState(""),[m,g]=x.useState("member"),[v,j]=x.useState(!1),[_,y]=x.useState(""),[w,k]=x.useState("");x.useEffect(()=>{e&&(N(),y(e.name),k(e.description||""))},[e]);async function N(){if(e)try{const E=await Xn.getOrganizationMembers(e.id);a(E)}catch(E){console.error("Error fetching members:",E),ge.error("Failed to load team members")}finally{l(!1)}}async function P(){if(e)try{await Xn.updateOrganization(e.id,{name:_,description:w}),ge.success("Organization updated successfully"),j(!1),await r()}catch(E){console.error("Error updating organization:",E),ge.error("Failed to update organization")}}async function O(){if(!(!e||!f))try{await Xn.inviteMember({organization_id:e.id,email:f,role:m}),ge.success(`Invitation sent to ${f}`),d(!1),h(""),g("member"),await N()}catch(E){console.error("Error inviting member:",E),ge.error(E.message||"Failed to invite member")}}async function T(E,D){if(e)try{await Xn.updateMemberRole(e.id,E,D),ge.success("Member role updated"),await N()}catch($){console.error("Error updating member role:",$),ge.error("Failed to update member role")}}async function A(E){if(e&&confirm("Are you sure you want to remove this member?"))try{await Xn.removeMember(e.id,E),ge.success("Member removed"),await N()}catch(D){console.error("Error removing member:",D),ge.error("Failed to remove member")}}const C=(t==null?void 0:t.role)==="owner"||(t==null?void 0:t.role)==="admin";return i?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):e?n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Organization"}),n.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Manage your organization settings and team members"})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h2",{className:"text-lg font-medium text-gray-900 flex items-center",children:[n.jsx(vh,{className:"h-5 w-5 mr-2"}),"Organization Profile"]}),C&&n.jsx("button",{onClick:()=>j(!v),className:"text-sm text-indigo-600 hover:text-indigo-700",children:v?"Cancel":"Edit"})]})}),n.jsx("div",{className:"px-6 py-4",children:v?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name"}),n.jsx("input",{type:"text",value:_,onChange:E=>y(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),n.jsx("textarea",{value:w,onChange:E=>k(E.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),n.jsx("button",{onClick:P,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Save Changes"})]}):n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Name"}),n.jsx("p",{className:"text-lg font-medium text-gray-900",children:e.name})]}),e.description&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Description"}),n.jsx("p",{className:"text-gray-900",children:e.description})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Subscription Tier"}),n.jsx("p",{className:"text-gray-900",children:e.subscription_tier||"Free"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Created"}),n.jsx("p",{className:"text-gray-900",children:new Date(e.created_at).toLocaleDateString()})]})]})})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h2",{className:"text-lg font-medium text-gray-900 flex items-center",children:[n.jsx(lt,{className:"h-5 w-5 mr-2"}),"Team Members (",s.length,")"]}),C&&n.jsxs("button",{onClick:()=>d(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:[n.jsx(dP,{className:"h-4 w-4 mr-2"}),"Invite Member"]})]})}),n.jsx("div",{className:"px-6 py-4",children:s.length===0?n.jsx("p",{className:"text-center text-gray-500 py-8",children:"No team members yet"}):n.jsx("div",{className:"space-y-3",children:s.map(E=>{var D,$,M;return n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:n.jsx(lt,{className:"h-5 w-5 text-indigo-600"})})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:((D=E.user)==null?void 0:D.full_name)||(($=E.user)==null?void 0:$.email)||"Unknown"}),n.jsx("p",{className:"text-xs text-gray-500",children:(M=E.user)==null?void 0:M.email}),n.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[n.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${E.status==="active"?"bg-green-100 text-green-800":E.status==="invited"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:E.status}),n.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${E.role==="owner"?"bg-purple-100 text-purple-800":E.role==="admin"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:[n.jsx(jr,{className:"h-3 w-3 mr-1"}),E.role]})]})]})]}),C&&E.role!=="owner"&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:E.role,onChange:z=>T(E.user_id,z.target.value),className:"text-sm border-gray-300 rounded-md",children:[n.jsx("option",{value:"viewer",children:"Viewer"}),n.jsx("option",{value:"member",children:"Member"}),n.jsx("option",{value:"manager",children:"Manager"}),n.jsx("option",{value:"admin",children:"Admin"}),(t==null?void 0:t.role)==="owner"&&n.jsx("option",{value:"owner",children:"Owner"})]}),n.jsx("button",{onClick:()=>A(E.user_id),className:"p-2 text-red-600 hover:text-red-700",title:"Remove member",children:n.jsx(wn,{className:"h-4 w-4"})})]})]},E.id)})})})]}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[n.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:[n.jsx(JC,{className:"inline h-5 w-5 mr-2"}),"Invite Team Member"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),n.jsx("input",{type:"email",value:f,onChange:E=>h(E.target.value),placeholder:"colleague@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),n.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"User must have an account already"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),n.jsxs("select",{value:m,onChange:E=>g(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[n.jsx("option",{value:"viewer",children:"Viewer"}),n.jsx("option",{value:"member",children:"Member"}),n.jsx("option",{value:"manager",children:"Manager"}),n.jsx("option",{value:"admin",children:"Admin"}),(t==null?void 0:t.role)==="owner"&&n.jsx("option",{value:"owner",children:"Owner"})]})]})]}),n.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[n.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:"Cancel"}),n.jsx("button",{onClick:O,disabled:!f,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400",children:"Send Invitation"})]})]})})]}):n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:n.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[n.jsx(vh,{className:"mx-auto h-12 w-12 text-gray-400"}),n.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No Organization"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"You don't belong to any organization yet."})]})})}function B9(){const{currentOrganization:e}=qd(),{eventId:t}=ja(),[r,s]=x.useState([]),[a,i]=x.useState(null),[l,c]=x.useState(!0),[d,f]=x.useState(""),[h,m]=x.useState("all"),[g,v]=x.useState(!1),[j,_]=x.useState(null),[y,w]=x.useState(!1),[k,N]=x.useState(null),[P,O]=x.useState("created_at"),[T,A]=x.useState("desc"),[C,E]=x.useState({ticket_number:"",ticket_category:"",holder_name:"",wristband_nfc_id:""});x.useEffect(()=>{e&&t&&(D(),$())},[e,t]);async function D(){if(t)try{const{data:F,error:V}=await B.from("events").select("id, name, start_date, description, location").eq("id",t).eq("organization_id",e==null?void 0:e.id).single();if(V)throw V;i(F)}catch(F){console.error("Error fetching event:",F),ge.error("Failed to load event details")}}async function $(){if(t)try{c(!0);const{data:F,error:V}=await B.from("tickets").select(`
          *,
          event:events(id, name),
          wristband:wristbands!tickets_linked_wristband_id_fkey(id, nfc_id, category)
        `).eq("event_id",t).order("created_at",{ascending:!1});if(V)throw V;s(F||[])}catch(F){console.error("Error fetching tickets:",F),ge.error("Failed to load guest list")}finally{c(!1)}}async function M(F){if(confirm("Are you sure you want to remove this guest from the list?"))try{const{error:V}=await B.from("tickets").delete().eq("id",F);if(V)throw V;ge.success("Guest removed successfully"),$()}catch(V){console.error("Error removing guest:",V),ge.error("Failed to remove guest")}}async function z(F){try{const{error:V}=await B.from("tickets").update({status:"cancelled"}).eq("id",F);if(V)throw V;ge.success("Guest status updated successfully"),$()}catch(V){console.error("Error updating guest status:",V),ge.error("Failed to update guest status")}}async function K(F,V){if(confirm("Are you sure you want to unlink this wristband from the ticket?"))try{const{error:te}=await B.from("wristbands").update({linked_ticket_id:null,linked_at:null,attendee_name:null,attendee_email:null}).eq("id",V);if(te)throw te;const{error:Z}=await B.from("tickets").update({status:"unused",linked_wristband_id:null,linked_at:null,linked_by:null}).eq("id",F);if(Z)throw Z;ge.success("Wristband unlinked successfully"),$()}catch(te){console.error("Error unlinking wristband:",te),ge.error("Failed to unlink wristband")}}async function W(F){if(confirm("Are you sure you want to check out this wristband? This will remove all check-in records."))try{const{error:V}=await B.from("checkin_logs").delete().eq("wristband_id",F);if(V)throw V;ge.success("Wristband checked out successfully"),$()}catch(V){console.error("Error checking out wristband:",V),ge.error("Failed to check out wristband")}}const U=F=>{P===F?A(T==="asc"?"desc":"asc"):(O(F),A("asc"))},Y=F=>P!==F?n.jsx(oa,{className:"w-4 h-4 text-gray-400"}):T==="asc"?n.jsx(oa,{className:"w-4 h-4 text-gray-600"}):n.jsx(Ja,{className:"w-4 h-4 text-gray-600"}),R=(F,V)=>{E(te=>({...te,[F]:V}))},H=r.filter(F=>{var xe,oe,de,ce;const V=F.ticket_number.toLowerCase().includes(d.toLowerCase())||((xe=F.holder_name)==null?void 0:xe.toLowerCase().includes(d.toLowerCase()))||((oe=F.holder_email)==null?void 0:oe.toLowerCase().includes(d.toLowerCase())),te=h==="all"||F.status===h,Z=!C.ticket_number||F.ticket_number.toLowerCase().includes(C.ticket_number.toLowerCase()),ie=!C.ticket_category||F.ticket_category.toLowerCase().includes(C.ticket_category.toLowerCase()),fe=!C.holder_name||((de=F.holder_name)==null?void 0:de.toLowerCase().includes(C.holder_name.toLowerCase())),be=!C.wristband_nfc_id||((ce=F.wristband)==null?void 0:ce.nfc_id.toLowerCase().includes(C.wristband_nfc_id.toLowerCase()));return V&&te&&Z&&ie&&fe&&be}).sort((F,V)=>{var ie,fe;let te,Z;switch(P){case"ticket_number":te=F.ticket_number,Z=V.ticket_number;break;case"ticket_category":te=F.ticket_category,Z=V.ticket_category;break;case"holder_name":te=F.holder_name||"",Z=V.holder_name||"";break;case"status":te=F.status,Z=V.status;break;case"wristband":te=((ie=F.wristband)==null?void 0:ie.nfc_id)||"",Z=((fe=V.wristband)==null?void 0:fe.nfc_id)||"";break;case"created_at":default:te=new Date(F.created_at).getTime(),Z=new Date(V.created_at).getTime();break}return te<Z?T==="asc"?-1:1:te>Z?T==="asc"?1:-1:0}),J={total:r.length,unused:r.filter(F=>F.status==="unused").length,linked:r.filter(F=>F.status==="linked").length,cancelled:r.filter(F=>F.status==="cancelled").length};return l?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsx("div",{className:"mb-8",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center mb-2",children:[n.jsx(dt,{to:"/events",className:"text-gray-400 hover:text-gray-600 mr-4",children:n.jsx(Mf,{className:"h-5 w-5"})}),n.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[n.jsx(lt,{className:"h-8 w-8 mr-3 text-indigo-600"}),"Guest List"]})]}),a&&n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("p",{className:"font-medium text-lg text-gray-900",children:a.name}),n.jsx("p",{children:"Manage guest list and wristband linking for this event"})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("button",{onClick:()=>v(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Import Guest List"]}),n.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Guests"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:J.total})]}),n.jsx(lt,{className:"h-8 w-8 text-gray-400"})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Unlinked"}),n.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:J.unused})]}),n.jsx(ir,{className:"h-8 w-8 text-yellow-400"})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Linked"}),n.jsx("p",{className:"text-2xl font-bold text-green-600",children:J.linked})]}),n.jsx(Tt,{className:"h-8 w-8 text-green-400"})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cancelled"}),n.jsx("p",{className:"text-2xl font-bold text-red-600",children:J.cancelled})]}),n.jsx(In,{className:"h-8 w-8 text-red-400"})]})})]}),n.jsx("div",{className:"bg-white rounded-lg shadow mb-6",children:n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"Search guests...",value:d,onChange:F=>f(F.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md"})]}),n.jsx("div",{className:"px-3 py-2 border border-gray-200 rounded-md bg-gray-50",children:n.jsxs("span",{className:"text-sm text-gray-600",children:["Event: ",(a==null?void 0:a.name)||"Loading..."]})}),n.jsxs("select",{value:h,onChange:F=>m(F.target.value),className:"px-3 py-2 border border-gray-300 rounded-md",children:[n.jsx("option",{value:"all",children:"All Statuses"}),n.jsx("option",{value:"unused",children:"Unlinked"}),n.jsx("option",{value:"linked",children:"Linked to Wristband"}),n.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})})}),n.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsxs("thead",{className:"bg-gray-50",children:[n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("button",{onClick:()=>U("ticket_number"),className:"flex items-center space-x-1 hover:text-gray-700 focus:outline-none",children:[n.jsx("span",{children:"Ticket/Reference"}),Y("ticket_number")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("button",{onClick:()=>U("ticket_category"),className:"flex items-center space-x-1 hover:text-gray-700 focus:outline-none",children:[n.jsx("span",{children:"Category"}),Y("ticket_category")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("button",{onClick:()=>U("holder_name"),className:"flex items-center space-x-1 hover:text-gray-700 focus:outline-none",children:[n.jsx("span",{children:"Guest Details"}),Y("holder_name")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("button",{onClick:()=>U("status"),className:"flex items-center space-x-1 hover:text-gray-700 focus:outline-none",children:[n.jsx("span",{children:"Status"}),Y("status")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("button",{onClick:()=>U("wristband"),className:"flex items-center space-x-1 hover:text-gray-700 focus:outline-none",children:[n.jsx("span",{children:"Wristband"}),Y("wristband")]})}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]}),n.jsxs("tr",{className:"bg-gray-100",children:[n.jsx("th",{className:"px-6 py-2",children:n.jsx("input",{type:"text",placeholder:"Filter ticket...",value:C.ticket_number,onChange:F=>R("ticket_number",F.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})}),n.jsx("th",{className:"px-6 py-2",children:n.jsx("input",{type:"text",placeholder:"Filter category...",value:C.ticket_category,onChange:F=>R("ticket_category",F.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})}),n.jsx("th",{className:"px-6 py-2",children:n.jsx("input",{type:"text",placeholder:"Filter holder...",value:C.holder_name,onChange:F=>R("holder_name",F.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})}),n.jsx("th",{className:"px-6 py-2"}),n.jsx("th",{className:"px-6 py-2",children:n.jsx("input",{type:"text",placeholder:"Filter wristband...",value:C.wristband_nfc_id,onChange:F=>R("wristband_nfc_id",F.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})}),n.jsx("th",{className:"px-6 py-2"})]})]}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No guests found"})}):H.map(F=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:F.ticket_number})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:F.ticket_category})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-sm text-gray-900",children:F.holder_name||"N/A"}),n.jsx("div",{className:"text-sm text-gray-500",children:F.holder_email||""})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${F.status==="linked"?"bg-green-100 text-green-800":F.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:F.status})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F.wristband?n.jsxs(dt,{to:`/wristbands?eventId=${F.event_id}&wristband_id=${F.wristband.id}`,className:"text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded p-1 block transition-colors",children:[n.jsx(bh,{className:"inline h-3 w-3 mr-1 text-green-600"}),F.wristband.nfc_id,n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:F.wristband.category})]}):n.jsx("span",{className:"text-sm text-gray-400",children:"Not linked"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:()=>_(j===F.id?null:F.id),className:"text-gray-400 hover:text-gray-600",children:n.jsx(rb,{className:"h-5 w-5"})}),j===F.id&&n.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",children:n.jsxs("div",{className:"py-1",children:[n.jsxs("button",{onClick:()=>{N(F),w(!0),_(null)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[n.jsx(us,{className:"h-4 w-4 mr-2"}),"View Details"]}),F.wristband&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>{var V;(V=F.wristband)!=null&&V.id&&K(F.id,F.wristband.id),_(null)},className:"w-full text-left px-4 py-2 text-sm text-purple-700 hover:bg-gray-100 flex items-center",children:[n.jsx(lP,{className:"h-4 w-4 mr-2"}),"Unlink Wristband"]}),n.jsxs("button",{onClick:()=>{var V;(V=F.wristband)!=null&&V.id&&W(F.wristband.id),_(null)},className:"w-full text-left px-4 py-2 text-sm text-orange-700 hover:bg-gray-100 flex items-center",children:[n.jsx(eb,{className:"h-4 w-4 mr-2"}),"Check Out Wristband"]})]}),F.status!=="cancelled"&&n.jsxs("button",{onClick:()=>{z(F.id),_(null)},className:"w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-gray-100 flex items-center",children:[n.jsx(In,{className:"h-4 w-4 mr-2"}),"Cancel Guest"]}),n.jsxs("button",{onClick:()=>{M(F.id),_(null)},className:"w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-gray-100 flex items-center",children:[n.jsx(wn,{className:"h-4 w-4 mr-2"}),"Remove Guest"]})]})})]})})]},F.id))})]})})}),g&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Import Guest List from CSV"}),t?n.jsx(ib,{eventId:t,onUploadComplete:()=>{v(!1),$()},onClose:()=>v(!1)}):n.jsx("div",{className:"text-center py-8",children:n.jsx("p",{className:"text-gray-500",children:"No event selected. Please select an event first."})}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:"Close"})})]})}),y&&k&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Guest Details"}),n.jsx("button",{onClick:()=>{w(!1),N(null)},className:"text-gray-400 hover:text-gray-600",children:n.jsx(In,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-gray-200",children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-700",children:"Status"}),n.jsx("span",{className:`px-3 py-1 inline-flex text-sm leading-5 font-semibold rounded-full ${k.status==="linked"?"bg-green-100 text-green-800":k.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:k.status.toUpperCase()})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Ticket Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Ticket Number"}),n.jsx("p",{className:"text-base font-medium text-gray-900",children:k.ticket_number})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Category"}),n.jsx("p",{className:"text-base font-medium text-gray-900",children:k.ticket_category})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Created"}),n.jsx("p",{className:"text-base font-medium text-gray-900",children:new Date(k.created_at).toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Last Updated"}),n.jsx("p",{className:"text-base font-medium text-gray-900",children:new Date(k.updated_at).toLocaleString()})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Guest Information"}),n.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Name"}),n.jsx("p",{className:"text-base font-medium text-gray-900",children:k.holder_name||"Not provided"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),n.jsx("p",{className:"text-base font-medium text-gray-900",children:k.holder_email||"Not provided"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Phone"}),n.jsx("p",{className:"text-base font-medium text-gray-900",children:k.holder_phone||"Not provided"})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Wristband Information"}),k.wristband?n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx(bh,{className:"h-6 w-6 text-green-600 mt-1"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-green-900",children:"Linked to Wristband"}),n.jsxs("div",{className:"mt-2 space-y-2",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-green-700",children:"NFC ID"}),n.jsx("p",{className:"text-sm font-mono text-green-900",children:k.wristband.nfc_id})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-green-700",children:"Category"}),n.jsx("p",{className:"text-sm text-green-900",children:k.wristband.category})]}),k.linked_at&&n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-green-700",children:"Linked At"}),n.jsx("p",{className:"text-sm text-green-900",children:new Date(k.linked_at).toLocaleString()})]})]})]})]})}):n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(ir,{className:"h-5 w-5 text-yellow-600"}),n.jsx("p",{className:"text-sm text-yellow-800",children:"No wristband linked to this ticket"})]})})]}),k.event&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Event"}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("p",{className:"text-base font-medium text-blue-900",children:k.event.name}),n.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Event ID: ",k.event.id]})]})]})]}),n.jsx("div",{className:"mt-6 flex justify-end space-x-3",children:n.jsx("button",{onClick:()=>{w(!1),N(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Close"})})]})})]})}const F9=()=>{var Me,Qe,Xe,ut,tt;const[e]=py(),t=e.get("eventId"),[r,s]=x.useState([]),[a,i]=x.useState([]),[l,c]=x.useState(t),[d,f]=x.useState(!0),[h,m]=x.useState(0),[g,v]=x.useState(1),[j,_]=x.useState(25),[y,w]=x.useState(""),[k,N]=x.useState({}),[P,O]=x.useState({key:"timestamp",direction:"desc"}),[T,A]=x.useState(new Set),[C,E]=x.useState(!1),[D,$]=x.useState("comfortable"),[M,z]=x.useState(null),[K,W]=x.useState(!1),[U,Y]=x.useState({start:"",end:""}),[R,H]=x.useState(null),[J,F]=x.useState(!1),[V,te]=x.useState(!1),Z=[{key:"timestamp",label:"Timestamp",sortable:!0,filterable:!0},{key:"nfc_id",label:"NFC ID",sortable:!0,filterable:!0},{key:"category",label:"Category",sortable:!0,filterable:!0},{key:"location",label:"Location",sortable:!0,filterable:!0},{key:"staff_name",label:"Staff",sortable:!0,filterable:!0},{key:"notes",label:"Notes",sortable:!1,filterable:!0}];x.useEffect(()=>{ie()},[]),x.useEffect(()=>{l&&fe()},[l,g,j,P,y,k,U]),x.useEffect(()=>{if(!M||!l)return;const ae=setInterval(()=>{fe()},M*1e3);return()=>clearInterval(ae)},[M,l]);const ie=async()=>{try{const{data:ae,error:Te}=await B.from("events").select("id, name").order("start_date",{ascending:!1});if(Te)throw Te;i(ae||[]),!l&&ae&&ae.length>0&&c(ae[0].id)}catch(ae){console.error("Error fetching events:",ae)}},fe=async()=>{if(l){f(!0);try{let ae=B.from("checkin_logs").select(`
          *,
          wristbands!inner (
            nfc_id,
            category
          )
        `,{count:"exact"}).eq("event_id",l);if(ae=ae.order(P.key,{ascending:P.direction==="asc"}),y&&(ae=ae.or(`
          wristbands.nfc_id.ilike.%${y}%,
          wristbands.category.ilike.%${y}%,
          location.ilike.%${y}%,
          staff_id.ilike.%${y}%,
          notes.ilike.%${y}%
        `)),Object.entries(k).forEach(([et,zr])=>{zr&&(et==="nfc_id"||et==="category"?ae=ae.filter(`wristbands.${et}`,"ilike",`%${zr}%`):et==="staff_name"?ae=ae.filter("staff_id","ilike",`%${zr}%`):ae=ae.filter(et,"ilike",`%${zr}%`))}),U.start&&(ae=ae.gte("timestamp",U.start)),U.end){const et=new Date(U.end);et.setDate(et.getDate()+1),ae=ae.lt("timestamp",et.toISOString())}const Te=(g-1)*j,We=Te+j-1;ae=ae.range(Te,We);const{data:tr,count:It,error:zt}=await ae;if(zt)throw zt;const Et=tr||[],dr=[...new Set(Et.map(et=>et.staff_id).filter(Boolean))];let Yr=new Map;if(dr.length>0)try{const{data:et}=await B.from("profiles").select("id, full_name, email").in("id",dr);et&&et.forEach(zr=>{Yr.set(zr.id,zr)})}catch(et){console.warn("Could not fetch staff profiles:",et)}const Pr=Et.map(et=>({...et,profiles:Yr.get(et.staff_id)||null}));s(Pr),m(It||0)}catch(ae){console.error("Error fetching check-ins:",ae)}finally{f(!1)}}},be=ae=>{O(Te=>Te.key===ae?{...Te,direction:Te.direction==="asc"?"desc":"asc"}:{key:ae,direction:"asc"})},xe=(ae,Te)=>{N(We=>({...We,[ae]:Te})),v(1)},oe=()=>{N({}),w(""),Y({start:"",end:""}),v(1)},de=ae=>{A(Te=>{const We=new Set(Te);return We.has(ae)?We.delete(ae):We.add(ae),We})},ce=()=>{T.size===r.length?A(new Set):A(new Set(r.map(ae=>ae.id)))},ne=ae=>{H(ae),F(!0)},Oe=ae=>{H(ae),te(!0)},Ce=async ae=>{try{await navigator.clipboard.writeText(ae.id),console.log("Check-in ID copied to clipboard:",ae.id)}catch(Te){console.error("Failed to copy to clipboard:",Te);const We=document.createElement("textarea");We.value=ae.id,document.body.appendChild(We),We.select(),document.execCommand("copy"),document.body.removeChild(We)}},$e=async ae=>{if(R)try{const{error:Te}=await B.from("fraud_detections").insert({event_id:R.event_id,wristband_id:R.wristband_id,detection_type:"suspicious_pattern",severity:"medium",details:{checkin_id:R.id,reason:ae,flagged_by:"manual_review",timestamp:new Date().toISOString()}});if(Te)throw Te;te(!1),H(null),console.log("Check-in flagged for review successfully")}catch(Te){console.error("Error flagging check-in:",Te)}},Ne=async(ae="csv")=>{if(l)try{let Te=B.from("checkin_logs").select(`
          id, timestamp, location, notes, staff_id,
          wristbands!inner (nfc_id, category)
        `).eq("event_id",l).order("timestamp",{ascending:!1});const{data:We,error:tr}=await Te;if(tr)throw tr;if(!We||We.length===0){alert("No check-ins to export");return}const It=[...new Set(We.map(Et=>Et.staff_id).filter(Boolean))];let zt=new Map;if(It.length>0)try{const{data:Et}=await B.from("profiles").select("id, full_name, email").in("id",It);Et&&Et.forEach(dr=>{zt.set(dr.id,dr)})}catch(Et){console.warn("Could not fetch staff profiles:",Et)}if(ae==="csv"){let Et=`Timestamp,NFC ID,Category,Location,Staff,Notes
`;We.forEach(et=>{var ze,qe;const zr=new Date(et.timestamp).toLocaleString(),Ca=((ze=et.wristbands)==null?void 0:ze.nfc_id)||"",Bs=((qe=et.wristbands)==null?void 0:qe.category)||"",X=et.location||"",we=zt.get(et.staff_id),Ie=(we==null?void 0:we.full_name)||(we==null?void 0:we.email)||et.staff_id||"Unknown",Fe=et.notes?`"${et.notes.replace(/"/g,'""')}"`:"";Et+=`${zr},${Ca},${Bs},${X},${Ie},${Fe}
`});const dr=new Blob([Et],{type:"text/csv;charset=utf-8"}),Yr=URL.createObjectURL(dr),Pr=document.createElement("a");Pr.href=Yr,Pr.download=`checkins_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Pr),Pr.click(),document.body.removeChild(Pr),URL.revokeObjectURL(Yr)}}catch(Te){console.error("Error exporting check-ins:",Te),alert("Failed to export check-ins")}},G=Math.ceil(h/j),se=(g-1)*j+1,ue=Math.min(g*j,h),me=(()=>{switch(D){case"compact":return{rowHeight:"h-8",cellPadding:"px-2 py-1",textSize:"text-xs",headerPadding:"px-2 py-2"};case"expanded":return{rowHeight:"h-16",cellPadding:"px-4 py-4",textSize:"text-sm",headerPadding:"px-4 py-4"};default:return{rowHeight:"h-12",cellPadding:"px-3 py-3",textSize:"text-sm",headerPadding:"px-3 py-3"}}})();return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center space-y-4 lg:space-y-0",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Check-in Logs"}),n.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Showing ",se,"",ue," of ",h.toLocaleString()," records"]})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsxs("select",{value:j,onChange:ae=>_(Number(ae.target.value)),className:"text-sm border border-gray-300 rounded-md px-3 py-1",children:[n.jsx("option",{value:10,children:"10 per page"}),n.jsx("option",{value:25,children:"25 per page"}),n.jsx("option",{value:50,children:"50 per page"}),n.jsx("option",{value:100,children:"100 per page"})]}),n.jsxs("button",{onClick:()=>E(!C),className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm hover:bg-gray-50",children:[n.jsx(Qy,{size:14,className:"mr-1"}),"Filters"]}),n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>W(!K),className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm hover:bg-gray-50",children:[n.jsx(oi,{size:14,className:"mr-1"}),"Export"]}),K&&n.jsx("div",{className:"absolute right-0 mt-1 w-48 bg-white border border-gray-200 rounded-md shadow-lg z-10",children:n.jsx("div",{className:"p-2",children:n.jsx("button",{onClick:()=>Ne("csv"),className:"w-full text-left px-2 py-1 text-sm hover:bg-gray-100 rounded",children:"Export CSV"})})})]}),M&&n.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[n.jsx(Gr,{size:14,className:"mr-1 animate-spin"}),"Auto-refresh: ",M,"s"]})]})]}),n.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Event"}),n.jsxs("select",{value:l||"",onChange:ae=>c(ae.target.value||null),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[n.jsx("option",{value:"",children:"Select an event"}),a.map(ae=>n.jsx("option",{value:ae.id,children:ae.name},ae.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Global Search"}),n.jsxs("div",{className:"relative",children:[n.jsx(Dn,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),n.jsx("input",{type:"text",value:y,onChange:ae=>w(ae.target.value),placeholder:"Search all columns...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md text-sm"})]})]}),n.jsx("div",{className:"flex items-end",children:n.jsx("button",{onClick:oe,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Clear All Filters"})})]})}),C&&n.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Advanced Filters"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),n.jsx("input",{type:"date",value:U.start,onChange:ae=>{Y(Te=>({...Te,start:ae.target.value})),v(1)},className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),n.jsx("input",{type:"date",value:U.end,onChange:ae=>{Y(Te=>({...Te,end:ae.target.value})),v(1)},className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Auto Refresh",M&&n.jsx("span",{className:"ml-1 inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"ON"})]}),n.jsxs("select",{value:M||"",onChange:ae=>z(ae.target.value?Number(ae.target.value):null),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[n.jsx("option",{value:"",children:"Off"}),n.jsx("option",{value:5,children:"5 seconds"}),n.jsx("option",{value:10,children:"10 seconds"}),n.jsx("option",{value:30,children:"30 seconds"}),n.jsx("option",{value:60,children:"1 minute"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"View Mode"}),n.jsxs("select",{value:D,onChange:ae=>$(ae.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[n.jsx("option",{value:"compact",children:"Compact"}),n.jsx("option",{value:"comfortable",children:"Comfortable"}),n.jsx("option",{value:"expanded",children:"Expanded"})]})]})]}),(U.start||U.end||M)&&n.jsx("div",{className:"flex justify-end mt-4",children:n.jsx("button",{onClick:()=>{Y({start:"",end:""}),z(null),v(1)},className:"text-sm text-gray-600 hover:text-gray-800 underline",children:"Clear Date Filters & Auto-refresh"})})]}),r.length>0&&n.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.toLocaleString()}),n.jsx("div",{className:"text-sm text-gray-500",children:"Total Check-ins"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:new Set(r.map(ae=>{var Te;return(Te=ae.wristbands)==null?void 0:Te.nfc_id})).size}),n.jsx("div",{className:"text-sm text-gray-500",children:"Unique Wristbands"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-purple-600",children:new Set(r.map(ae=>ae.staff_id)).size}),n.jsx("div",{className:"text-sm text-gray-500",children:"Active Staff"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-orange-600",children:new Set(r.map(ae=>ae.location)).size}),n.jsx("div",{className:"text-sm text-gray-500",children:"Locations"})]})]})}),n.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l?d?n.jsx("div",{className:"p-6",children:n.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3,4,5].map(ae=>n.jsx("div",{className:"h-12 bg-gray-200 rounded"},ae))})}):r.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-full",children:n.jsxs("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left w-12",children:n.jsx("input",{type:"checkbox",checked:T.size===r.length&&r.length>0,onChange:ce,className:"rounded border-gray-300"})}),Z.map(ae=>n.jsx("th",{className:`${me.headerPadding} text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx("span",{children:ae.label}),ae.sortable&&n.jsx("button",{onClick:()=>be(ae.key),className:"text-gray-400 hover:text-gray-600",children:P.key===ae.key&&P.direction==="asc"?n.jsx(oa,{size:14}):n.jsx(Ja,{size:14})})]}),ae.filterable&&n.jsx("input",{type:"text",value:k[ae.key]||"",onChange:Te=>xe(ae.key,Te.target.value),placeholder:`Filter ${ae.label.toLowerCase()}...`,className:"w-full text-xs border border-gray-300 rounded px-2 py-1"})]})},ae.key)),n.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(ae=>{var Te,We,tr,It;return n.jsxs("tr",{className:`${me.rowHeight} hover:bg-gray-50`,children:[n.jsx("td",{className:"px-3 py-2",children:n.jsx("input",{type:"checkbox",checked:T.has(ae.id),onChange:()=>de(ae.id),className:"rounded border-gray-300"})}),n.jsx("td",{className:`${me.cellPadding} ${me.textSize} text-gray-900 w-32`,children:n.jsx("div",{className:"break-words",children:new Date(ae.timestamp).toLocaleString()})}),n.jsx("td",{className:`${me.cellPadding} ${me.textSize} font-medium text-blue-600 w-28`,children:n.jsx("div",{className:"break-all",children:((Te=ae.wristbands)==null?void 0:Te.nfc_id)||"N/A"})}),n.jsx("td",{className:`${me.cellPadding} w-24`,children:n.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 break-words",children:((We=ae.wristbands)==null?void 0:We.category)||"Unknown"})}),n.jsx("td",{className:`${me.cellPadding} ${me.textSize} text-gray-500 w-28`,children:n.jsx("div",{className:"break-words",children:ae.location||"N/A"})}),n.jsx("td",{className:`${me.cellPadding} ${me.textSize} text-gray-500 w-40`,children:n.jsx("div",{className:"break-words",children:((tr=ae.profiles)==null?void 0:tr.full_name)||((It=ae.profiles)==null?void 0:It.email)||ae.staff_id||"Unknown"})}),n.jsx("td",{className:`${me.cellPadding} ${me.textSize} text-gray-500`,children:n.jsx("div",{className:`break-words ${D==="expanded"?"line-clamp-5":"line-clamp-3"}`,children:ae.notes||"-"})}),n.jsx("td",{className:`${me.cellPadding} text-right ${me.textSize} font-medium w-24`,children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("div",{className:"relative group",children:[n.jsx("button",{onClick:()=>ne(ae),className:"text-blue-600 hover:text-blue-900",children:n.jsx(us,{size:14})}),n.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-900 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-75 pointer-events-none whitespace-nowrap z-10",children:"View check-in details"})]}),n.jsxs("div",{className:"relative group",children:[n.jsx("button",{onClick:()=>Oe(ae),className:"text-yellow-600 hover:text-yellow-900",children:n.jsx(GC,{size:14})}),n.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-900 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-75 pointer-events-none whitespace-nowrap z-10",children:"Flag for review"})]}),n.jsxs("div",{className:"relative group",children:[n.jsx("button",{onClick:()=>Ce(ae),className:"text-gray-400 hover:text-gray-600",children:n.jsx(Lf,{size:14})}),n.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 text-xs text-white bg-gray-900 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-75 pointer-events-none whitespace-nowrap z-10",children:"Copy check-in ID"})]})]})})]},ae.id)})})]})}),n.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",n.jsx("span",{className:"font-medium",children:se})," to"," ",n.jsx("span",{className:"font-medium",children:ue})," of"," ",n.jsx("span",{className:"font-medium",children:h.toLocaleString()})," results",T.size>0&&n.jsxs("span",{className:"ml-2 text-blue-600",children:["(",T.size," selected)"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>v(1),disabled:g<=1,className:"px-3 py-1 border border-gray-300 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:"First"}),n.jsx("button",{onClick:()=>v(g-1),disabled:g<=1,className:"px-3 py-1 border border-gray-300 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:"Previous"}),n.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",g," of ",G]}),n.jsx("button",{onClick:()=>v(g+1),disabled:g>=G,className:"px-3 py-1 border border-gray-300 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:"Next"}),n.jsx("button",{onClick:()=>v(G),disabled:g>=G,className:"px-3 py-1 border border-gray-300 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:"Last"})]})]})})]}):n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-gray-500",children:y||Object.values(k).some(ae=>ae)||U.start||U.end?"No check-ins found matching your criteria":"No check-ins found for this event"})}):n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-gray-500",children:"Please select an event to view check-in logs"})})}),J&&R&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Check-in Details"}),n.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Check-in ID"}),n.jsx("p",{className:"text-sm text-gray-900 font-mono",children:R.id})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Timestamp"}),n.jsx("p",{className:"text-sm text-gray-900",children:new Date(R.timestamp).toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NFC ID"}),n.jsx("p",{className:"text-sm text-gray-900 font-mono",children:((Me=R.wristbands)==null?void 0:Me.nfc_id)||"N/A"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),n.jsx("p",{className:"text-sm text-gray-900",children:((Qe=R.wristbands)==null?void 0:Qe.category)||"Unknown"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),n.jsx("p",{className:"text-sm text-gray-900",children:R.location||"N/A"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Staff"}),n.jsx("p",{className:"text-sm text-gray-900",children:((Xe=R.profiles)==null?void 0:Xe.full_name)||((ut=R.profiles)==null?void 0:ut.email)||R.staff_id||"Unknown"})]})]}),R.notes&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),n.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded",children:R.notes})]})]}),n.jsx("div",{className:"flex justify-end space-x-2 mt-6",children:n.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50",children:"Close"})})]})}),V&&R&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Flag for Review"}),n.jsx("button",{onClick:()=>te(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),n.jsxs("form",{onSubmit:ae=>{ae.preventDefault();const We=new FormData(ae.target).get("reason");We.trim()&&$e(We.trim())},children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{children:n.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Flagging check-in for: ",n.jsx("span",{className:"font-mono",children:(tt=R.wristbands)==null?void 0:tt.nfc_id})]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for flagging"}),n.jsx("textarea",{name:"reason",required:!0,rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",placeholder:"Describe why this check-in needs review..."})]})]}),n.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[n.jsx("button",{type:"button",onClick:()=>te(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-yellow-600 text-white rounded-md text-sm hover:bg-yellow-700",children:"Flag for Review"})]})]})]})})]})},U9=()=>{const[e]=py(),t=e.get("eventId"),[r,s]=x.useState([]),[a,i]=x.useState([]),[l,c]=x.useState(t),[d,f]=x.useState(null),[h,m]=x.useState([]),[g,v]=x.useState(""),[j,_]=x.useState(!0),[y,w]=x.useState(1),[k,N]=x.useState(0),P=50;x.useEffect(()=>{O(),l&&(T(l),A(l,d,1))},[l,d]),x.useEffect(()=>{if(l){const M=setTimeout(()=>{A(l,d,1),w(1)},300);return()=>clearTimeout(M)}},[g,l,d]);const O=async()=>{try{const{data:M,error:z}=await B.from("events").select("id, name").order("start_date",{ascending:!1});if(z)throw z;i(M||[]),!l&&M&&M.length>0&&c(M[0].id)}catch(M){console.error("Error fetching events:",M)}},T=async M=>{try{const{data:z,error:K}=await B.from("wristbands").select("category").eq("event_id",M).order("category");if(K)throw K;const W=[...new Set(z==null?void 0:z.map(U=>U.category))];m(W)}catch(z){console.error("Error fetching categories:",z)}},A=async(M,z,K)=>{_(!0);try{let W=B.from("wristbands").select("*",{count:"exact"}).eq("event_id",M).order("created_at",{ascending:!1}).range((K-1)*P,K*P-1);z&&(W=W.eq("category",z)),g&&(W=W.ilike("nfc_id",`%${g}%`));const{data:U,count:Y,error:R}=await W;if(R)throw R;s(U||[]),N(Y||0),w(K)}catch(W){console.error("Error fetching wristbands:",W)}finally{_(!1)}},C=async M=>{if(window.confirm("Are you sure you want to delete this wristband?"))try{const{count:z}=await B.from("checkin_logs").select("id",{count:"exact",head:!0}).eq("wristband_id",M);if(z&&z>0){if(!window.confirm("This wristband has check-in records. Deleting it will also delete all check-in records. Continue?"))return;await B.from("checkin_logs").delete().eq("wristband_id",M)}const{error:K}=await B.from("wristbands").delete().eq("id",M);if(K)throw K;s(r.filter(W=>W.id!==M)),N(W=>W-1)}catch(z){console.error("Error deleting wristband:",z),alert("Failed to delete wristband. Please try again.")}},E=M=>{M.preventDefault(),l&&A(l,d,1)},D=Math.ceil(k/P),$=()=>{l&&(A(l,d,y),T(l))};return n.jsxs("div",{className:"container py-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Wristbands"}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage event wristbands and bulk uploads"})]}),l&&n.jsxs("div",{className:"flex space-x-3",children:[n.jsx(ab,{eventId:l,onUploadComplete:$,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700"}),n.jsxs(dt,{to:`/wristbands/export?eventId=${l}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(_n,{size:16,className:"mr-2"}),"Export"]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4",children:[n.jsxs("div",{className:"w-full md:w-1/3",children:[n.jsx("label",{htmlFor:"event-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Event"}),n.jsxs("select",{id:"event-select",value:l||"",onChange:M=>c(M.target.value||null),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[n.jsx("option",{value:"",children:"Select an event"}),a.map(M=>n.jsx("option",{value:M.id,children:M.name},M.id))]})]}),h.length>0&&n.jsxs("div",{className:"w-full md:w-1/3",children:[n.jsx("label",{htmlFor:"category-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Category"}),n.jsxs("select",{id:"category-select",value:d||"",onChange:M=>f(M.target.value||null),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[n.jsx("option",{value:"",children:"All Categories"}),h.map(M=>n.jsx("option",{value:M,children:M},M))]})]}),n.jsxs("div",{className:"w-full md:w-1/3",children:[n.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search by NFC ID"}),n.jsx("form",{onSubmit:E,children:n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",id:"search",value:g,onChange:M=>v(M.target.value),placeholder:"Search...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Dn,{size:18,className:"text-gray-400"})}),n.jsx("button",{type:"submit",className:"absolute inset-y-0 right-0 px-3 flex items-center bg-blue-600 rounded-r-md text-white",children:"Search"})]})})]})]})}),l?j?n.jsx("div",{className:"animate-pulse",children:[1,2,3,4,5].map(M=>n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),n.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4"})]},M))}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NFC ID"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.length>0?r.map(M=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:M.nfc_id}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:M.category}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${M.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:M.is_active?"Active":"Inactive"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(M.created_at).toLocaleDateString()}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx(dt,{to:`/wristbands/${M.id}/edit`,className:"text-blue-600 hover:text-blue-900 mr-4",children:n.jsx(ii,{size:16})}),n.jsx("button",{onClick:()=>C(M.id),className:"text-red-600 hover:text-red-900",children:n.jsx(wn,{size:16})})]})]},M.id)):n.jsx("tr",{children:n.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx(Dn,{className:"w-8 h-8 text-gray-300 mb-2"}),n.jsx("p",{className:"text-sm",children:g||d?"No wristbands found matching your search criteria":"No wristbands found for this event"}),g||d?n.jsx("button",{onClick:()=>{v(""),f(null),l&&A(l,null,1)},className:"mt-2 text-sm text-blue-600 hover:text-blue-800",children:"Clear search and filters"}):n.jsx(dt,{to:`/wristbands/new?eventId=${l}`,className:"mt-2 inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Add your first wristband"})]})})})})]})}),D>1&&n.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-700",children:["Showing"," ",n.jsx("span",{className:"font-medium",children:(y-1)*P+1})," ","to"," ",n.jsx("span",{className:"font-medium",children:Math.min(y*P,k)})," ","of ",n.jsx("span",{className:"font-medium",children:k})," results"]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:()=>A(l,d,y-1),disabled:y<=1,className:`px-3 py-1 border rounded ${y<=1?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Previous"}),n.jsx("button",{onClick:()=>A(l,d,y+1),disabled:y>=D,className:`px-3 py-1 border rounded ${y>=D?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Next"})]})]})]}):n.jsx("div",{className:"text-center py-8",children:n.jsx("p",{className:"text-gray-500 text-sm",children:"Please select an event to view wristbands"})})]})]})},fy=[{id:"main-entrance",name:"Main Entrance",latitude:.3476,longitude:32.5825,status:"active",health_score:95,checkin_count:150},{id:"vip-gate",name:"VIP Gate",latitude:.3477,longitude:32.585,status:"active",health_score:88,checkin_count:45},{id:"staff-entrance",name:"Staff Entrance",latitude:.35,longitude:32.58,status:"maintenance",health_score:72,checkin_count:23},{id:"emergency-exit",name:"Emergency Exit",latitude:.3465,longitude:32.5835,status:"inactive",health_score:0,checkin_count:0},{id:"side-gate",name:"Side Gate",latitude:.3485,longitude:32.5815,status:"active",health_score:92,checkin_count:78}],W9=[{id:"entrance-1",name:"North Entrance",x:120,y:80,status:"active",health_score:95,checkin_count:200},{id:"entrance-2",name:"South Entrance",x:800,y:700,status:"active",health_score:88,checkin_count:180},{id:"vip-lounge",name:"VIP Lounge Access",x:400,y:200,status:"active",health_score:92,checkin_count:65},{id:"backstage",name:"Backstage Access",x:600,y:450,status:"maintenance",health_score:65,checkin_count:12},{id:"emergency-1",name:"Emergency Exit 1",x:50,y:400,status:"inactive",health_score:0,checkin_count:0},{id:"emergency-2",name:"Emergency Exit 2",x:950,y:400,status:"active",health_score:100,checkin_count:5}],q9=[{id:"cluster-1",name:"Gate A",latitude:.3476,longitude:32.5825,status:"active",health_score:95,checkin_count:50},{id:"cluster-2",name:"Gate B",latitude:.3476,longitude:32.5826,status:"active",health_score:88,checkin_count:35},{id:"cluster-3",name:"Gate C",latitude:.3477,longitude:32.5825,status:"maintenance",health_score:72,checkin_count:20}],G9=[{id:"north",name:"North Gate",latitude:.4,longitude:32.5,status:"active",health_score:95,checkin_count:100},{id:"south",name:"South Gate",latitude:.3,longitude:32.6,status:"active",health_score:88,checkin_count:85},{id:"east",name:"East Gate",latitude:.35,longitude:32.7,status:"active",health_score:92,checkin_count:120},{id:"west",name:"West Gate",latitude:.35,longitude:32.4,status:"maintenance",health_score:65,checkin_count:45}];function H9(){var d,f;const[e,t]=x.useState("geo"),[r,s]=x.useState(null),a=()=>{switch(e){case"geo":return fy;case"image":return W9;case"clustered":return q9;case"spread":return G9;default:return fy}},i=()=>e==="image"?{url:"/assets/venue-floorplan.png",width:1e3,height:800}:null,l=h=>{s(h),console.log("Gate clicked:",h)},c=()=>{const h=["geo","image","clustered","spread"],g=(h.indexOf(e)+1)%h.length;t(h[g]),s(null)};return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx("div",{className:"bg-white shadow-sm border-b",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"flex items-center justify-between h-16",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs(dt,{to:"/events",className:"flex items-center text-gray-600 hover:text-gray-900",children:[n.jsx(Mf,{size:20,className:"mr-2"}),"Back to Events"]}),n.jsx("div",{className:"h-6 border-l border-gray-300"}),n.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"LandscapeMap Demo"})]}),n.jsxs("button",{onClick:c,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[n.jsx(nP,{size:16}),n.jsx("span",{children:"Switch Mode"})]})]})})}),n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsx("div",{className:"mb-8",children:n.jsxs("div",{className:"flex flex-wrap gap-4",children:[n.jsxs("button",{onClick:()=>{t("geo"),s(null)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg border transition-colors ${e==="geo"?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:[n.jsx(HC,{size:16}),n.jsx("span",{children:"Geographic Mode"})]}),n.jsxs("button",{onClick:()=>{t("image"),s(null)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg border transition-colors ${e==="image"?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:[n.jsx(KC,{size:16}),n.jsx("span",{children:"Image Mode"})]}),n.jsxs("button",{onClick:()=>{t("clustered"),s(null)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg border transition-colors ${e==="clustered"?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:[n.jsx(cn,{size:16}),n.jsx("span",{children:"Clustered Gates"})]}),n.jsxs("button",{onClick:()=>{t("spread"),s(null)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg border transition-colors ${e==="spread"?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:[n.jsx(cn,{size:16}),n.jsx("span",{children:"Spread Out Gates"})]})]})}),n.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsxs("h3",{className:"font-medium text-blue-900 mb-2",children:[e==="geo"&&"Geographic Coordinates Demo",e==="image"&&"Image-Based Floorplan Demo",e==="clustered"&&"Clustered Gates Demo",e==="spread"&&"Spread Out Gates Demo"]}),n.jsxs("p",{className:"text-blue-700 text-sm",children:[e==="geo"&&"Shows gates using real latitude/longitude coordinates with OpenStreetMap tiles. The map automatically scales to show all gates with appropriate padding.",e==="image"&&"Displays gates on a venue floorplan using pixel coordinates. Uses Leaflet CRS.Simple for image-based mapping.",e==="clustered"&&"Demonstrates automatic scaling when gates are very close together. Prevents over-zooming with minimum bounds.",e==="spread"&&"Shows how the map handles gates spread across a large geographic area with optimal zoom levels."]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[n.jsx("div",{className:"lg:col-span-3",children:n.jsx("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:n.jsx("div",{className:"h-[600px]",children:n.jsx(q1,{gates:a(),backgroundImage:i(),fitPadding:[40,40],minZoom:1,maxZoom:18,onGateClick:l,showControls:!0})})})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4",children:[n.jsxs("h3",{className:"font-medium text-gray-900 mb-4",children:["Gates (",a().length,")"]}),n.jsx("div",{className:"space-y-2",children:a().map(h=>{var m,g;return n.jsxs("div",{className:`p-3 rounded border cursor-pointer transition-colors ${(r==null?void 0:r.id)===h.id?"bg-blue-50 border-blue-200":"hover:bg-gray-50"}`,onClick:()=>s(h),children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("span",{className:"font-medium text-sm",children:h.name||h.id}),n.jsx("div",{className:`w-2 h-2 rounded-full ${h.status==="active"?"bg-green-500":h.status==="maintenance"?"bg-yellow-500":"bg-gray-500"}`})]}),n.jsx("div",{className:"text-xs text-gray-500",children:e==="image"?`${h.x}, ${h.y}`:`${(m=h.latitude??h.lat)==null?void 0:m.toFixed(4)}, ${(g=h.longitude??h.lon)==null?void 0:g.toFixed(4)}`}),h.checkin_count!==void 0&&n.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[h.checkin_count," check-ins"]})]},h.id)})})]}),r&&n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Gate Details"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Name"}),n.jsx("p",{className:"text-sm text-gray-900",children:r.name||r.id})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Status"}),n.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${r.status==="active"?"bg-green-500":r.status==="maintenance"?"bg-yellow-500":"bg-gray-500"}`}),n.jsx("span",{className:"text-sm text-gray-900 capitalize",children:r.status||"Active"})]})]}),r.health_score!==void 0&&n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Health Score"}),n.jsxs("p",{className:"text-sm text-gray-900",children:[r.health_score,"%"]})]}),r.checkin_count!==void 0&&n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Check-ins"}),n.jsx("p",{className:"text-sm text-gray-900",children:r.checkin_count})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Coordinates"}),n.jsx("p",{className:"text-sm text-gray-900 font-mono",children:e==="image"?`x: ${r.x}, y: ${r.y}`:`${(d=r.latitude??r.lat)==null?void 0:d.toFixed(6)}, ${(f=r.longitude??r.lon)==null?void 0:f.toFixed(6)}`})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Features"}),n.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),n.jsx("span",{children:"Automatic bounds fitting"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),n.jsx("span",{children:"Dynamic scaling"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),n.jsx("span",{children:"Status-based markers"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),n.jsx("span",{children:"Interactive popups"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),n.jsx("span",{children:"Responsive design"})]})]})]})]})]})]})]})}const V9=e=>{const t=e.filter(s=>s.status==="resolved"||s.status==="false_positive");return t.length===0?0:e.filter(s=>s.status==="false_positive").length/t.length*100},K9=e=>{const t=e.filter(s=>s.investigated_at&&s.detected_at);return t.length===0?0:t.reduce((s,a)=>{if(!a.investigated_at||!a.detected_at)return s;const i=new Date(a.detected_at).getTime(),c=(new Date(a.investigated_at).getTime()-i)/(1e3*60);return s+c},0)/t.length},Z9=e=>{const t=e.filter(s=>s.status==="resolved"||s.status==="false_positive");return t.length===0?0:e.filter(s=>s.status==="resolved").length/t.length*100},Y9=()=>{const[e,t]=x.useState([]),[r,s]=x.useState({totalAlerts:0,criticalAlerts:0,resolvedToday:0,falsePositiveRate:0,averageResponseTime:0,blockedWristbands:0,suspiciousPatterns:0,aiAccuracy:0}),[a,i]=x.useState(!0),[l,c]=x.useState(null),[d,f]=x.useState("all"),[h,m]=x.useState("all"),[g,v]=x.useState("");x.useEffect(()=>{j();const P=setInterval(j,3e4);return()=>clearInterval(P)},[]);const j=async()=>{try{const{data:P,error:O}=await B.from("fraud_detections").select(`
          id,
          detection_type,
          severity,
          details,
          created_at,
          investigated_at,
          investigated_by,
          wristband_id,
          event_id,
          event:events(id, name),
          wristband:wristbands(id, nfc_id)
        `).order("created_at",{ascending:!1}).limit(50);if(O)throw O;const T=(P||[]).map($=>{var M,z,K,W,U,Y;return{id:$.id,type:$.detection_type,severity:$.severity,wristband_id:((M=$.wristband)==null?void 0:M.nfc_id)||"Unknown",event_id:$.event_id,event_name:((z=$.event)==null?void 0:z.name)||"Unknown Event",description:((K=$.details)==null?void 0:K.description)||"Fraud pattern detected",detected_at:$.created_at,investigated_at:$.investigated_at,status:$.status||($.investigated_at?"resolved":"pending"),location:((W=$.details)==null?void 0:W.location)||"",confidence_score:((U=$.details)==null?void 0:U.confidence_score)||.75,related_scans:((Y=$.details)==null?void 0:Y.related_scans)||1,staff_member:$.investigated_by}});t(T);const A=new Date,C=new Date(A.getFullYear(),A.getMonth(),A.getDate()),E=T.filter($=>$.investigated_at?$.status==="resolved"&&new Date($.investigated_at)>=C:!1).length,{data:D}=await B.from("wristband_blocks").select("id").is("unblocked_at",null);s({totalAlerts:T.length,criticalAlerts:T.filter($=>$.severity==="critical").length,resolvedToday:E,falsePositiveRate:V9(T),averageResponseTime:K9(T),blockedWristbands:(D==null?void 0:D.length)||0,suspiciousPatterns:T.filter($=>$.type==="pattern_suspicious").length,aiAccuracy:Z9(T)}),i(!1)}catch(P){console.error("Error fetching fraud data:",P),i(!1)}},_=async(P,O)=>{try{const{data:T,error:A}=await B.auth.getUser();if(A||!T||!T.user){console.error("Authentication error:",A),alert("You must be logged in to perform this action. Please log in and try again.");return}const C=T.user;if(O==="resolve"||O==="false_positive"){const{error:E}=await B.from("fraud_detections").update({investigated_at:new Date().toISOString(),investigated_by:C.id}).eq("id",P);if(E)throw E}if(O==="block"){const E=e.find(D=>D.id===P);if(E){const{data:D}=await B.from("wristbands").select("id").eq("nfc_id",E.wristband_id).single();if(D){const{error:$}=await B.from("wristband_blocks").insert({wristband_id:D.id,event_id:E.event_id,reason:E.description,blocked_by:C.id});if($)throw $}}}t(e.map(E=>E.id===P?{...E,status:O==="investigate"?"investigating":O==="resolve"?"resolved":O==="false_positive"?"false_positive":O==="block"?"resolved":E.status,staff_member:C.email||"Current User"}:E)),await j()}catch(T){console.error("Error updating alert:",T)}},y=P=>{switch(P){case"critical":return"text-red-600 bg-red-100 border-red-200";case"high":return"text-orange-600 bg-orange-100 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"low":return"text-blue-600 bg-blue-100 border-blue-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},w=P=>{switch(P){case"pending":return"text-red-600 bg-red-100";case"investigating":return"text-yellow-600 bg-yellow-100";case"resolved":return"text-green-600 bg-green-100";case"false_positive":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},k=P=>{switch(P){case"duplicate_scan":return lt;case"velocity_anomaly":return ha;case"location_impossible":return cn;case"pattern_suspicious":return qt;case"time_anomaly":return Vr;default:return bt}},N=e.filter(P=>{const O=d==="all"||P.severity===d,T=h==="all"||P.status===h,A=g===""||P.wristband_id.toLowerCase().includes(g.toLowerCase())||P.event_name.toLowerCase().includes(g.toLowerCase())||P.description.toLowerCase().includes(g.toLowerCase());return O&&T&&A});return a?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[n.jsx(jr,{className:"h-6 w-6 mr-2 text-red-500"}),"Fraud Detection Center"]}),n.jsx("p",{className:"text-gray-600",children:"AI-powered fraud monitoring and prevention system"})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("div",{className:"flex items-center text-sm text-green-600",children:[n.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"}),"AI Monitoring Active"]}),n.jsxs("button",{onClick:j,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-l-red-500",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(bt,{className:"h-6 w-6 text-red-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Alerts"}),n.jsx("dd",{className:"text-lg font-medium text-gray-900",children:r.totalAlerts})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-l-orange-500",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(jr,{className:"h-6 w-6 text-orange-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Critical Alerts"}),n.jsx("dd",{className:"text-lg font-medium text-gray-900",children:r.criticalAlerts})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-l-green-500",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(Tt,{className:"h-6 w-6 text-green-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Resolved Today"}),n.jsx("dd",{className:"text-lg font-medium text-gray-900",children:r.resolvedToday})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-l-blue-500",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(Mn,{className:"h-6 w-6 text-blue-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"AI Accuracy"}),n.jsxs("dd",{className:"text-lg font-medium text-gray-900",children:[r.aiAccuracy.toFixed(1),"%"]})]})})]})})})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"System Performance"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[r.falsePositiveRate.toFixed(1),"%"]}),n.jsx("div",{className:"text-sm text-gray-500",children:"False Positive Rate"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[r.averageResponseTime.toFixed(1),"min"]}),n.jsx("div",{className:"text-sm text-gray-500",children:"Avg Response Time"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.blockedWristbands}),n.jsx("div",{className:"text-sm text-gray-500",children:"Blocked Wristbands"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.suspiciousPatterns}),n.jsx("div",{className:"text-sm text-gray-500",children:"Suspicious Patterns"})]})]})]}),n.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"Search alerts...",value:g,onChange:P=>v(P.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),n.jsxs("select",{value:d,onChange:P=>f(P.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"all",children:"All Severities"}),n.jsx("option",{value:"critical",children:"Critical"}),n.jsx("option",{value:"high",children:"High"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"low",children:"Low"})]}),n.jsxs("select",{value:h,onChange:P=>m(P.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"all",children:"All Statuses"}),n.jsx("option",{value:"pending",children:"Pending"}),n.jsx("option",{value:"investigating",children:"Investigating"}),n.jsx("option",{value:"resolved",children:"Resolved"}),n.jsx("option",{value:"false_positive",children:"False Positive"})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),n.jsxs("button",{className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(Qy,{className:"h-4 w-4 mr-2"}),"Advanced Filters"]})]})]})}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Fraud Alerts (",N.length,")"]})}),n.jsx("div",{className:"divide-y divide-gray-200",children:N.map(P=>{const O=k(P.type);return n.jsx("div",{className:"p-6 hover:bg-gray-50",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start space-x-4",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${y(P.severity)}`,children:n.jsx(O,{className:"h-5 w-5"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-900",children:P.type.replace("_"," ").toUpperCase()}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y(P.severity)}`,children:P.severity}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w(P.status)}`,children:P.status.replace("_"," ")})]}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:P.description}),n.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[n.jsxs("span",{children:["Wristband: ",P.wristband_id]}),n.jsxs("span",{children:["Event: ",P.event_name]}),n.jsxs("span",{children:["Confidence: ",(P.confidence_score*100).toFixed(1),"%"]}),n.jsxs("span",{children:["Related Scans: ",P.related_scans]}),P.location&&n.jsxs("span",{children:["Location: ",P.location]})]}),n.jsxs("div",{className:"flex items-center space-x-2 mt-2 text-xs text-gray-400",children:[n.jsx(Vr,{className:"h-3 w-3"}),n.jsxs("span",{children:["Detected: ",new Date(P.detected_at).toLocaleString()]}),P.staff_member&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsxs("span",{children:["Assigned to: ",P.staff_member]})]})]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[P.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>_(P.id,"investigate"),className:"inline-flex items-center px-2 py-1 border border-yellow-300 text-xs font-medium rounded text-yellow-700 bg-yellow-50 hover:bg-yellow-100",children:[n.jsx(us,{className:"h-3 w-3 mr-1"}),"Investigate"]}),n.jsx("button",{onClick:()=>_(P.id,"false_positive"),className:"inline-flex items-center px-2 py-1 border border-gray-300 text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50",children:"False Positive"})]}),P.status==="investigating"&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>_(P.id,"resolve"),className:"inline-flex items-center px-2 py-1 border border-green-300 text-xs font-medium rounded text-green-700 bg-green-50 hover:bg-green-100",children:[n.jsx(Tt,{className:"h-3 w-3 mr-1"}),"Resolve"]}),n.jsxs("button",{onClick:()=>_(P.id,"block"),className:"inline-flex items-center px-2 py-1 border border-red-300 text-xs font-medium rounded text-red-700 bg-red-50 hover:bg-red-100",children:[n.jsx(If,{className:"h-3 w-3 mr-1"}),"Block"]})]}),n.jsx("button",{onClick:()=>c(P),className:"inline-flex items-center px-2 py-1 border border-blue-300 text-xs font-medium rounded text-blue-700 bg-blue-50 hover:bg-blue-100",children:"View Details"})]})]})},P.id)})})]}),l&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Alert Details"}),n.jsx("button",{onClick:()=>c(null),className:"text-gray-400 hover:text-gray-600",children:""})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Alert ID"}),n.jsx("p",{className:"text-sm text-gray-900",children:l.id})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),n.jsx("p",{className:"text-sm text-gray-900",children:l.type.replace("_"," ")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Severity"}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y(l.severity)}`,children:l.severity})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w(l.status)}`,children:l.status.replace("_"," ")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Wristband ID"}),n.jsx("p",{className:"text-sm text-gray-900 font-mono",children:l.wristband_id})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Event"}),n.jsx("p",{className:"text-sm text-gray-900",children:l.event_name})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confidence Score"}),n.jsxs("p",{className:"text-sm text-gray-900",children:[(l.confidence_score*100).toFixed(1),"%"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Related Scans"}),n.jsx("p",{className:"text-sm text-gray-900",children:l.related_scans})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:l.description})]}),l.location&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:l.location})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Detected At"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:new Date(l.detected_at).toLocaleString()})]}),l.staff_member&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Staff"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:l.staff_member})]})]}),n.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 bg-gray-50 border-t",children:[n.jsx("button",{onClick:()=>c(null),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Close"}),n.jsx("button",{className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Take Action"})]})]})})]})},X9=()=>{const[e,t]=x.useState({level:"normal",active:!1,lastUpdated:new Date().toISOString(),activeIncidents:0,evacuationStatus:"none",systemsLocked:!1}),[r,s]=x.useState([]),[a,i]=x.useState(""),[l,c]=x.useState(null),[d,f]=x.useState(!1),h=[{id:"full_lockdown",type:"lockdown",title:"Full System Lockdown",description:"Immediately lock all gates and prevent new check-ins",severity:"critical",requiresConfirmation:!0,estimatedImpact:"All attendee movement stopped",icon:wh},{id:"partial_lockdown",type:"lockdown",title:"Partial Lockdown",description:"Lock specific gates while maintaining emergency exits",severity:"high",requiresConfirmation:!0,estimatedImpact:"Limited attendee movement",icon:jr},{id:"emergency_broadcast",type:"broadcast",title:"Emergency Broadcast",description:"Send urgent message to all staff and connected systems",severity:"high",requiresConfirmation:!1,estimatedImpact:"All staff notified immediately",icon:cx},{id:"evacuation_alert",type:"evacuation",title:"Evacuation Alert",description:"Trigger evacuation procedures and guide attendees to exits",severity:"critical",requiresConfirmation:!0,estimatedImpact:"Full venue evacuation initiated",icon:lt},{id:"staff_emergency_alert",type:"staff_alert",title:"Staff Emergency Alert",description:"Alert all staff members of emergency situation",severity:"medium",requiresConfirmation:!1,estimatedImpact:"All staff receive emergency notification",icon:eP},{id:"system_shutdown",type:"system_shutdown",title:"Emergency System Shutdown",description:"Shut down all non-essential systems to preserve critical functions",severity:"critical",requiresConfirmation:!0,estimatedImpact:"Only emergency systems remain active",icon:Gc}];x.useEffect(()=>{m();const y=setInterval(m,1e4);return()=>clearInterval(y)},[]);const m=async()=>{try{const{data:y,error:w}=await B.from("emergency_incidents").select("*").in("status",["active","investigating"]).order("reported_at",{ascending:!1}).limit(20);if(w)throw w;const k=(y||[]).map(A=>({id:A.id,type:A.incident_type,severity:A.severity,location:A.location||"Unknown",description:A.description,reportedAt:A.reported_at,reportedBy:A.reported_by||"System",status:A.status,responders:A.responders||[],estimatedAffected:A.estimated_affected||0}));s(k);const N=k.filter(A=>A.status==="active").length,P=k.some(A=>A.severity==="critical"),O=k.some(A=>A.severity==="high"),T=k.some(A=>A.severity==="medium");t(A=>({...A,activeIncidents:N,level:P?"critical":O?"high":T?"elevated":"normal",lastUpdated:new Date().toISOString(),active:N>0}))}catch(y){console.error("Error fetching emergency data:",y)}},g=async y=>{if(y.requiresConfirmation){c(y);return}f(!0);try{switch(console.log(`Executing emergency action: ${y.type}`),y.type){case"lockdown":t(w=>({...w,systemsLocked:!0}));break;case"evacuation":t(w=>({...w,evacuationStatus:"full"}));break;case"broadcast":a.trim()&&(console.log("Broadcasting:",a),i(""));break;case"staff_alert":console.log("Staff alert sent");break;case"system_shutdown":console.log("Emergency shutdown initiated");break}await new Promise(w=>setTimeout(w,1e3))}catch(w){console.error("Error executing emergency action:",w)}finally{f(!1)}},v=async()=>{l&&(c(null),await g(l))},j=y=>{switch(y){case"critical":return"text-red-600 bg-red-100 border-red-200";case"high":return"text-orange-600 bg-orange-100 border-orange-200";case"elevated":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"normal":return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},_=y=>{switch(y){case"critical":return"text-red-600 bg-red-100";case"high":return"text-orange-600 bg-orange-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[n.jsx(bt,{className:"h-6 w-6 mr-2 text-red-500"}),"Emergency Control Center"]}),n.jsx("p",{className:"text-gray-600",children:"Critical incident management and emergency response controls"})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${j(e.level)}`,children:[n.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${e.level==="critical"?"bg-red-500 animate-pulse":e.level==="high"?"bg-orange-500 animate-pulse":e.level==="elevated"?"bg-yellow-500":"bg-green-500"}`}),e.level.toUpperCase()," ALERT"]}),n.jsxs("button",{onClick:m,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsx("div",{className:`bg-white overflow-hidden shadow rounded-lg border-l-4 ${e.level==="critical"?"border-l-red-500":e.level==="high"?"border-l-orange-500":e.level==="elevated"?"border-l-yellow-500":"border-l-green-500"}`,children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(bt,{className:`h-6 w-6 ${e.level==="critical"?"text-red-400":e.level==="high"?"text-orange-400":e.level==="elevated"?"text-yellow-400":"text-green-400"}`})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Alert Level"}),n.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.level.toUpperCase()})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-l-blue-500",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(qt,{className:"h-6 w-6 text-blue-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Incidents"}),n.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.activeIncidents})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-l-purple-500",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:e.systemsLocked?n.jsx(wh,{className:"h-6 w-6 text-red-400"}):n.jsx(cP,{className:"h-6 w-6 text-green-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"System Status"}),n.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.systemsLocked?"LOCKED":"OPERATIONAL"})]})})]})})}),n.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-l-indigo-500",children:n.jsx("div",{className:"p-5",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(lt,{className:"h-6 w-6 text-indigo-400"})}),n.jsx("div",{className:"ml-5 w-0 flex-1",children:n.jsxs("dl",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Evacuation"}),n.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.evacuationStatus.toUpperCase()})]})})]})})})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Emergency Actions"}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Critical response actions for emergency situations"})]}),n.jsx("div",{className:"p-6",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(y=>{const w=y.icon;return n.jsx("div",{className:`p-4 border-2 rounded-lg hover:shadow-md transition-shadow ${y.severity==="critical"?"border-red-200 hover:border-red-300":y.severity==="high"?"border-orange-200 hover:border-orange-300":y.severity==="medium"?"border-yellow-200 hover:border-yellow-300":"border-blue-200 hover:border-blue-300"}`,children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center ${_(y.severity)}`,children:n.jsx(w,{className:"h-5 w-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-900",children:y.title}),n.jsx("p",{className:"text-xs text-gray-600 mt-1",children:y.description}),n.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Impact: ",y.estimatedImpact]}),n.jsx("button",{onClick:()=>g(y),disabled:d,className:`mt-3 w-full inline-flex items-center justify-center px-3 py-2 border border-transparent text-xs font-medium rounded-md text-white ${y.severity==="critical"?"bg-red-600 hover:bg-red-700":y.severity==="high"?"bg-orange-600 hover:bg-orange-700":y.severity==="medium"?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"} disabled:opacity-50`,children:d?"Executing...":`Execute ${y.requiresConfirmation?"(Confirm)":""}`})]})]})},y.id)})})})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[n.jsx(cx,{className:"h-5 w-5 mr-2 text-blue-500"}),"Emergency Broadcast System"]})}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Broadcast Message"}),n.jsx("textarea",{value:a,onChange:y=>i(y.target.value),rows:3,className:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter emergency message to broadcast to all staff and systems..."})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{className:"text-sm text-gray-500",children:"Message will be sent to all staff via Telegram, email, and in-app notifications"}),n.jsxs("button",{onClick:()=>g(h.find(y=>y.type==="broadcast")),disabled:!a.trim()||d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",children:[n.jsx(Kl,{className:"h-4 w-4 mr-2"}),"Send Emergency Broadcast"]})]})]})})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Active Incidents"})}),n.jsx("div",{className:"divide-y divide-gray-200",children:r.length===0?n.jsxs("div",{className:"p-6 text-center",children:[n.jsx(Tt,{className:"mx-auto h-12 w-12 text-green-400"}),n.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No Active Incidents"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"All systems operating normally"})]}):r.map(y=>n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start space-x-4",children:[n.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center ${_(y.severity)}`,children:n.jsx(bt,{className:"h-5 w-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-900",children:y.type}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_(y.severity)}`,children:y.severity}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y.status==="active"?"text-red-600 bg-red-100":y.status==="investigating"?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100"}`,children:y.status})]}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:y.description}),n.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[n.jsxs("span",{className:"flex items-center",children:[n.jsx(cn,{className:"h-3 w-3 mr-1"}),y.location]}),n.jsxs("span",{className:"flex items-center",children:[n.jsx(Vr,{className:"h-3 w-3 mr-1"}),new Date(y.reportedAt).toLocaleString()]}),n.jsxs("span",{className:"flex items-center",children:[n.jsx(lt,{className:"h-3 w-3 mr-1"}),"~",y.estimatedAffected," affected"]})]}),n.jsxs("div",{className:"mt-2",children:[n.jsxs("span",{className:"text-xs text-gray-500",children:["Reported by: ",y.reportedBy]}),y.responders.length>0&&n.jsxs("span",{className:"text-xs text-gray-500 ml-4",children:["Responders: ",y.responders.join(", ")]})]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{className:"inline-flex items-center px-2 py-1 border border-blue-300 text-xs font-medium rounded text-blue-700 bg-blue-50 hover:bg-blue-100",children:[n.jsx(us,{className:"h-3 w-3 mr-1"}),"View Details"]}),y.status==="active"&&n.jsxs("button",{className:"inline-flex items-center px-2 py-1 border border-green-300 text-xs font-medium rounded text-green-700 bg-green-50 hover:bg-green-100",children:[n.jsx(Tt,{className:"h-3 w-3 mr-1"}),"Resolve"]})]})]})},y.id))})]}),l&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"flex items-center justify-between p-6 border-b",children:n.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[n.jsx(bt,{className:"h-5 w-5 mr-2 text-red-500"}),"Confirm Emergency Action"]})}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900",children:l.title}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.description})]}),n.jsx("div",{className:`p-3 rounded-lg ${_(l.severity)}`,children:n.jsxs("p",{className:"text-sm font-medium",children:["Impact: ",l.estimatedImpact]})}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:n.jsx("p",{className:"text-sm text-yellow-800",children:" This action cannot be undone. Please confirm you want to proceed."})})]})}),n.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 bg-gray-50 border-t",children:[n.jsx("button",{onClick:()=>c(null),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:v,className:`px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${l.severity==="critical"?"bg-red-600 hover:bg-red-700":"bg-orange-600 hover:bg-orange-700"}`,children:"Confirm & Execute"})]})]})})]})},J9=()=>{const e=Cf(),t=[{title:"Overview",items:[{name:"Dashboard",href:"/",icon:VC}]},{title:"Event Management",items:[{name:"Events",href:"/events",icon:On},{name:"Check-ins",href:"/checkins",icon:yh}]},{title:"Operations",items:[{name:"Access Control",href:"/access",icon:lt},{name:"Analytics",href:"/analytics",icon:ai},{name:"Reports",href:"/reports",icon:sa}]},{title:"Security & Monitoring",items:[{name:"Fraud Detection",href:"/fraud",icon:jr},{name:"Emergency Center",href:"/emergency",icon:bt},{name:"Autonomous Ops",href:"/autonomous-operations",icon:ha}]},{title:"Administration",items:[{name:"Organization",href:"/organization",icon:vh},{name:"Webhooks",href:"/webhooks",icon:_h},{name:"Settings",href:"/settings",icon:oi}]}];return n.jsxs("div",{className:"layout-sidebar",children:[n.jsx("div",{className:"flex items-center h-16 px-4 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold text-sm",children:"NFC"})}),n.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Portal"})]})}),n.jsx("nav",{className:"flex-1 py-4",children:t.map(r=>n.jsxs("div",{className:"nav-section",children:[n.jsx("div",{className:"nav-section-title",children:r.title}),r.items.map(s=>{const a=e.pathname===s.href;return n.jsxs(dt,{to:s.href,className:`nav-item ${a?"active":""}`,children:[n.jsx(s.icon,{className:"nav-item-icon"}),s.name]},s.name)})]},r.title))})]})},Q9=({user:e})=>{var c,d;const[t,r]=x.useState(!1),i=!(Cf().pathname==="/events/new"),l=async()=>{await B.auth.signOut()};return n.jsxs("header",{className:"layout-header",children:[n.jsx("div",{className:"flex items-center flex-1",children:i&&n.jsx("div",{className:"max-w-lg w-full",children:n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Dn,{className:"h-4 w-4 text-gray-400"})}),n.jsx("input",{type:"text",className:"form-input pl-10 pr-4 py-2 w-full text-sm",placeholder:"Search events, wristbands, or check-ins..."})]})})}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("button",{className:"btn-ghost btn-sm p-2",children:n.jsx(xh,{className:"h-4 w-4"})}),n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>r(!t),className:"flex items-center space-x-2 p-2 text-gray-700 rounded-lg hover:bg-gray-50",children:[n.jsx("div",{className:"w-7 h-7 bg-blue-600 rounded-full flex items-center justify-center",children:n.jsx(uP,{className:"h-4 w-4 text-white"})}),n.jsx("span",{className:"text-sm font-medium hidden sm:block",children:((c=e==null?void 0:e.email)==null?void 0:c.split("@")[0])||"User"})]}),t&&n.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:n.jsxs("div",{className:"py-1",children:[n.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:((d=e==null?void 0:e.email)==null?void 0:d.split("@")[0])||"User"}),n.jsx("p",{className:"text-xs text-gray-500",children:e==null?void 0:e.email})]}),n.jsxs("a",{href:"/settings",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[n.jsx(oi,{className:"h-4 w-4 mr-2"}),"Settings"]}),n.jsxs("button",{onClick:l,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[n.jsx(eb,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})})]})]})]})},e7=({user:e})=>n.jsxs("div",{className:"layout-container",children:[n.jsx(J9,{}),n.jsxs("div",{className:"layout-main",children:[n.jsx(Q9,{user:e}),n.jsx("main",{className:"layout-content",children:n.jsx(lS,{})})]})]});class t7 extends x.Component{constructor(){super(...arguments);nr(this,"state",{hasError:!1})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,s){console.error("Uncaught error:",r,s)}render(){return this.state.hasError?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:n.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Something went wrong"}),n.jsx("p",{className:"text-sm text-gray-600",children:"An error occurred while loading the application"})]})]}),this.state.error&&n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Error Details:"}),n.jsx("p",{className:"text-xs text-gray-600 font-mono break-all",children:this.state.error.message})]}),n.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Reload Page"})]})}):this.props.children}}const r7=({onClick:e})=>n.jsxs("button",{onClick:e,className:"fixed bottom-6 right-6 z-[9997] group","aria-label":"Take Tour",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full animate-ping opacity-75"}),n.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full animate-pulse opacity-50"}),n.jsxs("div",{className:"relative flex items-center gap-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-5 py-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105",children:[n.jsx(FC,{className:"w-5 h-5 animate-spin-slow"}),n.jsx("span",{className:"font-semibold text-sm",children:"Take Tour"})]})]}),n.jsx("div",{className:"absolute bottom-full right-0 mb-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:n.jsxs("div",{className:"bg-gray-900 text-white text-xs px-3 py-2 rounded-lg whitespace-nowrap",children:["Learn how to use the portal",n.jsx("div",{className:"absolute top-full right-6 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})})]}),n7=()=>{const[e,t]=x.useState(null),[r,s]=x.useState(!0),[a,i]=x.useState(null),[l,c]=x.useState(!1);if(x.useEffect(()=>{const f=setTimeout(()=>{console.warn("Auth initialization timeout, proceeding without session"),s(!1)},1e4);B.auth.getSession().then(({data:{session:m},error:g})=>{clearTimeout(f),g&&console.error("Auth session error:",g),t(m),i((m==null?void 0:m.user)??null),s(!1)}).catch(m=>{clearTimeout(f),console.error("Auth initialization failed:",m),s(!1)});const{data:{subscription:h}}=B.auth.onAuthStateChange((m,g)=>{t(g),i((g==null?void 0:g.user)??null)});return()=>{clearTimeout(f),h.unsubscribe()}},[]),r)return n.jsx(nb,{});const d=()=>{c(!1),localStorage.setItem("onboarding_completed","true"),localStorage.setItem("onboarding_completed_at",new Date().toISOString())};return n.jsxs(t7,{children:[e&&l&&n.jsx(X1,{onClose:()=>c(!1),onComplete:d}),e&&!l&&n.jsx(r7,{onClick:()=>c(!0)}),n.jsx(IC,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),n.jsx(cS,{children:n.jsxs(dS,{children:[n.jsx(xt,{path:"/login",element:e?n.jsx(gu,{to:"/"}):n.jsx(LC,{})}),e?n.jsxs(xt,{path:"/*",element:n.jsx(XU,{children:n.jsx(e7,{user:a})}),children:[n.jsx(xt,{index:!0,element:n.jsx(fP,{})}),n.jsx(xt,{path:"autonomous-operations",element:n.jsx(gP,{})}),n.jsx(xt,{path:"events",element:n.jsx(yP,{})}),n.jsx(xt,{path:"events/new",element:n.jsx(QU,{})}),n.jsx(xt,{path:"events/:id",element:n.jsx(YU,{})}),n.jsx(xt,{path:"events/:id/edit",element:n.jsx(o9,{})}),n.jsx(xt,{path:"events/:eventId/staff",element:n.jsx(y9,{})}),n.jsx(xt,{path:"wristbands",element:n.jsx(U9,{})}),n.jsx(xt,{path:"tickets",element:n.jsx(B9,{})}),n.jsx(xt,{path:"checkins",element:n.jsx(F9,{})}),n.jsx(xt,{path:"access",element:n.jsx(l9,{})}),n.jsx(xt,{path:"access/:id/edit",element:n.jsx(d9,{})}),n.jsx(xt,{path:"analytics",element:n.jsx($9,{})}),n.jsx(xt,{path:"reports",element:n.jsx(D9,{})}),n.jsx(xt,{path:"fraud",element:n.jsx(Y9,{})}),n.jsx(xt,{path:"emergency",element:n.jsx(X9,{})}),n.jsx(xt,{path:"organization",element:n.jsx(z9,{})}),n.jsx(xt,{path:"webhooks",element:n.jsx(I9,{})}),n.jsx(xt,{path:"telegram-test",element:n.jsx(L9,{})}),n.jsx(xt,{path:"map-demo",element:n.jsx(H9,{})}),n.jsx(xt,{path:"settings",element:n.jsx(f9,{})}),n.jsx(xt,{path:"notification-test",element:n.jsx(m9,{})}),n.jsx(xt,{path:"*",element:n.jsx(gu,{to:"/",replace:!0})})]}):n.jsx(xt,{path:"*",element:n.jsx(gu,{to:"/login",replace:!0})})]})})]})},my=document.getElementById("root");my&&vy(my).render(n.jsx(at.StrictMode,{children:n.jsx(n7,{})}));
//# sourceMappingURL=index-BIlyV4qZ.js.map
