var l=Object.defineProperty;var i=(c,e,t)=>e in c?l(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var s=(c,e,t)=>i(c,typeof e!="symbol"?e+"":e,t);class h{constructor(){s(this,"prefix","qs_secure_");s(this,"key","quickstrap_storage_key")}encrypt(e){const t=this.key;let r="";for(let o=0;o<e.length;o++)r+=String.fromCharCode(e.charCodeAt(o)^t.charCodeAt(o%t.length));return btoa(r)}decrypt(e){try{const t=atob(e),r=this.key;let o="";for(let a=0;a<t.length;a++)o+=String.fromCharCode(t.charCodeAt(a)^r.charCodeAt(a%r.length));return o}catch(t){return console.error("Decryption failed:",t),""}}setItem(e,t,r={}){try{const o={value:t,timestamp:Date.now(),expiry:r.expiry?Date.now()+r.expiry:null},a=JSON.stringify(o),n=r.encrypt!==!1?this.encrypt(a):a;localStorage.setItem(this.prefix+e,n)}catch(o){console.error("Secure storage setItem failed:",o)}}getItem(e,t=!0){try{const r=localStorage.getItem(this.prefix+e);if(!r)return null;const o=t?this.decrypt(r):r;if(!o)return null;const a=JSON.parse(o);return a.expiry&&Date.now()>a.expiry?(this.removeItem(e),null):a.value}catch(r){return console.error("Secure storage getItem failed:",r),null}}removeItem(e){localStorage.removeItem(this.prefix+e)}clear(){Object.keys(localStorage).forEach(t=>{t.startsWith(this.prefix)&&localStorage.removeItem(t)})}hasItem(e){return this.getItem(e)!==null}}const u=new h;export{u as secureStorage};
//# sourceMappingURL=secureStorage-BLm_y47z.js.map
