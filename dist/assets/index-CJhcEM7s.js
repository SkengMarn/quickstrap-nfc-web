import{r as v,a as ta,g as sa,c as ee,R as $,L as F,u as We,b as be,d as Bs,e as zs,f as ra,N as ls,O as aa,B as na,h as ia,i as H,j as Xe}from"./vendor-DwgHmrTp.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();window.ENV={REACT_APP_SUPABASE_URL:"https://pmrxyisasfaimumuobvu.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtcnh5aXNhc2ZhaW11bXVvYnZ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyODQ2ODMsImV4cCI6MjA2ODg2MDY4M30.rVsKq08Ynw82RkCntxWFXOTgP8T0cGyhJvqfrnOH4YQ"};var Ws={exports:{}},it={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oa=v,la=Symbol.for("react.element"),ca=Symbol.for("react.fragment"),da=Object.prototype.hasOwnProperty,ua=oa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ha={key:!0,ref:!0,__self:!0,__source:!0};function Hs(s,e,t){var r,a={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)da.call(e,r)&&!ha.hasOwnProperty(r)&&(a[r]=e[r]);if(s&&s.defaultProps)for(r in e=s.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:la,type:s,key:i,ref:o,props:a,_owner:ua.current}}it.Fragment=ca;it.jsx=Hs;it.jsxs=Hs;Ws.exports=it;var n=Ws.exports,Vs,cs=ta;Vs=cs.createRoot,cs.hydrateRoot;const fa="modulepreload",ma=function(s){return"/"+s},ds={},He=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(t.map(c=>{if(c=ma(c),c in ds)return;ds[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":fa,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,y)=>{h.addEventListener("load",f),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},pa=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>He(async()=>{const{default:r}=await Promise.resolve().then(()=>Ie);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Gt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class ga extends Gt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class us extends Gt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class hs extends Gt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var It;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(It||(It={}));var ya=function(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(s,e||[])).next())})};class xa{constructor(e,{headers:t={},customFetch:r,region:a=It.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=pa(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return ya(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=t;let l={},{region:c}=t;c||(c=this.region);const u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const h=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:d}).catch(p=>{throw new ga(p)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new us(h);if(!h.ok)throw new hs(h);let y=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),x;return y==="application/json"?x=yield h.json():y==="application/octet-stream"?x=yield h.blob():y==="text/event-stream"?x=h:y==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof hs||a instanceof us?a.context:void 0}}})}}var Q={},Xt={},ot={},Ve={},lt={},ct={},va=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ae=va();const ba=Ae.fetch,Ks=Ae.fetch.bind(Ae),Js=Ae.Headers,wa=Ae.Request,_a=Ae.Response,Ie=Object.freeze(Object.defineProperty({__proto__:null,Headers:Js,Request:wa,Response:_a,default:Ks,fetch:ba},Symbol.toStringTag,{value:"Module"})),ja=sa(Ie);var dt={};Object.defineProperty(dt,"__esModule",{value:!0});let ka=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};dt.default=ka;var Gs=ee&&ee.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ct,"__esModule",{value:!0});const Na=Gs(ja),Sa=Gs(dt);let Ta=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Na.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let u=null,d=null,h=null,f=i.status,y=i.statusText;if(i.ok){if(this.method!=="HEAD"){const g=await i.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=g:d=JSON.parse(g))}const p=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),m=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");p&&m&&m.length>1&&(h=parseInt(m[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,y="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const p=await i.text();try{u=JSON.parse(p),Array.isArray(u)&&i.status===404&&(d=[],u=null,f=200,y="OK")}catch{i.status===404&&p===""?(f=204,y="No Content"):u={message:p}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,f=200,y="OK"),u&&this.shouldThrowOnError)throw new Sa.default(u)}return{error:u,data:d,count:h,status:f,statusText:y}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}};ct.default=Ta;var Ea=ee&&ee.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(lt,"__esModule",{value:!0});const Ca=Ea(ct);let Pa=class extends Ca.default{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};lt.default=Pa;var Oa=ee&&ee.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ve,"__esModule",{value:!0});const Aa=Oa(lt);let Ia=class extends Aa.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Ve.default=Ia;var $a=ee&&ee.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ot,"__esModule",{value:!0});const De=$a(Ve);let Da=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=t,this.schema=r,this.fetch=a}select(e,{head:t=!1,count:r}={}){const a=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new De.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new De.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new De.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),t&&a.push(`count=${t}`),this.headers.Prefer=a.join(","),new De.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new De.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ot.default=Da;var ut={},ht={};Object.defineProperty(ht,"__esModule",{value:!0});ht.version=void 0;ht.version="0.0.0-automated";Object.defineProperty(ut,"__esModule",{value:!0});ut.DEFAULT_HEADERS=void 0;const Ra=ht;ut.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ra.version}`};var Xs=ee&&ee.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Xt,"__esModule",{value:!0});const La=Xs(ot),Ua=Xs(Ve),Ma=ut;let Fa=class Ys{constructor(e,{headers:t={},schema:r,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},Ma.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=a}from(e){const t=new URL(`${this.url}/${e}`);return new La.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Ys(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:a=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let c;r||a?(o=r?"HEAD":"GET",Object.entries(t).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",c=t);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new Ua.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Xt.default=Fa;var $e=ee&&ee.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Q,"__esModule",{value:!0});Q.PostgrestError=Q.PostgrestBuilder=Q.PostgrestTransformBuilder=Q.PostgrestFilterBuilder=Q.PostgrestQueryBuilder=Q.PostgrestClient=void 0;const Qs=$e(Xt);Q.PostgrestClient=Qs.default;const Zs=$e(ot);Q.PostgrestQueryBuilder=Zs.default;const er=$e(Ve);Q.PostgrestFilterBuilder=er.default;const tr=$e(lt);Q.PostgrestTransformBuilder=tr.default;const sr=$e(ct);Q.PostgrestBuilder=sr.default;const rr=$e(dt);Q.PostgrestError=rr.default;var qa=Q.default={PostgrestClient:Qs.default,PostgrestQueryBuilder:Zs.default,PostgrestFilterBuilder:er.default,PostgrestTransformBuilder:tr.default,PostgrestBuilder:sr.default,PostgrestError:rr.default};const{PostgrestClient:Ba,PostgrestQueryBuilder:bc,PostgrestFilterBuilder:wc,PostgrestTransformBuilder:_c,PostgrestBuilder:jc,PostgrestError:kc}=qa;function za(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Wa=za(),Ha="2.11.15",Va=`realtime-js/${Ha}`,Ka="1.0.0",ar=1e4,Ja=1e3;var Me;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Me||(Me={}));var J;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(J||(J={}));var se;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(se||(se={}));var $t;(function(s){s.websocket="websocket"})($t||($t={}));var ye;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(ye||(ye={}));class Ga{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const a=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+a));o=o+a;const c=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class nr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var L;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(L||(L={}));const fs=(s,e,t={})=>{var r;const a=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=Xa(o,s,e,a),i),{})},Xa=(s,e,t,r)=>{const a=e.find(l=>l.name===s),i=a==null?void 0:a.type,o=t[s];return i&&!r.includes(i)?ir(i,o):Dt(o)},ir=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return en(e,t)}switch(s){case L.bool:return Ya(e);case L.float4:case L.float8:case L.int2:case L.int4:case L.int8:case L.numeric:case L.oid:return Qa(e);case L.json:case L.jsonb:return Za(e);case L.timestamp:return tn(e);case L.abstime:case L.date:case L.daterange:case L.int4range:case L.int8range:case L.money:case L.reltime:case L.text:case L.time:case L.timestamptz:case L.timetz:case L.tsrange:case L.tstzrange:return Dt(e);default:return Dt(e)}},Dt=s=>s,Ya=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Qa=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},Za=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},en=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let i;const o=s.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>ir(e,l))}return s},tn=s=>typeof s=="string"?s.replace(" ","T"):s,or=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class _t{constructor(e,t,r={},a=ar){this.channel=e,this.event=t,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ms;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(ms||(ms={}));class Fe{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Fe.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=Fe.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Fe.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,a){const i=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(m=>m.presence_ref),y=h.map(m=>m.presence_ref),x=d.filter(m=>y.indexOf(m.presence_ref)<0),p=h.filter(m=>f.indexOf(m.presence_ref)<0);x.length>0&&(l[u]=x),p.length>0&&(c[u]=p)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},r,a)}static syncDiff(e,t,r,a){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),d.length>0){const h=e[l].map(y=>y.presence_ref),f=d.filter(y=>h.indexOf(y.presence_ref)<0);e[l].unshift(...f)}r(l,d,c)}),this.map(o,(l,c)=>{let u=e[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=u,a(l,u,c),u.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const a=e[r];return"metas"in a?t[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ps;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(ps||(ps={}));var gs;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(gs||(gs={}));var ae;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(ae||(ae={}));class Yt{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=J.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new _t(this,se.join,this.params,this.timeout),this.rejoinTimer=new nr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=J.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=J.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this._on(se.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Fe(this),this.broadcastEndpointURL=or(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==J.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(d=>e==null?void 0:e(ae.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(ae.CLOSED));const c={},u={broadcast:i,presence:o,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(d=>d.filter))!==null&&a!==void 0?a:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){e==null||e(ae.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,y=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,x=[];for(let p=0;p<y;p++){const m=f[p],{filter:{event:g,schema:w,table:b,filter:_}}=m,C=d&&d[p];if(C&&C.event===g&&C.schema===w&&C.table===b&&C.filter===_)x.push(Object.assign(Object.assign({},m),{id:C.id}));else{this.unsubscribe(),this.state=J.errored,e==null||e(ae.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(ae.SUBSCRIBED);return}}).receive("error",d=>{this.state=J.errored,e==null||e(ae.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ae.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=J.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(se.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new _t(this,se.leave,{},e),r.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new _t(this,e,t,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var a,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=se;if(r&&[l,c,u,d].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,t,r);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(y=>{var x,p,m;return((x=y.filter)===null||x===void 0?void 0:x.event)==="*"||((m=(p=y.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===o}).map(y=>y.callback(f,r)):(i=this.bindings[o])===null||i===void 0||i.filter(y=>{var x,p,m,g,w,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const _=y.id,C=(x=y.filter)===null||x===void 0?void 0:x.event;return _&&((p=t.ids)===null||p===void 0?void 0:p.includes(_))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const _=(w=(g=y==null?void 0:y.filter)===null||g===void 0?void 0:g.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return _==="*"||_===((b=t==null?void 0:t.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof f=="object"&&"ids"in f){const x=f.data,{schema:p,table:m,commit_timestamp:g,type:w,errors:b}=x;f=Object.assign(Object.assign({},{schema:p,table:m,commit_timestamp:g,eventType:w,new:{},old:{},errors:b}),this._getPayloadRecords(x))}y.callback(f,r)})}_isClosed(){return this.state===J.closed}_isJoined(){return this.state===J.joined}_isJoining(){return this.state===J.joining}_isLeaving(){return this.state===J.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const a=e.toLocaleLowerCase(),i={type:a,filter:t,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Yt.isEqual(a.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(se.close,{},e)}_onError(e){this._on(se.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=J.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=fs(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=fs(e.columns,e.old_record)),t}}const ys=()=>{},sn=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class rn{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ar,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ys,this.ref=0,this.logger=ys,this.conn=null,this.sendBuffer=[],this.serializer=new Ga,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>He(async()=>{const{default:c}=await Promise.resolve().then(()=>Ie);return{default:c}},void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${$t.websocket}`,this.httpEndpoint=or(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const a=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new nr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Wa),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ka}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Me.connecting:return ye.Connecting;case Me.open:return ye.Open;case Me.closing:return ye.Closing;default:return ye.Closed}}isConnected(){return this.connectionState()===ye.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new Yt(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:a,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${r} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const a={access_token:t,version:Va};t&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(se.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Ja,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:a,payload:i,ref:o}=t;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${a} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(r)).forEach(l=>l._trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(se.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${r}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([sn],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Qt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function V(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class an extends Qt{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Rt extends Qt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var nn=function(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(s,e||[])).next())})};const lr=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>He(async()=>{const{default:r}=await Promise.resolve().then(()=>Ie);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},on=()=>nn(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield He(()=>Promise.resolve().then(()=>Ie),void 0)).Response:Response}),Lt=s=>{if(Array.isArray(s))return s.map(t=>Lt(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const a=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Lt(r)}),e},ln=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)};var we=function(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(s,e||[])).next())})};const jt=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),cn=(s,e,t)=>we(void 0,void 0,void 0,function*(){const r=yield on();s instanceof r&&!(t!=null&&t.noResolveJson)?s.json().then(a=>{const i=s.status||500,o=(a==null?void 0:a.statusCode)||i+"";e(new an(jt(a),i,o))}).catch(a=>{e(new Rt(jt(a),a))}):e(new Rt(jt(s),s))}),dn=(s,e,t,r)=>{const a={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||!r?a:(ln(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,Object.assign(Object.assign({},a),t))};function Ke(s,e,t,r,a,i){return we(this,void 0,void 0,function*(){return new Promise((o,l)=>{s(t,dn(e,r,a,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>cn(c,l,r))})})}function rt(s,e,t,r){return we(this,void 0,void 0,function*(){return Ke(s,"GET",e,t,r)})}function ne(s,e,t,r,a){return we(this,void 0,void 0,function*(){return Ke(s,"POST",e,r,a,t)})}function Ut(s,e,t,r,a){return we(this,void 0,void 0,function*(){return Ke(s,"PUT",e,r,a,t)})}function un(s,e,t,r){return we(this,void 0,void 0,function*(){return Ke(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function cr(s,e,t,r,a){return we(this,void 0,void 0,function*(){return Ke(s,"DELETE",e,r,a,t)})}var Y=function(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(s,e||[])).next())})};const hn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},xs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class fn{constructor(e,t={},r,a){this.url=e,this.headers=t,this.bucketId=r,this.fetch=lr(a)}uploadOrUpdate(e,t,r,a){return Y(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},xs),a);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),h=yield(e=="PUT"?Ut:ne)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(V(i))return{data:null,error:i};throw i}})}upload(e,t,r){return Y(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,a){return Y(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const u=Object.assign({upsert:xs.upsert},a),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield Ut(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(V(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return Y(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const i=yield ne(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Qt("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(V(r))return{data:null,error:r};throw r}})}update(e,t,r){return Y(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Y(this,void 0,void 0,function*(){try{return{data:yield ne(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(V(a))return{data:null,error:a};throw a}})}copy(e,t,r){return Y(this,void 0,void 0,function*(){try{return{data:{path:(yield ne(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(V(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,r){return Y(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield ne(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(V(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,r){return Y(this,void 0,void 0,function*(){try{const a=yield ne(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(V(a))return{data:null,error:a};throw a}})}download(e,t){return Y(this,void 0,void 0,function*(){const a=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield rt(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(V(l))return{data:null,error:l};throw l}})}info(e){return Y(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield rt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Lt(r),error:null}}catch(r){if(V(r))return{data:null,error:r};throw r}})}exists(e){return Y(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield un(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(V(r)&&r instanceof Rt){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&a.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(e){return Y(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(V(t))return{data:null,error:t};throw t}})}list(e,t,r){return Y(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},hn),t),{prefix:e||""});return{data:yield ne(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(V(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const mn="2.10.4",pn={"X-Client-Info":`storage-js/${mn}`};var je=function(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(s,e||[])).next())})};class gn{constructor(e,t={},r,a){const i=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},pn),t),this.fetch=lr(r)}listBuckets(){return je(this,void 0,void 0,function*(){try{return{data:yield rt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}})}getBucket(e){return je(this,void 0,void 0,function*(){try{return{data:yield rt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(V(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return je(this,void 0,void 0,function*(){try{return{data:yield ne(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(V(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return je(this,void 0,void 0,function*(){try{return{data:yield Ut(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(V(r))return{data:null,error:r};throw r}})}emptyBucket(e){return je(this,void 0,void 0,function*(){try{return{data:yield ne(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(V(t))return{data:null,error:t};throw t}})}deleteBucket(e){return je(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(V(t))return{data:null,error:t};throw t}})}}class yn extends gn{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new fn(this.url,this.headers,e,this.fetch)}}const xn="2.53.0";let Ue="";typeof Deno<"u"?Ue="deno":typeof document<"u"?Ue="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ue="react-native":Ue="node";const vn={"X-Client-Info":`supabase-js-${Ue}/${xn}`},bn={headers:vn},wn={schema:"public"},_n={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jn={};var kn=function(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(s,e||[])).next())})};const Nn=s=>{let e;return s?e=s:typeof fetch>"u"?e=Ks:e=fetch,(...t)=>e(...t)},Sn=()=>typeof Headers>"u"?Js:Headers,Tn=(s,e,t)=>{const r=Nn(t),a=Sn();return(i,o)=>kn(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:s;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",s),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var En=function(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(s,e||[])).next())})};function Cn(s){return s.endsWith("/")?s:s+"/"}function Pn(s,e){var t,r;const{db:a,auth:i,realtime:o,global:l}=s,{db:c,auth:u,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>En(this,void 0,void 0,function*(){return""})};return s.accessToken?f.accessToken=s.accessToken:delete f.accessToken,f}const dr="2.71.1",Ce=30*1e3,Mt=3,kt=Mt*Ce,On="http://localhost:9999",An="supabase.auth.token",In={"X-Client-Info":`gotrue-js/${dr}`},Ft="X-Supabase-Api-Version",ur={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},$n=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Dn=10*60*1e3;class Zt extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function O(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class Rn extends Zt{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Ln(s){return O(s)&&s.name==="AuthApiError"}class hr extends Zt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ue extends Zt{constructor(e,t,r,a){super(e,r,a),this.name=t,this.status=r}}class le extends ue{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Un(s){return O(s)&&s.name==="AuthSessionMissingError"}class Ye extends ue{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qe extends ue{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ze extends ue{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Mn(s){return O(s)&&s.name==="AuthImplicitGrantRedirectError"}class vs extends ue{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class qt extends ue{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Nt(s){return O(s)&&s.name==="AuthRetryableFetchError"}class bs extends ue{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Bt extends ue{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const at="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ws=` 	
\r=`.split(""),Fn=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<ws.length;e+=1)s[ws[e].charCodeAt(0)]=-2;for(let e=0;e<at.length;e+=1)s[at[e].charCodeAt(0)]=e;return s})();function _s(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(at[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(at[r]),e.queuedBits-=6}}function fr(s,e,t){const r=Fn[s];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function js(s){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{zn(o,r,t)};for(let o=0;o<s.length;o+=1)fr(s.charCodeAt(o),a,i);return e.join("")}function qn(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function Bn(s,e){for(let t=0;t<s.length;t+=1){let r=s.charCodeAt(t);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(s.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}qn(r,e)}}function zn(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let r=1;r<6;r+=1)if(!(s>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Wn(s){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<s.length;a+=1)fr(s.charCodeAt(a),t,r);return new Uint8Array(e)}function Hn(s){const e=[];return Bn(s,t=>e.push(t)),new Uint8Array(e)}function Vn(s){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};return s.forEach(a=>_s(a,t,r)),_s(null,t,r),e.join("")}function Kn(s){return Math.round(Date.now()/1e3)+s}function Jn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const te=()=>typeof window<"u"&&typeof document<"u",he={tested:!1,writable:!1},mr=()=>{if(!te())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(he.tested)return he.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),he.tested=!0,he.writable=!0}catch{he.tested=!0,he.writable=!1}return he.writable};function Gn(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return t.searchParams.forEach((r,a)=>{e[a]=r}),e}const pr=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>He(async()=>{const{default:r}=await Promise.resolve().then(()=>Ie);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Xn=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",Pe=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},fe=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},oe=async(s,e)=>{await s.removeItem(e)};class ft{constructor(){this.promise=new ft.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ft.promiseConstructor=Promise;function St(s){const e=s.split(".");if(e.length!==3)throw new Bt("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!$n.test(e[r]))throw new Bt("JWT not in base64url format");return{header:JSON.parse(js(e[0])),payload:JSON.parse(js(e[1])),signature:Wn(e[2]),raw:{header:e[0],payload:e[1]}}}async function Yn(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function Qn(s,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await s(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function Zn(s){return("0"+s.toString(16)).substr(-2)}function ei(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let a="";for(let i=0;i<56;i++)a+=t.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,Zn).join("")}async function ti(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function si(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await ti(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ke(s,e,t=!1){const r=ei();let a=r;t&&(a+="/PASSWORD_RECOVERY"),await Pe(s,`${e}-code-verifier`,a);const i=await si(r);return[i,r===i?"plain":"s256"]}const ri=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ai(s){const e=s.headers.get(Ft);if(!e||!e.match(ri))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function ni(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function ii(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const oi=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ne(s){if(!oi.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Tt(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ks(s){return JSON.parse(JSON.stringify(s))}var li=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(s);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(s,r[a])&&(t[r[a]]=s[r[a]]);return t};const pe=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),ci=[502,503,504];async function Ns(s){var e;if(!Xn(s))throw new qt(pe(s),0);if(ci.includes(s.status))throw new qt(pe(s),s.status);let t;try{t=await s.json()}catch(i){throw new hr(pe(i),i)}let r;const a=ai(s);if(a&&a.getTime()>=ur["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new bs(pe(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new le}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new bs(pe(t),s.status,t.weak_password.reasons);throw new Rn(pe(t),s.status||500,r)}const di=(s,e,t,r)=>{const a={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),t))};async function A(s,e,t,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[Ft]||(i[Ft]=ur["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await ui(s,e,t+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function ui(s,e,t,r,a,i){const o=di(e,r,a,i);let l;try{l=await s(t,Object.assign({},o))}catch(c){throw console.error(c),new qt(pe(c),0)}if(l.ok||await Ns(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await Ns(c)}}function re(s){var e;let t=null;pi(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=Kn(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function Ss(s){const e=re(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function ce(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function hi(s){return{data:s,error:null}}function fi(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:i}=s,o=li(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function mi(s){return s}function pi(s){return s.access_token&&s.refresh_token&&s.expires_in}const Et=["global","local","others"];var gi=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(s);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(s,r[a])&&(t[r[a]]=s[r[a]]);return t};class yi{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=pr(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Et[0]){if(Et.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Et.join(", ")}`);try{return await A(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await A(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ce})}catch(r){if(O(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=gi(e,["options"]),a=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await A(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:fi,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(O(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await A(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ce})}catch(t){if(O(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,a,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await A(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:mi});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return y.length>0&&(y.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(x.split(";")[1].split("=")[1]);u[`${m}Page`]=p}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(O(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Ne(e);try{return await A(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ce})}catch(t){if(O(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ne(e);try{return await A(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ce})}catch(r){if(O(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Ne(e);try{return await A(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ce})}catch(r){if(O(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ne(e.userId);try{const{data:t,error:r}=await A(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:r}}catch(t){if(O(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ne(e.userId),Ne(e.id);try{return{data:await A(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}}}function Ts(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function xi(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Se={debug:!!(globalThis&&mr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class gr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class vi extends gr{}async function bi(s,e,t){Se.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Se.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Se.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,a.name);try{return await t()}finally{Se.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,a.name)}}else{if(e===0)throw Se.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new vi(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(Se.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}xi();const wi={url:On,storageKey:An,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:In,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Es(s,e,t){return await t()}const Te={};class Be{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Be.nextInstanceID,Be.nextInstanceID+=1,this.instanceID>0&&te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},wi),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new yi({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=pr(a.fetch),this.lock=a.lock||Es,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:te()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=bi:this.lock=Es,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:mr()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ts(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Ts(this.memoryStorage)),te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Te[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Te[this.storageKey]=Object.assign(Object.assign({},Te[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Te[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Te[this.storageKey]=Object.assign(Object.assign({},Te[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${dr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Gn(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),te()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Mn(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return O(t)?{error:t}:{error:new hr("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,a;try{const i=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:re}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(O(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,a;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let y=null,x=null;this.flowType==="pkce"&&([y,x]=await ke(this.storage,this.storageKey)),i=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:y,code_challenge_method:x},xform:re})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:re})}else throw new Qe("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(O(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await A(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ss})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await A(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ss})}else throw new Qe("You must provide either an email or phone number and a password");const{data:r,error:a}=t;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ye}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,a,i,o,l,c,u,d,h,f,y;let x,p;if("message"in e)x=e.message,p=e.signature;else{const{chain:m,wallet:g,statement:w,options:b}=e;let _;if(te())if(typeof g=="object")_=g;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))_=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=g}const C=new URL((t=b==null?void 0:b.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in _&&_.signIn){const T=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),w?{statement:w}:null));let S;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")S=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)S=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)x=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),p=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${C.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(a=(r=b==null?void 0:b.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((u=b==null?void 0:b.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(d=b==null?void 0:b.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const T=await _.signMessage(new TextEncoder().encode(x),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=T}}try{const{data:m,error:g}=await A(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:Vn(p)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:re});if(g)throw g;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new Ye}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:g})}catch(m){if(O(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(e){const t=await fe(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(t??"").split("/");try{const{data:i,error:o}=await A(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:re});if(await oe(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ye}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(O(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:a,access_token:i,nonce:o}=e,l=await A(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:re}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ye}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,a,i,o;try{if("email"in e){const{email:l,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await ke(this.storage,this.storageKey));const{error:h}=await A(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:d}=await A(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Qe("You must provide either an email or phone number.")}catch(l){if(O(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,r;try{let a,i;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await A(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:re});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(O(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var t,r,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await ke(this.storage,this.storageKey)),await A(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:hi})}catch(i){if(O(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new le;const{error:a}=await A(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(O(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:o}=await A(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:o,error:l}=await A(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Qe("You must provide either an email or phone number and a type")}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await fe(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<kt:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await fe(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Tt()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await A(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ce}):await this._useSession(async t=>{var r,a,i;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new le}:await A(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:ce})})}catch(t){if(O(t))return Un(t)&&(await this._removeSession(),await oe(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new le;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await ke(this.storage,this.storageKey));const{data:u,error:d}=await A(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:ce});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(O(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new le;const t=Date.now()/1e3;let r=t,a=!0,i=null;const{payload:o}=St(e.access_token);if(o.exp&&(r=o.exp,a=r<=t),a){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(O(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new le;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!te())throw new Ze("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ze(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new vs("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ze("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new vs("No code detected.");const{data:w,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=e;if(!i||!l||!o||!u)throw new Ze("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;c&&(f=parseInt(c));const y=f-d;y*1e3<=Ce&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${h}s`);const x=f-h;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,f,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,f,d);const{data:p,error:m}=await this._getUser(i);if(m)throw m;const g={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(r){if(O(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await fe(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:a,error:i}=t;if(i)return{error:i};const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Ln(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await oe(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Jn(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,a;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await ke(this.storage,this.storageKey,!0));try{return await A(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(O(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:a}=await this._useSession(async i=>{var o,l,c,u,d;const{data:h,error:f}=i;if(f)throw f;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await A(this.fetch,"GET",y,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return te()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(O(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,a;const{data:i,error:o}=t;if(o)throw o;return await A(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(O(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Qn(async a=>(a>0&&await Yn(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await A(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:re})),(a,i)=>{const o=200*Math.pow(2,a);return i&&Nt(i)&&Date.now()+o-r<Ce})}catch(r){if(this._debug(t,"error",r),O(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),te()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await fe(this.storage,this.storageKey);if(a&&this.userStorage){let o=await fe(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await Pe(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Tt()}else if(a&&!a.user&&!a.user){const o=await fe(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await oe(this.storage,this.storageKey+"-user"),await Pe(this.storage,this.storageKey,a)):a.user=Tt()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const i=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<kt;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${kt}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),Nt(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new le;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ft;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new le;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),O(i)){const o={session:null,error:i};return Nt(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Pe(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const i=ks(a);await Pe(this.storage,this.storageKey,i)}else{const a=ks(t);await Pe(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await oe(this.storage,this.storageKey),await oe(this.storage,this.storageKey+"-code-verifier"),await oe(this.storage,this.storageKey+"-user"),this.userStorage&&await oe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&te()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ce);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Ce);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ce}ms, refresh threshold is ${Mt} ticks`),a<=Mt&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof gr)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!te()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const a=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await ke(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:a,error:i}=t;return i?{data:null,error:i}:await A(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(O(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,a;const{data:i,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await A(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(O(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:l}=await A(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(O(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:i}=t;return i?{data:null,error:i}:await A(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(O(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],a=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=St(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(l=>l.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+Dn>a)return r;const{data:i,error:o}=await A(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,r=i.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:y,error:x}=await this.getSession();if(x||!y.session)return{data:null,error:x};r=y.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=St(r);t!=null&&t.allowExpired||ni(i.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!u){const{error:y}=await this.getUser(r);if(y)throw y;return{data:{claims:i,header:a,signature:o},error:null}}const d=ii(a.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,Hn(`${l}.${c}`)))throw new Bt("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}}}Be.nextInstanceID=0;const _i=Be;class ji extends _i{constructor(e){super(e)}}var ki=function(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(s,e||[])).next())})};class Ni{constructor(e,t,r){var a,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=Cn(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:wn,realtime:jn,auth:Object.assign(Object.assign({},_n),{storageKey:u}),global:bn},h=Pn(r??{},d);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=Tn(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Ba(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new yn(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new xa(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ki(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,storageKey:i,flowType:o,lock:l,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ji({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new rn(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Si=(s,e,t)=>new Ni(s,e,t);function Ti(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const s=process.version.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}Ti()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ei=typeof window<"u",Ci="https://pmrxyisasfaimumuobvu.supabase.co",Pi="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtcnh5aXNhc2ZhaW11bXVvYnZ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyODQ2ODMsImV4cCI6MjA2ODg2MDY4M30.rVsKq08Ynw82RkCntxWFXOTgP8T0cGyhJvqfrnOH4YQ",N=Si(Ci,Pi,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:Ei}});function yr(s){var e,t,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var a=s.length;for(e=0;e<a;e++)s[e]&&(t=yr(s[e]))&&(r&&(r+=" "),r+=t)}else for(t in s)s[t]&&(r&&(r+=" "),r+=t);return r}function xe(){for(var s,e,t=0,r="",a=arguments.length;t<a;t++)(s=arguments[t])&&(e=yr(s))&&(r&&(r+=" "),r+=e);return r}function Oi(s){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}Oi(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Je=s=>typeof s=="number"&&!isNaN(s),ve=s=>typeof s=="string",ie=s=>typeof s=="function",Ai=s=>ve(s)||Je(s),zt=s=>ve(s)||ie(s)?s:null,Ii=(s,e)=>s===!1||Je(s)&&s>0?s:e,Wt=s=>v.isValidElement(s)||ve(s)||ie(s)||Je(s);function $i(s,e,t=300){let{scrollHeight:r,style:a}=s;requestAnimationFrame(()=>{a.minHeight="initial",a.height=r+"px",a.transition=`all ${t}ms`,requestAnimationFrame(()=>{a.height="0",a.padding="0",a.margin="0",setTimeout(e,t)})})}function Di({enter:s,exit:e,appendPosition:t=!1,collapse:r=!0,collapseDuration:a=300}){return function({children:i,position:o,preventExitTransition:l,done:c,nodeRef:u,isIn:d,playToast:h}){let f=t?`${s}--${o}`:s,y=t?`${e}--${o}`:e,x=v.useRef(0);return v.useLayoutEffect(()=>{let p=u.current,m=f.split(" "),g=w=>{w.target===u.current&&(h(),p.removeEventListener("animationend",g),p.removeEventListener("animationcancel",g),x.current===0&&w.type!=="animationcancel"&&p.classList.remove(...m))};p.classList.add(...m),p.addEventListener("animationend",g),p.addEventListener("animationcancel",g)},[]),v.useEffect(()=>{let p=u.current,m=()=>{p.removeEventListener("animationend",m),r?$i(p,c,a):c()};d||(l?m():(x.current=1,p.className+=` ${y}`,p.addEventListener("animationend",m)))},[d]),$.createElement($.Fragment,null,i)}}function Cs(s,e){return{content:xr(s.content,s.props),containerId:s.props.containerId,id:s.props.toastId,theme:s.props.theme,type:s.props.type,data:s.props.data||{},isLoading:s.props.isLoading,icon:s.props.icon,reason:s.removalReason,status:e}}function xr(s,e,t=!1){return v.isValidElement(s)&&!ve(s.type)?v.cloneElement(s,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):ie(s)?s({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):s}function Ri({closeToast:s,theme:e,ariaLabel:t="close"}){return $.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:r=>{r.stopPropagation(),s(!0)},"aria-label":t},$.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},$.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Li({delay:s,isRunning:e,closeToast:t,type:r="default",hide:a,className:i,controlledProgress:o,progress:l,rtl:c,isIn:u,theme:d}){let h=a||o&&l===0,f={animationDuration:`${s}ms`,animationPlayState:e?"running":"paused"};o&&(f.transform=`scaleX(${l})`);let y=xe("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":c}),x=ie(i)?i({rtl:c,type:r,defaultClassName:y}):xe(y,i),p={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{u&&t()}};return $.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},$.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${r}`}),$.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:x,style:f,...p}))}var Ui=1,vr=()=>`${Ui++}`;function Mi(s,e,t){let r=1,a=0,i=[],o=[],l=e,c=new Map,u=new Set,d=w=>(u.add(w),()=>u.delete(w)),h=()=>{o=Array.from(c.values()),u.forEach(w=>w())},f=({containerId:w,toastId:b,updateId:_})=>{let C=w?w!==s:s!==1,T=c.has(b)&&_==null;return C||T},y=(w,b)=>{c.forEach(_=>{var C;(b==null||b===_.props.toastId)&&((C=_.toggle)==null||C.call(_,w))})},x=w=>{var b,_;(_=(b=w.props)==null?void 0:b.onClose)==null||_.call(b,w.removalReason),w.isActive=!1},p=w=>{if(w==null)c.forEach(x);else{let b=c.get(w);b&&x(b)}h()},m=()=>{a-=i.length,i=[]},g=w=>{var b,_;let{toastId:C,updateId:T}=w.props,S=T==null;w.staleId&&c.delete(w.staleId),w.isActive=!0,c.set(C,w),h(),t(Cs(w,S?"added":"updated")),S&&((_=(b=w.props).onOpen)==null||_.call(b))};return{id:s,props:l,observe:d,toggle:y,removeToast:p,toasts:c,clearQueue:m,buildToast:(w,b)=>{if(f(b))return;let{toastId:_,updateId:C,data:T,staleId:S,delay:I}=b,B=C==null;B&&a++;let k={...l,style:l.toastStyle,key:r++,...Object.fromEntries(Object.entries(b).filter(([E,M])=>M!=null)),toastId:_,updateId:C,data:T,isIn:!1,className:zt(b.className||l.toastClassName),progressClassName:zt(b.progressClassName||l.progressClassName),autoClose:b.isLoading?!1:Ii(b.autoClose,l.autoClose),closeToast(E){c.get(_).removalReason=E,p(_)},deleteToast(){let E=c.get(_);if(E!=null){if(t(Cs(E,"removed")),c.delete(_),a--,a<0&&(a=0),i.length>0){g(i.shift());return}h()}}};k.closeButton=l.closeButton,b.closeButton===!1||Wt(b.closeButton)?k.closeButton=b.closeButton:b.closeButton===!0&&(k.closeButton=Wt(l.closeButton)?l.closeButton:!0);let j={content:w,props:k,staleId:S};l.limit&&l.limit>0&&a>l.limit&&B?i.push(j):Je(I)?setTimeout(()=>{g(j)},I):g(j)},setProps(w){l=w},setToggle:(w,b)=>{let _=c.get(w);_&&(_.toggle=b)},isToastActive:w=>{var b;return(b=c.get(w))==null?void 0:b.isActive},getSnapshot:()=>o}}var X=new Map,ze=[],Ht=new Set,Fi=s=>Ht.forEach(e=>e(s)),br=()=>X.size>0;function qi(){ze.forEach(s=>_r(s.content,s.options)),ze=[]}var Bi=(s,{containerId:e})=>{var t;return(t=X.get(e||1))==null?void 0:t.toasts.get(s)};function wr(s,e){var t;if(e)return!!((t=X.get(e))!=null&&t.isToastActive(s));let r=!1;return X.forEach(a=>{a.isToastActive(s)&&(r=!0)}),r}function zi(s){if(!br()){ze=ze.filter(e=>s!=null&&e.options.toastId!==s);return}if(s==null||Ai(s))X.forEach(e=>{e.removeToast(s)});else if(s&&("containerId"in s||"id"in s)){let e=X.get(s.containerId);e?e.removeToast(s.id):X.forEach(t=>{t.removeToast(s.id)})}}var Wi=(s={})=>{X.forEach(e=>{e.props.limit&&(!s.containerId||e.id===s.containerId)&&e.clearQueue()})};function _r(s,e){Wt(s)&&(br()||ze.push({content:s,options:e}),X.forEach(t=>{t.buildToast(s,e)}))}function Hi(s){var e;(e=X.get(s.containerId||1))==null||e.setToggle(s.id,s.fn)}function jr(s,e){X.forEach(t=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===t.id)&&t.toggle(s,e==null?void 0:e.id)})}function Vi(s){let e=s.containerId||1;return{subscribe(t){let r=Mi(e,s,Fi);X.set(e,r);let a=r.observe(t);return qi(),()=>{a(),X.delete(e)}},setProps(t){var r;(r=X.get(e))==null||r.setProps(t)},getSnapshot(){var t;return(t=X.get(e))==null?void 0:t.getSnapshot()}}}function Ki(s){return Ht.add(s),()=>{Ht.delete(s)}}function Ji(s){return s&&(ve(s.toastId)||Je(s.toastId))?s.toastId:vr()}function Ge(s,e){return _r(s,e),e.toastId}function mt(s,e){return{...e,type:e&&e.type||s,toastId:Ji(e)}}function pt(s){return(e,t)=>Ge(e,mt(s,t))}function P(s,e){return Ge(s,mt("default",e))}P.loading=(s,e)=>Ge(s,mt("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function Gi(s,{pending:e,error:t,success:r},a){let i;e&&(i=ve(e)?P.loading(e,a):P.loading(e.render,{...a,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,d,h)=>{if(d==null){P.dismiss(i);return}let f={type:u,...o,...a,data:h},y=ve(d)?{render:d}:d;return i?P.update(i,{...f,...y}):P(y.render,{...f,...y}),h},c=ie(s)?s():s;return c.then(u=>l("success",r,u)).catch(u=>l("error",t,u)),c}P.promise=Gi;P.success=pt("success");P.info=pt("info");P.error=pt("error");P.warning=pt("warning");P.warn=P.warning;P.dark=(s,e)=>Ge(s,mt("default",{theme:"dark",...e}));function Xi(s){zi(s)}P.dismiss=Xi;P.clearWaitingQueue=Wi;P.isActive=wr;P.update=(s,e={})=>{let t=Bi(s,e);if(t){let{props:r,content:a}=t,i={delay:100,...r,...e,toastId:e.toastId||s,updateId:vr()};i.toastId!==s&&(i.staleId=s);let o=i.render||a;delete i.render,Ge(o,i)}};P.done=s=>{P.update(s,{progress:1})};P.onChange=Ki;P.play=s=>jr(!0,s);P.pause=s=>jr(!1,s);function Yi(s){var e;let{subscribe:t,getSnapshot:r,setProps:a}=v.useRef(Vi(s)).current;a(s);let i=(e=v.useSyncExternalStore(t,r,r))==null?void 0:e.slice();function o(l){if(!i)return[];let c=new Map;return s.newestOnTop&&i.reverse(),i.forEach(u=>{let{position:d}=u.props;c.has(d)||c.set(d,[]),c.get(d).push(u)}),Array.from(c,u=>l(u[0],u[1]))}return{getToastToRender:o,isToastActive:wr,count:i==null?void 0:i.length}}function Qi(s){let[e,t]=v.useState(!1),[r,a]=v.useState(!1),i=v.useRef(null),o=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:d,closeOnClick:h}=s;Hi({id:s.toastId,containerId:s.containerId,fn:t}),v.useEffect(()=>{if(s.pauseOnFocusLoss)return f(),()=>{y()}},[s.pauseOnFocusLoss]);function f(){document.hasFocus()||g(),window.addEventListener("focus",m),window.addEventListener("blur",g)}function y(){window.removeEventListener("focus",m),window.removeEventListener("blur",g)}function x(S){if(s.draggable===!0||s.draggable===S.pointerType){w();let I=i.current;o.canCloseOnClick=!0,o.canDrag=!0,I.style.transition="none",s.draggableDirection==="x"?(o.start=S.clientX,o.removalDistance=I.offsetWidth*(s.draggablePercent/100)):(o.start=S.clientY,o.removalDistance=I.offsetHeight*(s.draggablePercent===80?s.draggablePercent*1.5:s.draggablePercent)/100)}}function p(S){let{top:I,bottom:B,left:k,right:j}=i.current.getBoundingClientRect();S.nativeEvent.type!=="touchend"&&s.pauseOnHover&&S.clientX>=k&&S.clientX<=j&&S.clientY>=I&&S.clientY<=B?g():m()}function m(){t(!0)}function g(){t(!1)}function w(){o.didMove=!1,document.addEventListener("pointermove",_),document.addEventListener("pointerup",C)}function b(){document.removeEventListener("pointermove",_),document.removeEventListener("pointerup",C)}function _(S){let I=i.current;if(o.canDrag&&I){o.didMove=!0,e&&g(),s.draggableDirection==="x"?o.delta=S.clientX-o.start:o.delta=S.clientY-o.start,o.start!==S.clientX&&(o.canCloseOnClick=!1);let B=s.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;I.style.transform=`translate3d(${B},0)`,I.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function C(){b();let S=i.current;if(o.canDrag&&o.didMove&&S){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){a(!0),s.closeToast(!0),s.collapseAll();return}S.style.transition="transform 0.2s, opacity 0.2s",S.style.removeProperty("transform"),S.style.removeProperty("opacity")}}let T={onPointerDown:x,onPointerUp:p};return l&&c&&(T.onMouseEnter=g,s.stacked||(T.onMouseLeave=m)),h&&(T.onClick=S=>{d&&d(S),o.canCloseOnClick&&u(!0)}),{playToast:m,pauseToast:g,isRunning:e,preventExitTransition:r,toastRef:i,eventHandlers:T}}var Zi=typeof window<"u"?v.useLayoutEffect:v.useEffect,gt=({theme:s,type:e,isLoading:t,...r})=>$.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:s==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...r});function eo(s){return $.createElement(gt,{...s},$.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function to(s){return $.createElement(gt,{...s},$.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function so(s){return $.createElement(gt,{...s},$.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function ro(s){return $.createElement(gt,{...s},$.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function ao(){return $.createElement("div",{className:"Toastify__spinner"})}var Vt={info:to,warning:eo,success:so,error:ro,spinner:ao},no=s=>s in Vt;function io({theme:s,type:e,isLoading:t,icon:r}){let a=null,i={theme:s,type:e};return r===!1||(ie(r)?a=r({...i,isLoading:t}):v.isValidElement(r)?a=v.cloneElement(r,i):t?a=Vt.spinner():no(e)&&(a=Vt[e](i))),a}var oo=s=>{let{isRunning:e,preventExitTransition:t,toastRef:r,eventHandlers:a,playToast:i}=Qi(s),{closeButton:o,children:l,autoClose:c,onClick:u,type:d,hideProgressBar:h,closeToast:f,transition:y,position:x,className:p,style:m,progressClassName:g,updateId:w,role:b,progress:_,rtl:C,toastId:T,deleteToast:S,isIn:I,isLoading:B,closeOnClick:k,theme:j,ariaLabel:E}=s,M=xe("Toastify__toast",`Toastify__toast-theme--${j}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":C},{"Toastify__toast--close-on-click":k}),R=ie(p)?p({rtl:C,position:x,type:d,defaultClassName:M}):xe(M,p),z=io(s),W=!!_||!c,q={closeToast:f,type:d,theme:j},_e=null;return o===!1||(ie(o)?_e=o(q):v.isValidElement(o)?_e=v.cloneElement(o,q):_e=Ri(q)),$.createElement(y,{isIn:I,done:S,position:x,preventExitTransition:t,nodeRef:r,playToast:i},$.createElement("div",{id:T,tabIndex:0,onClick:u,"data-in":I,className:R,...a,style:m,ref:r,...I&&{role:b,"aria-label":E}},z!=null&&$.createElement("div",{className:xe("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!B})},z),xr(l,s,!e),_e,!s.customProgressBar&&$.createElement(Li,{...w&&!W?{key:`p-${w}`}:{},rtl:C,theme:j,delay:c,isRunning:e,isIn:I,closeToast:f,hide:h,type:d,className:g,controlledProgress:W,progress:_||0})))},lo=(s,e=!1)=>({enter:`Toastify--animate Toastify__${s}-enter`,exit:`Toastify--animate Toastify__${s}-exit`,appendPosition:e}),co=Di(lo("bounce",!0)),uo={position:"top-right",transition:co,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:s=>s.altKey&&s.code==="KeyT"};function ho(s){let e={...uo,...s},t=s.stacked,[r,a]=v.useState(!0),i=v.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=Yi(e),{className:u,style:d,rtl:h,containerId:f,hotKeys:y}=e;function x(m){let g=xe("Toastify__toast-container",`Toastify__toast-container--${m}`,{"Toastify__toast-container--rtl":h});return ie(u)?u({position:m,rtl:h,defaultClassName:g}):xe(g,zt(u))}function p(){t&&(a(!0),P.play())}return Zi(()=>{var m;if(t){let g=i.current.querySelectorAll('[data-in="true"]'),w=12,b=(m=e.position)==null?void 0:m.includes("top"),_=0,C=0;Array.from(g).reverse().forEach((T,S)=>{let I=T;I.classList.add("Toastify__toast--stacked"),S>0&&(I.dataset.collapsed=`${r}`),I.dataset.pos||(I.dataset.pos=b?"top":"bot");let B=_*(r?.2:1)+(r?0:w*S);I.style.setProperty("--y",`${b?B:B*-1}px`),I.style.setProperty("--g",`${w}`),I.style.setProperty("--s",`${1-(r?C:0)}`),_+=I.offsetHeight,C+=.025})}},[r,c,t]),v.useEffect(()=>{function m(g){var w;let b=i.current;y(g)&&((w=b.querySelector('[tabIndex="0"]'))==null||w.focus(),a(!1),P.pause()),g.key==="Escape"&&(document.activeElement===b||b!=null&&b.contains(document.activeElement))&&(a(!0),P.play())}return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[y]),$.createElement("section",{ref:i,className:"Toastify",id:f,onMouseEnter:()=>{t&&(a(!1),P.pause())},onMouseLeave:p,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((m,g)=>{let w=g.length?{...d}:{...d,pointerEvents:"none"};return $.createElement("div",{tabIndex:-1,className:x(m),"data-stacked":t,style:w,key:`c-${m}`},g.map(({content:b,props:_})=>$.createElement(oo,{..._,stacked:t,collapseAll:p,isIn:l(_.toastId,_.containerId),key:`t-${_.key}`},b)))}))}const fo=()=>{const[s,e]=v.useState(""),[t,r]=v.useState(""),[a,i]=v.useState(!1),[o,l]=v.useState(null),c=async u=>{u.preventDefault(),i(!0),l(null);try{const{data:d,error:h}=await N.auth.signInWithPassword({email:s,password:t});if(h)throw h;if(d!=null&&d.user){const{data:f,error:y}=await N.from("profiles").select("role").eq("id",d.user.id).single();if(y)throw y;if(f.role!=="admin")throw await N.auth.signOut(),new Error("Access denied. Admin privileges required.")}}catch(d){const h=d instanceof Error?d.message:"An error occurred during sign in";l(h)}finally{i(!1)}};return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Event Admin Portal"}),n.jsx("h2",{className:"mt-6 text-center text-xl font-bold text-gray-900",children:"Sign in to your account"}),n.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Admin access only"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:c,children:[o&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:o}),n.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email address"}),n.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:s,onChange:u=>e(u.target.value),className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),n.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:t,onChange:u=>r(u.target.value),className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]}),n.jsx("div",{children:n.jsx("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-300",children:a?"Signing in...":"Sign in"})})]})]})})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),U=(s,e)=>{const t=v.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...u},d)=>v.createElement("svg",{ref:d,...mo,width:a,height:a,stroke:r,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${po(s)}`,l].join(" "),...u},[...e.map(([h,f])=>v.createElement(h,f)),...Array.isArray(c)?c:[c]]));return t.displayName=`${s}`,t};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=U("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=U("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=U("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=U("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=U("CalendarPlus",[["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"19",x2:"19",y1:"16",y2:"22",key:"1ttwzi"}],["line",{x1:"16",x2:"22",y1:"19",y2:"19",key:"1g9955"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=U("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=U("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=U("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=U("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=U("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=U("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=U("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=U("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=U("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=U("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=U("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=U("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=U("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=U("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=U("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=U("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=U("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=U("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=U("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=U("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=U("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ao=()=>{const[s,e]=v.useState({totalEvents:0,activeEvents:0,totalWristbands:0,totalCheckins:0}),[t,r]=v.useState([]),[a,i]=v.useState(!0);v.useEffect(()=>{(async()=>{i(!0);try{const{data:c}=await N.from("events").select("id, name, start_date, end_date"),u=new Date,d=(c==null?void 0:c.filter(p=>{const m=new Date(p.start_date),g=new Date(p.end_date);return m<=u&&g>=u}))||[],{count:h}=await N.from("wristbands").select("id",{count:"exact",head:!0}),{count:f}=await N.from("checkin_logs").select("id",{count:"exact",head:!0});e({totalEvents:(c==null?void 0:c.length)||0,activeEvents:d.length,totalWristbands:h||0,totalCheckins:f||0});const{data:y}=await N.from("events").select("*").order("start_date",{ascending:!1}).limit(5),x=await Promise.all((y||[]).map(async p=>{const{count:m}=await N.from("wristbands").select("id",{count:"exact",head:!0}).eq("event_id",p.id),{count:g}=await N.from("checkin_logs").select("id",{count:"exact",head:!0}).eq("event_id",p.id);return{...p,total_wristbands:m||0,checked_in:g||0}}));r(x)}catch(c){console.error("Error fetching dashboard data:",c)}finally{i(!1)}})()},[]);const o=({title:l,value:c,icon:u,color:d})=>n.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`p-3 rounded-lg ${d}`,children:u}),n.jsxs("div",{className:"ml-5",children:[n.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:l}),n.jsx("div",{className:"mt-1 text-3xl font-semibold text-gray-900",children:c})]})]})});return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),n.jsxs(F,{to:"/events/new",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[n.jsx(Kt,{size:16,className:"mr-2"}),"New Event"]})]}),a?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 animate-pulse",children:[1,2,3,4].map(l=>n.jsx("div",{className:"h-32 bg-gray-200 rounded-xl"},l))}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsx(o,{title:"Total Events",value:s.totalEvents,icon:n.jsx(Kt,{size:24,className:"text-blue-600"}),color:"bg-blue-50"}),n.jsx(o,{title:"Active Events",value:s.activeEvents,icon:n.jsx(Ps,{size:24,className:"text-green-600"}),color:"bg-green-50"}),n.jsx(o,{title:"Total Wristbands",value:s.totalWristbands,icon:n.jsx(vt,{size:24,className:"text-purple-600"}),color:"bg-purple-50"}),n.jsx(o,{title:"Total Check-ins",value:s.totalCheckins,icon:n.jsx(Ps,{size:24,className:"text-amber-600"}),color:"bg-amber-50"})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Recent Events"})}),a?n.jsx("div",{className:"animate-pulse",children:[1,2,3].map(l=>n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),n.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4"})]},l))}):t.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event Name"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Wristbands"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-ins"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(l=>{const c=new Date(l.start_date),u=new Date(l.end_date),d=new Date>=c&&new Date<=u;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"flex items-center",children:n.jsxs("div",{children:[n.jsx(F,{to:`/events/${l.id}`,className:"text-sm font-medium text-blue-600 hover:text-blue-800",children:l.name}),d&&n.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"})]})})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.toLocaleDateString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.location||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.total_wristbands}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("span",{className:"font-medium",children:l.checked_in}),l.total_wristbands>0&&n.jsxs("span",{className:"ml-2 text-gray-500",children:["(",Math.round(l.checked_in/l.total_wristbands*100),"%)"]})]})})]},l.id)})})]})}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("p",{className:"text-gray-500 text-sm",children:"No events found"}),n.jsx(F,{to:"/events/new",className:"mt-2 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Create your first event"})]}),t.length>0&&n.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:n.jsx(F,{to:"/events",className:"text-sm font-medium text-blue-600 hover:text-blue-800",children:"View all events"})})]})]})},K=[];for(let s=0;s<256;++s)K.push((s+256).toString(16).slice(1));function Io(s,e=0){return(K[s[e+0]]+K[s[e+1]]+K[s[e+2]]+K[s[e+3]]+"-"+K[s[e+4]]+K[s[e+5]]+"-"+K[s[e+6]]+K[s[e+7]]+"-"+K[s[e+8]]+K[s[e+9]]+"-"+K[s[e+10]]+K[s[e+11]]+K[s[e+12]]+K[s[e+13]]+K[s[e+14]]+K[s[e+15]]).toLowerCase()}let Ct;const $o=new Uint8Array(16);function Do(){if(!Ct){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ct=crypto.getRandomValues.bind(crypto)}return Ct($o)}const Ro=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),As={randomUUID:Ro};function Nr(s,e,t){var a;if(As.randomUUID&&!s)return As.randomUUID();s=s||{};const r=s.random??((a=s.rng)==null?void 0:a.call(s))??Do();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Io(r)}const Is=s=>{let e;const t=new Set,r=(u,d)=>{const h=typeof u=="function"?u(e):u;if(!Object.is(h,e)){const f=e;e=d??(typeof h!="object"||h===null)?h:Object.assign({},e,h),t.forEach(y=>y(e,f))}},a=()=>e,l={setState:r,getState:a,getInitialState:()=>c,subscribe:u=>(t.add(u),()=>t.delete(u))},c=e=s(r,a,l);return l},Lo=s=>s?Is(s):Is,Uo=s=>s;function Mo(s,e=Uo){const t=$.useSyncExternalStore(s.subscribe,()=>e(s.getState()),()=>e(s.getInitialState()));return $.useDebugValue(t),t}const $s=s=>{const e=Lo(s),t=r=>Mo(e,r);return Object.assign(t,e),t},Fo=s=>s?$s(s):$s,bt=Fo((s,e)=>({notifications:[],unreadCount:0,addNotification:t=>s(r=>{const a=[t,...r.notifications].slice(0,100);return{notifications:a,unreadCount:a.filter(i=>!i.read).length}}),markAsRead:t=>s(r=>{const a=r.notifications.map(i=>i.id===t?{...i,read:!0}:i);return{notifications:a,unreadCount:a.filter(i=>!i.read).length}}),clear:()=>s({notifications:[],unreadCount:0}),removeNotification:t=>s(r=>{const a=r.notifications.filter(i=>i.id!==t);return{notifications:a,unreadCount:a.filter(i=>!i.read).length}}),markAllAsRead:()=>s(t=>({notifications:t.notifications.map(r=>({...r,read:!0})),unreadCount:0})),createSystemNotification:(t,r="info")=>{const a={...t,id:crypto.randomUUID(),timestamp:new Date,read:!1,category:"system",severity:r,origin:t.origin||"app"};return e().addNotification(a),a},createFunctionalNotification:(t,r="info")=>{const a={...t,id:crypto.randomUUID(),timestamp:new Date,read:!1,category:"functional",severity:r,origin:t.origin||"app"};return e().addNotification(a),a}})),Sr={position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"light"},qo={critical:console.error,error:console.error,warning:console.warn,info:console.info,success:console.log,debug:console.debug},Tr=(s,e,t)=>{const r=qo[s]||console.info;typeof r=="function"&&r(`[${s.toUpperCase()}] ${e}`,t||"")},Ee=(s,e="info")=>{const t={id:Nr(),timestamp:new Date,read:!1,category:"system",severity:e,message:s.message,origin:s.origin||"app",code:s.code,context:s.context,logToConsole:s.logToConsole??!0,showInUI:s.showInUI??!0,toastOptions:{...Sr,...s.toastOptions,type:Cr(e)}};return t.logToConsole&&Tr(e,t.message,t.context),t.showInUI&&P(t.message,t.toastOptions),bt.getState().addNotification(t),t},Er=(s,e="info")=>{const t={id:Nr(),timestamp:new Date,read:!1,category:"functional",severity:e,entity:s.entity,operation:s.operation,message:s.message,origin:s.origin||"app",technicalDetails:s.technicalDetails,data:s.data,context:s.context,logToConsole:s.logToConsole??!0,showInUI:s.showInUI??!0,toastOptions:{...Sr,...s.toastOptions,type:Cr(e),"data-entity":s.entity,"data-operation":s.operation}};return t.logToConsole&&Tr(e,`[${t.entity}.${t.operation}] ${t.message}`,t.context),t.showInUI&&P(t.message,t.toastOptions),bt.getState().addNotification(t),t},me=(s,e,t,r={})=>Er({...r,entity:e,operation:s,message:t},r.severity),Cr=s=>{switch(s){case"success":return"success";case"error":case"critical":return"error";case"warning":return"warning";case"info":case"debug":default:return"info"}},Ds=s=>{bt.getState().markAsRead(s)},D={system:s=>{if(!s.message)throw new Error("System notification requires a message");return Ee({...s,severity:"severity"in s?s.severity:"info"})},functional:s=>{if(!s.message||!s.entity||!s.operation)throw new Error("Functional notification requires message, entity, and operation");return Er({...s,severity:"severity"in s?s.severity:"info"})},success:(s,e={origin:"app"})=>Ee({...e,message:s}),error:(s,e,t={origin:"app"})=>{const r=e instanceof Error?e.message:String(e||s);return Ee({...t,message:e?`${s}: ${r}`:s,context:{...t.context||{},error:e instanceof Error?e:new Error(r)},origin:t.origin||"app"})},warning:(s,e={origin:"app"})=>Ee({...e,message:s}),info:(s,e={origin:"app"})=>Ee({...e,message:s}),critical:(s,e={origin:"app"})=>Ee({...e,message:s}),debug:(s,e={origin:"app"})=>(console.debug(`[DEBUG] ${s}`,e),null),operation:{create:(s,e,t={})=>me("create",s,e,t),read:(s,e,t={})=>me("read",s,e,t),update:(s,e,t={})=>me("update",s,e,t),delete:(s,e,t={})=>me("delete",s,e,t),sync:(s,e,t={})=>me("sync",s,e,t),validate:(s,e,t={})=>me("validate",s,e,t),process:(s,e,t={})=>me("process",s,e,t)},created(s,e,t){return this.operation.create(s,e,{data:t})},read(s,e,t){const r=this.operation.read(s,e,{data:t});return r.markAsRead=a=>Ds(a),r},markAsRead(s){Ds(s)},updated(s,e,t){return this.operation.update(s,e,{data:t})},deleted(s,e,t){return this.operation.delete(s,e,{data:t})},fetched(s,e,t){return this.functional({entity:s,message:e,data:t,operation:"read",severity:"info"})}};var Bo={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function zo(s){if(typeof s=="number")return{value:s,unit:"px"};var e,t=(s.match(/^[0-9.]*/)||"").toString();t.includes(".")?e=parseFloat(t):e=parseInt(t,10);var r=(s.match(/[^0-9]*$/)||"").toString();return Bo[r]?{value:e,unit:r}:(console.warn("React Spinners: ".concat(s," is not a valid css value. Defaulting to ").concat(e,"px.")),{value:e,unit:"px"})}function Pt(s){var e=zo(s);return"".concat(e.value).concat(e.unit)}var Wo=function(s,e,t){var r="react-spinners-".concat(s,"-").concat(t);if(typeof window>"u"||!window.document)return r;var a=document.createElement("style");document.head.appendChild(a);var i=a.sheet,o=`
    @keyframes `.concat(r,` {
      `).concat(e,`
    }
  `);return i&&i.insertRule(o,0),r},nt=function(){return nt=Object.assign||function(s){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=e[a])}return s},nt.apply(this,arguments)},Ho=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(s);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(s,r[a])&&(t[r[a]]=s[r[a]]);return t},Vo=Wo("BeatLoader","50% {transform: scale(0.75);opacity: 0.2} 100% {transform: scale(1);opacity: 1}","beat");function Ko(s){var e=s.loading,t=e===void 0?!0:e,r=s.color,a=r===void 0?"#000000":r,i=s.speedMultiplier,o=i===void 0?1:i,l=s.cssOverride,c=l===void 0?{}:l,u=s.size,d=u===void 0?15:u,h=s.margin,f=h===void 0?2:h,y=Ho(s,["loading","color","speedMultiplier","cssOverride","size","margin"]),x=nt({display:"inherit"},c),p=function(m){return{display:"inline-block",backgroundColor:a,width:Pt(d),height:Pt(d),margin:Pt(f),borderRadius:"100%",animation:"".concat(Vo," ").concat(.7/o,"s ").concat(m%2?"0s":"".concat(.35/o,"s")," infinite linear"),animationFillMode:"both"}};return t?v.createElement("span",nt({style:x},y),v.createElement("span",{style:p(1)}),v.createElement("span",{style:p(2)}),v.createElement("span",{style:p(3)})):null}const Rs={primary:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 hover:bg-gray-700 focus:ring-gray-500",danger:"bg-red-600 hover:bg-red-700 focus:ring-red-500"},Ls=({children:s,isLoading:e=!1,loadingText:t="Processing...",variant:r="primary",fullWidth:a=!1,disabled:i=!1,className:o="",type:l="button",...c})=>{const u="inline-flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",d=Rs[r]||Rs.primary,h=a?"w-full":"";return n.jsx("button",{type:l,disabled:i||e,className:`${u} ${d} ${h} ${o}`,...c,children:e?n.jsxs(n.Fragment,{children:[n.jsx(Ko,{size:8,color:"#ffffff",className:"mr-2"}),t]}):s})},Jo=()=>{const[s,e]=v.useState([]),[t,r]=v.useState(!0),[a,i]=v.useState(null),[o,l]=v.useState(""),c=We();v.useEffect(()=>{u()},[]);const u=async()=>{try{r(!0);const{data:f,error:y}=await N.from("events").select("*").order("start_date",{ascending:!1});if(y)throw y;e(f||[])}catch(f){console.error("Error fetching events:",f),D.error("Could not load events",f,{origin:"app",context:{entity:"events",operation:"read",error:f instanceof Error?f:new Error("Failed to fetch events"),technicalDetails:f instanceof Error?f.message:"Failed to fetch events"},toastOptions:{autoClose:1e4}})}finally{r(!1)}},d=async f=>{const y=s.find(x=>x.id===f);if(y&&window.confirm(`Are you sure you want to delete "${y.name}"? This will permanently delete the event and all associated data including wristbands and check-in logs.`)){i(f);try{D.warning(`Deleting "${y.name}" and all its related data...`,{origin:"app",context:{entity:"event",operation:"delete",eventId:f,eventName:y.name,technicalDetails:"Initiating deletion of event and all related data"},toastOptions:{autoClose:3e3}});const x=[N.from("checkin_logs").delete().eq("event_id",f),N.from("wristbands").delete().eq("event_id",f),N.from("event_access").delete().eq("event_id",f)];await Promise.all(x);const{error:p}=await N.from("events").delete().eq("id",f);if(p)throw p;e(s.filter(m=>m.id!==f)),D.success(`Event "${y.name}" was successfully deleted.
Note: This action cannot be undone. All related data has been removed.`,{origin:"app",context:{entity:"event",operation:"delete",eventId:f,eventName:y.name,technicalDetails:"Event and all related data have been permanently removed"},toastOptions:{autoClose:1e4}})}catch(x){D.error(`Failed to delete event "${(y==null?void 0:y.name)||"Unknown"}". Please try again.`,x,{origin:"app",context:{entity:"event",operation:"delete",eventId:f,eventName:y==null?void 0:y.name,error:x instanceof Error?x:new Error(String(x)),technicalDetails:x instanceof Error?x.message:"Failed to delete event"},toastOptions:{autoClose:1e4}})}finally{i(null)}}},h=$.useMemo(()=>s.filter(f=>f.name.toLowerCase().includes(o.toLowerCase())||f.location&&f.location.toLowerCase().includes(o.toLowerCase())),[s,o]);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Events"}),n.jsxs(Ls,{onClick:()=>c("/events/new"),variant:"primary",children:[n.jsx(Kt,{size:16,className:"mr-2"}),"Create Event"]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(xt,{size:18,className:"text-gray-400"})}),n.jsx("input",{type:"text",value:o,onChange:f=>l(f.target.value),placeholder:"Search events...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),t?n.jsx("div",{className:"animate-pulse",children:[1,2,3].map(f=>n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),n.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4"})]},f))}):h.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event Name"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capacity"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(f=>{const y=new Date(f.start_date),x=new Date(f.end_date),p=new Date>=y&&new Date<=x,m=new Date>x;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"flex items-center",children:n.jsxs("div",{children:[n.jsx(F,{to:`/events/${f.id}`,className:"text-sm font-medium text-blue-600 hover:text-blue-800",children:f.name}),p&&n.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"}),m&&n.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Past"})]})})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[y.toLocaleDateString()," -"," ",x.toLocaleDateString()]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.location||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.total_capacity>0?f.total_capacity:"Unlimited"}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx(F,{to:`/events/${f.id}/edit`,className:"text-blue-600 hover:text-blue-900 mr-4",children:n.jsx(yt,{size:16})}),n.jsx(Ls,{onClick:()=>d(f.id),variant:"danger",isLoading:a===f.id,loadingText:"Deleting...",className:"p-2 text-red-600 hover:bg-red-50 hover:text-red-900",title:"Delete event",children:n.jsx(ts,{size:18})})]})]},f.id)})})]})}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("p",{className:"text-gray-500 text-sm",children:o?"No events found matching your search":"No events found"}),!o&&n.jsx(F,{to:"/events/new",className:"mt-2 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Create your first event"})]})]})]})},Pr=()=>n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),n.jsx("h2",{className:"text-lg font-medium text-gray-700",children:"Loading..."})]})}),Go=()=>{const{id:s}=be(),[e,t]=v.useState(null),[r,a]=v.useState({totalWristbands:0,checkedIn:0,categories:[]}),[i,o]=v.useState([]),[l,c]=v.useState(!0),[u,d]=v.useState("overview"),[,h]=v.useState(null);v.useEffect(()=>{s&&f(s)},[s]);const f=async g=>{c(!0);try{const{data:w,error:b}=await N.from("events").select("*").eq("id",g).single();if(b)throw b;t(w);const{data:_,error:C}=await N.from("wristbands").select("id, category, is_active").eq("event_id",g);if(C)throw C;const{data:T,error:S}=await N.from("checkin_logs").select("wristband_id").eq("event_id",g);if(S)throw S;const I=(_==null?void 0:_.length)||0,B=(T==null?void 0:T.length)||0,k=new Map;_==null||_.forEach(R=>{const z=R.category||"Uncategorized",W=k.get(z)||{total:0,checkedIn:0};W.total++,T!=null&&T.some(q=>q.wristband_id===R.id)&&W.checkedIn++,k.set(z,W)});const j=Array.from(k.entries()).map(([R,z])=>({name:R,total:z.total,checkedIn:z.checkedIn}));a({totalWristbands:I,checkedIn:B,categories:j});const{data:E,error:M}=await N.from("event_access").select(`
          id,
          access_level,
          user_id,
          granted_by,
          created_at,
          profiles!event_access_user_id_fkey (
            email,
            full_name
          ),
          grantedBy:profiles!event_access_granted_by_fkey (
            email
          )
        `).eq("event_id",g);if(M)throw M;o(E||[])}catch(w){console.error("Error fetching event details:",w);const b=w instanceof Error?w.message:"Failed to load event details";h(b)}finally{c(!1)}};if(l)return n.jsx(Pr,{});if(!e)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx("h2",{className:"text-xl font-medium text-gray-900",children:"Event not found"}),n.jsx("p",{className:"mt-2 text-gray-500",children:"The event you're looking for doesn't exist or you don't have access to it."}),n.jsx(F,{to:"/events",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Back to events"})]});const y=new Date(e.start_date),x=new Date(e.end_date),p=new Date>=y&&new Date<=x,m=new Date>x;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-4 sm:space-y-0",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.name}),p&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"}),m&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Past"})]}),n.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[y.toLocaleDateString()," - ",x.toLocaleDateString(),e.location&&`  ${e.location}`]})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsxs("button",{onClick:()=>f(s),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(Eo,{size:14,className:"mr-1.5"}),"Refresh"]}),n.jsxs(F,{to:`/events/${e.id}/edit`,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(yt,{size:14,className:"mr-1.5"}),"Edit"]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"-mb-px flex",children:[n.jsx("button",{className:`${u==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-6 border-b-2 font-medium text-sm`,onClick:()=>d("overview"),children:"Overview"}),n.jsx("button",{className:`${u==="wristbands"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-6 border-b-2 font-medium text-sm`,onClick:()=>d("wristbands"),children:"Wristbands"}),n.jsx("button",{className:`${u==="access"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-6 border-b-2 font-medium text-sm`,onClick:()=>d("access"),children:"User Access"})]})}),n.jsxs("div",{className:"p-6",children:[u==="overview"&&n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Event Details"}),n.jsxs("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6",children:[n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Start Date"}),n.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:y.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"End Date"}),n.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:x.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Location"}),n.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:e.location||"-"})]}),n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Capacity"}),n.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:e.total_capacity>0?e.total_capacity:"Unlimited"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Description"}),n.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:e.description||"-"})]})]})]}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Statistics"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[n.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Total Wristbands"}),n.jsx("p",{className:"mt-1 text-3xl font-semibold text-blue-900",children:r.totalWristbands})]}),n.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[n.jsx("p",{className:"text-sm font-medium text-green-800",children:"Checked In"}),n.jsx("p",{className:"mt-1 text-3xl font-semibold text-green-900",children:r.checkedIn})]}),n.jsxs("div",{className:"bg-amber-50 rounded-lg p-4",children:[n.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Check-in Rate"}),n.jsx("p",{className:"mt-1 text-3xl font-semibold text-amber-900",children:r.totalWristbands>0?`${Math.round(r.checkedIn/r.totalWristbands*100)}%`:"-"})]})]})]}),r.categories.length>0&&n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Category Breakdown"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Active"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Checked In"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-in Rate"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.categories.map(g=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.total}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.checkedIn}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.checkedIn}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.total>0?`${Math.round(g.checkedIn/g.total*100)}%`:"-"})]},g.name))})]})})]})]}),u==="wristbands"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Wristbands"}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx(F,{to:`/wristbands/new?eventId=${e.id}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:"Add Wristband"}),n.jsxs(F,{to:`/wristbands/bulk?eventId=${e.id}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(kr,{size:16,className:"mr-2"}),"Bulk Upload"]}),n.jsxs(F,{to:`/wristbands/export?eventId=${e.id}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(es,{size:16,className:"mr-2"}),"Export"]})]})]}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:n.jsx(F,{to:`/wristbands?eventId=${e.id}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Manage Wristbands"})})]}),u==="access"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"User Access"}),n.jsxs(F,{to:`/access/new?eventId=${e.id}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[n.jsx(vt,{size:16,className:"mr-2"}),"Grant Access"]})]}),i.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Access Level"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted By"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted On"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(g=>{var w,b,_;return n.jsxs("tr",{children:[n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:((w=g.profiles)==null?void 0:w.full_name)||"Unnamed User"}),n.jsx("div",{className:"text-sm text-gray-500",children:(b=g.profiles)==null?void 0:b.email})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g.access_level==="owner"?"bg-purple-100 text-purple-800":g.access_level==="admin"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:g.access_level})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((_=g.grantedBy)==null?void 0:_.email)||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(g.created_at).toLocaleDateString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsx(F,{to:`/access/${g.id}/edit`,className:"text-blue-600 hover:text-blue-900",children:"Edit"})})]},g.id)})})]})}):n.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[n.jsx("p",{className:"text-gray-500 mb-4",children:"No users have been granted access to this event yet."}),n.jsx(F,{to:`/access/new?eventId=${e.id}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Grant access to users"})]})]})]})]})]})},Or=({isEdit:s=!1})=>{const{id:e}=be(),t=We(),[r,a]=v.useState(!1),[i,o]=v.useState({name:"",description:"",start_date:"",end_date:"",location:"",is_public:!1});v.useEffect(()=>{s&&e&&l()},[e,s]);const l=async()=>{try{a(!0);const{data:d,error:h}=await N.from("events").select("*").eq("id",e).single();if(h)throw h;d&&o(f=>({...f,...d,start_date:d.start_date?new Date(d.start_date).toISOString().slice(0,16):"",end_date:d.end_date?new Date(d.end_date).toISOString().slice(0,16):""}))}catch(d){console.error("Error:",d),P.error("Failed to load event")}finally{a(!1)}},c=d=>{const{name:h,value:f,type:y}=d.target;o(x=>({...x,[h]:y==="checkbox"?d.target.checked:f}))},u=async d=>{var y;if(d.preventDefault(),!i.name){D.error("Please provide a name for the event",void 0,{origin:"app",context:{entity:"event",operation:"create",validation:"required_field",field:"name",technicalDetails:"Validation failed: Event name is required"},toastOptions:{autoClose:5e3}});return}if(!i.start_date){D.error("Please select a start date for the event",void 0,{origin:"app",context:{entity:"event",operation:"create",validation:"required_field",field:"start_date",technicalDetails:"Validation failed: Start date is required"},toastOptions:{autoClose:5e3}});return}if(!i.end_date){D.error("Please select an end date for the event",void 0,{origin:"app",context:{entity:"event",operation:"create",validation:"required_field",technicalDetails:"Validation failed: End date is required",field:"end_date"},toastOptions:{autoClose:5e3}});return}const h=new Date(i.start_date),f=new Date(i.end_date);if(isNaN(h.getTime())||isNaN(f.getTime())){D.error("Please enter valid dates in the correct format",void 0,{origin:"app",context:{entity:"event",operation:"create",technicalDetails:"Validation failed: Invalid date format"},toastOptions:{autoClose:5e3}});return}if(f<=h){D.error("End date must be after the start date",{origin:"app",context:{entity:"event",operation:"create",technicalDetails:"Validation failed: Invalid date range",showInUI:!0,logToConsole:!0}});return}a(!0);try{const x={...i,start_date:h.toISOString(),end_date:f.toISOString()},{data:p,error:m}=s&&e?await N.from("events").update(x).eq("id",e).select():await N.from("events").insert([{...x,created_by:(y=(await N.auth.getUser()).data.user)==null?void 0:y.id}]).select();if(m)throw m.code==="23505"?new Error("An event with this name already exists"):m.code==="42501"?new Error("You do not have permission to perform this action"):m.code==="PGRST116"?new Error("Required fields are missing"):m;if(p&&p.length>0)s?D.success(`Event "${i.name}" updated successfully`,{origin:"app",context:{entity:"event",operation:"update"}}):D.success(`Event "${i.name}" created successfully`,{origin:"app",context:{entity:"event",operation:"create"}}),setTimeout(()=>{t("/events",{state:{message:`Event "${i.name}" successfully ${s?"updated":"created"}`,timestamp:Date.now()}})},500);else throw new Error("No data returned from the server")}catch(x){let p="An unknown error occurred",m="";if(x instanceof Error){if(p=x.message,"code"in x)switch(m=String(x.code),x.code){case"23505":p="An event with this name already exists";break;case"42501":p="You do not have permission to perform this action";break;case"PGRST116":p="Required fields are missing";break}}else typeof x=="string"?p=x:x&&typeof x=="object"&&"message"in x&&(p=String(x.message));const g=`Could not ${s?"update":"create"} event: ${p}`;D.error(g,{"data-entity":"event","data-operation":s?"update":"create",autoClose:5e3,context:{errorCode:m,errorStack:void 0,formData:void 0}})}finally{a(!1)}};return r&&s?n.jsx("div",{className:"flex justify-center p-8",children:"Loading..."}):n.jsx("div",{className:"max-w-3xl mx-auto p-6",children:n.jsxs("form",{onSubmit:u,className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[n.jsx("h2",{className:"text-xl font-semibold",children:s?"Edit Event":"New Event"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Event Name *"}),n.jsx("input",{type:"text",name:"name",value:i.name,onChange:c,className:"w-full p-2 border rounded",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),n.jsx("textarea",{name:"description",value:i.description,onChange:c,className:"w-full p-2 border rounded",rows:3})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Date/Time *"}),n.jsx("input",{type:"datetime-local",name:"start_date",value:i.start_date,onChange:c,className:"w-full p-2 border rounded",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Date/Time *"}),n.jsx("input",{type:"datetime-local",name:"end_date",value:i.end_date,min:i.start_date,onChange:c,className:"w-full p-2 border rounded",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Location"}),n.jsx("input",{type:"text",name:"location",value:i.location,onChange:c,className:"w-full p-2 border rounded"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",name:"is_public",checked:i.is_public,onChange:c,className:"h-4 w-4 rounded"}),n.jsx("label",{className:"ml-2 text-sm",children:"Make event public"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>t(-1),className:"px-4 py-2 border rounded",disabled:r,children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50",disabled:r,children:r?"Saving...":"Save Event"})]})]})})},Xo=()=>n.jsx(Or,{}),Yo=()=>(be(),n.jsx(Or,{isEdit:!0})),Qo=()=>{const[s]=Bs(),e=s.get("eventId"),[t,r]=v.useState([]),[a,i]=v.useState([]),[o,l]=v.useState(e),[c,u]=v.useState(null),[d,h]=v.useState([]),[f,y]=v.useState(""),[x,p]=v.useState(!0),[m,g]=v.useState(1),[w,b]=v.useState(0),_=50;v.useEffect(()=>{C(),o&&(T(o),S(o,c,1))},[o,c]);const C=async()=>{try{const{data:j,error:E}=await N.from("events").select("id, name").order("start_date",{ascending:!1});if(E)throw E;i(j||[]),!o&&j&&j.length>0&&l(j[0].id)}catch(j){console.error("Error fetching events:",j)}},T=async j=>{try{const{data:E,error:M}=await N.from("wristbands").select("category").eq("event_id",j).order("category");if(M)throw M;const R=[...new Set(E==null?void 0:E.map(z=>z.category))];h(R)}catch(E){console.error("Error fetching categories:",E)}},S=async(j,E,M)=>{p(!0);try{let R=N.from("wristbands").select("*",{count:"exact"}).eq("event_id",j).order("created_at",{ascending:!1}).range((M-1)*_,M*_-1);E&&(R=R.eq("category",E)),f&&(R=R.ilike("nfc_id",`%${f}%`));const{data:z,count:W,error:q}=await R;if(q)throw q;r(z||[]),b(W||0),g(M)}catch(R){console.error("Error fetching wristbands:",R)}finally{p(!1)}},I=async j=>{if(window.confirm("Are you sure you want to delete this wristband?"))try{const{count:E}=await N.from("checkin_logs").select("id",{count:"exact",head:!0}).eq("wristband_id",j);if(E&&E>0){if(!window.confirm("This wristband has check-in records. Deleting it will also delete all check-in records. Continue?"))return;await N.from("checkin_logs").delete().eq("wristband_id",j)}const{error:M}=await N.from("wristbands").delete().eq("id",j);if(M)throw M;r(t.filter(R=>R.id!==j)),b(R=>R-1)}catch(E){console.error("Error deleting wristband:",E),alert("Failed to delete wristband. Please try again.")}},B=j=>{j.preventDefault(),o&&S(o,c,1)},k=Math.ceil(w/_);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-4 sm:space-y-0",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Wristbands"}),n.jsxs(F,{to:o?`/wristbands/new?event_id=${o}`:"/wristbands/new",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[n.jsx(Jt,{size:16,className:"mr-2"}),"Register Wristband"]}),n.jsx("div",{className:"flex space-x-3",children:o&&n.jsxs(n.Fragment,{children:[n.jsxs(F,{to:`/wristbands/new?eventId=${o}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[n.jsx(Jt,{size:16,className:"mr-2"}),"Add Wristband"]}),n.jsxs(F,{to:`/wristbands/bulk?eventId=${o}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(kr,{size:16,className:"mr-2"}),"Bulk Upload"]}),n.jsxs(F,{to:`/wristbands/export?eventId=${o}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(es,{size:16,className:"mr-2"}),"Export"]})]})})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4",children:[n.jsxs("div",{className:"w-full md:w-1/3",children:[n.jsx("label",{htmlFor:"event-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Event"}),n.jsxs("select",{id:"event-select",value:o||"",onChange:j=>l(j.target.value||null),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[n.jsx("option",{value:"",children:"Select an event"}),a.map(j=>n.jsx("option",{value:j.id,children:j.name},j.id))]})]}),d.length>0&&n.jsxs("div",{className:"w-full md:w-1/3",children:[n.jsx("label",{htmlFor:"category-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Category"}),n.jsxs("select",{id:"category-select",value:c||"",onChange:j=>u(j.target.value||null),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[n.jsx("option",{value:"",children:"All Categories"}),d.map(j=>n.jsx("option",{value:j,children:j},j))]})]}),n.jsxs("div",{className:"w-full md:w-1/3",children:[n.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search by NFC ID"}),n.jsx("form",{onSubmit:B,children:n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",id:"search",value:f,onChange:j=>y(j.target.value),placeholder:"Search...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(xt,{size:18,className:"text-gray-400"})}),n.jsx("button",{type:"submit",className:"absolute inset-y-0 right-0 px-3 flex items-center bg-blue-600 rounded-r-md text-white",children:"Search"})]})})]})]})}),o?x?n.jsx("div",{className:"animate-pulse",children:[1,2,3,4,5].map(j=>n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),n.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4"})]},j))}):t.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NFC ID"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(j=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:j.nfc_id}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.category}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${j.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:j.is_active?"Active":"Inactive"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(j.created_at).toLocaleDateString()}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx(F,{to:`/wristbands/${j.id}/edit`,className:"text-blue-600 hover:text-blue-900 mr-4",children:n.jsx(yt,{size:16})}),n.jsx("button",{onClick:()=>I(j.id),className:"text-red-600 hover:text-red-900",children:n.jsx(ts,{size:16})})]})]},j.id))})]})}),k>1&&n.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-700",children:["Showing"," ",n.jsx("span",{className:"font-medium",children:(m-1)*_+1})," ","to"," ",n.jsx("span",{className:"font-medium",children:Math.min(m*_,w)})," ","of ",n.jsx("span",{className:"font-medium",children:w})," results"]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:()=>S(o,c,m-1),disabled:m<=1,className:`px-3 py-1 border rounded ${m<=1?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Previous"}),n.jsx("button",{onClick:()=>S(o,c,m+1),disabled:m>=k,className:`px-3 py-1 border rounded ${m>=k?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Next"})]})]})]}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("p",{className:"text-gray-500 text-sm",children:f||c?"No wristbands found matching your criteria":"No wristbands found for this event"}),n.jsx(F,{to:`/wristbands/new?eventId=${o}`,className:"mt-2 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Add your first wristband"})]}):n.jsx("div",{className:"text-center py-8",children:n.jsx("p",{className:"text-gray-500 text-sm",children:"Please select an event to view wristbands"})})]})]})},Ar=({isEdit:s=!1})=>{const{id:e}=be(),t=zs(),r=We(),[a,i]=v.useState(!1),[o,l]=v.useState([]),[c,u]=v.useState({nfc_id:"",category:"general",is_active:!0,event_id:"",notes:""});v.useEffect(()=>{if(d(),s&&e)h();else{const m=new URLSearchParams(t.search).get("event_id");m&&u(g=>({...g,event_id:m}))}},[e,s,t.search]);const d=async()=>{try{const{data:p,error:m}=await N.from("events").select("id, name").order("start_date",{ascending:!1});if(m)throw m;l(p||[])}catch(p){console.error("Error fetching events:",p),P.error("Failed to load events")}},h=async()=>{try{i(!0);const{data:p,error:m}=await N.from("wristbands").select("*").eq("id",e).single();if(m)throw m;p&&u({nfc_id:p.nfc_id,category:p.category||"general",is_active:p.is_active,event_id:p.event_id,notes:p.notes||""})}catch(p){console.error("Error fetching wristband:",p),P.error("Failed to load wristband data")}finally{i(!1)}},f=p=>{const{name:m,value:g,type:w}=p.target,b=w==="checkbox"?p.target.checked:void 0;u(_=>({..._,[m]:w==="checkbox"?b:g}))},y=()=>c.nfc_id.trim()?c.event_id?!0:(P.error("Event is required"),!1):(P.error("NFC ID is required"),!1),x=async p=>{var m;if(p.preventDefault(),!!y()){i(!0);try{if(s&&e){const{error:g}=await N.from("wristbands").update(c).eq("id",e);if(g)throw g;P.success("Wristband updated successfully")}else{const{error:g}=await N.from("wristbands").insert([{...c,created_by:(m=(await N.auth.getUser()).data.user)==null?void 0:m.id}]);if(g)throw g;P.success("Wristband created successfully")}r(c.event_id?`/wristbands?event_id=${c.event_id}`:"/wristbands")}catch(g){console.error(`Error ${s?"updating":"creating"} wristband:`,g),P.error(`Failed to ${s?"update":"create"} wristband`)}finally{i(!1)}}};return a&&s?n.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n.jsx("div",{className:"max-w-3xl mx-auto",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:s?"Edit Wristband":"Register New Wristband"})}),n.jsxs("form",{onSubmit:x,className:"p-6 space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"nfc_id",className:"block text-sm font-medium text-gray-700 mb-1",children:["NFC ID ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",id:"nfc_id",name:"nfc_id",value:c.nfc_id,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"Enter NFC ID",required:!0,disabled:s})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"event_id",className:"block text-sm font-medium text-gray-700 mb-1",children:["Event ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{id:"event_id",name:"event_id",value:c.event_id,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:!!new URLSearchParams(t.search).get("event_id"),children:[n.jsx("option",{value:"",children:"Select an event"}),o.map(p=>n.jsx("option",{value:p.id,children:p.name},p.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),n.jsxs("select",{id:"category",name:"category",value:c.category,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"general",children:"General"}),n.jsx("option",{value:"vip",children:"VIP"}),n.jsx("option",{value:"staff",children:"Staff"}),n.jsx("option",{value:"media",children:"Media"}),n.jsx("option",{value:"vendor",children:"Vendor"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{id:"notes",name:"notes",value:c.notes,onChange:f,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Any additional notes"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"is_active",name:"is_active",checked:c.is_active,onChange:f,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),n.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-700",children:"Active (can be used for check-ins)"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>r(-1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:a,children:"Cancel"}),n.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",disabled:a,children:a?"Saving...":s?"Update Wristband":"Register Wristband"})]})]})]})})},Zo=()=>n.jsx(Ar,{}),el=()=>(be(),n.jsx(Ar,{isEdit:!0})),tl=()=>{const[s]=Bs(),e=s.get("eventId"),[t,r]=v.useState([]),[a,i]=v.useState([]),[o,l]=v.useState(e),[c,u]=v.useState(""),[d,h]=v.useState({start:null,end:null}),[f,y]=v.useState(!0),[x,p]=v.useState(1),[m,g]=v.useState(0),w=50;v.useEffect(()=>{b(),o&&_(o,1)},[o]);const b=async()=>{try{const{data:k,error:j}=await N.from("events").select("id, name").order("start_date",{ascending:!1});if(j)throw j;i(k||[]),!o&&k&&k.length>0&&l(k[0].id)}catch(k){console.error("Error fetching events:",k)}},_=async(k,j)=>{y(!0);try{let E=N.from("checkin_logs").select(`
          *,
          wristbands (
            nfc_id,
            category
          ),
          staff:profiles!checkin_logs_staff_id_fkey (
            email,
            full_name
          )
        `,{count:"exact"}).eq("event_id",k).order("timestamp",{ascending:!1}).range((j-1)*w,j*w-1);if(c&&(E=E.or(`wristbands.nfc_id.ilike.%${c}%,wristbands.category.ilike.%${c}%`)),d.start&&(E=E.gte("timestamp",d.start)),d.end){const W=new Date(d.end);W.setDate(W.getDate()+1),E=E.lt("timestamp",W.toISOString())}const{data:M,count:R,error:z}=await E;if(z)throw z;r(M||[]),g(R||0),p(j)}catch(E){console.error("Error fetching check-ins:",E)}finally{y(!1)}},C=k=>{k.preventDefault(),o&&_(o,1)},T=(k,j)=>{h(E=>({...E,[k]:j||null}))},S=()=>{o&&_(o,1)},I=async()=>{if(o)try{let k=N.from("checkin_logs").select(`
          id,
          timestamp,
          location,
          notes,
          wristbands (
            nfc_id,
            category
          ),
          staff:profiles!checkin_logs_staff_id_fkey (
            email,
            full_name
          )
        `).eq("event_id",o).order("timestamp",{ascending:!1});if(c&&(k=k.or(`wristbands.nfc_id.ilike.%${c}%,wristbands.category.ilike.%${c}%`)),d.start&&(k=k.gte("timestamp",d.start)),d.end){const q=new Date(d.end);q.setDate(q.getDate()+1),k=k.lt("timestamp",q.toISOString())}const{data:j,error:E}=await k.select(`
          *,
          wristbands (nfc_id, category),
          staff:profiles (email, full_name)
        `);if(E)throw E;if(!j||j.length===0){alert("No check-ins to export");return}let M=`Timestamp,NFC ID,Category,Location,Staff,Notes
`;j.forEach(q=>{var as,ns,is,os;const _e=new Date(q.timestamp).toLocaleString(),Xr=((as=q.wristbands)==null?void 0:as.nfc_id)||"",Yr=((ns=q.wristbands)==null?void 0:ns.category)||"",Qr=q.location||"",Zr=((is=q.staff)==null?void 0:is.full_name)||((os=q.staff)==null?void 0:os.email)||"",ea=q.notes?`"${q.notes.replace(/"/g,'""')}"`:"";M+=`${_e},${Xr},${Yr},${Qr},${Zr},${ea}
`});const R=new Blob([M],{type:"text/csv;charset=utf-8"}),z=URL.createObjectURL(R),W=document.createElement("a");W.href=z,W.setAttribute("download",`checkins_${new Date().toISOString()}.csv`),document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(z)}catch(k){console.error("Error exporting check-ins:",k),alert("Failed to export check-ins")}},B=Math.ceil(m/w);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-4 sm:space-y-0",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Check-in Logs"}),o&&n.jsxs("button",{onClick:I,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(es,{size:16,className:"mr-2"}),"Export to CSV"]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"flex flex-col space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"event-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Event"}),n.jsxs("select",{id:"event-select",value:o||"",onChange:k=>l(k.target.value||null),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[n.jsx("option",{value:"",children:"Select an event"}),a.map(k=>n.jsx("option",{value:k.id,children:k.name},k.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),n.jsx("input",{type:"date",id:"start-date",value:d.start||"",onChange:k=>T("start",k.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"end-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),n.jsx("input",{type:"date",id:"end-date",value:d.end||"",onChange:k=>T("end",k.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]})]}),n.jsxs("div",{className:"flex space-x-4",children:[n.jsx("div",{className:"flex-1",children:n.jsx("form",{onSubmit:C,children:n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",value:c,onChange:k=>u(k.target.value),placeholder:"Search by NFC ID or category...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(xt,{size:18,className:"text-gray-400"})}),n.jsx("button",{type:"submit",className:"absolute inset-y-0 right-0 px-3 flex items-center bg-blue-600 rounded-r-md text-white",children:"Search"})]})})}),n.jsxs("button",{onClick:S,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[n.jsx(jo,{size:16,className:"mr-2"}),"Apply Filters"]})]})]})}),o?f?n.jsx("div",{className:"animate-pulse",children:[1,2,3,4,5].map(k=>n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),n.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4"})]},k))}):t.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NFC ID"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Staff"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(k=>{var j,E,M,R;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(k.timestamp).toLocaleString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:((j=k.wristbands)==null?void 0:j.nfc_id)||"N/A"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:((E=k.wristbands)==null?void 0:E.category)||"Unknown"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:k.location||"N/A"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((M=k.staff)==null?void 0:M.full_name)||((R=k.staff)==null?void 0:R.email)||"N/A"}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:k.notes||"-"})]},k.id)})})]})}),B>1&&n.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-700",children:["Showing"," ",n.jsx("span",{className:"font-medium",children:(x-1)*w+1})," ","to"," ",n.jsx("span",{className:"font-medium",children:Math.min(x*w,m)})," ","of ",n.jsx("span",{className:"font-medium",children:m})," results"]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:()=>_(o,x-1),disabled:x<=1,className:`px-3 py-1 border rounded ${x<=1?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Previous"}),n.jsx("button",{onClick:()=>_(o,x+1),disabled:x>=B,className:`px-3 py-1 border rounded ${x>=B?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Next"})]})]})]}):n.jsx("div",{className:"text-center py-8",children:n.jsx("p",{className:"text-gray-500 text-sm",children:c||d.start||d.end?"No check-ins found matching your criteria":"No check-ins found for this event"})}):n.jsx("div",{className:"text-center py-8",children:n.jsx("p",{className:"text-gray-500 text-sm",children:"Please select an event to view check-in logs"})})]})]})},sl=()=>{const[s,e]=v.useState([]),[t,r]=v.useState([]),[a,i]=v.useState(null),[o,l]=v.useState(""),[c,u]=v.useState(!0);v.useEffect(()=>{d()},[]),v.useEffect(()=>{a?f(a):h()},[a]);const d=async()=>{try{const{data:p,error:m}=await N.from("events").select("id, name").order("start_date",{ascending:!1});if(m)throw m;r(p||[])}catch(p){console.error("Error fetching events:",p)}},h=async()=>{u(!0);try{const{data:p,error:m}=await N.from("event_access").select(`
          id,
          access_level,
          user_id,
          event_id,
          granted_by,
          created_at,
          events (
            name
          ),
          profiles!event_access_user_id_fkey (
            email,
            full_name
          ),
          grantedBy:profiles!event_access_granted_by_fkey (
            email,
            full_name
          )
        `).order("created_at",{ascending:!1});if(m)throw m;e(p||[])}catch(p){console.error("Error fetching access list:",p)}finally{u(!1)}},f=async p=>{u(!0);try{const{data:m,error:g}=await N.from("event_access").select(`
          id,
          access_level,
          user_id,
          event_id,
          granted_by,
          created_at,
          events (
            name
          ),
          profiles!event_access_user_id_fkey (
            email,
            full_name
          ),
          grantedBy:profiles!event_access_granted_by_fkey (
            email,
            full_name
          )
        `).eq("event_id",p).order("created_at",{ascending:!1});if(g)throw g;e(m||[])}catch(m){console.error("Error fetching access list:",m)}finally{u(!1)}},y=async p=>{if(window.confirm("Are you sure you want to revoke this access?"))try{const{error:m}=await N.from("event_access").delete().eq("id",p);if(m)throw m;e(s.filter(g=>g.id!==p))}catch(m){console.error("Error deleting access:",m),alert("Failed to revoke access. Please try again.")}},x=o?s.filter(p=>{var m,g,w;return((m=p.profiles)==null?void 0:m.email)&&p.profiles.email.toLowerCase().includes(o.toLowerCase())||((g=p.profiles)==null?void 0:g.full_name)&&p.profiles.full_name.toLowerCase().includes(o.toLowerCase())||((w=p.events)==null?void 0:w.name)&&p.events.name.toLowerCase().includes(o.toLowerCase())}):s;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-4 sm:space-y-0",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Access Management"}),n.jsxs(F,{to:a?`/access/new?event_id=${a}`:"/access/new",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[n.jsx(vt,{size:16,className:"mr-2"}),"Grant Access"]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"event-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Event"}),n.jsxs("select",{id:"event-select",value:a||"",onChange:p=>i(p.target.value||null),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[n.jsx("option",{value:"",children:"All Events"}),t.map(p=>n.jsx("option",{value:p.id,children:p.name},p.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",id:"search",value:o,onChange:p=>l(p.target.value),placeholder:"Search by user or event name...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(xt,{size:18,className:"text-gray-400"})})]})]})]})}),c?n.jsx("div",{className:"animate-pulse",children:[1,2,3].map(p=>n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),n.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4"})]},p))}):x.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Access Level"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted By"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Granted On"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(p=>{var m,g,w,b,_;return n.jsxs("tr",{children:[n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:((m=p.profiles)==null?void 0:m.full_name)||"Unnamed User"}),n.jsx("div",{className:"text-sm text-gray-500",children:(g=p.profiles)==null?void 0:g.email})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(w=p.events)==null?void 0:w.name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${p.access_level==="owner"?"bg-purple-100 text-purple-800":p.access_level==="admin"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:p.access_level})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((b=p.grantedBy)==null?void 0:b.full_name)||((_=p.grantedBy)==null?void 0:_.email)||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(p.created_at).toLocaleDateString()}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx(F,{to:`/access/${p.id}/edit`,className:"text-blue-600 hover:text-blue-900 mr-4",children:n.jsx(yt,{size:16})}),n.jsx("button",{onClick:()=>y(p.id),className:"text-red-600 hover:text-red-900",children:n.jsx(ts,{size:16})})]})]},p.id)})})]})}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("p",{className:"text-gray-500 text-sm",children:o||a?"No access records found matching your criteria":"No access records found"}),n.jsx(F,{to:"/access/new",className:"mt-2 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"Grant access to users"})]})]})]})},Ir=({isEdit:s=!1})=>{const{id:e}=be(),t=zs(),r=We(),[a,i]=v.useState(!1),[o,l]=v.useState([]),[c,u]=v.useState({user_email:"",event_id:"",role:"scanner"});v.useEffect(()=>{d(),s&&e&&h();const m=new URLSearchParams(t.search).get("event_id");m&&u(g=>({...g,event_id:m}))},[e,s,t.search]);const d=async()=>{try{const{data:m,error:g}=await N.from("events").select("id, name").order("start_date",{ascending:!1});if(g)throw g;l(m||[])}catch(m){console.error("Error fetching events:",m),P.error("Failed to load events")}},h=async()=>{var m;try{i(!0);const{data:g,error:w}=await N.from("event_access").select("*, user:user_id(id, email)").eq("id",e).single();if(w)throw w;g&&u({user_email:((m=g.user)==null?void 0:m.email)||"",event_id:g.event_id,role:g.role})}catch(g){console.error("Error fetching access:",g),P.error("Failed to load access data")}finally{i(!1)}},f=m=>{const{name:g,value:w}=m.target;u(b=>({...b,[g]:w}))},y=async m=>{if(m.preventDefault(),!c.user_email||!c.event_id){P.error("Please fill in all required fields");return}i(!0);try{const{data:g,error:w}=await N.from("users").select("id").eq("email",c.user_email.trim()).single();if(w||!g)throw new Error("User not found");s&&e?await x(g.id):await p(g.id),r(c.event_id?`/access?event_id=${c.event_id}`:"/access")}catch(g){console.error("Error:",g),P.error(g.message||"An error occurred")}finally{i(!1)}},x=async m=>{const{error:g}=await N.from("event_access").update({user_id:m,event_id:c.event_id,role:c.role,updated_at:new Date().toISOString()}).eq("id",e);if(g)throw g;P.success("Access updated successfully")},p=async m=>{var w;const{error:g}=await N.from("event_access").insert([{user_id:m,event_id:c.event_id,role:c.role,created_by:(w=(await N.auth.getUser()).data.user)==null?void 0:w.id}]);if(g)throw g;P.success("Access granted successfully")};return a&&s?n.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n.jsx("div",{className:"max-w-3xl mx-auto",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[n.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:s?"Edit Access":"Grant Access"})}),n.jsxs("form",{onSubmit:y,className:"p-6 space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"user_email",className:"block text-sm font-medium text-gray-700 mb-1",children:["User Email ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"email",id:"user_email",name:"user_email",value:c.user_email,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter user's email",required:!0,disabled:s})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"event_id",className:"block text-sm font-medium text-gray-700 mb-1",children:["Event ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{id:"event_id",name:"event_id",value:c.event_id,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:!!new URLSearchParams(t.search).get("event_id"),children:[n.jsx("option",{value:"",children:"Select an event"}),o.map(m=>n.jsx("option",{value:m.id,children:m.name},m.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:["Role ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{id:"role",name:"role",value:c.role,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:[n.jsx("option",{value:"scanner",children:"Scanner"}),n.jsx("option",{value:"admin",children:"Admin"})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>r(-1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:a,children:"Cancel"}),n.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",disabled:a,children:a?"Saving...":s?"Update Access":"Grant Access"})]})]})]})})},rl=()=>n.jsx(Ir,{}),al=()=>(be(),n.jsx(Ir,{isEdit:!0})),nl=()=>{const[s,e]=v.useState(!1),[t,r]=v.useState(!1),[a,i]=v.useState("account"),[,o]=v.useState(null),[l,c]=v.useState({email:"",full_name:"",phone:""}),[u,d]=v.useState({currentPassword:"",newPassword:"",confirmPassword:""});v.useEffect(()=>{h()},[]);const h=async()=>{try{e(!0);const{data:{user:m}}=await N.auth.getUser();if(!m)throw new Error("No user found");const{data:g,error:w}=await N.from("profiles").select("*").eq("id",m.id).single();if(w)throw w;o(g),c({full_name:g.full_name||"",email:g.email||"",phone:g.phone||""})}catch(m){console.error("Error fetching profile:",m),D.error("Failed to load profile",{operation:"read",severity:"error",technicalDetails:"Failed to fetch profile data",context:{component:"SettingsPage",action:"fetchProfile",error:m instanceof Error?m:new Error("Unknown error fetching profile")},toastOptions:{autoClose:1e4}})}finally{e(!1)}},f=m=>{const{name:g,value:w}=m.target;c(b=>({...b,[g]:w}))},y=m=>{const{name:g,value:w}=m.target;d(b=>({...b,[g]:w}))},x=async m=>{m.preventDefault();try{e(!0);const{data:{user:g}}=await N.auth.getUser();if(!g)throw new Error("No user found");const{error:w}=await N.from("profiles").update({full_name:l.full_name,phone:l.phone,updated_at:new Date().toISOString()}).eq("id",g.id);if(w)throw w;if(l.email!==g.email){const{error:b}=await N.auth.updateUser({email:l.email},{emailRedirectTo:`${window.location.origin}/settings`});if(b)throw b}await h(),D.success("Profile updated successfully",{origin:"app",context:{}})}catch(g){console.error("Error updating profile:",g),D.error("Could not update profile",void 0,{origin:"app",context:{}})}finally{e(!1)}},p=async m=>{if(m.preventDefault(),u.newPassword!==u.confirmPassword){D.error("New password and confirmation do not match",{origin:"app",context:{}});return}if(u.newPassword.length<8){D.error("Password must be at least 8 characters long",{origin:"app",context:{}});return}try{if(r(!0),u.currentPassword){const{error:b}=await N.auth.signInWithPassword({email:l.email||"",password:u.currentPassword});if(b)throw new Error("Current password is incorrect")}const{error:g}=await N.auth.updateUser({password:u.newPassword});if(g)throw g;d({currentPassword:"",newPassword:"",confirmPassword:""});const{error:w}=await N.auth.signOut();if(w)throw w;D.success("Successfully signed out",{origin:"app",context:{}})}catch(g){D.error("Failed to update password",{origin:"settings",context:{entity:"user",operation:"update_password",error:g instanceof Error?g:new Error(String(g))}})}finally{r(!1)}};return s&&!l.email?n.jsx("div",{className:"flex justify-center items-center min-h-screen",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n.jsxs("div",{className:"container mx-auto px-4 py-8",children:[n.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Settings"}),n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex -mb-px",children:[n.jsx("button",{onClick:()=>i("account"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${a==="account"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,type:"button",children:"Account"}),n.jsx("button",{onClick:()=>i("password"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${a==="password"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,type:"button",children:"Change Password"})]})}),n.jsx("div",{className:"p-6",children:a==="account"?n.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),n.jsx("input",{type:"email",name:"email",id:"email",value:l.email,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:s})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),n.jsx("input",{type:"text",name:"full_name",id:"full_name",value:l.full_name,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:s})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),n.jsx("input",{type:"tel",name:"phone",id:"phone",value:l.phone,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:s})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:s,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Saving...":"Save Changes"})})]}):n.jsxs("form",{onSubmit:m=>{m.preventDefault(),p(m)},className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),n.jsx("input",{type:"password",name:"currentPassword",id:"currentPassword",value:u.currentPassword,onChange:y,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:t,required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700",children:"New Password"}),n.jsx("input",{type:"password",name:"newPassword",id:"newPassword",value:u.newPassword,onChange:y,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:t,minLength:8,required:!0}),n.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 8 characters long"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),n.jsx("input",{type:"password",name:"confirmPassword",id:"confirmPassword",value:u.confirmPassword,onChange:y,className:`mt-1 block w-full rounded-md shadow-sm sm:text-sm ${u.newPassword&&u.confirmPassword&&u.newPassword!==u.confirmPassword?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,disabled:t,required:!0}),u.newPassword&&u.confirmPassword&&u.newPassword!==u.confirmPassword&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Passwords do not match"})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:t||!u.currentPassword||!u.newPassword||!u.confirmPassword||u.newPassword!==u.confirmPassword,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Updating...":"Update Password"})})]})})]})]})};var $r={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(s){(function(){var e={}.hasOwnProperty;function t(){for(var i="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(i=a(i,r(l)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return t.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var o="";for(var l in i)e.call(i,l)&&i[l]&&(o=a(o,l));return o}function a(i,o){return o?i?i+" "+o:i+o:i}s.exports?(t.default=t,s.exports=t):window.classNames=t})()})($r);var il=$r.exports;const G=ra(il),ol=["xxl","xl","lg","md","sm","xs"],ll="xs",wt=v.createContext({prefixes:{},breakpoints:ol,minBreakpoint:ll}),{Consumer:Nc,Provider:Sc}=wt;function Z(s,e){const{prefixes:t}=v.useContext(wt);return s||t[e]||e}function Dr(){const{breakpoints:s}=v.useContext(wt);return s}function Rr(){const{minBreakpoint:s}=v.useContext(wt);return s}const Lr=s=>v.forwardRef((e,t)=>n.jsx("div",{...e,ref:t,className:G(e.className,s)})),cl=["as","disabled"];function dl(s,e){if(s==null)return{};var t={};for(var r in s)if({}.hasOwnProperty.call(s,r)){if(e.indexOf(r)>=0)continue;t[r]=s[r]}return t}function ul(s){return!s||s.trim()==="#"}function Ur({tagName:s,disabled:e,href:t,target:r,rel:a,role:i,onClick:o,tabIndex:l=0,type:c}){s||(t!=null||r!=null||a!=null?s="a":s="button");const u={tagName:s};if(s==="button")return[{type:c||"button",disabled:e},u];const d=f=>{if((e||s==="a"&&ul(t))&&f.preventDefault(),e){f.stopPropagation();return}o==null||o(f)},h=f=>{f.key===" "&&(f.preventDefault(),d(f))};return s==="a"&&(t||(t="#"),e&&(t=void 0)),[{role:i??"button",disabled:void 0,tabIndex:e?void 0:l,href:t,target:s==="a"?r:void 0,"aria-disabled":e||void 0,rel:s==="a"?a:void 0,onClick:d,onKeyDown:h},u]}const hl=v.forwardRef((s,e)=>{let{as:t,disabled:r}=s,a=dl(s,cl);const[i,{tagName:o}]=Ur(Object.assign({tagName:t,disabled:r},a));return n.jsx(o,Object.assign({},a,i,{ref:e}))});hl.displayName="Button";const ge=v.forwardRef(({as:s,bsPrefix:e,variant:t="primary",size:r,active:a=!1,disabled:i=!1,className:o,...l},c)=>{const u=Z(e,"btn"),[d,{tagName:h}]=Ur({tagName:s,disabled:i,...l}),f=h;return n.jsx(f,{...d,...l,ref:c,disabled:i,className:G(o,u,a&&"active",t&&`${u}-${t}`,r&&`${u}-${r}`,l.href&&i&&"disabled")})});ge.displayName="Button";const Oe=v.forwardRef(({className:s,bsPrefix:e,as:t="div",...r},a)=>(e=Z(e,"card-body"),n.jsx(t,{ref:a,className:G(s,e),...r})));Oe.displayName="CardBody";const Mr=v.forwardRef(({className:s,bsPrefix:e,as:t="div",...r},a)=>(e=Z(e,"card-footer"),n.jsx(t,{ref:a,className:G(s,e),...r})));Mr.displayName="CardFooter";const Fr=v.createContext(null);Fr.displayName="CardHeaderContext";const qe=v.forwardRef(({bsPrefix:s,className:e,as:t="div",...r},a)=>{const i=Z(s,"card-header"),o=v.useMemo(()=>({cardHeaderBsPrefix:i}),[i]);return n.jsx(Fr.Provider,{value:o,children:n.jsx(t,{ref:a,...r,className:G(e,i)})})});qe.displayName="CardHeader";const qr=v.forwardRef(({bsPrefix:s,className:e,variant:t,as:r="img",...a},i)=>{const o=Z(s,"card-img");return n.jsx(r,{ref:i,className:G(t?`${o}-${t}`:o,e),...a})});qr.displayName="CardImg";const Br=v.forwardRef(({className:s,bsPrefix:e,as:t="div",...r},a)=>(e=Z(e,"card-img-overlay"),n.jsx(t,{ref:a,className:G(s,e),...r})));Br.displayName="CardImgOverlay";const zr=v.forwardRef(({className:s,bsPrefix:e,as:t="a",...r},a)=>(e=Z(e,"card-link"),n.jsx(t,{ref:a,className:G(s,e),...r})));zr.displayName="CardLink";const fl=Lr("h6"),Wr=v.forwardRef(({className:s,bsPrefix:e,as:t=fl,...r},a)=>(e=Z(e,"card-subtitle"),n.jsx(t,{ref:a,className:G(s,e),...r})));Wr.displayName="CardSubtitle";const Hr=v.forwardRef(({className:s,bsPrefix:e,as:t="p",...r},a)=>(e=Z(e,"card-text"),n.jsx(t,{ref:a,className:G(s,e),...r})));Hr.displayName="CardText";const ml=Lr("h5"),Vr=v.forwardRef(({className:s,bsPrefix:e,as:t=ml,...r},a)=>(e=Z(e,"card-title"),n.jsx(t,{ref:a,className:G(s,e),...r})));Vr.displayName="CardTitle";const Kr=v.forwardRef(({bsPrefix:s,className:e,bg:t,text:r,border:a,body:i=!1,children:o,as:l="div",...c},u)=>{const d=Z(s,"card");return n.jsx(l,{ref:u,...c,className:G(e,d,t&&`bg-${t}`,r&&`text-${r}`,a&&`border-${a}`),children:i?n.jsx(Oe,{children:o}):o})});Kr.displayName="Card";const Ot=Object.assign(Kr,{Img:qr,Title:Vr,Subtitle:Wr,Body:Oe,Link:zr,Text:Hr,Header:qe,Footer:Mr,ImgOverlay:Br});function pl({as:s,bsPrefix:e,className:t,...r}){e=Z(e,"col");const a=Dr(),i=Rr(),o=[],l=[];return a.forEach(c=>{const u=r[c];delete r[c];let d,h,f;typeof u=="object"&&u!=null?{span:d,offset:h,order:f}=u:d=u;const y=c!==i?`-${c}`:"";d&&o.push(d===!0?`${e}${y}`:`${e}${y}-${d}`),f!=null&&l.push(`order${y}-${f}`),h!=null&&l.push(`offset${y}-${h}`)}),[{...r,className:G(t,...o,...l)},{as:s,bsPrefix:e,spans:o}]}const tt=v.forwardRef((s,e)=>{const[{className:t,...r},{as:a="div",bsPrefix:i,spans:o}]=pl(s);return n.jsx(a,{...r,ref:e,className:G(t,!o.length&&i)})});tt.displayName="Col";const Jr=v.forwardRef(({bsPrefix:s,fluid:e=!1,as:t="div",className:r,...a},i)=>{const o=Z(s,"container"),l=typeof e=="string"?`-${e}`:"-fluid";return n.jsx(t,{ref:i,...a,className:G(r,e?`${o}${l}`:o)})});Jr.displayName="Container";const Gr=v.forwardRef(({bsPrefix:s,className:e,as:t="div",...r},a)=>{const i=Z(s,"row"),o=Dr(),l=Rr(),c=`${i}-cols`,u=[];return o.forEach(d=>{const h=r[d];delete r[d];let f;h!=null&&typeof h=="object"?{cols:f}=h:f=h;const y=d!==l?`-${d}`:"";f!=null&&u.push(`${c}${y}-${f}`)}),n.jsx(t,{ref:a,...r,className:G(e,i,...u)})});Gr.displayName="Row";function gl(){const s=()=>{D.info("This is a system notification",{origin:"test",context:{entity:"system",operation:"test",test:"system",code:"SYSTEM_NOTIFICATION",technicalDetails:"System notification test"},toastOptions:{autoClose:3e3}})},e=()=>{D.success("Operation completed successfully",{origin:"test",context:{entity:"test",operation:"create",test:"success",technicalDetails:"Success notification test"},toastOptions:{autoClose:3e3}})},t=()=>{try{throw new Error("This is a test error")}catch(o){const l=o instanceof Error?o.message:"Unknown error";D.error("An error occurred",o,{origin:"test",context:{entity:"test",operation:"delete",error:o instanceof Error?o.stack:String(o),test:"error",technicalDetails:l},toastOptions:{autoClose:5e3}})}},r=()=>{D.warning("This is a warning",{origin:"test",context:{entity:"test",operation:"update",test:"warning",technicalDetails:"Warning notification test"},toastOptions:{autoClose:4e3}})},a=()=>{D.info("Test item created",{origin:"test",context:{entity:"test",operation:"create",test:"functional",technicalDetails:"Additional details about the operation",data:{id:"123",name:"Test Item"}},toastOptions:{autoClose:4500}})},i=()=>{D.success("Test item was created",{origin:"test",context:{entity:"Test Item",operation:"create",id:"123"}}),D.success("Test item was updated",{origin:"test",context:{entity:"Test Item",operation:"update",id:"123"}}),D.success("Test item was deleted",{origin:"test",context:{entity:"Test Item",operation:"delete",id:"123"}}),D.success("Test items were fetched",{origin:"test",context:{entity:"Test Items",operation:"read",count:5}})};return n.jsxs(Jr,{className:"py-4",children:[n.jsx("h1",{className:"mb-4",children:"Notification System Test"}),n.jsxs(Gr,{className:"g-4",children:[n.jsx(tt,{md:6,lg:4,children:n.jsxs(Ot,{children:[n.jsx(qe,{children:"System Notifications"}),n.jsxs(Oe,{children:[n.jsx(ge,{variant:"outline-primary",className:"w-100 mb-2",onClick:s,children:"Test System Notification"}),n.jsx(ge,{variant:"outline-success",className:"w-100 mb-2",onClick:e,children:"Test Success Notification"}),n.jsx(ge,{variant:"outline-danger",className:"w-100 mb-2",onClick:t,children:"Test Error Notification"}),n.jsx(ge,{variant:"outline-warning",className:"w-100",onClick:r,children:"Test Warning Notification"})]})]})}),n.jsx(tt,{md:6,lg:4,children:n.jsxs(Ot,{children:[n.jsx(qe,{children:"Functional Notifications"}),n.jsxs(Oe,{children:[n.jsx(ge,{variant:"outline-info",className:"w-100 mb-3",onClick:a,children:"Test Functional Notification"}),n.jsx(ge,{variant:"outline-secondary",className:"w-100",onClick:i,children:"Test CRUD Notifications"})]})]})}),n.jsx(tt,{md:12,lg:4,children:n.jsxs(Ot,{children:[n.jsx(qe,{children:"Notification Center"}),n.jsxs(Oe,{children:[n.jsx("p",{className:"text-muted",children:"Check the notification center (bell icon) to see all notifications. Notifications will also appear as toasts at the top-right of the screen."}),n.jsxs("p",{className:"text-muted",children:[n.jsx("strong",{children:"Note:"})," System notifications with severity 'debug' will only appear in the console."]})]})]})})]})]})}const yl=()=>{const s=[{to:"/",label:"Dashboard",icon:n.jsx(No,{size:20})},{to:"/events",label:"Events",icon:n.jsx(xo,{size:20})},{to:"/wristbands",label:"Wristbands",icon:n.jsx(Jt,{size:20})},{to:"/checkins",label:"Check-ins",icon:n.jsx(wo,{size:20})},{to:"/access",label:"User Access",icon:n.jsx(vt,{size:20})}];return n.jsxs("aside",{className:"hidden md:flex md:flex-col md:w-64 bg-white border-r border-gray-200",children:[n.jsx("div",{className:"flex items-center justify-center h-16 border-b border-gray-200",children:n.jsx("h1",{className:"text-xl font-bold text-blue-600",children:"Event Admin"})}),n.jsx("div",{className:"flex flex-col flex-1 overflow-y-auto",children:n.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1",children:s.map(e=>n.jsxs(ls,{to:e.to,className:({isActive:t})=>`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ${t?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:[n.jsx("span",{className:"mr-3",children:e.icon}),e.label]},e.to))})}),n.jsx("div",{className:"p-4 border-t border-gray-200",children:n.jsxs(ls,{to:"/settings",className:"flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:[n.jsx(Co,{size:20,className:"mr-3"}),"Settings"]})})]})},et=43200,Us=1440,Ms=Symbol.for("constructDateFrom");function ss(s,e){return typeof s=="function"?s(e):s&&typeof s=="object"&&Ms in s?s[Ms](e):s instanceof Date?new s.constructor(e):new Date(e)}function xl(s){return ss(s,Date.now())}const vl={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},bl=(s,e,t)=>{let r;const a=vl[s];return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function At(s){return(e={})=>{const t=e.width?String(e.width):s.defaultWidth;return s.formats[t]||s.formats[s.defaultWidth]}}const wl={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},_l={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},jl={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},kl={date:At({formats:wl,defaultWidth:"full"}),time:At({formats:_l,defaultWidth:"full"}),dateTime:At({formats:jl,defaultWidth:"full"})},Nl={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Sl=(s,e,t,r)=>Nl[s];function Re(s){return(e,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&s.formattingValues){const o=s.defaultFormattingWidth||s.defaultWidth,l=t!=null&&t.width?String(t.width):o;a=s.formattingValues[l]||s.formattingValues[o]}else{const o=s.defaultWidth,l=t!=null&&t.width?String(t.width):s.defaultWidth;a=s.values[l]||s.values[o]}const i=s.argumentCallback?s.argumentCallback(e):e;return a[i]}}const Tl={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},El={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Cl={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Pl={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ol={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Al={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Il=(s,e)=>{const t=Number(s),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},$l={ordinalNumber:Il,era:Re({values:Tl,defaultWidth:"wide"}),quarter:Re({values:El,defaultWidth:"wide",argumentCallback:s=>s-1}),month:Re({values:Cl,defaultWidth:"wide"}),day:Re({values:Pl,defaultWidth:"wide"}),dayPeriod:Re({values:Ol,defaultWidth:"wide",formattingValues:Al,defaultFormattingWidth:"wide"})};function Le(s){return(e,t={})=>{const r=t.width,a=r&&s.matchPatterns[r]||s.matchPatterns[s.defaultMatchWidth],i=e.match(a);if(!i)return null;const o=i[0],l=r&&s.parsePatterns[r]||s.parsePatterns[s.defaultParseWidth],c=Array.isArray(l)?Rl(l,h=>h.test(o)):Dl(l,h=>h.test(o));let u;u=s.valueCallback?s.valueCallback(c):c,u=t.valueCallback?t.valueCallback(u):u;const d=e.slice(o.length);return{value:u,rest:d}}}function Dl(s,e){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&e(s[t]))return t}function Rl(s,e){for(let t=0;t<s.length;t++)if(e(s[t]))return t}function Ll(s){return(e,t={})=>{const r=e.match(s.matchPattern);if(!r)return null;const a=r[0],i=e.match(s.parsePattern);if(!i)return null;let o=s.valueCallback?s.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const l=e.slice(a.length);return{value:o,rest:l}}}const Ul=/^(\d+)(th|st|nd|rd)?/i,Ml=/\d+/i,Fl={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ql={any:[/^b/i,/^(a|c)/i]},Bl={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},zl={any:[/1/i,/2/i,/3/i,/4/i]},Wl={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Hl={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Vl={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Kl={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Jl={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Gl={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Xl={ordinalNumber:Ll({matchPattern:Ul,parsePattern:Ml,valueCallback:s=>parseInt(s,10)}),era:Le({matchPatterns:Fl,defaultMatchWidth:"wide",parsePatterns:ql,defaultParseWidth:"any"}),quarter:Le({matchPatterns:Bl,defaultMatchWidth:"wide",parsePatterns:zl,defaultParseWidth:"any",valueCallback:s=>s+1}),month:Le({matchPatterns:Wl,defaultMatchWidth:"wide",parsePatterns:Hl,defaultParseWidth:"any"}),day:Le({matchPatterns:Vl,defaultMatchWidth:"wide",parsePatterns:Kl,defaultParseWidth:"any"}),dayPeriod:Le({matchPatterns:Jl,defaultMatchWidth:"any",parsePatterns:Gl,defaultParseWidth:"any"})},Yl={code:"en-US",formatDistance:bl,formatLong:kl,formatRelative:Sl,localize:$l,match:Xl,options:{weekStartsOn:0,firstWeekContainsDate:1}};let Ql={};function Zl(){return Ql}function de(s,e){return ss(s,s)}function Fs(s){const e=de(s),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+s-+t}function rs(s,...e){const t=ss.bind(null,s||e.find(r=>typeof r=="object"));return e.map(t)}function st(s,e){const t=+de(s)-+de(e);return t<0?-1:t>0?1:t}function ec(s,e,t){const[r,a]=rs(t==null?void 0:t.in,s,e),i=r.getFullYear()-a.getFullYear(),o=r.getMonth()-a.getMonth();return i*12+o}function tc(s,e){const t=de(s);return t.setHours(23,59,59,999),t}function sc(s,e){const t=de(s),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function rc(s,e){const t=de(s);return+tc(t)==+sc(t)}function ac(s,e,t){const[r,a,i]=rs(t==null?void 0:t.in,s,s,e),o=st(a,i),l=Math.abs(ec(a,i));if(l<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-o*l);let c=st(a,i)===-o;rc(r)&&l===1&&st(r,i)===1&&(c=!1);const u=o*(l-+c);return u===0?0:u}function nc(s){return e=>{const r=(s?Math[s]:Math.trunc)(e);return r===0?0:r}}function ic(s,e){return+de(s)-+de(e)}function oc(s,e,t){const r=ic(s,e)/1e3;return nc(t==null?void 0:t.roundingMethod)(r)}function lc(s,e,t){const r=Zl(),a=(t==null?void 0:t.locale)??r.locale??Yl,i=2520,o=st(s,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:o}),[c,u]=rs(t==null?void 0:t.in,...o>0?[e,s]:[s,e]),d=oc(u,c),h=(Fs(u)-Fs(c))/1e3,f=Math.round((d-h)/60);let y;if(f<2)return t!=null&&t.includeSeconds?d<5?a.formatDistance("lessThanXSeconds",5,l):d<10?a.formatDistance("lessThanXSeconds",10,l):d<20?a.formatDistance("lessThanXSeconds",20,l):d<40?a.formatDistance("halfAMinute",0,l):d<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):f===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",f,l);if(f<45)return a.formatDistance("xMinutes",f,l);if(f<90)return a.formatDistance("aboutXHours",1,l);if(f<Us){const x=Math.round(f/60);return a.formatDistance("aboutXHours",x,l)}else{if(f<i)return a.formatDistance("xDays",1,l);if(f<et){const x=Math.round(f/Us);return a.formatDistance("xDays",x,l)}else if(f<et*2)return y=Math.round(f/et),a.formatDistance("aboutXMonths",y,l)}if(y=ac(u,c),y<12){const x=Math.round(f/et);return a.formatDistance("xMonths",x,l)}else{const x=y%12,p=Math.trunc(y/12);return x<3?a.formatDistance("aboutXYears",p,l):x<9?a.formatDistance("overXYears",p,l):a.formatDistance("almostXYears",p+1,l)}}function cc(s,e){return lc(s,xl(s),e)}const dc=()=>{const[s,e]=v.useState(!1),{notifications:t,unreadCount:r,markAsRead:a,markAllAsRead:i,removeNotification:o}=bt(),l=v.useRef(null);v.useEffect(()=>{function d(h){l.current&&!l.current.contains(h.target)&&e(!1)}return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]);const c=d=>{const h="w-5 h-5 mr-2";if(d.category==="system")switch(d.severity){case"error":case"critical":return n.jsx(Oo,{className:`${h} text-red-500`});case"warning":return n.jsx(go,{className:`${h} text-yellow-500`});case"info":case"debug":default:return n.jsx(ko,{className:`${h} text-blue-500`})}else return n.jsx(vo,{className:`${h} text-green-500`})},u=d=>{if(d.category==="system")return`System ${d.severity}`;{const h=d;return h.entity.charAt(0).toUpperCase()+h.entity.slice(1)}};return n.jsxs("div",{className:"relative",ref:l,children:[n.jsxs("button",{onClick:()=>{e(!s),!s&&r>0&&i()},className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 relative","aria-label":"Notifications",children:[n.jsx(yo,{className:"w-6 h-6 text-gray-600 dark:text-gray-300"}),r>0&&n.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-500 rounded-full",children:r>9?"9+":r})]}),s&&n.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden z-50",children:[n.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[n.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Notifications"}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:i,className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",disabled:t.length===0,children:"Mark all as read"}),n.jsx("button",{onClick:()=>e(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:n.jsx(Os,{className:"w-5 h-5"})})]})]}),n.jsx("div",{className:"max-h-96 overflow-y-auto",children:t.length===0?n.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No notifications"}):n.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:t.map(d=>{var h;return n.jsx("li",{className:`p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 ${d.read?"":"bg-blue-50 dark:bg-blue-900/20"}`,onClick:()=>a(d.id),children:n.jsxs("div",{className:"flex items-start",children:[n.jsx("div",{className:"flex-shrink-0",children:c(d)}),n.jsxs("div",{className:"ml-3 flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u(d)}),n.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[n.jsx(_o,{className:"w-3 h-3 mr-1"}),cc(new Date(d.timestamp),{addSuffix:!0})]})]}),n.jsx("p",{className:"mt-1 text-sm text-gray-700 dark:text-gray-300",children:d.category==="system"?typeof d.context=="object"&&d.context!==null&&((h=d.context)==null?void 0:h.message)||"System notification":d.message}),d.category==="functional"&&d.technicalDetails&&n.jsxs("details",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[n.jsx("summary",{className:"cursor-pointer",children:"Details"}),n.jsx("pre",{className:"mt-1 p-2 bg-gray-100 dark:bg-gray-900 rounded overflow-auto max-h-32",children:d.technicalDetails})]})]}),n.jsx("button",{onClick:f=>{f.stopPropagation(),o(d.id)},className:"ml-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200","aria-label":"Dismiss notification",children:n.jsx(Os,{className:"w-4 h-4"})})]})},d.id)})})})]})]})},uc=({user:s})=>{const[e,t]=v.useState(!1),r=We(),a=async()=>{await N.auth.signOut(),r("/login")};return n.jsx("header",{className:"bg-white border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between h-16 px-4 md:px-6",children:[n.jsx("div",{className:"flex items-center md:hidden",children:n.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-600","aria-label":"Open sidebar",children:n.jsx(To,{size:24})})}),n.jsx("div",{className:"flex-1"}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("div",{className:"relative",children:n.jsx(dc,{})}),n.jsxs("div",{className:"relative",children:[n.jsx("button",{type:"button",className:"flex items-center text-sm rounded-full focus:outline-none",onClick:()=>t(!e),children:n.jsxs("div",{className:"flex items-center px-2 py-1 rounded-full hover:bg-gray-100",children:[n.jsx("div",{className:"bg-blue-100 text-blue-800 flex items-center justify-center w-8 h-8 rounded-full",children:n.jsx(Po,{size:16})}),n.jsx("span",{className:"ml-2 text-gray-700 hidden sm:block",children:s==null?void 0:s.email}),n.jsx(bo,{size:16,className:"ml-1 text-gray-500"})]})}),e&&n.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 border border-gray-200",onBlur:()=>t(!1),children:n.jsxs("button",{onClick:a,className:"flex w-full items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[n.jsx(So,{size:16,className:"mr-2"}),"Sign out"]})})]})]})]})})},hc=({user:s})=>n.jsxs("div",{className:"flex h-screen bg-gray-100",children:[n.jsx(yl,{}),n.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[n.jsx(uc,{user:s}),n.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:n.jsx(aa,{})})]})]}),fc=()=>{const[s,e]=v.useState(null),[t,r]=v.useState(!0),[a,i]=v.useState(null);return v.useEffect(()=>{N.auth.getSession().then(({data:{session:l}})=>{e(l),i((l==null?void 0:l.user)??null),r(!1)});const{data:{subscription:o}}=N.auth.onAuthStateChange((l,c)=>{e(c),i((c==null?void 0:c.user)??null)});return()=>o.unsubscribe()},[]),t?n.jsx(Pr,{}):n.jsxs(n.Fragment,{children:[n.jsx(ho,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),n.jsx(na,{children:n.jsxs(ia,{children:[n.jsx(H,{path:"/login",element:s?n.jsx(Xe,{to:"/"}):n.jsx(fo,{})}),n.jsxs(H,{element:s?n.jsx(hc,{user:a}):n.jsx(Xe,{to:"/login"}),children:[n.jsx(H,{path:"/",element:n.jsx(Ao,{})}),n.jsx(H,{path:"/events",element:n.jsx(Jo,{})}),n.jsx(H,{path:"/events/new",element:n.jsx(Xo,{})}),n.jsx(H,{path:"/events/:id",element:n.jsx(Go,{})}),n.jsx(H,{path:"/events/:id/edit",element:n.jsx(Yo,{})}),n.jsx(H,{path:"/wristbands",element:n.jsx(Qo,{})}),n.jsx(H,{path:"/wristbands/new",element:n.jsx(Zo,{})}),n.jsx(H,{path:"/wristbands/:id/edit",element:n.jsx(el,{})}),n.jsx(H,{path:"/checkins",element:n.jsx(tl,{})}),n.jsx(H,{path:"/access",element:n.jsx(sl,{})}),n.jsx(H,{path:"/access/create",element:n.jsx(rl,{})}),n.jsx(H,{path:"/access/:id/edit",element:n.jsx(al,{})}),n.jsx(H,{path:"/settings",element:n.jsx(nl,{})}),n.jsx(H,{path:"/notification-test",element:n.jsx(gl,{})}),n.jsx(H,{path:"*",element:n.jsx(Xe,{to:"/",replace:!0})})]}),n.jsx(H,{path:"*",element:n.jsx(Xe,{to:"/login",replace:!0})})]})})]})},qs=document.getElementById("root");qs&&Vs(qs).render(n.jsx($.StrictMode,{children:n.jsx(fc,{})}));
//# sourceMappingURL=index-CJhcEM7s.js.map
